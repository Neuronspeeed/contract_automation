2024-10-14 13:40:47,819 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-14 13:41:10,056 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-14 13:41:36,318 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-14 13:42:09,589 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-14 13:42:18,562 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-14 13:42:50,299 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-14 13:42:58,339 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-14 13:42:59,599 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-14 13:42:59,599 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-14 13:42:59,922 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-14 13:43:19,660 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-14 13:43:20,939 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-14 13:43:20,940 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-14 13:43:21,274 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-14 13:43:21,278 - DEBUG - Using proactor: IocpProactor
2024-10-14 13:44:39,462 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-14 13:44:40,741 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-14 13:44:40,742 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-14 13:44:41,067 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-14 13:44:41,067 - DEBUG - Using proactor: IocpProactor
2024-10-14 13:44:48,782 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-14 13:44:50,044 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-14 13:44:50,044 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-14 13:44:50,368 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-14 13:44:50,368 - DEBUG - Using proactor: IocpProactor
2024-10-14 13:44:50,372 - INFO - Template selected based on metadata: airbnb.txt
2024-10-14 13:44:50,423 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 13:44:50,423 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 13:44:50,423 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 13:44:50,423 - DEBUG - Compression method 0
2024-10-14 13:44:50,423 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 13:44:50,423 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 13:44:50,423 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-14 13:44:50,423 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-14 13:44:50,423 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-14 13:44:50,423 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-14 13:44:50,423 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 13:44:50,423 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 13:44:50,423 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 13:44:50,424 - DEBUG - Compression method 0
2024-10-14 13:44:50,424 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 13:44:50,424 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 13:44:50,424 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-14 13:44:50,424 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-14 13:44:50,424 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-14 13:44:50,424 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-14 13:44:50,435 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 13:44:50,435 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 13:44:50,435 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-14 13:44:50,435 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-14 13:44:50,436 - DEBUG - Error closing: Operation on closed image
2024-10-14 13:44:52,427 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 13:44:52,427 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 13:44:52,427 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 13:44:52,427 - DEBUG - Compression method 0
2024-10-14 13:44:52,427 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 13:44:52,427 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 13:44:52,427 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-14 13:44:52,427 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-14 13:44:52,427 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-14 13:44:52,427 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-14 13:44:52,427 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 13:44:52,427 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 13:44:52,427 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 13:44:52,427 - DEBUG - Compression method 0
2024-10-14 13:44:52,427 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 13:44:52,427 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 13:44:52,427 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-14 13:44:52,427 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-14 13:44:52,427 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-14 13:44:52,427 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-14 13:44:52,445 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 13:44:52,445 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 13:44:52,445 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-14 13:44:52,445 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-14 13:44:52,446 - DEBUG - Error closing: Operation on closed image
2024-10-14 13:46:10,517 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-14 13:46:11,788 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-14 13:46:11,789 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-14 13:46:12,113 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-14 13:46:12,114 - DEBUG - Using proactor: IocpProactor
2024-10-14 13:46:12,119 - INFO - Template selected based on metadata: airbnb.txt
2024-10-14 13:46:12,134 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 13:46:12,135 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 13:46:12,135 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 13:46:12,135 - DEBUG - Compression method 0
2024-10-14 13:46:12,135 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 13:46:12,135 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 13:46:12,135 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-14 13:46:12,135 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-14 13:46:12,135 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-14 13:46:12,135 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-14 13:46:12,135 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 13:46:12,135 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 13:46:12,135 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 13:46:12,135 - DEBUG - Compression method 0
2024-10-14 13:46:12,135 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 13:46:12,135 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 13:46:12,135 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-14 13:46:12,135 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-14 13:46:12,135 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-14 13:46:12,135 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-14 13:46:12,145 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 13:46:12,145 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 13:46:12,145 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-14 13:46:12,145 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-14 13:46:12,146 - DEBUG - Error closing: Operation on closed image
2024-10-14 13:46:14,129 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 13:46:14,129 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 13:46:14,129 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 13:46:14,129 - DEBUG - Compression method 0
2024-10-14 13:46:14,129 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 13:46:14,129 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 13:46:14,129 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-14 13:46:14,129 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-14 13:46:14,129 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-14 13:46:14,129 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-14 13:46:14,129 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 13:46:14,129 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 13:46:14,129 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 13:46:14,129 - DEBUG - Compression method 0
2024-10-14 13:46:14,129 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 13:46:14,129 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 13:46:14,129 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-14 13:46:14,129 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-14 13:46:14,129 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-14 13:46:14,129 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-14 13:46:14,146 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 13:46:14,146 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 13:46:14,146 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-14 13:46:14,146 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-14 13:46:14,147 - DEBUG - Error closing: Operation on closed image
2024-10-14 13:46:26,165 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-14 13:46:27,417 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-14 13:46:27,417 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-14 13:46:27,732 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-14 13:46:27,733 - DEBUG - Using proactor: IocpProactor
2024-10-14 13:46:27,737 - INFO - Template selected based on metadata: airbnb.txt
2024-10-14 13:46:27,753 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 13:46:27,753 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 13:46:27,753 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 13:46:27,753 - DEBUG - Compression method 0
2024-10-14 13:46:27,753 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 13:46:27,753 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 13:46:27,753 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-14 13:46:27,753 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-14 13:46:27,753 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-14 13:46:27,753 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-14 13:46:27,753 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 13:46:27,753 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 13:46:27,753 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 13:46:27,753 - DEBUG - Compression method 0
2024-10-14 13:46:27,754 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 13:46:27,754 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 13:46:27,754 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-14 13:46:27,754 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-14 13:46:27,754 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-14 13:46:27,754 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-14 13:46:27,763 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 13:46:27,763 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 13:46:27,763 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-14 13:46:27,763 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-14 13:46:27,764 - DEBUG - Error closing: Operation on closed image
2024-10-14 13:46:29,758 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 13:46:29,758 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 13:46:29,758 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 13:46:29,758 - DEBUG - Compression method 0
2024-10-14 13:46:29,758 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 13:46:29,758 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 13:46:29,758 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-14 13:46:29,758 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-14 13:46:29,758 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-14 13:46:29,758 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-14 13:46:29,759 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 13:46:29,759 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 13:46:29,759 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 13:46:29,759 - DEBUG - Compression method 0
2024-10-14 13:46:29,759 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 13:46:29,759 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 13:46:29,759 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-14 13:46:29,759 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-14 13:46:29,759 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-14 13:46:29,759 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-14 13:46:29,776 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 13:46:29,776 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 13:46:29,776 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-14 13:46:29,776 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-14 13:46:29,777 - DEBUG - Error closing: Operation on closed image
2024-10-14 13:47:02,877 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-14 13:47:04,164 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-14 13:47:04,165 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-14 13:47:04,489 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-14 13:47:04,489 - DEBUG - Using proactor: IocpProactor
2024-10-14 13:47:04,494 - INFO - Template selected based on metadata: airbnb.txt
2024-10-14 13:47:04,508 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 13:47:04,509 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 13:47:04,509 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 13:47:04,509 - DEBUG - Compression method 0
2024-10-14 13:47:04,509 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 13:47:04,509 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 13:47:04,509 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-14 13:47:04,509 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-14 13:47:04,509 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-14 13:47:04,509 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-14 13:47:04,509 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 13:47:04,509 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 13:47:04,509 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 13:47:04,509 - DEBUG - Compression method 0
2024-10-14 13:47:04,510 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 13:47:04,510 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 13:47:04,510 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-14 13:47:04,510 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-14 13:47:04,510 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-14 13:47:04,510 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-14 13:47:04,520 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 13:47:04,520 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 13:47:04,520 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-14 13:47:04,520 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-14 13:47:04,520 - DEBUG - Error closing: Operation on closed image
2024-10-14 13:47:06,501 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 13:47:06,501 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 13:47:06,501 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 13:47:06,501 - DEBUG - Compression method 0
2024-10-14 13:47:06,501 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 13:47:06,501 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 13:47:06,501 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-14 13:47:06,501 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-14 13:47:06,501 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-14 13:47:06,501 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-14 13:47:06,501 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 13:47:06,501 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 13:47:06,501 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 13:47:06,501 - DEBUG - Compression method 0
2024-10-14 13:47:06,501 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 13:47:06,501 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 13:47:06,501 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-14 13:47:06,501 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-14 13:47:06,501 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-14 13:47:06,501 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-14 13:47:06,519 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 13:47:06,519 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 13:47:06,519 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-14 13:47:06,519 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-14 13:47:06,520 - DEBUG - Error closing: Operation on closed image
2024-10-14 13:47:20,942 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-14 13:47:22,209 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-14 13:47:22,209 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-14 13:47:22,533 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-14 13:47:22,534 - DEBUG - Using proactor: IocpProactor
2024-10-14 13:47:22,540 - INFO - Template selected based on metadata: airbnb.txt
2024-10-14 13:47:22,556 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 13:47:22,557 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 13:47:22,557 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 13:47:22,557 - DEBUG - Compression method 0
2024-10-14 13:47:22,557 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 13:47:22,557 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 13:47:22,557 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-14 13:47:22,557 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-14 13:47:22,557 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-14 13:47:22,557 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-14 13:47:22,557 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 13:47:22,557 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 13:47:22,557 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 13:47:22,557 - DEBUG - Compression method 0
2024-10-14 13:47:22,557 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 13:47:22,557 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 13:47:22,557 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-14 13:47:22,557 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-14 13:47:22,557 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-14 13:47:22,557 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-14 13:47:22,567 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 13:47:22,567 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 13:47:22,567 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-14 13:47:22,567 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-14 13:47:22,567 - DEBUG - Error closing: Operation on closed image
2024-10-14 13:47:24,615 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 13:47:24,615 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 13:47:24,615 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 13:47:24,615 - DEBUG - Compression method 0
2024-10-14 13:47:24,615 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 13:47:24,615 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 13:47:24,615 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-14 13:47:24,615 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-14 13:47:24,615 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-14 13:47:24,615 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-14 13:47:24,615 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 13:47:24,615 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 13:47:24,615 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 13:47:24,615 - DEBUG - Compression method 0
2024-10-14 13:47:24,615 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 13:47:24,616 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 13:47:24,616 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-14 13:47:24,616 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-14 13:47:24,616 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-14 13:47:24,616 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-14 13:47:24,633 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 13:47:24,633 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 13:47:24,633 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-14 13:47:24,633 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-14 13:47:24,634 - DEBUG - Error closing: Operation on closed image
2024-10-14 13:48:57,860 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-14 13:48:59,124 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-14 13:48:59,125 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-14 13:48:59,452 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-14 13:48:59,453 - DEBUG - Using proactor: IocpProactor
2024-10-14 13:48:59,458 - INFO - Template selected based on metadata: airbnb.txt
2024-10-14 13:48:59,472 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 13:48:59,472 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 13:48:59,472 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 13:48:59,472 - DEBUG - Compression method 0
2024-10-14 13:48:59,472 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 13:48:59,472 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 13:48:59,472 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-14 13:48:59,472 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-14 13:48:59,472 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-14 13:48:59,472 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-14 13:48:59,473 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 13:48:59,473 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 13:48:59,473 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 13:48:59,473 - DEBUG - Compression method 0
2024-10-14 13:48:59,473 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 13:48:59,473 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 13:48:59,473 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-14 13:48:59,473 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-14 13:48:59,473 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-14 13:48:59,473 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-14 13:48:59,482 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 13:48:59,482 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 13:48:59,482 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-14 13:48:59,483 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-14 13:48:59,483 - DEBUG - Error closing: Operation on closed image
2024-10-14 13:49:01,481 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 13:49:01,481 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 13:49:01,481 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 13:49:01,481 - DEBUG - Compression method 0
2024-10-14 13:49:01,481 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 13:49:01,481 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 13:49:01,481 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-14 13:49:01,481 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-14 13:49:01,481 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-14 13:49:01,481 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-14 13:49:01,481 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 13:49:01,481 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 13:49:01,481 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 13:49:01,481 - DEBUG - Compression method 0
2024-10-14 13:49:01,482 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 13:49:01,482 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 13:49:01,482 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-14 13:49:01,482 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-14 13:49:01,482 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-14 13:49:01,482 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-14 13:49:01,499 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 13:49:01,499 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 13:49:01,499 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-14 13:49:01,499 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-14 13:49:01,500 - DEBUG - Error closing: Operation on closed image
2024-10-14 13:49:04,037 - DEBUG - Document content: ROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 18...
2024-10-14 13:49:04,037 - ERROR - PII extraction error: name 'ChatCompletion' is not defined
2024-10-14 13:49:04,037 - DEBUG - Document content: ROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP ...
2024-10-14 13:49:04,037 - ERROR - PII extraction error: name 'ChatCompletion' is not defined
2024-10-14 13:50:37,123 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-14 13:50:38,379 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-14 13:50:38,380 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-14 13:50:38,702 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-14 13:50:38,703 - DEBUG - Using proactor: IocpProactor
2024-10-14 13:50:38,709 - INFO - Template selected based on metadata: airbnb.txt
2024-10-14 13:50:38,725 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 13:50:38,725 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 13:50:38,725 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 13:50:38,725 - DEBUG - Compression method 0
2024-10-14 13:50:38,725 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 13:50:38,725 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 13:50:38,725 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-14 13:50:38,725 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-14 13:50:38,725 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-14 13:50:38,725 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-14 13:50:38,726 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 13:50:38,726 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 13:50:38,726 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 13:50:38,726 - DEBUG - Compression method 0
2024-10-14 13:50:38,726 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 13:50:38,726 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 13:50:38,726 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-14 13:50:38,726 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-14 13:50:38,726 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-14 13:50:38,726 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-14 13:50:38,735 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 13:50:38,735 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 13:50:38,735 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-14 13:50:38,735 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-14 13:50:38,736 - DEBUG - Error closing: Operation on closed image
2024-10-14 13:50:40,725 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 13:50:40,726 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 13:50:40,726 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 13:50:40,726 - DEBUG - Compression method 0
2024-10-14 13:50:40,726 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 13:50:40,726 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 13:50:40,726 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-14 13:50:40,726 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-14 13:50:40,726 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-14 13:50:40,726 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-14 13:50:40,726 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 13:50:40,726 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 13:50:40,726 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 13:50:40,726 - DEBUG - Compression method 0
2024-10-14 13:50:40,726 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 13:50:40,726 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 13:50:40,726 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-14 13:50:40,726 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-14 13:50:40,726 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-14 13:50:40,726 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-14 13:50:40,743 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 13:50:40,743 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 13:50:40,743 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-14 13:50:40,743 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-14 13:50:40,744 - DEBUG - Error closing: Operation on closed image
2024-10-14 13:50:43,238 - DEBUG - Document content: ROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 18...
2024-10-14 13:50:43,239 - ERROR - PII extraction error: name 'ChatCompletion' is not defined
2024-10-14 13:50:43,239 - DEBUG - Document content: ROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP ...
2024-10-14 13:50:43,240 - ERROR - PII extraction error: name 'ChatCompletion' is not defined
2024-10-14 13:52:20,852 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-14 13:52:22,118 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-14 13:52:22,118 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-14 13:52:22,439 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-14 13:52:22,439 - DEBUG - Using proactor: IocpProactor
2024-10-14 13:52:22,444 - INFO - Template selected based on metadata: airbnb.txt
2024-10-14 13:52:22,460 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 13:52:22,460 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 13:52:22,460 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 13:52:22,460 - DEBUG - Compression method 0
2024-10-14 13:52:22,461 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 13:52:22,461 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 13:52:22,461 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-14 13:52:22,461 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-14 13:52:22,461 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-14 13:52:22,461 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-14 13:52:22,461 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 13:52:22,461 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 13:52:22,461 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 13:52:22,461 - DEBUG - Compression method 0
2024-10-14 13:52:22,462 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 13:52:22,462 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 13:52:22,462 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-14 13:52:22,462 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-14 13:52:22,462 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-14 13:52:22,462 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-14 13:52:22,476 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 13:52:22,476 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 13:52:22,476 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-14 13:52:22,476 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-14 13:52:22,477 - DEBUG - Error closing: Operation on closed image
2024-10-14 13:52:24,462 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 13:52:24,462 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 13:52:24,462 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 13:52:24,462 - DEBUG - Compression method 0
2024-10-14 13:52:24,462 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 13:52:24,463 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 13:52:24,463 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-14 13:52:24,463 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-14 13:52:24,463 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-14 13:52:24,463 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-14 13:52:24,463 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 13:52:24,463 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 13:52:24,463 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 13:52:24,463 - DEBUG - Compression method 0
2024-10-14 13:52:24,463 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 13:52:24,463 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 13:52:24,463 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-14 13:52:24,463 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-14 13:52:24,463 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-14 13:52:24,463 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-14 13:52:24,480 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 13:52:24,481 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 13:52:24,481 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-14 13:52:24,481 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-14 13:52:24,481 - DEBUG - Error closing: Operation on closed image
2024-10-14 13:52:26,940 - DEBUG - Document content: ROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 18...
2024-10-14 13:52:26,940 - ERROR - PII extraction error: name 'ChatCompletion' is not defined
2024-10-14 13:52:26,940 - DEBUG - Document content: ROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP ...
2024-10-14 13:52:26,940 - ERROR - PII extraction error: name 'ChatCompletion' is not defined
2024-10-14 13:53:53,059 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-14 13:53:54,339 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-14 13:53:54,339 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-14 13:53:54,666 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-14 13:53:54,667 - DEBUG - Using proactor: IocpProactor
2024-10-14 13:53:54,671 - INFO - Template selected based on metadata: airbnb.txt
2024-10-14 13:53:54,686 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 13:53:54,686 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 13:53:54,686 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 13:53:54,686 - DEBUG - Compression method 0
2024-10-14 13:53:54,687 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 13:53:54,687 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 13:53:54,687 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-14 13:53:54,687 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-14 13:53:54,687 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-14 13:53:54,687 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-14 13:53:54,687 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 13:53:54,687 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 13:53:54,687 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 13:53:54,687 - DEBUG - Compression method 0
2024-10-14 13:53:54,687 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 13:53:54,687 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 13:53:54,687 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-14 13:53:54,687 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-14 13:53:54,687 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-14 13:53:54,687 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-14 13:53:54,697 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 13:53:54,697 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 13:53:54,697 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-14 13:53:54,697 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-14 13:53:54,698 - DEBUG - Error closing: Operation on closed image
2024-10-14 13:53:56,715 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 13:53:56,715 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 13:53:56,715 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 13:53:56,715 - DEBUG - Compression method 0
2024-10-14 13:53:56,715 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 13:53:56,715 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 13:53:56,715 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-14 13:53:56,715 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-14 13:53:56,715 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-14 13:53:56,716 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-14 13:53:56,716 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 13:53:56,716 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 13:53:56,716 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 13:53:56,716 - DEBUG - Compression method 0
2024-10-14 13:53:56,716 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 13:53:56,716 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 13:53:56,716 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-14 13:53:56,716 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-14 13:53:56,716 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-14 13:53:56,716 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-14 13:53:56,733 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 13:53:56,733 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 13:53:56,733 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-14 13:53:56,733 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-14 13:53:56,734 - DEBUG - Error closing: Operation on closed image
2024-10-14 13:53:59,300 - DEBUG - Document content: ROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 18...
2024-10-14 13:53:59,300 - ERROR - PII extraction error: name 'ChatCompletion' is not defined
2024-10-14 13:53:59,300 - DEBUG - Document content: ROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP ...
2024-10-14 13:53:59,300 - ERROR - PII extraction error: name 'ChatCompletion' is not defined
2024-10-14 13:54:42,629 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-14 13:54:43,884 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-14 13:54:43,885 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-14 13:54:44,206 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-14 13:54:44,207 - DEBUG - Using proactor: IocpProactor
2024-10-14 13:54:44,211 - INFO - Template selected based on metadata: airbnb.txt
2024-10-14 13:54:44,227 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 13:54:44,227 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 13:54:44,227 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 13:54:44,227 - DEBUG - Compression method 0
2024-10-14 13:54:44,227 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 13:54:44,227 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 13:54:44,227 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-14 13:54:44,227 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-14 13:54:44,227 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-14 13:54:44,227 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-14 13:54:44,227 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 13:54:44,227 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 13:54:44,227 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 13:54:44,227 - DEBUG - Compression method 0
2024-10-14 13:54:44,227 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 13:54:44,228 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 13:54:44,228 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-14 13:54:44,228 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-14 13:54:44,228 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-14 13:54:44,228 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-14 13:54:44,239 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 13:54:44,239 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 13:54:44,239 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-14 13:54:44,239 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-14 13:54:44,240 - DEBUG - Error closing: Operation on closed image
2024-10-14 13:54:46,263 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 13:54:46,264 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 13:54:46,264 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 13:54:46,264 - DEBUG - Compression method 0
2024-10-14 13:54:46,264 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 13:54:46,264 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 13:54:46,264 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-14 13:54:46,264 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-14 13:54:46,264 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-14 13:54:46,264 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-14 13:54:46,264 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 13:54:46,264 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 13:54:46,264 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 13:54:46,264 - DEBUG - Compression method 0
2024-10-14 13:54:46,264 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 13:54:46,264 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 13:54:46,264 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-14 13:54:46,264 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-14 13:54:46,264 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-14 13:54:46,264 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-14 13:54:46,281 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 13:54:46,281 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 13:54:46,281 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-14 13:54:46,282 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-14 13:54:46,282 - DEBUG - Error closing: Operation on closed image
2024-10-14 13:54:48,819 - DEBUG - Document content: ROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 18...
2024-10-14 13:54:48,819 - ERROR - PII extraction error: name 'ChatCompletion' is not defined
2024-10-14 13:54:48,819 - DEBUG - Document content: ROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP ...
2024-10-14 13:54:48,819 - ERROR - PII extraction error: name 'ChatCompletion' is not defined
2024-10-14 13:56:16,555 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-14 13:56:17,811 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-14 13:56:17,811 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-14 13:56:18,141 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-14 13:56:18,142 - DEBUG - Using proactor: IocpProactor
2024-10-14 13:56:18,162 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 13:56:18,163 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 13:56:18,163 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 13:56:18,163 - DEBUG - Compression method 0
2024-10-14 13:56:18,163 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 13:56:18,163 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 13:56:18,163 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-14 13:56:18,163 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-14 13:56:18,163 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-14 13:56:18,163 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-14 13:56:18,163 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 13:56:18,163 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 13:56:18,163 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 13:56:18,163 - DEBUG - Compression method 0
2024-10-14 13:56:18,163 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 13:56:18,163 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 13:56:18,163 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-14 13:56:18,163 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-14 13:56:18,163 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-14 13:56:18,163 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-14 13:56:18,174 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 13:56:18,174 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 13:56:18,174 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-14 13:56:18,174 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-14 13:56:18,174 - DEBUG - Error closing: Operation on closed image
2024-10-14 13:56:20,211 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 13:56:20,211 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 13:56:20,211 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 13:56:20,211 - DEBUG - Compression method 0
2024-10-14 13:56:20,211 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 13:56:20,211 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 13:56:20,211 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-14 13:56:20,211 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-14 13:56:20,211 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-14 13:56:20,211 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-14 13:56:20,211 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 13:56:20,211 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 13:56:20,211 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 13:56:20,211 - DEBUG - Compression method 0
2024-10-14 13:56:20,211 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 13:56:20,212 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 13:56:20,212 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-14 13:56:20,212 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-14 13:56:20,212 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-14 13:56:20,212 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-14 13:56:20,229 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 13:56:20,229 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 13:56:20,229 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-14 13:56:20,229 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-14 13:56:20,230 - DEBUG - Error closing: Operation on closed image
2024-10-14 13:56:22,762 - DEBUG - Document content: ROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 18...
2024-10-14 13:56:22,769 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.PIIData'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}}
2024-10-14 13:56:22,770 - DEBUG - max_retries: 1
2024-10-14 13:56:22,773 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}, 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}]}}
2024-10-14 13:56:22,812 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 13:56:22,812 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-14 13:56:22,828 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000002059C29E510>
2024-10-14 13:56:22,828 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x000002059C0F1BD0> server_hostname='api.openai.com' timeout=5.0
2024-10-14 13:56:22,840 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000002059C29E240>
2024-10-14 13:56:22,840 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 13:56:22,840 - DEBUG - send_request_headers.complete
2024-10-14 13:56:22,840 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 13:56:22,840 - DEBUG - send_request_body.complete
2024-10-14 13:56:22,840 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 13:56:25,264 - DEBUG - receive_response_headers.failed exception=KeyboardInterrupt()
2024-10-14 13:56:25,265 - DEBUG - response_closed.started
2024-10-14 13:56:25,265 - DEBUG - response_closed.complete
2024-10-14 13:56:25,478 - ERROR - Task exception was never retrieved
future: <Task finished name='Task-1' coro=<agent_workflow() done, defined at D:\deve\contract_automation\src\main.py:25> exception=KeyboardInterrupt()>
Traceback (most recent call last):
  File "D:\deve\contract_automation\src\main.py", line 107, in <module>
    asyncio.run(agent_workflow())
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 30, in run
    return loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 92, in run_until_complete
    self._run_once()
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 133, in _run_once
    handle._run()
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 386, in __wakeup
    self.__step()
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 293, in __step
    self.__step_run_and_handle_result(exc)
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 304, in __step_run_and_handle_result
    result = coro.send(None)
             ^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\src\main.py", line 42, in agent_workflow
    pii = extract_pii(text)
          ^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\src\ai_functions.py", line 109, in extract_pii
    return client.chat.completions.create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\instructor\patch.py", line 291, in new_create_sync
    response = retry_sync(
               ^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\instructor\retry.py", line 189, in retry_sync
    for attempt in max_retries:
  File "D:\deve\contract_automation\.venv\Lib\site-packages\tenacity\__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\tenacity\__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\tenacity\__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\deve\contract_automation\.venv\Lib\site-packages\instructor\retry.py", line 192, in retry_sync
    response = func(*args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\openai\_utils\_utils.py", line 274, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\openai\resources\chat\completions.py", line 742, in create
    return self._post(
           ^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\openai\_base_client.py", line 1270, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\openai\_base_client.py", line 947, in request
    return self._request(
           ^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\openai\_base_client.py", line 983, in _request
    response = self._client.send(
               ^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpx\_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpx\_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpx\_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpx\_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpx\_transports\default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpcore\_sync\connection_pool.py", line 216, in handle_request
    raise exc from None
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpcore\_sync\connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpcore\_sync\connection.py", line 101, in handle_request
    return self._connection.handle_request(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpcore\_sync\http11.py", line 143, in handle_request
    raise exc
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpcore\_sync\http11.py", line 113, in handle_request
    ) = self._receive_response_headers(**kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpcore\_sync\http11.py", line 186, in _receive_response_headers
    event = self._receive_event(timeout=timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpcore\_sync\http11.py", line 224, in _receive_event
    data = self._network_stream.read(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpcore\_backends\sync.py", line 126, in read
    return self._sock.recv(max_bytes)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\ssl.py", line 1234, in recv
    return self.read(buflen)
           ^^^^^^^^^^^^^^^^^
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\ssl.py", line 1107, in read
    return self._sslobj.read(len)
           ^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
2024-10-14 13:57:55,787 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-14 13:57:57,051 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-14 13:57:57,051 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-14 13:57:57,370 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-14 13:59:58,776 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-14 14:00:00,038 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-14 14:00:00,039 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-14 14:00:00,362 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-14 14:01:57,404 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-14 14:01:58,665 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-14 14:01:58,666 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-14 14:01:58,984 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-14 14:03:20,198 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-14 14:03:21,461 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-14 14:03:21,461 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-14 14:03:21,777 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-14 14:03:21,777 - DEBUG - Using proactor: IocpProactor
2024-10-14 14:03:21,796 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 14:03:21,797 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 14:03:21,797 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 14:03:21,797 - DEBUG - Compression method 0
2024-10-14 14:03:21,797 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 14:03:21,797 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 14:03:21,797 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-14 14:03:21,797 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-14 14:03:21,797 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-14 14:03:21,797 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-14 14:03:21,797 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 14:03:21,797 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 14:03:21,797 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 14:03:21,797 - DEBUG - Compression method 0
2024-10-14 14:03:21,797 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 14:03:21,797 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 14:03:21,797 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-14 14:03:21,797 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-14 14:03:21,797 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-14 14:03:21,797 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-14 14:03:21,807 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 14:03:21,807 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 14:03:21,807 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-14 14:03:21,807 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-14 14:03:21,808 - DEBUG - Error closing: Operation on closed image
2024-10-14 14:03:23,870 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 14:03:23,870 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 14:03:23,870 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 14:03:23,870 - DEBUG - Compression method 0
2024-10-14 14:03:23,870 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 14:03:23,870 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 14:03:23,870 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-14 14:03:23,870 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-14 14:03:23,870 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-14 14:03:23,870 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-14 14:03:23,870 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 14:03:23,870 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 14:03:23,870 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 14:03:23,870 - DEBUG - Compression method 0
2024-10-14 14:03:23,870 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 14:03:23,870 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 14:03:23,870 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-14 14:03:23,870 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-14 14:03:23,871 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-14 14:03:23,871 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-14 14:03:23,888 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 14:03:23,888 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 14:03:23,888 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-14 14:03:23,888 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-14 14:03:23,889 - DEBUG - Error closing: Operation on closed image
2024-10-14 14:03:26,368 - DEBUG - Document content: ROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 18...
2024-10-14 14:03:26,371 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.PIIData'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}}
2024-10-14 14:03:26,372 - DEBUG - max_retries: 1
2024-10-14 14:03:26,374 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}, 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}]}}
2024-10-14 14:03:26,410 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:03:26,410 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-14 14:03:26,427 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000002390F36E360>
2024-10-14 14:03:26,427 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x000002390F1C1D50> server_hostname='api.openai.com' timeout=5.0
2024-10-14 14:03:26,434 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000002390F36E0C0>
2024-10-14 14:03:26,435 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:03:26,435 - DEBUG - send_request_headers.complete
2024-10-14 14:03:26,435 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:03:26,435 - DEBUG - send_request_body.complete
2024-10-14 14:03:26,435 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:03:28,775 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:03:28 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2184'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'9736'), (b'x-ratelimit-reset-requests', b'8.64s'), (b'x-ratelimit-reset-tokens', b'1.584s'), (b'x-request-id', b'req_1d948bd2d9d9ea78e60a50f8ca011790'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=d3BsNPYy7uG8CDittWj6WyiengmePrvoT6qBEcFlsW0-1728903808-1.0.1.1-Not.R_TP5ScsE5mKKL6lf25c4LE3WhXiryTs._EUrvKcu5Z52OsEV8T8nAWek_Tn3g_7PffVf82S.qFoxBjkXg; path=/; expires=Mon, 14-Oct-24 11:33:28 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=rg_QDH9IX3BBj8N2y4XhUMs.YKRErilaj_hoo9N23iE-1728903808942-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2715374a1f0531-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:03:28,777 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:03:28,777 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:03:28,778 - DEBUG - receive_response_body.complete
2024-10-14 14:03:28,778 - DEBUG - response_closed.started
2024-10-14 14:03:28,778 - DEBUG - response_closed.complete
2024-10-14 14:03:28,778 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Mon, 14 Oct 2024 11:03:28 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-kzzh9hik9ryjiou4ftvhondh'), ('openai-processing-ms', '2184'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '10000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '9736'), ('x-ratelimit-reset-requests', '8.64s'), ('x-ratelimit-reset-tokens', '1.584s'), ('x-request-id', 'req_1d948bd2d9d9ea78e60a50f8ca011790'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=d3BsNPYy7uG8CDittWj6WyiengmePrvoT6qBEcFlsW0-1728903808-1.0.1.1-Not.R_TP5ScsE5mKKL6lf25c4LE3WhXiryTs._EUrvKcu5Z52OsEV8T8nAWek_Tn3g_7PffVf82S.qFoxBjkXg; path=/; expires=Mon, 14-Oct-24 11:33:28 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=rg_QDH9IX3BBj8N2y4XhUMs.YKRErilaj_hoo9N23iE-1728903808942-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d2715374a1f0531-OTP'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-14 14:03:28,778 - DEBUG - request_id: req_1d948bd2d9d9ea78e60a50f8ca011790
2024-10-14 14:03:28,781 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AID9CqL7QV94VziNFlkFTXeYz3Vlz', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_DlITVvtxncOLcJ7QmNFUdBfT', function=Function(arguments='{\n"name": "ISPILANTE SENTIMENT BRUSLI",\n"address": "Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR"\n}', name='PIIData'), type='function')]))], created=1728903806, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=39, prompt_tokens=377, total_tokens=416, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:03:28,782 - DEBUG - Extracted PII: name='ISPILANTE SENTIMENT BRUSLI' address='Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR'
2024-10-14 14:03:31,751 - DEBUG - Document content: ROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP ...
2024-10-14 14:03:31,753 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.PIIData'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}}
2024-10-14 14:03:31,753 - DEBUG - max_retries: 1
2024-10-14 14:03:31,755 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}, 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}]}}
2024-10-14 14:03:31,756 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:03:31,756 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:03:31,756 - DEBUG - send_request_headers.complete
2024-10-14 14:03:31,756 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:03:31,757 - DEBUG - send_request_body.complete
2024-10-14 14:03:31,757 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:03:34,190 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:03:34 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2272'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9998'), (b'x-ratelimit-remaining-tokens', b'9742'), (b'x-ratelimit-reset-requests', b'11.956s'), (b'x-ratelimit-reset-tokens', b'1.548s'), (b'x-request-id', b'req_c215570a43084e59fbf49ad8cf6b0480'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2715588d6f0531-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:03:34,190 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:03:34,190 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:03:34,190 - DEBUG - receive_response_body.complete
2024-10-14 14:03:34,190 - DEBUG - response_closed.started
2024-10-14 14:03:34,190 - DEBUG - response_closed.complete
2024-10-14 14:03:34,190 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:03:34 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '2272', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9998', 'x-ratelimit-remaining-tokens': '9742', 'x-ratelimit-reset-requests': '11.956s', 'x-ratelimit-reset-tokens': '1.548s', 'x-request-id': 'req_c215570a43084e59fbf49ad8cf6b0480', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2715588d6f0531-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:03:34,190 - DEBUG - request_id: req_c215570a43084e59fbf49ad8cf6b0480
2024-10-14 14:03:34,191 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AID9IwE6ciw7d8WswDpWnsGhhb2A1', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_bP8UTHJTjWqjF1s4YQUu7bmS', function=Function(arguments='{\n"name": "ELENA VASILESCU",\n"address": "Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B"\n}', name='PIIData'), type='function')]))], created=1728903812, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=42, prompt_tokens=380, total_tokens=422, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:03:34,191 - DEBUG - Extracted PII: name='ELENA VASILESCU' address='Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'
2024-10-14 14:03:35,678 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.ContractParties'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Identify the buyer and seller from the given information:\n\nName: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'properties': {'buyer': {'description': 'Name of the buyer', 'title': 'Buyer', 'type': 'string'}, 'seller': {'description': 'Name of the seller', 'title': 'Seller', 'type': 'string'}}, 'required': ['buyer', 'seller'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}}
2024-10-14 14:03:35,679 - DEBUG - max_retries: 1
2024-10-14 14:03:35,681 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Identify the buyer and seller from the given information:\n\nName: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}, 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'properties': {'buyer': {'description': 'Name of the buyer', 'title': 'Buyer', 'type': 'string'}, 'seller': {'description': 'Name of the seller', 'title': 'Seller', 'type': 'string'}}, 'required': ['buyer', 'seller'], 'type': 'object'}}}]}}
2024-10-14 14:03:35,681 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:03:35,681 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:03:35,682 - DEBUG - send_request_headers.complete
2024-10-14 14:03:35,682 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:03:35,682 - DEBUG - send_request_body.complete
2024-10-14 14:03:35,682 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:03:37,334 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:03:37 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1493'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9998'), (b'x-ratelimit-remaining-tokens', b'9834'), (b'x-ratelimit-reset-requests', b'16.674s'), (b'x-ratelimit-reset-tokens', b'996ms'), (b'x-request-id', b'req_209478d7aa30fb2b35ddc2dc1704e2a5'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2715711e260531-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:03:37,334 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:03:37,334 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:03:37,334 - DEBUG - receive_response_body.complete
2024-10-14 14:03:37,334 - DEBUG - response_closed.started
2024-10-14 14:03:37,334 - DEBUG - response_closed.complete
2024-10-14 14:03:37,334 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:03:37 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1493', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9998', 'x-ratelimit-remaining-tokens': '9834', 'x-ratelimit-reset-requests': '16.674s', 'x-ratelimit-reset-tokens': '996ms', 'x-request-id': 'req_209478d7aa30fb2b35ddc2dc1704e2a5', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2715711e260531-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:03:37,335 - DEBUG - request_id: req_209478d7aa30fb2b35ddc2dc1704e2a5
2024-10-14 14:03:37,335 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AID9MgipJ3j9g9P4lKMCTdSj3rE2N', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_Qhdb6IEiyd11pjbSJ6UthZC5', function=Function(arguments='{\n"buyer": "ISPILANTE SENTIMENT BRUSLI",\n"seller": "ELENA VASILESCU"\n}', name='ContractParties'), type='function')]))], created=1728903816, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=28, prompt_tokens=232, total_tokens=260, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:03:50,046 - DEBUG - close.started
2024-10-14 14:03:50,047 - DEBUG - close.complete
2024-10-14 14:28:21,896 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-14 14:28:23,171 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-14 14:28:23,171 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-14 14:28:23,490 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-14 14:28:23,491 - DEBUG - Using proactor: IocpProactor
2024-10-14 14:28:23,510 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 14:28:23,510 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 14:28:23,511 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 14:28:23,511 - DEBUG - Compression method 0
2024-10-14 14:28:23,511 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 14:28:23,511 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 14:28:23,511 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-14 14:28:23,511 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-14 14:28:23,511 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-14 14:28:23,511 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-14 14:28:23,511 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 14:28:23,511 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 14:28:23,511 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 14:28:23,511 - DEBUG - Compression method 0
2024-10-14 14:28:23,511 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 14:28:23,511 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 14:28:23,511 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-14 14:28:23,511 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-14 14:28:23,511 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-14 14:28:23,511 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-14 14:28:23,521 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 14:28:23,522 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 14:28:23,522 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-14 14:28:23,522 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-14 14:28:23,522 - DEBUG - Error closing: Operation on closed image
2024-10-14 14:28:25,542 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 14:28:25,542 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 14:28:25,542 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 14:28:25,542 - DEBUG - Compression method 0
2024-10-14 14:28:25,542 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 14:28:25,542 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 14:28:25,542 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-14 14:28:25,542 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-14 14:28:25,542 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-14 14:28:25,542 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-14 14:28:25,542 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 14:28:25,542 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 14:28:25,542 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 14:28:25,542 - DEBUG - Compression method 0
2024-10-14 14:28:25,542 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 14:28:25,542 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 14:28:25,542 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-14 14:28:25,542 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-14 14:28:25,542 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-14 14:28:25,542 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-14 14:28:25,559 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 14:28:25,560 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 14:28:25,560 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-14 14:28:25,560 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-14 14:28:25,560 - DEBUG - Error closing: Operation on closed image
2024-10-14 14:28:28,028 - DEBUG - Document content: ROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 18...
2024-10-14 14:28:28,030 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.PIIData'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}}
2024-10-14 14:28:28,031 - DEBUG - max_retries: 1
2024-10-14 14:28:28,033 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}, 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}]}}
2024-10-14 14:28:28,070 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:28:28,070 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-14 14:28:28,082 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x0000015967F7E450>
2024-10-14 14:28:28,082 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x0000015967DD1CD0> server_hostname='api.openai.com' timeout=5.0
2024-10-14 14:28:28,089 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x0000015967F7E390>
2024-10-14 14:28:28,090 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:28:28,090 - DEBUG - send_request_headers.complete
2024-10-14 14:28:28,090 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:28:28,090 - DEBUG - send_request_body.complete
2024-10-14 14:28:28,090 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:28:30,218 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:28:30 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1972'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'9736'), (b'x-ratelimit-reset-requests', b'8.64s'), (b'x-ratelimit-reset-tokens', b'1.584s'), (b'x-request-id', b'req_a2a0d2446ae4b72e8cd8d2d3c0449f00'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=HFLwQwNLiSRFlNbMTV2n9otohFsfmLtoh5BZCLX9fFs-1728905310-1.0.1.1-h5iBirqEjnpMe8U_do678ZFyKIVDz9OfG_FRmFrdRQWhUjzMawnADR2HPjYF.9T4Dap.AFXg019gnwbCgm5CYw; path=/; expires=Mon, 14-Oct-24 11:58:30 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=Kcjo4yNqyrmsPbjeNvAUAuYSeXI51aYyJ63XZuYrVbM-1728905310447-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2739e10a9fca1c-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:28:30,220 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:28:30,220 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:28:30,220 - DEBUG - receive_response_body.complete
2024-10-14 14:28:30,221 - DEBUG - response_closed.started
2024-10-14 14:28:30,221 - DEBUG - response_closed.complete
2024-10-14 14:28:30,221 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Mon, 14 Oct 2024 11:28:30 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-kzzh9hik9ryjiou4ftvhondh'), ('openai-processing-ms', '1972'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '10000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '9736'), ('x-ratelimit-reset-requests', '8.64s'), ('x-ratelimit-reset-tokens', '1.584s'), ('x-request-id', 'req_a2a0d2446ae4b72e8cd8d2d3c0449f00'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=HFLwQwNLiSRFlNbMTV2n9otohFsfmLtoh5BZCLX9fFs-1728905310-1.0.1.1-h5iBirqEjnpMe8U_do678ZFyKIVDz9OfG_FRmFrdRQWhUjzMawnADR2HPjYF.9T4Dap.AFXg019gnwbCgm5CYw; path=/; expires=Mon, 14-Oct-24 11:58:30 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=Kcjo4yNqyrmsPbjeNvAUAuYSeXI51aYyJ63XZuYrVbM-1728905310447-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d2739e10a9fca1c-OTP'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-14 14:28:30,221 - DEBUG - request_id: req_a2a0d2446ae4b72e8cd8d2d3c0449f00
2024-10-14 14:28:30,224 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDXQxKhyg0oCHeQrqBcSxIxEYl04', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_UNU6lwYOCGcL2CVbK7VbuSyi', function=Function(arguments='{\n"name": "ISPILANTE SENTIMENT BRUSLI",\n"address": "Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR"\n}', name='PIIData'), type='function')]))], created=1728905308, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=39, prompt_tokens=377, total_tokens=416, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:28:30,225 - DEBUG - Extracted PII: name='ISPILANTE SENTIMENT BRUSLI' address='Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR'
2024-10-14 14:28:33,603 - DEBUG - Document content: ROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP ...
2024-10-14 14:28:33,605 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.PIIData'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}}
2024-10-14 14:28:33,605 - DEBUG - max_retries: 1
2024-10-14 14:28:33,607 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}, 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}]}}
2024-10-14 14:28:33,608 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:28:33,608 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:28:33,608 - DEBUG - send_request_headers.complete
2024-10-14 14:28:33,608 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:28:33,608 - DEBUG - send_request_body.complete
2024-10-14 14:28:33,608 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:28:36,106 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:28:36 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2329'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9998'), (b'x-ratelimit-remaining-tokens', b'9742'), (b'x-ratelimit-reset-requests', b'11.753s'), (b'x-ratelimit-reset-tokens', b'1.548s'), (b'x-request-id', b'req_81092538ef30a5d6eed26a8cf88ab104'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d273a038df5ca1c-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:28:36,107 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:28:36,107 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:28:36,107 - DEBUG - receive_response_body.complete
2024-10-14 14:28:36,108 - DEBUG - response_closed.started
2024-10-14 14:28:36,108 - DEBUG - response_closed.complete
2024-10-14 14:28:36,108 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:28:36 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '2329', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9998', 'x-ratelimit-remaining-tokens': '9742', 'x-ratelimit-reset-requests': '11.753s', 'x-ratelimit-reset-tokens': '1.548s', 'x-request-id': 'req_81092538ef30a5d6eed26a8cf88ab104', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d273a038df5ca1c-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:28:36,108 - DEBUG - request_id: req_81092538ef30a5d6eed26a8cf88ab104
2024-10-14 14:28:36,109 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDXWkcQOz3Q62D8kCJyrUr1mXIRn', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_eMu5UoUcluX6KVnCI7dKfafI', function=Function(arguments='{\n"name": "ELENA VASILESCU",\n"address": "Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B"\n}', name='PIIData'), type='function')]))], created=1728905314, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=42, prompt_tokens=380, total_tokens=422, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:28:36,110 - DEBUG - Extracted PII: name='ELENA VASILESCU' address='Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'
2024-10-14 14:28:37,301 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.ContractParties'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Identify the buyer and seller from the given information:\n\nName: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'properties': {'buyer': {'description': 'Name of the buyer', 'title': 'Buyer', 'type': 'string'}, 'seller': {'description': 'Name of the seller', 'title': 'Seller', 'type': 'string'}}, 'required': ['buyer', 'seller'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}}
2024-10-14 14:28:37,301 - DEBUG - max_retries: 1
2024-10-14 14:28:37,303 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Identify the buyer and seller from the given information:\n\nName: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}, 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'properties': {'buyer': {'description': 'Name of the buyer', 'title': 'Buyer', 'type': 'string'}, 'seller': {'description': 'Name of the seller', 'title': 'Seller', 'type': 'string'}}, 'required': ['buyer', 'seller'], 'type': 'object'}}}]}}
2024-10-14 14:28:37,303 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:28:37,304 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:28:37,304 - DEBUG - send_request_headers.complete
2024-10-14 14:28:37,304 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:28:37,304 - DEBUG - send_request_body.complete
2024-10-14 14:28:37,304 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:28:39,423 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:28:39 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1927'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9998'), (b'x-ratelimit-remaining-tokens', b'9834'), (b'x-ratelimit-reset-requests', b'16.709s'), (b'x-ratelimit-reset-tokens', b'996ms'), (b'x-request-id', b'req_59aa0a0b19f37bd29118360ada6ddf16'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d273a1a9c49ca1c-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:28:39,423 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:28:39,424 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:28:39,424 - DEBUG - receive_response_body.complete
2024-10-14 14:28:39,424 - DEBUG - response_closed.started
2024-10-14 14:28:39,424 - DEBUG - response_closed.complete
2024-10-14 14:28:39,424 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:28:39 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1927', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9998', 'x-ratelimit-remaining-tokens': '9834', 'x-ratelimit-reset-requests': '16.709s', 'x-ratelimit-reset-tokens': '996ms', 'x-request-id': 'req_59aa0a0b19f37bd29118360ada6ddf16', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d273a1a9c49ca1c-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:28:39,424 - DEBUG - request_id: req_59aa0a0b19f37bd29118360ada6ddf16
2024-10-14 14:28:39,425 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDXZ0nF5Nc5oQE0hDVzNCRXsnl91', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_VKrl6Wq93glcGxuBmYf3gC06', function=Function(arguments='{\n"buyer": "ISPILANTE SENTIMENT BRUSLI",\n"seller": "ELENA VASILESCU"\n}', name='ContractParties'), type='function')]))], created=1728905317, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=28, prompt_tokens=232, total_tokens=260, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:28:44,237 - DEBUG - close.started
2024-10-14 14:28:44,237 - DEBUG - close.complete
2024-10-14 14:40:09,752 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-14 14:40:11,035 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-14 14:40:11,036 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-14 14:40:11,357 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-14 14:42:36,063 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-14 14:42:37,334 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-14 14:42:37,335 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-14 14:42:37,657 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-14 14:43:17,583 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-14 14:43:18,840 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-14 14:43:18,840 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-14 14:43:19,164 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-14 14:43:40,026 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-14 14:43:41,292 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-14 14:43:41,293 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-14 14:43:41,619 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-14 14:43:41,623 - DEBUG - Using proactor: IocpProactor
2024-10-14 14:43:41,641 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 14:43:41,641 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 14:43:41,641 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 14:43:41,641 - DEBUG - Compression method 0
2024-10-14 14:43:41,641 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 14:43:41,641 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 14:43:41,642 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-14 14:43:41,642 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-14 14:43:41,642 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-14 14:43:41,642 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-14 14:43:41,642 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 14:43:41,642 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 14:43:41,642 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 14:43:41,642 - DEBUG - Compression method 0
2024-10-14 14:43:41,642 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 14:43:41,642 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 14:43:41,642 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-14 14:43:41,642 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-14 14:43:41,642 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-14 14:43:41,642 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-14 14:43:41,652 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 14:43:41,652 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 14:43:41,652 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-14 14:43:41,652 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-14 14:43:41,652 - DEBUG - Error closing: Operation on closed image
2024-10-14 14:43:43,714 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 14:43:43,714 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 14:43:43,714 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 14:43:43,714 - DEBUG - Compression method 0
2024-10-14 14:43:43,714 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 14:43:43,714 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 14:43:43,714 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-14 14:43:43,714 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-14 14:43:43,714 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-14 14:43:43,714 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-14 14:43:43,714 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 14:43:43,714 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 14:43:43,714 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 14:43:43,714 - DEBUG - Compression method 0
2024-10-14 14:43:43,714 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 14:43:43,714 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 14:43:43,714 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-14 14:43:43,714 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-14 14:43:43,714 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-14 14:43:43,714 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-14 14:43:43,731 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 14:43:43,731 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 14:43:43,731 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-14 14:43:43,731 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-14 14:43:43,732 - DEBUG - Error closing: Operation on closed image
2024-10-14 14:43:46,244 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Current state: {'verified_pii_data': [], 'parties': None, 'contract_details': None, 'contract': None, 'current_action': None}\nWhat action should be taken next?"}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-14 14:43:46,245 - DEBUG - max_retries: 1
2024-10-14 14:43:46,247 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Current state: {'verified_pii_data': [], 'parties': None, 'contract_details': None, 'contract': None, 'current_action': None}\nWhat action should be taken next?"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-14 14:43:46,284 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:43:46,285 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-14 14:43:46,357 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x00000179F6C0E8A0>
2024-10-14 14:43:46,357 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x00000179F6A55AD0> server_hostname='api.openai.com' timeout=5.0
2024-10-14 14:43:46,365 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x00000179F6C0E7E0>
2024-10-14 14:43:46,365 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:43:46,366 - DEBUG - send_request_headers.complete
2024-10-14 14:43:46,366 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:43:46,366 - DEBUG - send_request_body.complete
2024-10-14 14:43:46,366 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:43:47,450 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:43:47 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'920'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'9853'), (b'x-ratelimit-reset-requests', b'8.64s'), (b'x-ratelimit-reset-tokens', b'882ms'), (b'x-request-id', b'req_08cc0f66c425559d8883528b8233f852'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=XRMOKo5.EtsiOalsH7ZgPtwGq0rXl2n1.pKPnnWBrBU-1728906227-1.0.1.1-o8IE5bkoD6XTvCfXYgDGXoRPnuY9dWD8eeaGcnafaGNs.HOvTwOnSWc.f3lFTm9CNzMPotxhH.wL8SsjzC2VFw; path=/; expires=Mon, 14-Oct-24 12:13:47 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=n1Xv2J8tnMx5fiQiXqXWRT605w5WaUKTS0bggaiIgiM-1728906227719-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d27504c79d070d0-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:43:47,451 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:43:47,451 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:43:47,451 - DEBUG - receive_response_body.complete
2024-10-14 14:43:47,451 - DEBUG - response_closed.started
2024-10-14 14:43:47,451 - DEBUG - response_closed.complete
2024-10-14 14:43:47,451 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Mon, 14 Oct 2024 11:43:47 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-kzzh9hik9ryjiou4ftvhondh'), ('openai-processing-ms', '920'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '10000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '9853'), ('x-ratelimit-reset-requests', '8.64s'), ('x-ratelimit-reset-tokens', '882ms'), ('x-request-id', 'req_08cc0f66c425559d8883528b8233f852'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=XRMOKo5.EtsiOalsH7ZgPtwGq0rXl2n1.pKPnnWBrBU-1728906227-1.0.1.1-o8IE5bkoD6XTvCfXYgDGXoRPnuY9dWD8eeaGcnafaGNs.HOvTwOnSWc.f3lFTm9CNzMPotxhH.wL8SsjzC2VFw; path=/; expires=Mon, 14-Oct-24 12:13:47 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=n1Xv2J8tnMx5fiQiXqXWRT605w5WaUKTS0bggaiIgiM-1728906227719-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d27504c79d070d0-OTP'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-14 14:43:47,451 - DEBUG - request_id: req_08cc0f66c425559d8883528b8233f852
2024-10-14 14:43:47,453 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDmEKbKYNw2frrLgAfYoL7kx31sJ', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_MPRDU4RaUbRsclQAklB9u9OH', function=Function(arguments='{\n"action": "extract_information_from_documents"\n}', name='AgentAction'), type='function')]))], created=1728906226, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=11, prompt_tokens=183, total_tokens=194, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:43:47,454 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Current state: {'verified_pii_data': [], 'parties': None, 'contract_details': None, 'contract': None, 'current_action': None}\nWhat action should be taken next?"}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-14 14:43:47,454 - DEBUG - max_retries: 1
2024-10-14 14:43:47,456 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Current state: {'verified_pii_data': [], 'parties': None, 'contract_details': None, 'contract': None, 'current_action': None}\nWhat action should be taken next?"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-14 14:43:47,456 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:43:47,456 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:43:47,456 - DEBUG - send_request_headers.complete
2024-10-14 14:43:47,456 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:43:47,457 - DEBUG - send_request_body.complete
2024-10-14 14:43:47,457 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:43:48,327 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:43:48 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'718'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9998'), (b'x-ratelimit-remaining-tokens', b'9829'), (b'x-ratelimit-reset-requests', b'16.205s'), (b'x-ratelimit-reset-tokens', b'1.02s'), (b'x-request-id', b'req_e62d153f53ed56ee2a51d67d8b898651'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d27505348dd70d0-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:43:48,327 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:43:48,328 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:43:48,328 - DEBUG - receive_response_body.complete
2024-10-14 14:43:48,328 - DEBUG - response_closed.started
2024-10-14 14:43:48,328 - DEBUG - response_closed.complete
2024-10-14 14:43:48,328 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:43:48 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '718', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9998', 'x-ratelimit-remaining-tokens': '9829', 'x-ratelimit-reset-requests': '16.205s', 'x-ratelimit-reset-tokens': '1.02s', 'x-request-id': 'req_e62d153f53ed56ee2a51d67d8b898651', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d27505348dd70d0-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:43:48,328 - DEBUG - request_id: req_e62d153f53ed56ee2a51d67d8b898651
2024-10-14 14:43:48,329 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDmFbQMN3cQHNyAmTakK5TC9Ap9K', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_aZ0AFQouthYw9gNILVThhP4w', function=Function(arguments='{\n"action": "extract_information"\n}', name='AgentAction'), type='function')]))], created=1728906227, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=9, prompt_tokens=183, total_tokens=192, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:43:48,331 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Current state: {'verified_pii_data': [], 'parties': None, 'contract_details': None, 'contract': None, 'current_action': None}\nWhat action should be taken next?"}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-14 14:43:48,331 - DEBUG - max_retries: 1
2024-10-14 14:43:48,335 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Current state: {'verified_pii_data': [], 'parties': None, 'contract_details': None, 'contract': None, 'current_action': None}\nWhat action should be taken next?"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-14 14:43:48,336 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:43:48,336 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:43:48,336 - DEBUG - send_request_headers.complete
2024-10-14 14:43:48,337 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:43:48,337 - DEBUG - send_request_body.complete
2024-10-14 14:43:48,337 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:43:49,342 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:43:49 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'846'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9997'), (b'x-ratelimit-remaining-tokens', b'9786'), (b'x-ratelimit-reset-requests', b'23.954s'), (b'x-ratelimit-reset-tokens', b'1.281s'), (b'x-request-id', b'req_0517191513286132336df77cba315d41'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d275058ce8c70d0-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:43:49,343 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:43:49,343 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:43:49,343 - DEBUG - receive_response_body.complete
2024-10-14 14:43:49,344 - DEBUG - response_closed.started
2024-10-14 14:43:49,344 - DEBUG - response_closed.complete
2024-10-14 14:43:49,344 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:43:49 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '846', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9997', 'x-ratelimit-remaining-tokens': '9786', 'x-ratelimit-reset-requests': '23.954s', 'x-ratelimit-reset-tokens': '1.281s', 'x-request-id': 'req_0517191513286132336df77cba315d41', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d275058ce8c70d0-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:43:49,344 - DEBUG - request_id: req_0517191513286132336df77cba315d41
2024-10-14 14:43:49,344 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDmGXsZVzZZT9aB26dVQChHDXHm8', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_kyLFogkrUvVtjRl5mhLtaWvu', function=Function(arguments='{\n"action": "extract_parts_from_documents"\n}', name='AgentAction'), type='function')]))], created=1728906228, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=11, prompt_tokens=183, total_tokens=194, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:43:49,346 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Current state: {'verified_pii_data': [], 'parties': None, 'contract_details': None, 'contract': None, 'current_action': None}\nWhat action should be taken next?"}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-14 14:43:49,346 - DEBUG - max_retries: 1
2024-10-14 14:43:49,348 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Current state: {'verified_pii_data': [], 'parties': None, 'contract_details': None, 'contract': None, 'current_action': None}\nWhat action should be taken next?"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-14 14:43:49,349 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:43:49,349 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:43:49,349 - DEBUG - send_request_headers.complete
2024-10-14 14:43:49,349 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:43:49,349 - DEBUG - send_request_body.complete
2024-10-14 14:43:49,349 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:43:50,007 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:43:50 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'503'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9996'), (b'x-ratelimit-remaining-tokens', b'9757'), (b'x-ratelimit-reset-requests', b'31.606s'), (b'x-ratelimit-reset-tokens', b'1.456s'), (b'x-request-id', b'req_417952a65ed87c3cb237ed68369f9133'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d27505f2cb370d0-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:43:50,008 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:43:50,009 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:43:50,009 - DEBUG - receive_response_body.complete
2024-10-14 14:43:50,009 - DEBUG - response_closed.started
2024-10-14 14:43:50,009 - DEBUG - response_closed.complete
2024-10-14 14:43:50,010 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:43:50 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '503', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9996', 'x-ratelimit-remaining-tokens': '9757', 'x-ratelimit-reset-requests': '31.606s', 'x-ratelimit-reset-tokens': '1.456s', 'x-request-id': 'req_417952a65ed87c3cb237ed68369f9133', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d27505f2cb370d0-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:43:50,010 - DEBUG - request_id: req_417952a65ed87c3cb237ed68369f9133
2024-10-14 14:43:50,010 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDmHJDOw4um1dAOjrt21Eg788F1Q', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_y0OCLqDnbOGlGkllwAFfx2kp', function=Function(arguments='{\n"action": "extract_information"\n}', name='AgentAction'), type='function')]))], created=1728906229, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=9, prompt_tokens=183, total_tokens=192, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:43:50,012 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Current state: {'verified_pii_data': [], 'parties': None, 'contract_details': None, 'contract': None, 'current_action': None}\nWhat action should be taken next?"}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-14 14:43:50,012 - DEBUG - max_retries: 1
2024-10-14 14:43:50,015 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Current state: {'verified_pii_data': [], 'parties': None, 'contract_details': None, 'contract': None, 'current_action': None}\nWhat action should be taken next?"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-14 14:43:50,015 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:43:50,015 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:43:50,016 - DEBUG - send_request_headers.complete
2024-10-14 14:43:50,016 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:43:50,016 - DEBUG - send_request_body.complete
2024-10-14 14:43:50,016 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:43:51,094 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:43:51 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'900'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9995'), (b'x-ratelimit-remaining-tokens', b'9679'), (b'x-ratelimit-reset-requests', b'39.558s'), (b'x-ratelimit-reset-tokens', b'1.92s'), (b'x-request-id', b'req_8de554ee4bff4598fea40341b4226e26'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d27506348d570d0-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:43:51,094 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:43:51,095 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:43:51,095 - DEBUG - receive_response_body.complete
2024-10-14 14:43:51,095 - DEBUG - response_closed.started
2024-10-14 14:43:51,095 - DEBUG - response_closed.complete
2024-10-14 14:43:51,095 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:43:51 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '900', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9995', 'x-ratelimit-remaining-tokens': '9679', 'x-ratelimit-reset-requests': '39.558s', 'x-ratelimit-reset-tokens': '1.92s', 'x-request-id': 'req_8de554ee4bff4598fea40341b4226e26', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d27506348d570d0-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:43:51,095 - DEBUG - request_id: req_8de554ee4bff4598fea40341b4226e26
2024-10-14 14:43:51,096 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDmI3mNLRjODJ8MeFZGkBkNwrrFq', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_jcXG7ljnPv5kraoaim6G8PFx', function=Function(arguments='{\n"action": "extract_personal_information"\n}', name='AgentAction'), type='function')]))], created=1728906230, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=10, prompt_tokens=183, total_tokens=193, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:43:51,098 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Current state: {'verified_pii_data': [], 'parties': None, 'contract_details': None, 'contract': None, 'current_action': None}\nWhat action should be taken next?"}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-14 14:43:51,099 - DEBUG - max_retries: 1
2024-10-14 14:43:51,103 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Current state: {'verified_pii_data': [], 'parties': None, 'contract_details': None, 'contract': None, 'current_action': None}\nWhat action should be taken next?"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-14 14:43:51,104 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:43:51,104 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:43:51,104 - DEBUG - send_request_headers.complete
2024-10-14 14:43:51,105 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:43:51,105 - DEBUG - send_request_body.complete
2024-10-14 14:43:51,105 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:43:52,106 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:43:52 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'836'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9994'), (b'x-ratelimit-remaining-tokens', b'9667'), (b'x-ratelimit-reset-requests', b'47.113s'), (b'x-ratelimit-reset-tokens', b'1.994s'), (b'x-request-id', b'req_3ccdd4d88459d4ffd945e5a271e3df36'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d27506a186570d0-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:43:52,107 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:43:52,107 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:43:52,107 - DEBUG - receive_response_body.complete
2024-10-14 14:43:52,107 - DEBUG - response_closed.started
2024-10-14 14:43:52,107 - DEBUG - response_closed.complete
2024-10-14 14:43:52,107 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:43:52 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '836', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9994', 'x-ratelimit-remaining-tokens': '9667', 'x-ratelimit-reset-requests': '47.113s', 'x-ratelimit-reset-tokens': '1.994s', 'x-request-id': 'req_3ccdd4d88459d4ffd945e5a271e3df36', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d27506a186570d0-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:43:52,108 - DEBUG - request_id: req_3ccdd4d88459d4ffd945e5a271e3df36
2024-10-14 14:43:52,108 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDmJRy6dK7SMSbb56Fpxhvzt8ygG', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_bP8UTHJTjWqjF1s4YQUu7bmS', function=Function(arguments='{\n  "action": "extract_information"\n}', name='AgentAction'), type='function')]))], created=1728906231, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=10, prompt_tokens=183, total_tokens=193, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:43:52,110 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Current state: {'verified_pii_data': [], 'parties': None, 'contract_details': None, 'contract': None, 'current_action': None}\nWhat action should be taken next?"}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-14 14:43:52,110 - DEBUG - max_retries: 1
2024-10-14 14:43:52,112 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Current state: {'verified_pii_data': [], 'parties': None, 'contract_details': None, 'contract': None, 'current_action': None}\nWhat action should be taken next?"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-14 14:43:52,113 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:43:52,113 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:43:52,113 - DEBUG - send_request_headers.complete
2024-10-14 14:43:52,113 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:43:52,113 - DEBUG - send_request_body.complete
2024-10-14 14:43:52,113 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:43:53,382 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:43:53 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'894'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9993'), (b'x-ratelimit-remaining-tokens', b'9644'), (b'x-ratelimit-reset-requests', b'54.733s'), (b'x-ratelimit-reset-tokens', b'2.132s'), (b'x-request-id', b'req_4943357b5558974f1c94260e0a1fb4c4'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d275070681f70d0-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:43:53,383 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:43:53,383 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:43:53,384 - DEBUG - receive_response_body.complete
2024-10-14 14:43:53,384 - DEBUG - response_closed.started
2024-10-14 14:43:53,384 - DEBUG - response_closed.complete
2024-10-14 14:43:53,384 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:43:53 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '894', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9993', 'x-ratelimit-remaining-tokens': '9644', 'x-ratelimit-reset-requests': '54.733s', 'x-ratelimit-reset-tokens': '2.132s', 'x-request-id': 'req_4943357b5558974f1c94260e0a1fb4c4', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d275070681f70d0-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:43:53,385 - DEBUG - request_id: req_4943357b5558974f1c94260e0a1fb4c4
2024-10-14 14:43:53,385 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDmKHape0DdOigE1yC8KmdJMNnF0', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_esdOeYcUtJwYN3JSmEHmmrgV', function=Function(arguments='{\n"action": "extract_personal_information"\n}', name='AgentAction'), type='function')]))], created=1728906232, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=10, prompt_tokens=183, total_tokens=193, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:43:53,388 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Current state: {'verified_pii_data': [], 'parties': None, 'contract_details': None, 'contract': None, 'current_action': None}\nWhat action should be taken next?"}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-14 14:43:53,388 - DEBUG - max_retries: 1
2024-10-14 14:43:53,391 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Current state: {'verified_pii_data': [], 'parties': None, 'contract_details': None, 'contract': None, 'current_action': None}\nWhat action should be taken next?"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-14 14:43:53,391 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:43:53,392 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:43:53,392 - DEBUG - send_request_headers.complete
2024-10-14 14:43:53,392 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:43:53,392 - DEBUG - send_request_body.complete
2024-10-14 14:43:53,392 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:43:54,328 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:43:54 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'786'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9992'), (b'x-ratelimit-remaining-tokens', b'9662'), (b'x-ratelimit-reset-requests', b'1m2.108s'), (b'x-ratelimit-reset-tokens', b'2.024s'), (b'x-request-id', b'req_d2509aab2716d03dba5b6f18610b9018'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2750786a5270d0-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:43:54,329 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:43:54,329 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:43:54,330 - DEBUG - receive_response_body.complete
2024-10-14 14:43:54,330 - DEBUG - response_closed.started
2024-10-14 14:43:54,330 - DEBUG - response_closed.complete
2024-10-14 14:43:54,330 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:43:54 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '786', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9992', 'x-ratelimit-remaining-tokens': '9662', 'x-ratelimit-reset-requests': '1m2.108s', 'x-ratelimit-reset-tokens': '2.024s', 'x-request-id': 'req_d2509aab2716d03dba5b6f18610b9018', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2750786a5270d0-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:43:54,330 - DEBUG - request_id: req_d2509aab2716d03dba5b6f18610b9018
2024-10-14 14:43:54,331 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDmLajyi1YECVWq1SEOzXpAf3Dan', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_BjiFhST8R7TlMcMeaXTzUvg3', function=Function(arguments='{\n"action": "extract_pii"\n}', name='AgentAction'), type='function')]))], created=1728906233, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=10, prompt_tokens=183, total_tokens=193, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:43:54,333 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.PIIData'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}}
2024-10-14 14:43:54,334 - DEBUG - max_retries: 1
2024-10-14 14:43:54,337 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}, 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}]}}
2024-10-14 14:43:54,338 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:43:54,338 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:43:54,338 - DEBUG - send_request_headers.complete
2024-10-14 14:43:54,338 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:43:54,338 - DEBUG - send_request_body.complete
2024-10-14 14:43:54,338 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:43:56,114 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:43:56 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1602'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9991'), (b'x-ratelimit-remaining-tokens', b'9512'), (b'x-ratelimit-reset-requests', b'1m9.791s'), (b'x-ratelimit-reset-tokens', b'2.927s'), (b'x-request-id', b'req_09b4069fdc5d6bd8f3aa7321a1d566a9'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d27507e59d970d0-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:43:56,115 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:43:56,115 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:43:56,116 - DEBUG - receive_response_body.complete
2024-10-14 14:43:56,116 - DEBUG - response_closed.started
2024-10-14 14:43:56,116 - DEBUG - response_closed.complete
2024-10-14 14:43:56,116 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:43:56 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1602', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9991', 'x-ratelimit-remaining-tokens': '9512', 'x-ratelimit-reset-requests': '1m9.791s', 'x-ratelimit-reset-tokens': '2.927s', 'x-request-id': 'req_09b4069fdc5d6bd8f3aa7321a1d566a9', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d27507e59d970d0-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:43:56,117 - DEBUG - request_id: req_09b4069fdc5d6bd8f3aa7321a1d566a9
2024-10-14 14:43:56,118 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDmMuaGgZU5EvRAnvZkJ9hwLZ5KN', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_CFjNSkmUHSwr1TJ4b5h7wSSV', function=Function(arguments='{\n"name": "ISPILANTE SENTIMENT BRUSLI",\n"address": "Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR"\n}', name='PIIData'), type='function')]))], created=1728906234, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=39, prompt_tokens=377, total_tokens=416, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:44:03,463 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.PIIData'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}}
2024-10-14 14:44:03,463 - DEBUG - max_retries: 1
2024-10-14 14:44:03,465 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}, 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}]}}
2024-10-14 14:44:03,465 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:44:03,466 - DEBUG - close.started
2024-10-14 14:44:03,466 - DEBUG - close.complete
2024-10-14 14:44:03,466 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-14 14:44:03,471 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x00000179F6C4A8D0>
2024-10-14 14:44:03,471 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x00000179F6A55AD0> server_hostname='api.openai.com' timeout=5.0
2024-10-14 14:44:03,478 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x00000179F6C3D160>
2024-10-14 14:44:03,478 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:44:03,478 - DEBUG - send_request_headers.complete
2024-10-14 14:44:03,478 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:44:03,478 - DEBUG - send_request_body.complete
2024-10-14 14:44:03,478 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:44:05,878 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:44:06 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2252'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9991'), (b'x-ratelimit-remaining-tokens', b'9742'), (b'x-ratelimit-reset-requests', b'1m9.303s'), (b'x-ratelimit-reset-tokens', b'1.548s'), (b'x-request-id', b'req_198c15ef061ca52fe113ca042f2db01f'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2750b77c6dca1d-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:44:05,878 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:44:05,878 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:44:05,878 - DEBUG - receive_response_body.complete
2024-10-14 14:44:05,878 - DEBUG - response_closed.started
2024-10-14 14:44:05,878 - DEBUG - response_closed.complete
2024-10-14 14:44:05,878 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:44:06 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '2252', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9991', 'x-ratelimit-remaining-tokens': '9742', 'x-ratelimit-reset-requests': '1m9.303s', 'x-ratelimit-reset-tokens': '1.548s', 'x-request-id': 'req_198c15ef061ca52fe113ca042f2db01f', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2750b77c6dca1d-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:44:05,878 - DEBUG - request_id: req_198c15ef061ca52fe113ca042f2db01f
2024-10-14 14:44:05,879 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDmVRPTjl3G3fRcOpGtGSjb832Fa', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_N3uZ3291VnyiyXxQBprRpCSQ', function=Function(arguments='{\n"name": "ELENA VASILESCU",\n"address": "Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B"\n}', name='PIIData'), type='function')]))], created=1728906243, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=42, prompt_tokens=380, total_tokens=422, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:44:08,055 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Current state: {'verified_pii_data': [{'name': 'ELENA VASILESCU', 'address': 'Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'parties': None, 'contract_details': None, 'contract': None, 'current_action': None}\nWhat action should be taken next?"}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-14 14:44:08,056 - DEBUG - max_retries: 1
2024-10-14 14:44:08,058 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Current state: {'verified_pii_data': [{'name': 'ELENA VASILESCU', 'address': 'Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'parties': None, 'contract_details': None, 'contract': None, 'current_action': None}\nWhat action should be taken next?"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-14 14:44:08,058 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:44:08,058 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:44:08,059 - DEBUG - send_request_headers.complete
2024-10-14 14:44:08,059 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:44:08,059 - DEBUG - send_request_body.complete
2024-10-14 14:44:08,059 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:44:08,878 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:44:09 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'662'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9991'), (b'x-ratelimit-remaining-tokens', b'9830'), (b'x-ratelimit-reset-requests', b'1m13.361s'), (b'x-ratelimit-reset-tokens', b'1.02s'), (b'x-request-id', b'req_26c1777521e723f33051bd5784b133a7'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2750d41a02ca1d-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:44:08,878 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:44:08,878 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:44:08,879 - DEBUG - receive_response_body.complete
2024-10-14 14:44:08,879 - DEBUG - response_closed.started
2024-10-14 14:44:08,879 - DEBUG - response_closed.complete
2024-10-14 14:44:08,879 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:44:09 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '662', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9991', 'x-ratelimit-remaining-tokens': '9830', 'x-ratelimit-reset-requests': '1m13.361s', 'x-ratelimit-reset-tokens': '1.02s', 'x-request-id': 'req_26c1777521e723f33051bd5784b133a7', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2750d41a02ca1d-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:44:08,879 - DEBUG - request_id: req_26c1777521e723f33051bd5784b133a7
2024-10-14 14:44:08,879 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDma5y7TShp4yLhr8XcWw4DHzqg3', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_dPiDdxf38JgOyKK33UowQojc', function=Function(arguments='{\n"action": "identify_parties"\n}', name='AgentAction'), type='function')]))], created=1728906248, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=10, prompt_tokens=224, total_tokens=234, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:44:08,880 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.ContractParties'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Identify the buyer and seller from the given information:\n\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'properties': {'buyer': {'description': 'Name of the buyer', 'title': 'Buyer', 'type': 'string'}, 'seller': {'description': 'Name of the seller', 'title': 'Seller', 'type': 'string'}}, 'required': ['buyer', 'seller'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}}
2024-10-14 14:44:08,880 - DEBUG - max_retries: 1
2024-10-14 14:44:08,882 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Identify the buyer and seller from the given information:\n\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}, 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'properties': {'buyer': {'description': 'Name of the buyer', 'title': 'Buyer', 'type': 'string'}, 'seller': {'description': 'Name of the seller', 'title': 'Seller', 'type': 'string'}}, 'required': ['buyer', 'seller'], 'type': 'object'}}}]}}
2024-10-14 14:44:08,882 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:44:08,882 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:44:08,882 - DEBUG - send_request_headers.complete
2024-10-14 14:44:08,882 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:44:08,882 - DEBUG - send_request_body.complete
2024-10-14 14:44:08,882 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:44:10,134 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:44:10 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1103'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9990'), (b'x-ratelimit-remaining-tokens', b'9759'), (b'x-ratelimit-reset-requests', b'1m21.181s'), (b'x-ratelimit-reset-tokens', b'1.442s'), (b'x-request-id', b'req_a8a4b8d54e9b5728567669ed8dcba3c8'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2750d93ffdca1d-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:44:10,134 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:44:10,134 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:44:10,135 - DEBUG - receive_response_body.complete
2024-10-14 14:44:10,135 - DEBUG - response_closed.started
2024-10-14 14:44:10,135 - DEBUG - response_closed.complete
2024-10-14 14:44:10,135 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:44:10 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1103', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9990', 'x-ratelimit-remaining-tokens': '9759', 'x-ratelimit-reset-requests': '1m21.181s', 'x-ratelimit-reset-tokens': '1.442s', 'x-request-id': 'req_a8a4b8d54e9b5728567669ed8dcba3c8', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2750d93ffdca1d-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:44:10,135 - DEBUG - request_id: req_a8a4b8d54e9b5728567669ed8dcba3c8
2024-10-14 14:44:10,136 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDmbPCK0SvgTtZH5Hj5qx6NWexc0', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_QEmKdxGPkD5GQ39XqwxYKRhe', function=Function(arguments='{\n  "buyer": "ELENA VASILESCU",\n  "seller": ""\n}', name='ContractParties'), type='function')]))], created=1728906249, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=21, prompt_tokens=199, total_tokens=220, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:44:10,137 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Current state: {'verified_pii_data': [{'name': 'ELENA VASILESCU', 'address': 'Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'parties': {'buyer': 'ELENA VASILESCU', 'seller': ''}, 'contract_details': None, 'contract': None, 'current_action': None}\nWhat action should be taken next?"}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-14 14:44:10,137 - DEBUG - max_retries: 1
2024-10-14 14:44:10,140 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Current state: {'verified_pii_data': [{'name': 'ELENA VASILESCU', 'address': 'Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'parties': {'buyer': 'ELENA VASILESCU', 'seller': ''}, 'contract_details': None, 'contract': None, 'current_action': None}\nWhat action should be taken next?"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-14 14:44:10,141 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:44:10,141 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:44:10,141 - DEBUG - send_request_headers.complete
2024-10-14 14:44:10,141 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:44:10,141 - DEBUG - send_request_body.complete
2024-10-14 14:44:10,141 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:44:10,939 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:44:11 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'648'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9989'), (b'x-ratelimit-remaining-tokens', b'9712'), (b'x-ratelimit-reset-requests', b'1m28.56s'), (b'x-ratelimit-reset-tokens', b'1.722s'), (b'x-request-id', b'req_8c35d04cefe8d7ed367f534d4d19a737'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2750e11d8bca1d-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:44:10,940 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:44:10,940 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:44:10,940 - DEBUG - receive_response_body.complete
2024-10-14 14:44:10,940 - DEBUG - response_closed.started
2024-10-14 14:44:10,940 - DEBUG - response_closed.complete
2024-10-14 14:44:10,941 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:44:11 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '648', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9989', 'x-ratelimit-remaining-tokens': '9712', 'x-ratelimit-reset-requests': '1m28.56s', 'x-ratelimit-reset-tokens': '1.722s', 'x-request-id': 'req_8c35d04cefe8d7ed367f534d4d19a737', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2750e11d8bca1d-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:44:10,941 - DEBUG - request_id: req_8c35d04cefe8d7ed367f534d4d19a737
2024-10-14 14:44:10,941 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDmcEZo7o7uayau5ul1Gel46ix0W', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_sLew7sfo4AJVCbX6Td958zXr', function=Function(arguments='{\n"action": "extract_pii_data"\n}', name='AgentAction'), type='function')]))], created=1728906250, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=11, prompt_tokens=240, total_tokens=251, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:44:10,944 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Current state: {'verified_pii_data': [{'name': 'ELENA VASILESCU', 'address': 'Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'parties': {'buyer': 'ELENA VASILESCU', 'seller': ''}, 'contract_details': None, 'contract': None, 'current_action': None}\nWhat action should be taken next?"}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-14 14:44:10,944 - DEBUG - max_retries: 1
2024-10-14 14:44:10,946 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Current state: {'verified_pii_data': [{'name': 'ELENA VASILESCU', 'address': 'Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'parties': {'buyer': 'ELENA VASILESCU', 'seller': ''}, 'contract_details': None, 'contract': None, 'current_action': None}\nWhat action should be taken next?"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-14 14:44:10,946 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:44:10,946 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:44:10,946 - DEBUG - send_request_headers.complete
2024-10-14 14:44:10,947 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:44:10,947 - DEBUG - send_request_body.complete
2024-10-14 14:44:10,947 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:44:11,711 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:44:11 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'618'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9988'), (b'x-ratelimit-remaining-tokens', b'9595'), (b'x-ratelimit-reset-requests', b'1m36.396s'), (b'x-ratelimit-reset-tokens', b'2.424s'), (b'x-request-id', b'req_7b6ca878ff9c4329ac3166047977c6d1'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2750e61bd0ca1d-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:44:11,711 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:44:11,711 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:44:11,711 - DEBUG - receive_response_body.complete
2024-10-14 14:44:11,711 - DEBUG - response_closed.started
2024-10-14 14:44:11,711 - DEBUG - response_closed.complete
2024-10-14 14:44:11,711 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:44:11 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '618', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9988', 'x-ratelimit-remaining-tokens': '9595', 'x-ratelimit-reset-requests': '1m36.396s', 'x-ratelimit-reset-tokens': '2.424s', 'x-request-id': 'req_7b6ca878ff9c4329ac3166047977c6d1', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2750e61bd0ca1d-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:44:11,711 - DEBUG - request_id: req_7b6ca878ff9c4329ac3166047977c6d1
2024-10-14 14:44:11,712 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDmds87OYiMke4hJQELJvRgRqMhA', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_X0T05VUOFEmaZgJy7o0HAxTg', function=Function(arguments='{\n"action": "verify_pii_data"\n}', name='AgentAction'), type='function')]))], created=1728906251, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=11, prompt_tokens=240, total_tokens=251, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:44:11,713 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Current state: {'verified_pii_data': [{'name': 'ELENA VASILESCU', 'address': 'Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'parties': {'buyer': 'ELENA VASILESCU', 'seller': ''}, 'contract_details': None, 'contract': None, 'current_action': None}\nWhat action should be taken next?"}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-14 14:44:11,713 - DEBUG - max_retries: 1
2024-10-14 14:44:11,714 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Current state: {'verified_pii_data': [{'name': 'ELENA VASILESCU', 'address': 'Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'parties': {'buyer': 'ELENA VASILESCU', 'seller': ''}, 'contract_details': None, 'contract': None, 'current_action': None}\nWhat action should be taken next?"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-14 14:44:11,715 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:44:11,715 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:44:11,715 - DEBUG - send_request_headers.complete
2024-10-14 14:44:11,715 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:44:11,715 - DEBUG - send_request_body.complete
2024-10-14 14:44:11,715 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:44:12,523 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:44:12 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'664'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9987'), (b'x-ratelimit-remaining-tokens', b'9472'), (b'x-ratelimit-reset-requests', b'1m44.267s'), (b'x-ratelimit-reset-tokens', b'3.162s'), (b'x-request-id', b'req_c3d5949969b19696487d975da96ccf19'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2750eae8a4ca1d-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:44:12,524 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:44:12,524 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:44:12,525 - DEBUG - receive_response_body.complete
2024-10-14 14:44:12,525 - DEBUG - response_closed.started
2024-10-14 14:44:12,525 - DEBUG - response_closed.complete
2024-10-14 14:44:12,525 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:44:12 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '664', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9987', 'x-ratelimit-remaining-tokens': '9472', 'x-ratelimit-reset-requests': '1m44.267s', 'x-ratelimit-reset-tokens': '3.162s', 'x-request-id': 'req_c3d5949969b19696487d975da96ccf19', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2750eae8a4ca1d-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:44:12,526 - DEBUG - request_id: req_c3d5949969b19696487d975da96ccf19
2024-10-14 14:44:12,527 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDmem1XEWBTQQtsjc80Lxl5pPexD', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_F35y70aV6S4hPuXhXaibo9Im', function=Function(arguments='{\n"action": "verify_seller_details"\n}', name='AgentAction'), type='function')]))], created=1728906252, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=11, prompt_tokens=240, total_tokens=251, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:44:12,529 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Current state: {'verified_pii_data': [{'name': 'ELENA VASILESCU', 'address': 'Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'parties': {'buyer': 'ELENA VASILESCU', 'seller': ''}, 'contract_details': None, 'contract': None, 'current_action': None}\nWhat action should be taken next?"}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-14 14:44:12,529 - DEBUG - max_retries: 1
2024-10-14 14:44:12,531 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Current state: {'verified_pii_data': [{'name': 'ELENA VASILESCU', 'address': 'Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'parties': {'buyer': 'ELENA VASILESCU', 'seller': ''}, 'contract_details': None, 'contract': None, 'current_action': None}\nWhat action should be taken next?"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-14 14:44:12,532 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:44:12,532 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:44:12,532 - DEBUG - send_request_headers.complete
2024-10-14 14:44:12,533 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:44:12,533 - DEBUG - send_request_body.complete
2024-10-14 14:44:12,533 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:44:13,454 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:44:13 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'751'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9987'), (b'x-ratelimit-remaining-tokens', b'9358'), (b'x-ratelimit-reset-requests', b'1m52.088s'), (b'x-ratelimit-reset-tokens', b'3.848s'), (b'x-request-id', b'req_02850d67f1a2ce7574cbf6c3a336588e'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2750f00e66ca1d-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:44:13,454 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:44:13,455 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:44:13,455 - DEBUG - receive_response_body.complete
2024-10-14 14:44:13,455 - DEBUG - response_closed.started
2024-10-14 14:44:13,456 - DEBUG - response_closed.complete
2024-10-14 14:44:13,456 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:44:13 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '751', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9987', 'x-ratelimit-remaining-tokens': '9358', 'x-ratelimit-reset-requests': '1m52.088s', 'x-ratelimit-reset-tokens': '3.848s', 'x-request-id': 'req_02850d67f1a2ce7574cbf6c3a336588e', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2750f00e66ca1d-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:44:13,456 - DEBUG - request_id: req_02850d67f1a2ce7574cbf6c3a336588e
2024-10-14 14:44:13,457 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDmfzaEdoZ9NGIUNXAe8Ytt5t9fp', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_z7uSrSh9m33dT8m8CcMOvYVd', function=Function(arguments='{\n"action": "verify_seller_information"\n}', name='AgentAction'), type='function')]))], created=1728906253, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=11, prompt_tokens=240, total_tokens=251, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:44:13,460 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Current state: {'verified_pii_data': [{'name': 'ELENA VASILESCU', 'address': 'Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'parties': {'buyer': 'ELENA VASILESCU', 'seller': ''}, 'contract_details': None, 'contract': None, 'current_action': None}\nWhat action should be taken next?"}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-14 14:44:13,461 - DEBUG - max_retries: 1
2024-10-14 14:44:13,464 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Current state: {'verified_pii_data': [{'name': 'ELENA VASILESCU', 'address': 'Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'parties': {'buyer': 'ELENA VASILESCU', 'seller': ''}, 'contract_details': None, 'contract': None, 'current_action': None}\nWhat action should be taken next?"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-14 14:44:13,465 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:44:13,465 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:44:13,465 - DEBUG - send_request_headers.complete
2024-10-14 14:44:13,465 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:44:13,465 - DEBUG - send_request_body.complete
2024-10-14 14:44:13,465 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:44:14,284 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:44:14 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'667'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9986'), (b'x-ratelimit-remaining-tokens', b'9263'), (b'x-ratelimit-reset-requests', b'1m59.79s'), (b'x-ratelimit-reset-tokens', b'4.417s'), (b'x-request-id', b'req_78da532f34381ba9c1643bf3590952dd'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2750f5dec5ca1d-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:44:14,284 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:44:14,285 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:44:14,285 - DEBUG - receive_response_body.complete
2024-10-14 14:44:14,285 - DEBUG - response_closed.started
2024-10-14 14:44:14,285 - DEBUG - response_closed.complete
2024-10-14 14:44:14,285 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:44:14 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '667', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9986', 'x-ratelimit-remaining-tokens': '9263', 'x-ratelimit-reset-requests': '1m59.79s', 'x-ratelimit-reset-tokens': '4.417s', 'x-request-id': 'req_78da532f34381ba9c1643bf3590952dd', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2750f5dec5ca1d-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:44:14,285 - DEBUG - request_id: req_78da532f34381ba9c1643bf3590952dd
2024-10-14 14:44:14,286 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDmf2v6DQZwTzJRzeX9g97gpmybI', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_6YFU67wX99SxfRbOe8qCrRMa', function=Function(arguments='{\n  "action": "extract_info"\n}', name='AgentAction'), type='function')]))], created=1728906253, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=10, prompt_tokens=240, total_tokens=250, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:44:14,288 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Current state: {'verified_pii_data': [{'name': 'ELENA VASILESCU', 'address': 'Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'parties': {'buyer': 'ELENA VASILESCU', 'seller': ''}, 'contract_details': None, 'contract': None, 'current_action': None}\nWhat action should be taken next?"}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-14 14:44:14,288 - DEBUG - max_retries: 1
2024-10-14 14:44:14,290 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Current state: {'verified_pii_data': [{'name': 'ELENA VASILESCU', 'address': 'Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'parties': {'buyer': 'ELENA VASILESCU', 'seller': ''}, 'contract_details': None, 'contract': None, 'current_action': None}\nWhat action should be taken next?"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-14 14:44:14,290 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:44:14,290 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:44:14,290 - DEBUG - send_request_headers.complete
2024-10-14 14:44:14,290 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:44:14,290 - DEBUG - send_request_body.complete
2024-10-14 14:44:14,290 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:44:15,385 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:44:15 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'950'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9985'), (b'x-ratelimit-remaining-tokens', b'9150'), (b'x-ratelimit-reset-requests', b'2m7.612s'), (b'x-ratelimit-reset-tokens', b'5.099s'), (b'x-request-id', b'req_3c9d3fbc28f343b24bd2a470672027a1'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2750fb0df1ca1d-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:44:15,386 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:44:15,386 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:44:15,387 - DEBUG - receive_response_body.complete
2024-10-14 14:44:15,387 - DEBUG - response_closed.started
2024-10-14 14:44:15,387 - DEBUG - response_closed.complete
2024-10-14 14:44:15,387 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:44:15 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '950', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9985', 'x-ratelimit-remaining-tokens': '9150', 'x-ratelimit-reset-requests': '2m7.612s', 'x-ratelimit-reset-tokens': '5.099s', 'x-request-id': 'req_3c9d3fbc28f343b24bd2a470672027a1', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2750fb0df1ca1d-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:44:15,387 - DEBUG - request_id: req_3c9d3fbc28f343b24bd2a470672027a1
2024-10-14 14:44:15,389 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDmgzIn1A9YXYVb3nJr400BlVIhK', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_aIHFpkb3b3JqsG8a6OXjdBtX', function=Function(arguments='{\n"action": "extract_seller_information"\n}', name='AgentAction'), type='function')]))], created=1728906254, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=11, prompt_tokens=240, total_tokens=251, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:44:15,391 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Current state: {'verified_pii_data': [{'name': 'ELENA VASILESCU', 'address': 'Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'parties': {'buyer': 'ELENA VASILESCU', 'seller': ''}, 'contract_details': None, 'contract': None, 'current_action': None}\nWhat action should be taken next?"}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-14 14:44:15,391 - DEBUG - max_retries: 1
2024-10-14 14:44:15,394 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Current state: {'verified_pii_data': [{'name': 'ELENA VASILESCU', 'address': 'Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'parties': {'buyer': 'ELENA VASILESCU', 'seller': ''}, 'contract_details': None, 'contract': None, 'current_action': None}\nWhat action should be taken next?"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-14 14:44:15,394 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:44:15,395 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:44:15,395 - DEBUG - send_request_headers.complete
2024-10-14 14:44:15,395 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:44:15,395 - DEBUG - send_request_body.complete
2024-10-14 14:44:15,395 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:44:16,182 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:44:16 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'630'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9984'), (b'x-ratelimit-remaining-tokens', b'9083'), (b'x-ratelimit-reset-requests', b'2m15.145s'), (b'x-ratelimit-reset-tokens', b'5.497s'), (b'x-request-id', b'req_0acb221bd841c30abb452f9db717fbe1'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d275101e9bcca1d-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:44:16,183 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:44:16,184 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:44:16,184 - DEBUG - receive_response_body.complete
2024-10-14 14:44:16,185 - DEBUG - response_closed.started
2024-10-14 14:44:16,185 - DEBUG - response_closed.complete
2024-10-14 14:44:16,185 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:44:16 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '630', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9984', 'x-ratelimit-remaining-tokens': '9083', 'x-ratelimit-reset-requests': '2m15.145s', 'x-ratelimit-reset-tokens': '5.497s', 'x-request-id': 'req_0acb221bd841c30abb452f9db717fbe1', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d275101e9bcca1d-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:44:16,185 - DEBUG - request_id: req_0acb221bd841c30abb452f9db717fbe1
2024-10-14 14:44:16,186 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDmhTtDG1SzEmt6Xw3iRPdASMLn8', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_yvXYhlC9Cegzu8IIWXeuVu6x', function=Function(arguments='{\n"action": "extract_info"\n}', name='AgentAction'), type='function')]))], created=1728906255, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=9, prompt_tokens=240, total_tokens=249, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:44:16,188 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Current state: {'verified_pii_data': [{'name': 'ELENA VASILESCU', 'address': 'Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'parties': {'buyer': 'ELENA VASILESCU', 'seller': ''}, 'contract_details': None, 'contract': None, 'current_action': None}\nWhat action should be taken next?"}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-14 14:44:16,188 - DEBUG - max_retries: 1
2024-10-14 14:44:16,191 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Current state: {'verified_pii_data': [{'name': 'ELENA VASILESCU', 'address': 'Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'parties': {'buyer': 'ELENA VASILESCU', 'seller': ''}, 'contract_details': None, 'contract': None, 'current_action': None}\nWhat action should be taken next?"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-14 14:44:16,191 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:44:16,191 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:44:16,192 - DEBUG - send_request_headers.complete
2024-10-14 14:44:16,192 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:44:16,192 - DEBUG - send_request_body.complete
2024-10-14 14:44:16,192 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:44:17,027 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:44:17 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'684'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9983'), (b'x-ratelimit-remaining-tokens', b'8968'), (b'x-ratelimit-reset-requests', b'2m22.983s'), (b'x-ratelimit-reset-tokens', b'6.189s'), (b'x-request-id', b'req_fe9f3cbba64e238f6d9e935f1ace1659'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d275106eef6ca1d-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:44:17,028 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:44:17,028 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:44:17,028 - DEBUG - receive_response_body.complete
2024-10-14 14:44:17,028 - DEBUG - response_closed.started
2024-10-14 14:44:17,028 - DEBUG - response_closed.complete
2024-10-14 14:44:17,028 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:44:17 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '684', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9983', 'x-ratelimit-remaining-tokens': '8968', 'x-ratelimit-reset-requests': '2m22.983s', 'x-ratelimit-reset-tokens': '6.189s', 'x-request-id': 'req_fe9f3cbba64e238f6d9e935f1ace1659', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d275106eef6ca1d-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:44:17,028 - DEBUG - request_id: req_fe9f3cbba64e238f6d9e935f1ace1659
2024-10-14 14:44:17,029 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDmi6tRTt902HWk9hjgItENvdk6i', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_17Tf7lutJYjEb3WbvhBu0Y0c', function=Function(arguments='{\n"action": "extract_seller_information"\n}', name='AgentAction'), type='function')]))], created=1728906256, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=11, prompt_tokens=240, total_tokens=251, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:44:17,031 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Current state: {'verified_pii_data': [{'name': 'ELENA VASILESCU', 'address': 'Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'parties': {'buyer': 'ELENA VASILESCU', 'seller': ''}, 'contract_details': None, 'contract': None, 'current_action': None}\nWhat action should be taken next?"}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-14 14:44:17,031 - DEBUG - max_retries: 1
2024-10-14 14:44:17,033 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Current state: {'verified_pii_data': [{'name': 'ELENA VASILESCU', 'address': 'Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'parties': {'buyer': 'ELENA VASILESCU', 'seller': ''}, 'contract_details': None, 'contract': None, 'current_action': None}\nWhat action should be taken next?"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-14 14:44:17,034 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:44:17,034 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:44:17,034 - DEBUG - send_request_headers.complete
2024-10-14 14:44:17,034 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:44:17,034 - DEBUG - send_request_body.complete
2024-10-14 14:44:17,034 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:44:18,102 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:44:18 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'916'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9982'), (b'x-ratelimit-remaining-tokens', b'8856'), (b'x-ratelimit-reset-requests', b'2m30.786s'), (b'x-ratelimit-reset-tokens', b'6.859s'), (b'x-request-id', b'req_23c9ce5633d448892c0b67395c599064'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d27510c2bb0ca1d-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:44:18,102 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:44:18,103 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:44:18,103 - DEBUG - receive_response_body.complete
2024-10-14 14:44:18,103 - DEBUG - response_closed.started
2024-10-14 14:44:18,103 - DEBUG - response_closed.complete
2024-10-14 14:44:18,103 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:44:18 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '916', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9982', 'x-ratelimit-remaining-tokens': '8856', 'x-ratelimit-reset-requests': '2m30.786s', 'x-ratelimit-reset-tokens': '6.859s', 'x-request-id': 'req_23c9ce5633d448892c0b67395c599064', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d27510c2bb0ca1d-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:44:18,103 - DEBUG - request_id: req_23c9ce5633d448892c0b67395c599064
2024-10-14 14:44:18,104 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDmj3nNtmehPaNDT0iXksGodwAgB', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_uqTXTPepAqg8vPUd0NaPLL6M', function=Function(arguments='{\n"action": "extract_seller_details"\n}', name='AgentAction'), type='function')]))], created=1728906257, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=11, prompt_tokens=240, total_tokens=251, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:44:18,105 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Current state: {'verified_pii_data': [{'name': 'ELENA VASILESCU', 'address': 'Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'parties': {'buyer': 'ELENA VASILESCU', 'seller': ''}, 'contract_details': None, 'contract': None, 'current_action': None}\nWhat action should be taken next?"}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-14 14:44:18,105 - DEBUG - max_retries: 1
2024-10-14 14:44:18,108 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Current state: {'verified_pii_data': [{'name': 'ELENA VASILESCU', 'address': 'Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'parties': {'buyer': 'ELENA VASILESCU', 'seller': ''}, 'contract_details': None, 'contract': None, 'current_action': None}\nWhat action should be taken next?"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-14 14:44:18,108 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:44:18,108 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:44:18,109 - DEBUG - send_request_headers.complete
2024-10-14 14:44:18,109 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:44:18,109 - DEBUG - send_request_body.complete
2024-10-14 14:44:18,109 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:44:19,003 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:44:19 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'750'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9981'), (b'x-ratelimit-remaining-tokens', b'8784'), (b'x-ratelimit-reset-requests', b'2m38.353s'), (b'x-ratelimit-reset-tokens', b'7.291s'), (b'x-request-id', b'req_e5711e5d7cf4f1fde182c87affef1955'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d275112ef53ca1d-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:44:19,003 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:44:19,003 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:44:19,004 - DEBUG - receive_response_body.complete
2024-10-14 14:44:19,004 - DEBUG - response_closed.started
2024-10-14 14:44:19,004 - DEBUG - response_closed.complete
2024-10-14 14:44:19,004 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:44:19 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '750', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9981', 'x-ratelimit-remaining-tokens': '8784', 'x-ratelimit-reset-requests': '2m38.353s', 'x-ratelimit-reset-tokens': '7.291s', 'x-request-id': 'req_e5711e5d7cf4f1fde182c87affef1955', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d275112ef53ca1d-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:44:19,004 - DEBUG - request_id: req_e5711e5d7cf4f1fde182c87affef1955
2024-10-14 14:44:19,004 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDmkr3dyUubHOrDwPyk5JcmH8vXb', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_0pQDxBTJAGK3IEOuqfnchUZX', function=Function(arguments='{\n"action": "extract_pii_data"\n}', name='AgentAction'), type='function')]))], created=1728906258, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=11, prompt_tokens=240, total_tokens=251, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:44:19,005 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Current state: {'verified_pii_data': [{'name': 'ELENA VASILESCU', 'address': 'Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'parties': {'buyer': 'ELENA VASILESCU', 'seller': ''}, 'contract_details': None, 'contract': None, 'current_action': None}\nWhat action should be taken next?"}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-14 14:44:19,005 - DEBUG - max_retries: 1
2024-10-14 14:44:19,006 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Current state: {'verified_pii_data': [{'name': 'ELENA VASILESCU', 'address': 'Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'parties': {'buyer': 'ELENA VASILESCU', 'seller': ''}, 'contract_details': None, 'contract': None, 'current_action': None}\nWhat action should be taken next?"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-14 14:44:19,007 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:44:19,007 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:44:19,007 - DEBUG - send_request_headers.complete
2024-10-14 14:44:19,007 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:44:19,007 - DEBUG - send_request_body.complete
2024-10-14 14:44:19,007 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:44:20,085 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:44:20 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'921'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9980'), (b'x-ratelimit-remaining-tokens', b'8683'), (b'x-ratelimit-reset-requests', b'2m46.094s'), (b'x-ratelimit-reset-tokens', b'7.899s'), (b'x-request-id', b'req_1eb554bf2500942cec1b3fe8102f7d66'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2751188f8eca1d-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:44:20,085 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:44:20,086 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:44:20,086 - DEBUG - receive_response_body.complete
2024-10-14 14:44:20,086 - DEBUG - response_closed.started
2024-10-14 14:44:20,086 - DEBUG - response_closed.complete
2024-10-14 14:44:20,086 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:44:20 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '921', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9980', 'x-ratelimit-remaining-tokens': '8683', 'x-ratelimit-reset-requests': '2m46.094s', 'x-ratelimit-reset-tokens': '7.899s', 'x-request-id': 'req_1eb554bf2500942cec1b3fe8102f7d66', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2751188f8eca1d-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:44:20,086 - DEBUG - request_id: req_1eb554bf2500942cec1b3fe8102f7d66
2024-10-14 14:44:20,086 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDmlVxf8vx0ckCIlGULufRfhDjqq', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_94AdoKxrhiMlRCslJEfoXmys', function=Function(arguments='{\n"action": "verify_seller_pii_data"\n}', name='AgentAction'), type='function')]))], created=1728906259, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=13, prompt_tokens=240, total_tokens=253, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:44:20,087 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Current state: {'verified_pii_data': [{'name': 'ELENA VASILESCU', 'address': 'Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'parties': {'buyer': 'ELENA VASILESCU', 'seller': ''}, 'contract_details': None, 'contract': None, 'current_action': None}\nWhat action should be taken next?"}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-14 14:44:20,087 - DEBUG - max_retries: 1
2024-10-14 14:44:20,089 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Current state: {'verified_pii_data': [{'name': 'ELENA VASILESCU', 'address': 'Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'parties': {'buyer': 'ELENA VASILESCU', 'seller': ''}, 'contract_details': None, 'contract': None, 'current_action': None}\nWhat action should be taken next?"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-14 14:44:20,089 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:44:20,089 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:44:20,089 - DEBUG - send_request_headers.complete
2024-10-14 14:44:20,089 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:44:20,089 - DEBUG - send_request_body.complete
2024-10-14 14:44:20,089 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:44:20,973 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:44:21 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'688'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9979'), (b'x-ratelimit-remaining-tokens', b'8611'), (b'x-ratelimit-reset-requests', b'2m53.651s'), (b'x-ratelimit-reset-tokens', b'8.333s'), (b'x-request-id', b'req_600235e1216deca45dbdff63fc00df95'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d27511f4b1aca1d-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:44:20,974 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:44:20,974 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:44:20,974 - DEBUG - receive_response_body.complete
2024-10-14 14:44:20,974 - DEBUG - response_closed.started
2024-10-14 14:44:20,974 - DEBUG - response_closed.complete
2024-10-14 14:44:20,974 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:44:21 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '688', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9979', 'x-ratelimit-remaining-tokens': '8611', 'x-ratelimit-reset-requests': '2m53.651s', 'x-ratelimit-reset-tokens': '8.333s', 'x-request-id': 'req_600235e1216deca45dbdff63fc00df95', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d27511f4b1aca1d-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:44:20,974 - DEBUG - request_id: req_600235e1216deca45dbdff63fc00df95
2024-10-14 14:44:20,974 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDmmXgByhJhbaNNjYtAWrfVV5rj7', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_t9fPOnhzcK9BsUXtlLDXG9bk', function=Function(arguments='{\n"action": "extract_seller_details"\n}', name='AgentAction'), type='function')]))], created=1728906260, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=11, prompt_tokens=240, total_tokens=251, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:44:20,975 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Current state: {'verified_pii_data': [{'name': 'ELENA VASILESCU', 'address': 'Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'parties': {'buyer': 'ELENA VASILESCU', 'seller': ''}, 'contract_details': None, 'contract': None, 'current_action': None}\nWhat action should be taken next?"}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-14 14:44:20,976 - DEBUG - max_retries: 1
2024-10-14 14:44:20,977 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Current state: {'verified_pii_data': [{'name': 'ELENA VASILESCU', 'address': 'Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'parties': {'buyer': 'ELENA VASILESCU', 'seller': ''}, 'contract_details': None, 'contract': None, 'current_action': None}\nWhat action should be taken next?"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-14 14:44:20,977 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:44:20,978 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:44:20,978 - DEBUG - send_request_headers.complete
2024-10-14 14:44:20,978 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:44:20,978 - DEBUG - send_request_body.complete
2024-10-14 14:44:20,978 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:44:21,969 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:44:22 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'823'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9979'), (b'x-ratelimit-remaining-tokens', b'8509'), (b'x-ratelimit-reset-requests', b'3m1.392s'), (b'x-ratelimit-reset-tokens', b'8.941s'), (b'x-request-id', b'req_5104394867465210441322799298860e'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d275124dc4eca1d-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:44:21,969 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:44:21,969 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:44:21,970 - DEBUG - receive_response_body.complete
2024-10-14 14:44:21,970 - DEBUG - response_closed.started
2024-10-14 14:44:21,970 - DEBUG - response_closed.complete
2024-10-14 14:44:21,970 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:44:22 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '823', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9979', 'x-ratelimit-remaining-tokens': '8509', 'x-ratelimit-reset-requests': '3m1.392s', 'x-ratelimit-reset-tokens': '8.941s', 'x-request-id': 'req_5104394867465210441322799298860e', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d275124dc4eca1d-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:44:21,970 - DEBUG - request_id: req_5104394867465210441322799298860e
2024-10-14 14:44:21,972 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDmn8W4XcixswbnxWr4iPD3iGDQY', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_P68bZ2W9L7QTGZIOBYZ0spgZ', function=Function(arguments='{\n"action": "extract_party_details"\n}', name='AgentAction'), type='function')]))], created=1728906261, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=10, prompt_tokens=240, total_tokens=250, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:44:21,974 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Current state: {'verified_pii_data': [{'name': 'ELENA VASILESCU', 'address': 'Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'parties': {'buyer': 'ELENA VASILESCU', 'seller': ''}, 'contract_details': None, 'contract': None, 'current_action': None}\nWhat action should be taken next?"}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-14 14:44:21,974 - DEBUG - max_retries: 1
2024-10-14 14:44:21,977 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Current state: {'verified_pii_data': [{'name': 'ELENA VASILESCU', 'address': 'Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'parties': {'buyer': 'ELENA VASILESCU', 'seller': ''}, 'contract_details': None, 'contract': None, 'current_action': None}\nWhat action should be taken next?"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-14 14:44:21,977 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:44:21,977 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:44:21,978 - DEBUG - send_request_headers.complete
2024-10-14 14:44:21,978 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:44:21,978 - DEBUG - send_request_body.complete
2024-10-14 14:44:21,978 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:44:23,073 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:44:23 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'928'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9978'), (b'x-ratelimit-remaining-tokens', b'8425'), (b'x-ratelimit-reset-requests', b'3m9.039s'), (b'x-ratelimit-reset-tokens', b'9.448s'), (b'x-request-id', b'req_d6be773401fc7ad313b47f1d531687f6'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d27512b1e96ca1d-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:44:23,073 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:44:23,073 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:44:23,074 - DEBUG - receive_response_body.complete
2024-10-14 14:44:23,074 - DEBUG - response_closed.started
2024-10-14 14:44:23,074 - DEBUG - response_closed.complete
2024-10-14 14:44:23,074 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:44:23 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '928', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9978', 'x-ratelimit-remaining-tokens': '8425', 'x-ratelimit-reset-requests': '3m9.039s', 'x-ratelimit-reset-tokens': '9.448s', 'x-request-id': 'req_d6be773401fc7ad313b47f1d531687f6', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d27512b1e96ca1d-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:44:23,074 - DEBUG - request_id: req_d6be773401fc7ad313b47f1d531687f6
2024-10-14 14:44:23,074 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDmo1KSdb1TOEfPRYxpLUtQY3twU', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_FzdttkZ9CIGymZPqhQ4A2iLj', function=Function(arguments='{\n"action": "verify_seller_details"\n}', name='AgentAction'), type='function')]))], created=1728906262, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=11, prompt_tokens=240, total_tokens=251, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:44:23,076 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Current state: {'verified_pii_data': [{'name': 'ELENA VASILESCU', 'address': 'Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'parties': {'buyer': 'ELENA VASILESCU', 'seller': ''}, 'contract_details': None, 'contract': None, 'current_action': None}\nWhat action should be taken next?"}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-14 14:44:23,076 - DEBUG - max_retries: 1
2024-10-14 14:44:23,078 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Current state: {'verified_pii_data': [{'name': 'ELENA VASILESCU', 'address': 'Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'parties': {'buyer': 'ELENA VASILESCU', 'seller': ''}, 'contract_details': None, 'contract': None, 'current_action': None}\nWhat action should be taken next?"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-14 14:44:23,078 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:44:23,078 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:44:23,079 - DEBUG - send_request_headers.complete
2024-10-14 14:44:23,079 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:44:23,079 - DEBUG - send_request_body.complete
2024-10-14 14:44:23,079 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:44:24,273 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:44:24 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1033'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9977'), (b'x-ratelimit-remaining-tokens', b'8357'), (b'x-ratelimit-reset-requests', b'3m16.578s'), (b'x-ratelimit-reset-tokens', b'9.853s'), (b'x-request-id', b'req_00f1acbe9fb38ed1726638c6e1d29470'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d275131fa55ca1d-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:44:24,273 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:44:24,273 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:44:24,273 - DEBUG - receive_response_body.complete
2024-10-14 14:44:24,274 - DEBUG - response_closed.started
2024-10-14 14:44:24,274 - DEBUG - response_closed.complete
2024-10-14 14:44:24,274 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:44:24 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1033', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9977', 'x-ratelimit-remaining-tokens': '8357', 'x-ratelimit-reset-requests': '3m16.578s', 'x-ratelimit-reset-tokens': '9.853s', 'x-request-id': 'req_00f1acbe9fb38ed1726638c6e1d29470', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d275131fa55ca1d-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:44:24,274 - DEBUG - request_id: req_00f1acbe9fb38ed1726638c6e1d29470
2024-10-14 14:44:24,274 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDmpIhtIoT5mUlDNxhoeq8jXbnjK', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_SRS5CGTL6yjO5gwexYmPpsbi', function=Function(arguments='{\n"action": "extract_seller_information"\n}', name='AgentAction'), type='function')]))], created=1728906263, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=11, prompt_tokens=240, total_tokens=251, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:44:24,275 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Current state: {'verified_pii_data': [{'name': 'ELENA VASILESCU', 'address': 'Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'parties': {'buyer': 'ELENA VASILESCU', 'seller': ''}, 'contract_details': None, 'contract': None, 'current_action': None}\nWhat action should be taken next?"}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-14 14:44:24,275 - DEBUG - max_retries: 1
2024-10-14 14:44:24,276 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Current state: {'verified_pii_data': [{'name': 'ELENA VASILESCU', 'address': 'Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'parties': {'buyer': 'ELENA VASILESCU', 'seller': ''}, 'contract_details': None, 'contract': None, 'current_action': None}\nWhat action should be taken next?"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-14 14:44:24,276 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:44:24,277 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:44:24,277 - DEBUG - send_request_headers.complete
2024-10-14 14:44:24,277 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:44:24,277 - DEBUG - send_request_body.complete
2024-10-14 14:44:24,277 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:44:25,294 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:44:25 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'869'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9976'), (b'x-ratelimit-remaining-tokens', b'8302'), (b'x-ratelimit-reset-requests', b'3m24.044s'), (b'x-ratelimit-reset-tokens', b'10.185s'), (b'x-request-id', b'req_04ed9d9d397d3c50ac0ab895bb42f6a8'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2751397c38ca1d-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:44:25,294 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:44:25,295 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:44:25,295 - DEBUG - receive_response_body.complete
2024-10-14 14:44:25,295 - DEBUG - response_closed.started
2024-10-14 14:44:25,295 - DEBUG - response_closed.complete
2024-10-14 14:44:25,295 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:44:25 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '869', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9976', 'x-ratelimit-remaining-tokens': '8302', 'x-ratelimit-reset-requests': '3m24.044s', 'x-ratelimit-reset-tokens': '10.185s', 'x-request-id': 'req_04ed9d9d397d3c50ac0ab895bb42f6a8', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2751397c38ca1d-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:44:25,295 - DEBUG - request_id: req_04ed9d9d397d3c50ac0ab895bb42f6a8
2024-10-14 14:44:25,296 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDmqMATAObNVnNNbfnHxm0KepQl4', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_SRS5CGTL6yjO5gwexYmPpsbi', function=Function(arguments='{\n"action": "extract_pii"\n}', name='AgentAction'), type='function')]))], created=1728906264, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=10, prompt_tokens=240, total_tokens=250, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:44:25,297 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.PIIData'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}}
2024-10-14 14:44:25,297 - DEBUG - max_retries: 1
2024-10-14 14:44:25,298 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}, 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}]}}
2024-10-14 14:44:25,299 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:44:25,299 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:44:25,299 - DEBUG - send_request_headers.complete
2024-10-14 14:44:25,299 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:44:25,299 - DEBUG - send_request_body.complete
2024-10-14 14:44:25,299 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:44:27,090 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:44:27 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1638'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9975'), (b'x-ratelimit-remaining-tokens', b'8142'), (b'x-ratelimit-reset-requests', b'3m31.642s'), (b'x-ratelimit-reset-tokens', b'11.146s'), (b'x-request-id', b'req_85600838515a0a41791f553e229f0019'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d27513fdba1ca1d-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:44:27,090 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:44:27,091 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:44:27,091 - DEBUG - receive_response_body.complete
2024-10-14 14:44:27,091 - DEBUG - response_closed.started
2024-10-14 14:44:27,092 - DEBUG - response_closed.complete
2024-10-14 14:44:27,092 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:44:27 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1638', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9975', 'x-ratelimit-remaining-tokens': '8142', 'x-ratelimit-reset-requests': '3m31.642s', 'x-ratelimit-reset-tokens': '11.146s', 'x-request-id': 'req_85600838515a0a41791f553e229f0019', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d27513fdba1ca1d-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:44:27,093 - DEBUG - request_id: req_85600838515a0a41791f553e229f0019
2024-10-14 14:44:27,094 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDmrNWjyDKKu0TkGaYj7Za41DHuC', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_g9g3zkDPLuAZloO18HWBdWVo', function=Function(arguments='{\n"name": "ISPILANTE SENTIMENT BRUSLI",\n"address": "Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR"\n}', name='PIIData'), type='function')]))], created=1728906265, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=39, prompt_tokens=377, total_tokens=416, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:44:32,219 - DEBUG - close.started
2024-10-14 14:44:32,219 - DEBUG - close.complete
2024-10-14 14:44:32,220 - ERROR - Task exception was never retrieved
future: <Task finished name='Task-1' coro=<agent_workflow() done, defined at D:\deve\contract_automation\src\main.py:25> exception=KeyboardInterrupt()>
Traceback (most recent call last):
  File "D:\deve\contract_automation\src\main.py", line 73, in <module>
    asyncio.run(agent_workflow())
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 30, in run
    return loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 92, in run_until_complete
    self._run_once()
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 133, in _run_once
    handle._run()
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 386, in __wakeup
    self.__step()
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 293, in __step
    self.__step_run_and_handle_result(exc)
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 304, in __step_run_and_handle_result
    result = coro.send(None)
             ^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\src\main.py", line 38, in agent_workflow
    if verify_information(pii):
       ^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\src\utils.py", line 7, in verify_information
    verification = input("Is this information correct? (yes/no): ").lower()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
2024-10-14 14:45:52,928 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-14 14:45:54,211 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-14 14:45:54,211 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-14 14:45:54,535 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-14 14:45:54,536 - DEBUG - Using proactor: IocpProactor
2024-10-14 14:45:54,557 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 14:45:54,557 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 14:45:54,557 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 14:45:54,557 - DEBUG - Compression method 0
2024-10-14 14:45:54,557 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 14:45:54,557 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 14:45:54,557 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-14 14:45:54,557 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-14 14:45:54,557 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-14 14:45:54,557 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-14 14:45:54,557 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 14:45:54,557 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 14:45:54,557 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 14:45:54,557 - DEBUG - Compression method 0
2024-10-14 14:45:54,557 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 14:45:54,557 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 14:45:54,557 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-14 14:45:54,558 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-14 14:45:54,558 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-14 14:45:54,558 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-14 14:45:54,568 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 14:45:54,568 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 14:45:54,568 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-14 14:45:54,568 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-14 14:45:54,568 - DEBUG - Error closing: Operation on closed image
2024-10-14 14:45:56,588 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 14:45:56,588 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 14:45:56,588 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 14:45:56,588 - DEBUG - Compression method 0
2024-10-14 14:45:56,588 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 14:45:56,588 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 14:45:56,588 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-14 14:45:56,588 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-14 14:45:56,588 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-14 14:45:56,588 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-14 14:45:56,589 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 14:45:56,589 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 14:45:56,589 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 14:45:56,589 - DEBUG - Compression method 0
2024-10-14 14:45:56,589 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 14:45:56,589 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 14:45:56,589 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-14 14:45:56,589 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-14 14:45:56,589 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-14 14:45:56,589 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-14 14:45:56,606 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 14:45:56,606 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 14:45:56,606 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-14 14:45:56,606 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-14 14:45:56,607 - DEBUG - Error closing: Operation on closed image
2024-10-14 14:45:59,165 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Current state: {'verified_pii_data': [], 'parties': None, 'contract_details': None, 'contract': None, 'current_action': None}\nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish"}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-14 14:45:59,166 - DEBUG - max_retries: 1
2024-10-14 14:45:59,168 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Current state: {'verified_pii_data': [], 'parties': None, 'contract_details': None, 'contract': None, 'current_action': None}\nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-14 14:45:59,206 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:45:59,206 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-14 14:45:59,218 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x0000014CF907E840>
2024-10-14 14:45:59,218 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x0000014CF8EC5B50> server_hostname='api.openai.com' timeout=5.0
2024-10-14 14:45:59,225 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x0000014CF907E570>
2024-10-14 14:45:59,225 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:45:59,226 - DEBUG - send_request_headers.complete
2024-10-14 14:45:59,226 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:45:59,226 - DEBUG - send_request_body.complete
2024-10-14 14:45:59,226 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:46:00,232 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:46:00 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'842'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9985'), (b'x-ratelimit-remaining-tokens', b'9829'), (b'x-ratelimit-reset-requests', b'2m6.343s'), (b'x-ratelimit-reset-tokens', b'1.026s'), (b'x-request-id', b'req_6685429035916041bbafce881378c8e4'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=nAsmpYt3ZNA5q2szTXCcDHG60DNT7IGuy9WKVAtQIhE-1728906360-1.0.1.1-z7Fgq2FnI9jqQM4vjhqUoUqTB7iY.l6Dx6BI_qN8VahmBjGpF7w.QxUSxwo9Cji4Bp9Lcnx5xY7vIWKqk7jChg; path=/; expires=Mon, 14-Oct-24 12:16:00 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=f8Cedg8vxpToGJIRcD8Q.49VhZQZe19yaQLUxjVy2c0-1728906360505-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d27538aec4e26f6-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:46:00,234 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:46:00,234 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:46:00,235 - DEBUG - receive_response_body.complete
2024-10-14 14:46:00,235 - DEBUG - response_closed.started
2024-10-14 14:46:00,235 - DEBUG - response_closed.complete
2024-10-14 14:46:00,235 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Mon, 14 Oct 2024 11:46:00 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-kzzh9hik9ryjiou4ftvhondh'), ('openai-processing-ms', '842'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '10000'), ('x-ratelimit-remaining-requests', '9985'), ('x-ratelimit-remaining-tokens', '9829'), ('x-ratelimit-reset-requests', '2m6.343s'), ('x-ratelimit-reset-tokens', '1.026s'), ('x-request-id', 'req_6685429035916041bbafce881378c8e4'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=nAsmpYt3ZNA5q2szTXCcDHG60DNT7IGuy9WKVAtQIhE-1728906360-1.0.1.1-z7Fgq2FnI9jqQM4vjhqUoUqTB7iY.l6Dx6BI_qN8VahmBjGpF7w.QxUSxwo9Cji4Bp9Lcnx5xY7vIWKqk7jChg; path=/; expires=Mon, 14-Oct-24 12:16:00 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=f8Cedg8vxpToGJIRcD8Q.49VhZQZe19yaQLUxjVy2c0-1728906360505-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d27538aec4e26f6-OTP'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-14 14:46:00,236 - DEBUG - request_id: req_6685429035916041bbafce881378c8e4
2024-10-14 14:46:00,239 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDoNTarIb1QVrQu1U44BtJ7TroAu', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_oG9XGxO6fVdg9gBkeyCOYesR', function=Function(arguments='{\n"action": "extract_pii"\n}', name='AgentAction'), type='function')]))], created=1728906359, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=10, prompt_tokens=202, total_tokens=212, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:46:00,240 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.PIIData'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}}
2024-10-14 14:46:00,240 - DEBUG - max_retries: 1
2024-10-14 14:46:00,241 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}, 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}]}}
2024-10-14 14:46:00,242 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:46:00,242 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:46:00,242 - DEBUG - send_request_headers.complete
2024-10-14 14:46:00,242 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:46:00,242 - DEBUG - send_request_body.complete
2024-10-14 14:46:00,242 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:46:02,295 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:46:02 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1897'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9984'), (b'x-ratelimit-remaining-tokens', b'9692'), (b'x-ratelimit-reset-requests', b'2m13.97s'), (b'x-ratelimit-reset-tokens', b'1.843s'), (b'x-request-id', b'req_b5be01c698cbc7a7d3300b2a7dbf7245'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2753914a6a26f6-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:46:02,295 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:46:02,295 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:46:02,295 - DEBUG - receive_response_body.complete
2024-10-14 14:46:02,295 - DEBUG - response_closed.started
2024-10-14 14:46:02,295 - DEBUG - response_closed.complete
2024-10-14 14:46:02,296 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:46:02 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1897', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9984', 'x-ratelimit-remaining-tokens': '9692', 'x-ratelimit-reset-requests': '2m13.97s', 'x-ratelimit-reset-tokens': '1.843s', 'x-request-id': 'req_b5be01c698cbc7a7d3300b2a7dbf7245', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2753914a6a26f6-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:46:02,296 - DEBUG - request_id: req_b5be01c698cbc7a7d3300b2a7dbf7245
2024-10-14 14:46:02,296 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDoOaMu96VmeLmPeSqFT6AeEZz9q', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_t0A9jsxCVsNCFNhdcyrwmJUe', function=Function(arguments='{\n"name": "ISPILANTE SENTIMENT BRUSLI",\n"address": "Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR"\n}', name='PIIData'), type='function')]))], created=1728906360, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=39, prompt_tokens=377, total_tokens=416, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:46:19,639 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.PIIData'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}}
2024-10-14 14:46:19,640 - DEBUG - max_retries: 1
2024-10-14 14:46:19,643 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}, 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}]}}
2024-10-14 14:46:19,643 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:46:19,643 - DEBUG - close.started
2024-10-14 14:46:19,644 - DEBUG - close.complete
2024-10-14 14:46:19,644 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-14 14:46:19,648 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x0000014CF90A29F0>
2024-10-14 14:46:19,648 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x0000014CF8EC5B50> server_hostname='api.openai.com' timeout=5.0
2024-10-14 14:46:19,656 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x0000014CF90A0C50>
2024-10-14 14:46:19,657 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:46:19,657 - DEBUG - send_request_headers.complete
2024-10-14 14:46:19,657 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:46:19,657 - DEBUG - send_request_body.complete
2024-10-14 14:46:19,657 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:46:22,302 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:46:22 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2479'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9985'), (b'x-ratelimit-remaining-tokens', b'9742'), (b'x-ratelimit-reset-requests', b'2m3.185s'), (b'x-ratelimit-reset-tokens', b'1.548s'), (b'x-request-id', b'req_541388d7fe0f8091ab7ef0e068fa1d72'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d27540a9ea8b6a7-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:46:22,303 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:46:22,303 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:46:22,303 - DEBUG - receive_response_body.complete
2024-10-14 14:46:22,304 - DEBUG - response_closed.started
2024-10-14 14:46:22,304 - DEBUG - response_closed.complete
2024-10-14 14:46:22,304 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:46:22 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '2479', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9985', 'x-ratelimit-remaining-tokens': '9742', 'x-ratelimit-reset-requests': '2m3.185s', 'x-ratelimit-reset-tokens': '1.548s', 'x-request-id': 'req_541388d7fe0f8091ab7ef0e068fa1d72', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d27540a9ea8b6a7-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:46:22,304 - DEBUG - request_id: req_541388d7fe0f8091ab7ef0e068fa1d72
2024-10-14 14:46:22,305 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDoi0qMUnDoyTL4ZRMdTd3rmoUiv', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_ye3r6Q8OFdu8omqVrJ1Bb9vQ', function=Function(arguments='{\n"name": "VASILESCU ELENA",\n"address": "Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B"\n}', name='PIIData'), type='function')]))], created=1728906380, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=41, prompt_tokens=380, total_tokens=421, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:46:23,712 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Current state: {'verified_pii_data': [{'name': 'ISPILANTE SENTIMENT BRUSLI', 'address': 'Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR'}, {'name': 'VASILESCU ELENA', 'address': 'Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'parties': None, 'contract_details': None, 'contract': None, 'current_action': None}\nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish"}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-14 14:46:23,712 - DEBUG - max_retries: 1
2024-10-14 14:46:23,714 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Current state: {'verified_pii_data': [{'name': 'ISPILANTE SENTIMENT BRUSLI', 'address': 'Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR'}, {'name': 'VASILESCU ELENA', 'address': 'Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'parties': None, 'contract_details': None, 'contract': None, 'current_action': None}\nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-14 14:46:23,715 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:46:23,715 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:46:23,715 - DEBUG - send_request_headers.complete
2024-10-14 14:46:23,716 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:46:23,716 - DEBUG - send_request_body.complete
2024-10-14 14:46:23,716 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:46:24,869 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:46:25 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'988'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9985'), (b'x-ratelimit-remaining-tokens', b'9780'), (b'x-ratelimit-reset-requests', b'2m7.766s'), (b'x-ratelimit-reset-tokens', b'1.32s'), (b'x-request-id', b'req_077d18e980cfdaad803608437641098d'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d275423fc78b6a7-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:46:24,869 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:46:24,869 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:46:24,869 - DEBUG - receive_response_body.complete
2024-10-14 14:46:24,869 - DEBUG - response_closed.started
2024-10-14 14:46:24,869 - DEBUG - response_closed.complete
2024-10-14 14:46:24,869 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:46:25 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '988', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9985', 'x-ratelimit-remaining-tokens': '9780', 'x-ratelimit-reset-requests': '2m7.766s', 'x-ratelimit-reset-tokens': '1.32s', 'x-request-id': 'req_077d18e980cfdaad803608437641098d', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d275423fc78b6a7-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:46:24,869 - DEBUG - request_id: req_077d18e980cfdaad803608437641098d
2024-10-14 14:46:24,870 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDom2bAp1t1n3gA74uU6jj2qhLNU', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_Wz31eUdTFanX8NqqYZsbLCJt', function=Function(arguments='{\n"action": "identify_parties"\n}', name='AgentAction'), type='function')]))], created=1728906384, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=10, prompt_tokens=280, total_tokens=290, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:46:24,871 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.ContractParties'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Identify the buyer and seller from the given information:\n\nName: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: VASILESCU ELENA, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'properties': {'buyer': {'description': 'Name of the buyer', 'title': 'Buyer', 'type': 'string'}, 'seller': {'description': 'Name of the seller', 'title': 'Seller', 'type': 'string'}}, 'required': ['buyer', 'seller'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}}
2024-10-14 14:46:24,871 - DEBUG - max_retries: 1
2024-10-14 14:46:24,873 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Identify the buyer and seller from the given information:\n\nName: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: VASILESCU ELENA, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}, 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'properties': {'buyer': {'description': 'Name of the buyer', 'title': 'Buyer', 'type': 'string'}, 'seller': {'description': 'Name of the seller', 'title': 'Seller', 'type': 'string'}}, 'required': ['buyer', 'seller'], 'type': 'object'}}}]}}
2024-10-14 14:46:24,874 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:46:24,874 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:46:24,874 - DEBUG - send_request_headers.complete
2024-10-14 14:46:24,874 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:46:24,875 - DEBUG - send_request_body.complete
2024-10-14 14:46:24,875 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:46:26,687 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:46:26 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1640'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9984'), (b'x-ratelimit-remaining-tokens', b'9735'), (b'x-ratelimit-reset-requests', b'2m15.257s'), (b'x-ratelimit-reset-tokens', b'1.586s'), (b'x-request-id', b'req_896a78b39babe52f9f7771ab9255d77d'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d27542b3cc5b6a7-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:46:26,688 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:46:26,688 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:46:26,688 - DEBUG - receive_response_body.complete
2024-10-14 14:46:26,688 - DEBUG - response_closed.started
2024-10-14 14:46:26,688 - DEBUG - response_closed.complete
2024-10-14 14:46:26,688 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:46:26 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1640', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9984', 'x-ratelimit-remaining-tokens': '9735', 'x-ratelimit-reset-requests': '2m15.257s', 'x-ratelimit-reset-tokens': '1.586s', 'x-request-id': 'req_896a78b39babe52f9f7771ab9255d77d', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d27542b3cc5b6a7-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:46:26,688 - DEBUG - request_id: req_896a78b39babe52f9f7771ab9255d77d
2024-10-14 14:46:26,688 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDonZJ9YVGGnUs4l1oBoULnK3f5u', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_SXcbGdrG27U6btfV8RI0Ttvj', function=Function(arguments='{\n  "buyer": "ISPILANTE SENTIMENT BRUSLI",\n  "seller": "VASILESCU ELENA"\n}', name='ContractParties'), type='function')]))], created=1728906385, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=29, prompt_tokens=232, total_tokens=261, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:46:26,689 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Current state: {'verified_pii_data': [{'name': 'ISPILANTE SENTIMENT BRUSLI', 'address': 'Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR'}, {'name': 'VASILESCU ELENA', 'address': 'Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'parties': {'buyer': 'ISPILANTE SENTIMENT BRUSLI', 'seller': 'VASILESCU ELENA'}, 'contract_details': None, 'contract': None, 'current_action': None}\nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish"}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-14 14:46:26,689 - DEBUG - max_retries: 1
2024-10-14 14:46:26,691 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Current state: {'verified_pii_data': [{'name': 'ISPILANTE SENTIMENT BRUSLI', 'address': 'Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR'}, {'name': 'VASILESCU ELENA', 'address': 'Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'parties': {'buyer': 'ISPILANTE SENTIMENT BRUSLI', 'seller': 'VASILESCU ELENA'}, 'contract_details': None, 'contract': None, 'current_action': None}\nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-14 14:46:26,691 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:46:26,691 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:46:26,691 - DEBUG - send_request_headers.complete
2024-10-14 14:46:26,691 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:46:26,692 - DEBUG - send_request_body.complete
2024-10-14 14:46:26,692 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:46:27,611 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:46:27 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'756'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9983'), (b'x-ratelimit-remaining-tokens', b'9695'), (b'x-ratelimit-reset-requests', b'2m22.075s'), (b'x-ratelimit-reset-tokens', b'1.828s'), (b'x-request-id', b'req_259205e93b90a44a5e896cc644378501'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2754369996b6a7-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:46:27,612 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:46:27,612 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:46:27,612 - DEBUG - receive_response_body.complete
2024-10-14 14:46:27,612 - DEBUG - response_closed.started
2024-10-14 14:46:27,612 - DEBUG - response_closed.complete
2024-10-14 14:46:27,613 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:46:27 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '756', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9983', 'x-ratelimit-remaining-tokens': '9695', 'x-ratelimit-reset-requests': '2m22.075s', 'x-ratelimit-reset-tokens': '1.828s', 'x-request-id': 'req_259205e93b90a44a5e896cc644378501', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2754369996b6a7-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:46:27,613 - DEBUG - request_id: req_259205e93b90a44a5e896cc644378501
2024-10-14 14:46:27,613 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDopzWDFHqaN0YzFXc1q1BOs5u5R', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_7akbmKM3zanMMVPKQ57dua6b', function=Function(arguments='{\n"action": "determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728906387, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=11, prompt_tokens=303, total_tokens=314, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:46:39,036 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.ContractDetails'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Determine the contract details for a airbnb contract between ISPILANTE SENTIMENT BRUSLI and VASILESCU ELENA.'}], 'tools': [{'type': 'function', 'function': {'name': 'ContractDetails', 'description': 'Correctly extracted `ContractDetails` with all the required parameters with correct types', 'parameters': {'properties': {'contract_type': {'description': 'Type of contract (e.g., airbnb, buy-sell, it-consulting)', 'title': 'Contract Type', 'type': 'string'}, 'additional_info': {'additionalProperties': {'type': 'string'}, 'description': 'Additional information specific to the contract type', 'title': 'Additional Info', 'type': 'object'}}, 'required': ['additional_info', 'contract_type'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'ContractDetails'}}}
2024-10-14 14:46:39,036 - DEBUG - max_retries: 1
2024-10-14 14:46:39,038 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Determine the contract details for a airbnb contract between ISPILANTE SENTIMENT BRUSLI and VASILESCU ELENA.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'ContractDetails'}}, 'tools': [{'type': 'function', 'function': {'name': 'ContractDetails', 'description': 'Correctly extracted `ContractDetails` with all the required parameters with correct types', 'parameters': {'properties': {'contract_type': {'description': 'Type of contract (e.g., airbnb, buy-sell, it-consulting)', 'title': 'Contract Type', 'type': 'string'}, 'additional_info': {'additionalProperties': {'type': 'string'}, 'description': 'Additional information specific to the contract type', 'title': 'Additional Info', 'type': 'object'}}, 'required': ['additional_info', 'contract_type'], 'type': 'object'}}}]}}
2024-10-14 14:46:39,039 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:46:39,039 - DEBUG - close.started
2024-10-14 14:46:39,039 - DEBUG - close.complete
2024-10-14 14:46:39,039 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-14 14:46:39,046 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x0000014CF90AD4C0>
2024-10-14 14:46:39,046 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x0000014CF8EC5B50> server_hostname='api.openai.com' timeout=5.0
2024-10-14 14:46:39,053 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x0000014CF90AE9F0>
2024-10-14 14:46:39,053 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:46:39,053 - DEBUG - send_request_headers.complete
2024-10-14 14:46:39,053 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:46:39,053 - DEBUG - send_request_body.complete
2024-10-14 14:46:39,053 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:46:39,976 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:46:40 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'754'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9983'), (b'x-ratelimit-remaining-tokens', b'9865'), (b'x-ratelimit-reset-requests', b'2m18.362s'), (b'x-ratelimit-reset-tokens', b'810ms'), (b'x-request-id', b'req_eab72a4e50b2e6a625be3dae9f571541'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d275483df05c9d8-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:46:39,976 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:46:39,976 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:46:39,977 - DEBUG - receive_response_body.complete
2024-10-14 14:46:39,977 - DEBUG - response_closed.started
2024-10-14 14:46:39,977 - DEBUG - response_closed.complete
2024-10-14 14:46:39,977 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:46:40 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '754', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9983', 'x-ratelimit-remaining-tokens': '9865', 'x-ratelimit-reset-requests': '2m18.362s', 'x-ratelimit-reset-tokens': '810ms', 'x-request-id': 'req_eab72a4e50b2e6a625be3dae9f571541', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d275483df05c9d8-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:46:39,977 - DEBUG - request_id: req_eab72a4e50b2e6a625be3dae9f571541
2024-10-14 14:46:39,978 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDp1hbfI0KS2cq31yuPc8ZAnatc0', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_4vzuJSnUudEHTeOY5gOacCYB', function=Function(arguments='{\n  "contract_type": "airbnb"\n}', name='ContractDetails'), type='function')]))], created=1728906399, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=11, prompt_tokens=184, total_tokens=195, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:46:39,980 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Current state: {'verified_pii_data': [{'name': 'ISPILANTE SENTIMENT BRUSLI', 'address': 'Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR'}, {'name': 'VASILESCU ELENA', 'address': 'Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'parties': {'buyer': 'ISPILANTE SENTIMENT BRUSLI', 'seller': 'VASILESCU ELENA'}, 'contract_details': {'contract_type': 'airbnb', 'additional_info': {}}, 'contract': None, 'current_action': None}\nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish"}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-14 14:46:39,980 - DEBUG - max_retries: 1
2024-10-14 14:46:39,982 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Current state: {'verified_pii_data': [{'name': 'ISPILANTE SENTIMENT BRUSLI', 'address': 'Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR'}, {'name': 'VASILESCU ELENA', 'address': 'Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'parties': {'buyer': 'ISPILANTE SENTIMENT BRUSLI', 'seller': 'VASILESCU ELENA'}, 'contract_details': {'contract_type': 'airbnb', 'additional_info': {}}, 'contract': None, 'current_action': None}\nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-14 14:46:39,983 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:46:39,983 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:46:39,983 - DEBUG - send_request_headers.complete
2024-10-14 14:46:39,983 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:46:39,984 - DEBUG - send_request_body.complete
2024-10-14 14:46:39,984 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:46:40,799 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:46:41 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'667'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9983'), (b'x-ratelimit-remaining-tokens', b'9712'), (b'x-ratelimit-reset-requests', b'2m26.069s'), (b'x-ratelimit-reset-tokens', b'1.725s'), (b'x-request-id', b'req_0dfaddada4890846e9861c1e8879b07c'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d275489af81c9d8-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:46:40,799 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:46:40,799 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:46:40,799 - DEBUG - receive_response_body.complete
2024-10-14 14:46:40,799 - DEBUG - response_closed.started
2024-10-14 14:46:40,799 - DEBUG - response_closed.complete
2024-10-14 14:46:40,799 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:46:41 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '667', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9983', 'x-ratelimit-remaining-tokens': '9712', 'x-ratelimit-reset-requests': '2m26.069s', 'x-ratelimit-reset-tokens': '1.725s', 'x-request-id': 'req_0dfaddada4890846e9861c1e8879b07c', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d275489af81c9d8-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:46:40,799 - DEBUG - request_id: req_0dfaddada4890846e9861c1e8879b07c
2024-10-14 14:46:40,800 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDp2AstgizCC6cfjUjJWWKgtaSbh', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_aBN3ELdyfohgkHoGZ9RgyhzQ', function=Function(arguments='{\n"action": "construct_contract"\n}', name='AgentAction'), type='function')]))], created=1728906400, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=9, prompt_tokens=315, total_tokens=324, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:46:40,957 - DEBUG - close.started
2024-10-14 14:46:40,957 - DEBUG - close.complete
2024-10-14 14:48:02,575 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-14 14:48:03,844 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-14 14:48:03,844 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-14 14:48:04,176 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-14 14:48:04,177 - DEBUG - Using proactor: IocpProactor
2024-10-14 14:48:04,196 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 14:48:04,196 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 14:48:04,196 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 14:48:04,197 - DEBUG - Compression method 0
2024-10-14 14:48:04,197 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 14:48:04,197 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 14:48:04,197 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-14 14:48:04,197 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-14 14:48:04,197 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-14 14:48:04,197 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-14 14:48:04,197 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 14:48:04,197 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 14:48:04,197 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 14:48:04,197 - DEBUG - Compression method 0
2024-10-14 14:48:04,197 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 14:48:04,197 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 14:48:04,197 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-14 14:48:04,197 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-14 14:48:04,197 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-14 14:48:04,197 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-14 14:48:04,208 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 14:48:04,208 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 14:48:04,208 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-14 14:48:04,208 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-14 14:48:04,209 - DEBUG - Error closing: Operation on closed image
2024-10-14 14:48:06,303 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 14:48:06,303 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 14:48:06,303 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 14:48:06,303 - DEBUG - Compression method 0
2024-10-14 14:48:06,303 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 14:48:06,303 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 14:48:06,303 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-14 14:48:06,303 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-14 14:48:06,303 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-14 14:48:06,303 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-14 14:48:06,303 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 14:48:06,303 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 14:48:06,304 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 14:48:06,304 - DEBUG - Compression method 0
2024-10-14 14:48:06,304 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 14:48:06,304 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 14:48:06,304 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-14 14:48:06,304 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-14 14:48:06,304 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-14 14:48:06,304 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-14 14:48:06,323 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 14:48:06,323 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 14:48:06,323 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-14 14:48:06,323 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-14 14:48:06,324 - DEBUG - Error closing: Operation on closed image
2024-10-14 14:48:09,573 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Current state: {'verified_pii_data': [], 'parties': None, 'contract_details': None, 'contract': None, 'current_action': None}\nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish"}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-14 14:48:09,574 - DEBUG - max_retries: 1
2024-10-14 14:48:09,578 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Current state: {'verified_pii_data': [], 'parties': None, 'contract_details': None, 'contract': None, 'current_action': None}\nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-14 14:48:09,618 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:48:09,618 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-14 14:48:09,631 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x0000015C7F8968D0>
2024-10-14 14:48:09,631 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x0000015C7F6E5B50> server_hostname='api.openai.com' timeout=5.0
2024-10-14 14:48:09,639 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x0000015C7F8967E0>
2024-10-14 14:48:09,640 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:48:09,640 - DEBUG - send_request_headers.complete
2024-10-14 14:48:09,640 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:48:09,640 - DEBUG - send_request_body.complete
2024-10-14 14:48:09,640 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:48:10,457 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:48:10 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'669'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9992'), (b'x-ratelimit-remaining-tokens', b'9829'), (b'x-ratelimit-reset-requests', b'1m5.05s'), (b'x-ratelimit-reset-tokens', b'1.026s'), (b'x-request-id', b'req_3bf53e8741f2565fc16ca731b4583275'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=7RhrJv0jG7ZKTIr7CsKhJAoIvqZ78q2ZaIcy.b_kqo8-1728906490-1.0.1.1-G3hR1vnJXYJVSe.ChhEai.hsxZejLxnA6ejKQTnSQm3bzr1NBLYyN0yBfVhx2y59UJT3arHmwnI6yTreJyhD6g; path=/; expires=Mon, 14-Oct-24 12:18:10 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=HQ547sAU2_5AxJJpz0__5PSxZ8ypEgYgaMfscmFqYMU-1728906490736-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2756ba0991c9de-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:48:10,459 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:48:10,459 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:48:10,460 - DEBUG - receive_response_body.complete
2024-10-14 14:48:10,460 - DEBUG - response_closed.started
2024-10-14 14:48:10,460 - DEBUG - response_closed.complete
2024-10-14 14:48:10,460 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Mon, 14 Oct 2024 11:48:10 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-kzzh9hik9ryjiou4ftvhondh'), ('openai-processing-ms', '669'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '10000'), ('x-ratelimit-remaining-requests', '9992'), ('x-ratelimit-remaining-tokens', '9829'), ('x-ratelimit-reset-requests', '1m5.05s'), ('x-ratelimit-reset-tokens', '1.026s'), ('x-request-id', 'req_3bf53e8741f2565fc16ca731b4583275'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=7RhrJv0jG7ZKTIr7CsKhJAoIvqZ78q2ZaIcy.b_kqo8-1728906490-1.0.1.1-G3hR1vnJXYJVSe.ChhEai.hsxZejLxnA6ejKQTnSQm3bzr1NBLYyN0yBfVhx2y59UJT3arHmwnI6yTreJyhD6g; path=/; expires=Mon, 14-Oct-24 12:18:10 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=HQ547sAU2_5AxJJpz0__5PSxZ8ypEgYgaMfscmFqYMU-1728906490736-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d2756ba0991c9de-OTP'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-14 14:48:10,461 - DEBUG - request_id: req_3bf53e8741f2565fc16ca731b4583275
2024-10-14 14:48:10,465 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDqUg2iaQWtG9U5sLZr5ZYzQ0Ei9', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_PNI8GQMNSZyka94UQiyT3lGw', function=Function(arguments='{\n"action": "extract_pii"\n}', name='AgentAction'), type='function')]))], created=1728906490, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=10, prompt_tokens=202, total_tokens=212, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:48:10,466 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.PIIData'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}}
2024-10-14 14:48:10,466 - DEBUG - max_retries: 1
2024-10-14 14:48:10,468 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}, 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}]}}
2024-10-14 14:48:10,468 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:48:10,468 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:48:10,468 - DEBUG - send_request_headers.complete
2024-10-14 14:48:10,468 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:48:10,468 - DEBUG - send_request_body.complete
2024-10-14 14:48:10,468 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:48:12,469 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:48:12 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1854'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9991'), (b'x-ratelimit-remaining-tokens', b'9661'), (b'x-ratelimit-reset-requests', b'1m12.862s'), (b'x-ratelimit-reset-tokens', b'2.028s'), (b'x-request-id', b'req_b5311bf885f893c7c59867b59d0f46b7'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2756bf3fcec9de-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:48:12,470 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:48:12,470 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:48:12,470 - DEBUG - receive_response_body.complete
2024-10-14 14:48:12,470 - DEBUG - response_closed.started
2024-10-14 14:48:12,471 - DEBUG - response_closed.complete
2024-10-14 14:48:12,471 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:48:12 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1854', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9991', 'x-ratelimit-remaining-tokens': '9661', 'x-ratelimit-reset-requests': '1m12.862s', 'x-ratelimit-reset-tokens': '2.028s', 'x-request-id': 'req_b5311bf885f893c7c59867b59d0f46b7', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2756bf3fcec9de-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:48:12,471 - DEBUG - request_id: req_b5311bf885f893c7c59867b59d0f46b7
2024-10-14 14:48:12,472 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDqUhFmTO6kiK7hB6zITtP8JKG9t', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_J8PuNwQBq5HwxbSXMlXBSQ5V', function=Function(arguments='{\n"name": "ISPILANTE SENTIMENT BRUSLI",\n"address": "Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR"\n}', name='PIIData'), type='function')]))], created=1728906490, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=39, prompt_tokens=377, total_tokens=416, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:48:14,360 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.PIIData'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}}
2024-10-14 14:48:14,360 - DEBUG - max_retries: 1
2024-10-14 14:48:14,363 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}, 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}]}}
2024-10-14 14:48:14,363 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:48:14,363 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:48:14,364 - DEBUG - send_request_headers.complete
2024-10-14 14:48:14,364 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:48:14,364 - DEBUG - send_request_body.complete
2024-10-14 14:48:14,364 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:48:16,900 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:48:17 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2213'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9991'), (b'x-ratelimit-remaining-tokens', b'9742'), (b'x-ratelimit-reset-requests', b'1m17.607s'), (b'x-ratelimit-reset-tokens', b'1.548s'), (b'x-request-id', b'req_c9e5f13ba7bdfb4e54e7e34ff272a2f4'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2756d78bcbc9de-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:48:16,901 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:48:16,901 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:48:16,901 - DEBUG - receive_response_body.complete
2024-10-14 14:48:16,901 - DEBUG - response_closed.started
2024-10-14 14:48:16,902 - DEBUG - response_closed.complete
2024-10-14 14:48:16,902 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:48:17 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '2213', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9991', 'x-ratelimit-remaining-tokens': '9742', 'x-ratelimit-reset-requests': '1m17.607s', 'x-ratelimit-reset-tokens': '1.548s', 'x-request-id': 'req_c9e5f13ba7bdfb4e54e7e34ff272a2f4', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2756d78bcbc9de-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:48:16,902 - DEBUG - request_id: req_c9e5f13ba7bdfb4e54e7e34ff272a2f4
2024-10-14 14:48:16,903 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDqYc48myImmXGenLJmY58Vu4Qwy', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_G0NQNr4TLezYTg1DQBFeDuFZ', function=Function(arguments='{\n"name": "VASILESCU ELENA",\n"address": "Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B"\n}', name='PIIData'), type='function')]))], created=1728906494, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=41, prompt_tokens=380, total_tokens=421, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:48:18,312 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Current state: {'verified_pii_data': [{'name': 'ISPILANTE SENTIMENT BRUSLI', 'address': 'Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR'}, {'name': 'VASILESCU ELENA', 'address': 'Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'parties': None, 'contract_details': None, 'contract': None, 'current_action': None}\nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish"}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-14 14:48:18,312 - DEBUG - max_retries: 1
2024-10-14 14:48:18,315 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Current state: {'verified_pii_data': [{'name': 'ISPILANTE SENTIMENT BRUSLI', 'address': 'Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR'}, {'name': 'VASILESCU ELENA', 'address': 'Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'parties': None, 'contract_details': None, 'contract': None, 'current_action': None}\nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-14 14:48:18,315 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:48:18,316 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:48:18,316 - DEBUG - send_request_headers.complete
2024-10-14 14:48:18,316 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:48:18,316 - DEBUG - send_request_body.complete
2024-10-14 14:48:18,316 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:48:19,194 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:48:19 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'727'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9990'), (b'x-ratelimit-remaining-tokens', b'9780'), (b'x-ratelimit-reset-requests', b'1m22.295s'), (b'x-ratelimit-reset-tokens', b'1.32s'), (b'x-request-id', b'req_89a26160764bba22a89565761a506de4'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2756f03f74c9de-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:48:19,194 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:48:19,194 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:48:19,194 - DEBUG - receive_response_body.complete
2024-10-14 14:48:19,195 - DEBUG - response_closed.started
2024-10-14 14:48:19,195 - DEBUG - response_closed.complete
2024-10-14 14:48:19,195 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:48:19 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '727', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9990', 'x-ratelimit-remaining-tokens': '9780', 'x-ratelimit-reset-requests': '1m22.295s', 'x-ratelimit-reset-tokens': '1.32s', 'x-request-id': 'req_89a26160764bba22a89565761a506de4', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2756f03f74c9de-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:48:19,195 - DEBUG - request_id: req_89a26160764bba22a89565761a506de4
2024-10-14 14:48:19,195 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDqcEZZEjLys4pJTpqyJByeboLp4', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_t0A9jsxCVsNCFNhdcyrwmJUe', function=Function(arguments='{\n"action": "identify_parties"\n}', name='AgentAction'), type='function')]))], created=1728906498, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=10, prompt_tokens=280, total_tokens=290, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:48:19,196 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.ContractParties'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Identify the buyer and seller from the given information:\n\nName: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: VASILESCU ELENA, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'properties': {'buyer': {'description': 'Name of the buyer', 'title': 'Buyer', 'type': 'string'}, 'seller': {'description': 'Name of the seller', 'title': 'Seller', 'type': 'string'}}, 'required': ['buyer', 'seller'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}}
2024-10-14 14:48:19,196 - DEBUG - max_retries: 1
2024-10-14 14:48:19,197 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Identify the buyer and seller from the given information:\n\nName: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: VASILESCU ELENA, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}, 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'properties': {'buyer': {'description': 'Name of the buyer', 'title': 'Buyer', 'type': 'string'}, 'seller': {'description': 'Name of the seller', 'title': 'Seller', 'type': 'string'}}, 'required': ['buyer', 'seller'], 'type': 'object'}}}]}}
2024-10-14 14:48:19,197 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:48:19,198 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:48:19,198 - DEBUG - send_request_headers.complete
2024-10-14 14:48:19,198 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:48:19,198 - DEBUG - send_request_body.complete
2024-10-14 14:48:19,198 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:48:21,221 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:48:21 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1833'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9989'), (b'x-ratelimit-remaining-tokens', b'9693'), (b'x-ratelimit-reset-requests', b'1m30.039s'), (b'x-ratelimit-reset-tokens', b'1.839s'), (b'x-request-id', b'req_998d6f49f038add98e1fc578a4039f1e'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2756f5ce6fc9de-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:48:21,221 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:48:21,221 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:48:21,221 - DEBUG - receive_response_body.complete
2024-10-14 14:48:21,221 - DEBUG - response_closed.started
2024-10-14 14:48:21,222 - DEBUG - response_closed.complete
2024-10-14 14:48:21,222 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:48:21 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1833', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9989', 'x-ratelimit-remaining-tokens': '9693', 'x-ratelimit-reset-requests': '1m30.039s', 'x-ratelimit-reset-tokens': '1.839s', 'x-request-id': 'req_998d6f49f038add98e1fc578a4039f1e', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2756f5ce6fc9de-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:48:21,222 - DEBUG - request_id: req_998d6f49f038add98e1fc578a4039f1e
2024-10-14 14:48:21,222 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDqd5ZrhX7TWJz21V8Xy0nYbN8Vq', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_8vezk4WCDBc7SrSOv4ro2cFV', function=Function(arguments='{\n"buyer": "VASILESCU ELENA",\n"seller": "ISPILANTE SENTIMENT BRUSLI"\n}', name='ContractParties'), type='function')]))], created=1728906499, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=27, prompt_tokens=232, total_tokens=259, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:48:21,223 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Current state: {'verified_pii_data': [{'name': 'ISPILANTE SENTIMENT BRUSLI', 'address': 'Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR'}, {'name': 'VASILESCU ELENA', 'address': 'Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'parties': {'buyer': 'VASILESCU ELENA', 'seller': 'ISPILANTE SENTIMENT BRUSLI'}, 'contract_details': None, 'contract': None, 'current_action': None}\nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish"}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-14 14:48:21,223 - DEBUG - max_retries: 1
2024-10-14 14:48:21,224 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Current state: {'verified_pii_data': [{'name': 'ISPILANTE SENTIMENT BRUSLI', 'address': 'Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR'}, {'name': 'VASILESCU ELENA', 'address': 'Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'parties': {'buyer': 'VASILESCU ELENA', 'seller': 'ISPILANTE SENTIMENT BRUSLI'}, 'contract_details': None, 'contract': None, 'current_action': None}\nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-14 14:48:21,225 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:48:21,225 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:48:21,225 - DEBUG - send_request_headers.complete
2024-10-14 14:48:21,225 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:48:21,225 - DEBUG - send_request_body.complete
2024-10-14 14:48:21,225 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:48:22,087 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:48:22 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'712'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9988'), (b'x-ratelimit-remaining-tokens', b'9696'), (b'x-ratelimit-reset-requests', b'1m36.665s'), (b'x-ratelimit-reset-tokens', b'1.819s'), (b'x-request-id', b'req_dd4ccfd548e024266498a1dd34c05c6d'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2757026924c9de-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:48:22,087 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:48:22,087 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:48:22,087 - DEBUG - receive_response_body.complete
2024-10-14 14:48:22,087 - DEBUG - response_closed.started
2024-10-14 14:48:22,087 - DEBUG - response_closed.complete
2024-10-14 14:48:22,088 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:48:22 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '712', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9988', 'x-ratelimit-remaining-tokens': '9696', 'x-ratelimit-reset-requests': '1m36.665s', 'x-ratelimit-reset-tokens': '1.819s', 'x-request-id': 'req_dd4ccfd548e024266498a1dd34c05c6d', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2757026924c9de-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:48:22,088 - DEBUG - request_id: req_dd4ccfd548e024266498a1dd34c05c6d
2024-10-14 14:48:22,088 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDqf3DkCNLq6vFeLM69uuDf61rWm', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_wrEFQyrvi9B8gnmYPzocoajJ', function=Function(arguments='{\n"action": "determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728906501, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=11, prompt_tokens=303, total_tokens=314, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:48:26,447 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.ContractDetails'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Determine the contract details for a airbnb contract between VASILESCU ELENA and ISPILANTE SENTIMENT BRUSLI.'}], 'tools': [{'type': 'function', 'function': {'name': 'ContractDetails', 'description': 'Correctly extracted `ContractDetails` with all the required parameters with correct types', 'parameters': {'properties': {'contract_type': {'description': 'Type of contract (e.g., airbnb, buy-sell, it-consulting)', 'title': 'Contract Type', 'type': 'string'}, 'additional_info': {'additionalProperties': {'type': 'string'}, 'description': 'Additional information specific to the contract type', 'title': 'Additional Info', 'type': 'object'}}, 'required': ['additional_info', 'contract_type'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'ContractDetails'}}}
2024-10-14 14:48:26,447 - DEBUG - max_retries: 1
2024-10-14 14:48:26,449 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Determine the contract details for a airbnb contract between VASILESCU ELENA and ISPILANTE SENTIMENT BRUSLI.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'ContractDetails'}}, 'tools': [{'type': 'function', 'function': {'name': 'ContractDetails', 'description': 'Correctly extracted `ContractDetails` with all the required parameters with correct types', 'parameters': {'properties': {'contract_type': {'description': 'Type of contract (e.g., airbnb, buy-sell, it-consulting)', 'title': 'Contract Type', 'type': 'string'}, 'additional_info': {'additionalProperties': {'type': 'string'}, 'description': 'Additional information specific to the contract type', 'title': 'Additional Info', 'type': 'object'}}, 'required': ['additional_info', 'contract_type'], 'type': 'object'}}}]}}
2024-10-14 14:48:26,450 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:48:26,450 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:48:26,451 - DEBUG - send_request_headers.complete
2024-10-14 14:48:26,451 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:48:26,451 - DEBUG - send_request_body.complete
2024-10-14 14:48:26,451 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:48:27,417 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:48:27 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'800'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9988'), (b'x-ratelimit-remaining-tokens', b'9865'), (b'x-ratelimit-reset-requests', b'1m40.079s'), (b'x-ratelimit-reset-tokens', b'810ms'), (b'x-request-id', b'req_43dd8bd67726ee81cac4b567c6cce5d3'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2757231c1ec9de-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:48:27,417 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:48:27,417 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:48:27,418 - DEBUG - receive_response_body.complete
2024-10-14 14:48:27,418 - DEBUG - response_closed.started
2024-10-14 14:48:27,418 - DEBUG - response_closed.complete
2024-10-14 14:48:27,418 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:48:27 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '800', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9988', 'x-ratelimit-remaining-tokens': '9865', 'x-ratelimit-reset-requests': '1m40.079s', 'x-ratelimit-reset-tokens': '810ms', 'x-request-id': 'req_43dd8bd67726ee81cac4b567c6cce5d3', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2757231c1ec9de-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:48:27,418 - DEBUG - request_id: req_43dd8bd67726ee81cac4b567c6cce5d3
2024-10-14 14:48:27,419 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDqkT9KqQUiN2mITNTfV5HlLZLkF', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_8zFm4OyzuHRtRLocURoNmy6G', function=Function(arguments='{\n"contract_type": "airbnb"\n}', name='ContractDetails'), type='function')]))], created=1728906506, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=10, prompt_tokens=184, total_tokens=194, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:48:27,420 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Current state: {'verified_pii_data': [{'name': 'ISPILANTE SENTIMENT BRUSLI', 'address': 'Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR'}, {'name': 'VASILESCU ELENA', 'address': 'Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'parties': {'buyer': 'VASILESCU ELENA', 'seller': 'ISPILANTE SENTIMENT BRUSLI'}, 'contract_details': {'contract_type': 'airbnb', 'additional_info': {}}, 'contract': None, 'current_action': None}\nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish"}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-14 14:48:27,420 - DEBUG - max_retries: 1
2024-10-14 14:48:27,422 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Current state: {'verified_pii_data': [{'name': 'ISPILANTE SENTIMENT BRUSLI', 'address': 'Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR'}, {'name': 'VASILESCU ELENA', 'address': 'Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'parties': {'buyer': 'VASILESCU ELENA', 'seller': 'ISPILANTE SENTIMENT BRUSLI'}, 'contract_details': {'contract_type': 'airbnb', 'additional_info': {}}, 'contract': None, 'current_action': None}\nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-14 14:48:27,423 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:48:27,423 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:48:27,423 - DEBUG - send_request_headers.complete
2024-10-14 14:48:27,423 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:48:27,423 - DEBUG - send_request_body.complete
2024-10-14 14:48:27,423 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:48:28,454 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:48:28 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'873'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9987'), (b'x-ratelimit-remaining-tokens', b'9719'), (b'x-ratelimit-reset-requests', b'1m47.749s'), (b'x-ratelimit-reset-tokens', b'1.681s'), (b'x-request-id', b'req_7932905619dd4d0220ac968ddd7434c3'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2757292e65c9de-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:48:28,454 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:48:28,454 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:48:28,455 - DEBUG - receive_response_body.complete
2024-10-14 14:48:28,455 - DEBUG - response_closed.started
2024-10-14 14:48:28,455 - DEBUG - response_closed.complete
2024-10-14 14:48:28,455 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:48:28 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '873', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9987', 'x-ratelimit-remaining-tokens': '9719', 'x-ratelimit-reset-requests': '1m47.749s', 'x-ratelimit-reset-tokens': '1.681s', 'x-request-id': 'req_7932905619dd4d0220ac968ddd7434c3', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2757292e65c9de-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:48:28,455 - DEBUG - request_id: req_7932905619dd4d0220ac968ddd7434c3
2024-10-14 14:48:28,456 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDqlGuxtLO4x8WQqxXsNmbg8wGzX', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_8vezk4WCDBc7SrSOv4ro2cFV', function=Function(arguments='{\n"action": "determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728906507, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=11, prompt_tokens=315, total_tokens=326, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:48:32,858 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.ContractDetails'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Determine the contract details for a it-consulting contract between VASILESCU ELENA and ISPILANTE SENTIMENT BRUSLI.'}], 'tools': [{'type': 'function', 'function': {'name': 'ContractDetails', 'description': 'Correctly extracted `ContractDetails` with all the required parameters with correct types', 'parameters': {'properties': {'contract_type': {'description': 'Type of contract (e.g., airbnb, buy-sell, it-consulting)', 'title': 'Contract Type', 'type': 'string'}, 'additional_info': {'additionalProperties': {'type': 'string'}, 'description': 'Additional information specific to the contract type', 'title': 'Additional Info', 'type': 'object'}}, 'required': ['additional_info', 'contract_type'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'ContractDetails'}}}
2024-10-14 14:48:32,858 - DEBUG - max_retries: 1
2024-10-14 14:48:32,861 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Determine the contract details for a it-consulting contract between VASILESCU ELENA and ISPILANTE SENTIMENT BRUSLI.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'ContractDetails'}}, 'tools': [{'type': 'function', 'function': {'name': 'ContractDetails', 'description': 'Correctly extracted `ContractDetails` with all the required parameters with correct types', 'parameters': {'properties': {'contract_type': {'description': 'Type of contract (e.g., airbnb, buy-sell, it-consulting)', 'title': 'Contract Type', 'type': 'string'}, 'additional_info': {'additionalProperties': {'type': 'string'}, 'description': 'Additional information specific to the contract type', 'title': 'Additional Info', 'type': 'object'}}, 'required': ['additional_info', 'contract_type'], 'type': 'object'}}}]}}
2024-10-14 14:48:32,861 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:48:32,861 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:48:32,862 - DEBUG - send_request_headers.complete
2024-10-14 14:48:32,862 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:48:32,862 - DEBUG - send_request_body.complete
2024-10-14 14:48:32,862 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:48:34,018 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:48:34 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'998'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9987'), (b'x-ratelimit-remaining-tokens', b'9864'), (b'x-ratelimit-reset-requests', b'1m50.946s'), (b'x-ratelimit-reset-tokens', b'816ms'), (b'x-request-id', b'req_c38918228e5facd6758082a1d49bd8d1'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d27574b2d6bc9de-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:48:34,018 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:48:34,018 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:48:34,018 - DEBUG - receive_response_body.complete
2024-10-14 14:48:34,018 - DEBUG - response_closed.started
2024-10-14 14:48:34,018 - DEBUG - response_closed.complete
2024-10-14 14:48:34,018 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:48:34 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '998', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9987', 'x-ratelimit-remaining-tokens': '9864', 'x-ratelimit-reset-requests': '1m50.946s', 'x-ratelimit-reset-tokens': '816ms', 'x-request-id': 'req_c38918228e5facd6758082a1d49bd8d1', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d27574b2d6bc9de-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:48:34,018 - DEBUG - request_id: req_c38918228e5facd6758082a1d49bd8d1
2024-10-14 14:48:34,019 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDqrjpsX5nk1AOnP0Eo5GRDt3d6o', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_B9A3Mv2BcN2kjmqRpxyuthmt', function=Function(arguments='{\n  "contract_type": "it-consulting"\n}', name='ContractDetails'), type='function')]))], created=1728906513, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=13, prompt_tokens=186, total_tokens=199, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:48:34,020 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Current state: {'verified_pii_data': [{'name': 'ISPILANTE SENTIMENT BRUSLI', 'address': 'Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR'}, {'name': 'VASILESCU ELENA', 'address': 'Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'parties': {'buyer': 'VASILESCU ELENA', 'seller': 'ISPILANTE SENTIMENT BRUSLI'}, 'contract_details': {'contract_type': 'it-consulting', 'additional_info': {}}, 'contract': None, 'current_action': None}\nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish"}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-14 14:48:34,020 - DEBUG - max_retries: 1
2024-10-14 14:48:34,021 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Current state: {'verified_pii_data': [{'name': 'ISPILANTE SENTIMENT BRUSLI', 'address': 'Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR'}, {'name': 'VASILESCU ELENA', 'address': 'Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'parties': {'buyer': 'VASILESCU ELENA', 'seller': 'ISPILANTE SENTIMENT BRUSLI'}, 'contract_details': {'contract_type': 'it-consulting', 'additional_info': {}}, 'contract': None, 'current_action': None}\nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-14 14:48:34,025 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:48:34,025 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:48:34,026 - DEBUG - send_request_headers.complete
2024-10-14 14:48:34,026 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:48:34,026 - DEBUG - send_request_body.complete
2024-10-14 14:48:34,026 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:48:34,872 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:48:35 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'694'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9986'), (b'x-ratelimit-remaining-tokens', b'9711'), (b'x-ratelimit-reset-requests', b'1m58.42s'), (b'x-ratelimit-reset-tokens', b'1.728s'), (b'x-request-id', b'req_df6012b9aa2d9a104c215ac8314c67af'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2757527b09c9de-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:48:34,872 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:48:34,872 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:48:34,872 - DEBUG - receive_response_body.complete
2024-10-14 14:48:34,872 - DEBUG - response_closed.started
2024-10-14 14:48:34,872 - DEBUG - response_closed.complete
2024-10-14 14:48:34,872 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:48:35 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '694', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9986', 'x-ratelimit-remaining-tokens': '9711', 'x-ratelimit-reset-requests': '1m58.42s', 'x-ratelimit-reset-tokens': '1.728s', 'x-request-id': 'req_df6012b9aa2d9a104c215ac8314c67af', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2757527b09c9de-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:48:34,872 - DEBUG - request_id: req_df6012b9aa2d9a104c215ac8314c67af
2024-10-14 14:48:34,873 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDqsZQ09zLyF49mTTlN9sGp3IIp7', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_DdaZ4f1wnYfzABF6vkeZIx5w', function=Function(arguments='{\n"action": "construct_contract"\n}', name='AgentAction'), type='function')]))], created=1728906514, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=9, prompt_tokens=317, total_tokens=326, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:48:34,874 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Current state: {'verified_pii_data': [{'name': 'ISPILANTE SENTIMENT BRUSLI', 'address': 'Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR'}, {'name': 'VASILESCU ELENA', 'address': 'Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'parties': {'buyer': 'VASILESCU ELENA', 'seller': 'ISPILANTE SENTIMENT BRUSLI'}, 'contract_details': {'contract_type': 'it-consulting', 'additional_info': {}}, 'contract': None, 'current_action': None}\nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish"}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-14 14:48:34,874 - DEBUG - max_retries: 1
2024-10-14 14:48:34,876 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Current state: {'verified_pii_data': [{'name': 'ISPILANTE SENTIMENT BRUSLI', 'address': 'Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR'}, {'name': 'VASILESCU ELENA', 'address': 'Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'parties': {'buyer': 'VASILESCU ELENA', 'seller': 'ISPILANTE SENTIMENT BRUSLI'}, 'contract_details': {'contract_type': 'it-consulting', 'additional_info': {}}, 'contract': None, 'current_action': None}\nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-14 14:48:34,876 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:48:34,876 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:48:34,877 - DEBUG - send_request_headers.complete
2024-10-14 14:48:34,877 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:48:34,877 - DEBUG - send_request_body.complete
2024-10-14 14:48:34,877 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:48:35,898 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:48:36 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'861'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9985'), (b'x-ratelimit-remaining-tokens', b'9529'), (b'x-ratelimit-reset-requests', b'2m6.2s'), (b'x-ratelimit-reset-tokens', b'2.824s'), (b'x-request-id', b'req_550ba1d5f784bba06543537cc66727f9'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d275757cba7c9de-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:48:35,898 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:48:35,898 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:48:35,899 - DEBUG - receive_response_body.complete
2024-10-14 14:48:35,899 - DEBUG - response_closed.started
2024-10-14 14:48:35,899 - DEBUG - response_closed.complete
2024-10-14 14:48:35,899 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:48:36 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '861', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9985', 'x-ratelimit-remaining-tokens': '9529', 'x-ratelimit-reset-requests': '2m6.2s', 'x-ratelimit-reset-tokens': '2.824s', 'x-request-id': 'req_550ba1d5f784bba06543537cc66727f9', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d275757cba7c9de-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:48:35,899 - DEBUG - request_id: req_550ba1d5f784bba06543537cc66727f9
2024-10-14 14:48:35,900 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDqtlSeMcZqHaZyMeQdUD7Hpa2cI', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_rPthjjCbFROTgh02ENhfaCQ0', function=Function(arguments='{\n"action": "determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728906515, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=11, prompt_tokens=317, total_tokens=328, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:49:28,223 - DEBUG - close.started
2024-10-14 14:49:28,224 - DEBUG - close.complete
2024-10-14 14:49:28,224 - ERROR - Task exception was never retrieved
future: <Task finished name='Task-1' coro=<agent_workflow() done, defined at D:\deve\contract_automation\src\main.py:25> exception=KeyboardInterrupt()>
Traceback (most recent call last):
  File "D:\deve\contract_automation\src\main.py", line 79, in <module>
    asyncio.run(agent_workflow())
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 30, in run
    return loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 92, in run_until_complete
    self._run_once()
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 133, in _run_once
    handle._run()
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 386, in __wakeup
    self.__step()
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 293, in __step
    self.__step_run_and_handle_result(exc)
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 304, in __step_run_and_handle_result
    result = coro.send(None)
             ^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\src\main.py", line 45, in agent_workflow
    contract_type = input("Enter contract type (airbnb, buy-sell, it-consulting): ").lower().replace(" ", "-")
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
2024-10-14 14:49:44,145 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-14 14:49:45,461 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-14 14:49:45,462 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-14 14:49:45,783 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-14 14:49:45,783 - DEBUG - Using proactor: IocpProactor
2024-10-14 14:49:45,802 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 14:49:45,802 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 14:49:45,802 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 14:49:45,802 - DEBUG - Compression method 0
2024-10-14 14:49:45,802 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 14:49:45,802 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 14:49:45,802 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-14 14:49:45,802 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-14 14:49:45,802 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-14 14:49:45,802 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-14 14:49:45,803 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 14:49:45,803 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 14:49:45,803 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 14:49:45,803 - DEBUG - Compression method 0
2024-10-14 14:49:45,803 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 14:49:45,803 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 14:49:45,803 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-14 14:49:45,803 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-14 14:49:45,803 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-14 14:49:45,803 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-14 14:49:45,813 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 14:49:45,813 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 14:49:45,813 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-14 14:49:45,813 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-14 14:49:45,813 - DEBUG - Error closing: Operation on closed image
2024-10-14 14:49:47,783 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 14:49:47,783 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 14:49:47,783 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 14:49:47,783 - DEBUG - Compression method 0
2024-10-14 14:49:47,783 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 14:49:47,783 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 14:49:47,783 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-14 14:49:47,783 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-14 14:49:47,783 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-14 14:49:47,783 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-14 14:49:47,783 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 14:49:47,783 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 14:49:47,783 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 14:49:47,783 - DEBUG - Compression method 0
2024-10-14 14:49:47,784 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 14:49:47,784 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 14:49:47,784 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-14 14:49:47,784 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-14 14:49:47,784 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-14 14:49:47,784 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-14 14:49:47,801 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 14:49:47,801 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 14:49:47,801 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-14 14:49:47,801 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-14 14:49:47,802 - DEBUG - Error closing: Operation on closed image
2024-10-14 14:49:50,372 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Current state: {'verified_pii_data': [], 'parties': None, 'contract_details': None, 'contract': None, 'current_action': None}\nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish"}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-14 14:49:50,373 - DEBUG - max_retries: 1
2024-10-14 14:49:50,375 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Current state: {'verified_pii_data': [], 'parties': None, 'contract_details': None, 'contract': None, 'current_action': None}\nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-14 14:49:50,416 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:49:50,416 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-14 14:49:50,450 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x0000025BE9FBEAB0>
2024-10-14 14:49:50,450 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x0000025BE9E15B50> server_hostname='api.openai.com' timeout=5.0
2024-10-14 14:49:50,458 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x0000025BE9FBE810>
2024-10-14 14:49:50,459 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:49:50,459 - DEBUG - send_request_headers.complete
2024-10-14 14:49:50,459 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:49:50,459 - DEBUG - send_request_body.complete
2024-10-14 14:49:50,459 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:49:51,220 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:49:51 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'603'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9993'), (b'x-ratelimit-remaining-tokens', b'9829'), (b'x-ratelimit-reset-requests', b'59.263s'), (b'x-ratelimit-reset-tokens', b'1.026s'), (b'x-request-id', b'req_dd2498b1ebe5c0b5bbdc7f1223ffd1f0'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=8if3dGU69g3S0dKDU5NiLaYMnDO4TCrZfJzWn9tGk_I-1728906591-1.0.1.1-AeJR8mjr55ubW5jiioJi2Pjgr.PHihG1yeuHsejqDCSq0r9yCLJ9zRXYbpb1cFUbdDHb.cvvhoxgzn0hbZID8Q; path=/; expires=Mon, 14-Oct-24 12:19:51 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=4oCGKRNQvi36_HSV3p8nrC8g_tdpLKoWJFOhaC5oEvg-1728906591503-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2759302f0ee0c5-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:49:51,221 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:49:51,221 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:49:51,222 - DEBUG - receive_response_body.complete
2024-10-14 14:49:51,222 - DEBUG - response_closed.started
2024-10-14 14:49:51,222 - DEBUG - response_closed.complete
2024-10-14 14:49:51,222 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Mon, 14 Oct 2024 11:49:51 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-kzzh9hik9ryjiou4ftvhondh'), ('openai-processing-ms', '603'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '10000'), ('x-ratelimit-remaining-requests', '9993'), ('x-ratelimit-remaining-tokens', '9829'), ('x-ratelimit-reset-requests', '59.263s'), ('x-ratelimit-reset-tokens', '1.026s'), ('x-request-id', 'req_dd2498b1ebe5c0b5bbdc7f1223ffd1f0'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=8if3dGU69g3S0dKDU5NiLaYMnDO4TCrZfJzWn9tGk_I-1728906591-1.0.1.1-AeJR8mjr55ubW5jiioJi2Pjgr.PHihG1yeuHsejqDCSq0r9yCLJ9zRXYbpb1cFUbdDHb.cvvhoxgzn0hbZID8Q; path=/; expires=Mon, 14-Oct-24 12:19:51 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=4oCGKRNQvi36_HSV3p8nrC8g_tdpLKoWJFOhaC5oEvg-1728906591503-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d2759302f0ee0c5-OTP'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-14 14:49:51,222 - DEBUG - request_id: req_dd2498b1ebe5c0b5bbdc7f1223ffd1f0
2024-10-14 14:49:51,225 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDs6IalIKJVTEMKmE3HXqIMPn5oP', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_D00USs3f1FHx5MkTQDcQTJ27', function=Function(arguments='{\n"action": "extract_pii"\n}', name='AgentAction'), type='function')]))], created=1728906590, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=10, prompt_tokens=202, total_tokens=212, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:49:51,226 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.PIIData'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}}
2024-10-14 14:49:51,226 - DEBUG - max_retries: 1
2024-10-14 14:49:51,227 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}, 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}]}}
2024-10-14 14:49:51,228 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:49:51,228 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:49:51,228 - DEBUG - send_request_headers.complete
2024-10-14 14:49:51,228 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:49:51,228 - DEBUG - send_request_body.complete
2024-10-14 14:49:51,228 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:49:53,218 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:49:53 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1832'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9992'), (b'x-ratelimit-remaining-tokens', b'9652'), (b'x-ratelimit-reset-requests', b'1m7.13s'), (b'x-ratelimit-reset-tokens', b'2.082s'), (b'x-request-id', b'req_56606074589d37913e2e67dab593cd8c'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d275934ff39e0c5-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:49:53,218 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:49:53,218 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:49:53,219 - DEBUG - receive_response_body.complete
2024-10-14 14:49:53,219 - DEBUG - response_closed.started
2024-10-14 14:49:53,219 - DEBUG - response_closed.complete
2024-10-14 14:49:53,219 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:49:53 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1832', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9992', 'x-ratelimit-remaining-tokens': '9652', 'x-ratelimit-reset-requests': '1m7.13s', 'x-ratelimit-reset-tokens': '2.082s', 'x-request-id': 'req_56606074589d37913e2e67dab593cd8c', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d275934ff39e0c5-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:49:53,219 - DEBUG - request_id: req_56606074589d37913e2e67dab593cd8c
2024-10-14 14:49:53,220 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDs7y5Sr1PB0f59DdzoiGhy4mjCF', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_Z0zM8l2JK6jR0xE9aJvNsXLv', function=Function(arguments='{\n"name": "ISPILANTE SENTIMENT BRUSLI",\n"address": "Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR"\n}', name='PIIData'), type='function')]))], created=1728906591, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=39, prompt_tokens=377, total_tokens=416, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:49:55,300 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.PIIData'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}}
2024-10-14 14:49:55,301 - DEBUG - max_retries: 1
2024-10-14 14:49:55,303 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}, 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}]}}
2024-10-14 14:49:55,303 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:49:55,304 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:49:55,304 - DEBUG - send_request_headers.complete
2024-10-14 14:49:55,304 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:49:55,304 - DEBUG - send_request_body.complete
2024-10-14 14:49:55,304 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:49:57,427 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:49:57 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1974'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9991'), (b'x-ratelimit-remaining-tokens', b'9742'), (b'x-ratelimit-reset-requests', b'1m11.703s'), (b'x-ratelimit-reset-tokens', b'1.548s'), (b'x-request-id', b'req_a2050b1c3005a89ded5095ed202e12d1'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d27594e7de7e0c5-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:49:57,428 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:49:57,428 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:49:57,428 - DEBUG - receive_response_body.complete
2024-10-14 14:49:57,428 - DEBUG - response_closed.started
2024-10-14 14:49:57,428 - DEBUG - response_closed.complete
2024-10-14 14:49:57,428 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:49:57 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1974', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9991', 'x-ratelimit-remaining-tokens': '9742', 'x-ratelimit-reset-requests': '1m11.703s', 'x-ratelimit-reset-tokens': '1.548s', 'x-request-id': 'req_a2050b1c3005a89ded5095ed202e12d1', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d27594e7de7e0c5-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:49:57,429 - DEBUG - request_id: req_a2050b1c3005a89ded5095ed202e12d1
2024-10-14 14:49:57,429 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDsBYxZeGLtsQJ0DjrOKPOwe1ZML', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_0qgvcZWKmZd89PZPAhqCYcvs', function=Function(arguments='{\n"name": "ELENA VASILESCU",\n"address": "Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B"\n}', name='PIIData'), type='function')]))], created=1728906595, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=42, prompt_tokens=380, total_tokens=422, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:49:58,396 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Current state: {'verified_pii_data': [{'name': 'ISPILANTE SENTIMENT BRUSLI', 'address': 'Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR'}, {'name': 'ELENA VASILESCU', 'address': 'Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'parties': None, 'contract_details': None, 'contract': None, 'current_action': None}\nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish"}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-14 14:49:58,396 - DEBUG - max_retries: 1
2024-10-14 14:49:58,398 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Current state: {'verified_pii_data': [{'name': 'ISPILANTE SENTIMENT BRUSLI', 'address': 'Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR'}, {'name': 'ELENA VASILESCU', 'address': 'Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'parties': None, 'contract_details': None, 'contract': None, 'current_action': None}\nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-14 14:49:58,399 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:49:58,399 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:49:58,399 - DEBUG - send_request_headers.complete
2024-10-14 14:49:58,399 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:49:58,399 - DEBUG - send_request_body.complete
2024-10-14 14:49:58,400 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:49:59,241 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:49:59 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'690'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9991'), (b'x-ratelimit-remaining-tokens', b'9780'), (b'x-ratelimit-reset-requests', b'1m17.243s'), (b'x-ratelimit-reset-tokens', b'1.32s'), (b'x-request-id', b'req_41aef2c6e15a3c0b9d8be1bc1b1d9e77'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d275961ce73e0c5-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:49:59,242 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:49:59,242 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:49:59,242 - DEBUG - receive_response_body.complete
2024-10-14 14:49:59,242 - DEBUG - response_closed.started
2024-10-14 14:49:59,242 - DEBUG - response_closed.complete
2024-10-14 14:49:59,242 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:49:59 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '690', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9991', 'x-ratelimit-remaining-tokens': '9780', 'x-ratelimit-reset-requests': '1m17.243s', 'x-ratelimit-reset-tokens': '1.32s', 'x-request-id': 'req_41aef2c6e15a3c0b9d8be1bc1b1d9e77', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d275961ce73e0c5-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:49:59,242 - DEBUG - request_id: req_41aef2c6e15a3c0b9d8be1bc1b1d9e77
2024-10-14 14:49:59,243 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDsEeAo0ZwmD8oOllkw5S1sQoOHe', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_GOd2VX5wsxkAn7gbHR6jjWxL', function=Function(arguments='{\n"action": "identify_parties"\n}', name='AgentAction'), type='function')]))], created=1728906598, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=10, prompt_tokens=281, total_tokens=291, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:49:59,244 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.ContractParties'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Identify the buyer and seller from the given information:\n\nName: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'properties': {'buyer': {'description': 'Name of the buyer', 'title': 'Buyer', 'type': 'string'}, 'seller': {'description': 'Name of the seller', 'title': 'Seller', 'type': 'string'}}, 'required': ['buyer', 'seller'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}}
2024-10-14 14:49:59,244 - DEBUG - max_retries: 1
2024-10-14 14:49:59,246 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Identify the buyer and seller from the given information:\n\nName: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}, 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'properties': {'buyer': {'description': 'Name of the buyer', 'title': 'Buyer', 'type': 'string'}, 'seller': {'description': 'Name of the seller', 'title': 'Seller', 'type': 'string'}}, 'required': ['buyer', 'seller'], 'type': 'object'}}}]}}
2024-10-14 14:49:59,247 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:49:59,247 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:49:59,247 - DEBUG - send_request_headers.complete
2024-10-14 14:49:59,247 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:49:59,247 - DEBUG - send_request_body.complete
2024-10-14 14:49:59,247 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:50:01,092 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:50:01 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1699'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9990'), (b'x-ratelimit-remaining-tokens', b'9683'), (b'x-ratelimit-reset-requests', b'1m25.041s'), (b'x-ratelimit-reset-tokens', b'1.899s'), (b'x-request-id', b'req_f41751e746b95c67a44e72f29435aa63'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2759671f82e0c5-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:50:01,092 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:50:01,092 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:50:01,092 - DEBUG - receive_response_body.complete
2024-10-14 14:50:01,092 - DEBUG - response_closed.started
2024-10-14 14:50:01,092 - DEBUG - response_closed.complete
2024-10-14 14:50:01,092 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:50:01 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1699', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9990', 'x-ratelimit-remaining-tokens': '9683', 'x-ratelimit-reset-requests': '1m25.041s', 'x-ratelimit-reset-tokens': '1.899s', 'x-request-id': 'req_f41751e746b95c67a44e72f29435aa63', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2759671f82e0c5-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:50:01,092 - DEBUG - request_id: req_f41751e746b95c67a44e72f29435aa63
2024-10-14 14:50:01,093 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDsFI7el7kLLCCr6Uccj7Ts2ydQd', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_BZ0zJ3UN2iBNebuR8XpX3nfy', function=Function(arguments='{\n  "buyer": "ISPILANTE SENTIMENT BRUSLI",\n  "seller": "ELENA VASILESCU"\n}', name='ContractParties'), type='function')]))], created=1728906599, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=30, prompt_tokens=232, total_tokens=262, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:50:01,094 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Current state: {'verified_pii_data': [{'name': 'ISPILANTE SENTIMENT BRUSLI', 'address': 'Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR'}, {'name': 'ELENA VASILESCU', 'address': 'Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'parties': {'buyer': 'ISPILANTE SENTIMENT BRUSLI', 'seller': 'ELENA VASILESCU'}, 'contract_details': None, 'contract': None, 'current_action': None}\nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish"}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-14 14:50:01,094 - DEBUG - max_retries: 1
2024-10-14 14:50:01,095 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Current state: {'verified_pii_data': [{'name': 'ISPILANTE SENTIMENT BRUSLI', 'address': 'Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR'}, {'name': 'ELENA VASILESCU', 'address': 'Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'parties': {'buyer': 'ISPILANTE SENTIMENT BRUSLI', 'seller': 'ELENA VASILESCU'}, 'contract_details': None, 'contract': None, 'current_action': None}\nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-14 14:50:01,096 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:50:01,096 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:50:01,096 - DEBUG - send_request_headers.complete
2024-10-14 14:50:01,096 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:50:01,096 - DEBUG - send_request_body.complete
2024-10-14 14:50:01,096 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:50:04,494 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:50:04 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'3249'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9989'), (b'x-ratelimit-remaining-tokens', b'9659'), (b'x-ratelimit-reset-requests', b'1m31.831s'), (b'x-ratelimit-reset-tokens', b'2.041s'), (b'x-request-id', b'req_1a090f02c2704d03777dc6e013f27070'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d275972a9a4e0c5-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:50:04,495 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:50:04,495 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:50:04,496 - DEBUG - receive_response_body.complete
2024-10-14 14:50:04,496 - DEBUG - response_closed.started
2024-10-14 14:50:04,496 - DEBUG - response_closed.complete
2024-10-14 14:50:04,496 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:50:04 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '3249', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9989', 'x-ratelimit-remaining-tokens': '9659', 'x-ratelimit-reset-requests': '1m31.831s', 'x-ratelimit-reset-tokens': '2.041s', 'x-request-id': 'req_1a090f02c2704d03777dc6e013f27070', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d275972a9a4e0c5-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:50:04,497 - DEBUG - request_id: req_1a090f02c2704d03777dc6e013f27070
2024-10-14 14:50:04,498 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDsKvZqgGJpjf83DVbwTU2w9tb9i', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_qYQ015NVxj3aGSIZQGGN9k6l', function=Function(arguments='{\n"action": "determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728906604, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=11, prompt_tokens=305, total_tokens=316, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:50:07,925 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.ContractDetails'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Determine the contract details for a airbnb contract between ISPILANTE SENTIMENT BRUSLI and ELENA VASILESCU.'}], 'tools': [{'type': 'function', 'function': {'name': 'ContractDetails', 'description': 'Correctly extracted `ContractDetails` with all the required parameters with correct types', 'parameters': {'properties': {'contract_type': {'description': 'Type of contract (e.g., airbnb, buy-sell, it-consulting)', 'title': 'Contract Type', 'type': 'string'}, 'additional_info': {'additionalProperties': {'type': 'string'}, 'description': 'Additional information specific to the contract type', 'title': 'Additional Info', 'type': 'object'}}, 'required': ['additional_info', 'contract_type'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'ContractDetails'}}}
2024-10-14 14:50:07,926 - DEBUG - max_retries: 1
2024-10-14 14:50:07,927 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Determine the contract details for a airbnb contract between ISPILANTE SENTIMENT BRUSLI and ELENA VASILESCU.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'ContractDetails'}}, 'tools': [{'type': 'function', 'function': {'name': 'ContractDetails', 'description': 'Correctly extracted `ContractDetails` with all the required parameters with correct types', 'parameters': {'properties': {'contract_type': {'description': 'Type of contract (e.g., airbnb, buy-sell, it-consulting)', 'title': 'Contract Type', 'type': 'string'}, 'additional_info': {'additionalProperties': {'type': 'string'}, 'description': 'Additional information specific to the contract type', 'title': 'Additional Info', 'type': 'object'}}, 'required': ['additional_info', 'contract_type'], 'type': 'object'}}}]}}
2024-10-14 14:50:07,927 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:50:07,927 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:50:07,928 - DEBUG - send_request_headers.complete
2024-10-14 14:50:07,928 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:50:07,928 - DEBUG - send_request_body.complete
2024-10-14 14:50:07,928 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:50:08,809 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:50:09 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'726'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9989'), (b'x-ratelimit-remaining-tokens', b'9865'), (b'x-ratelimit-reset-requests', b'1m33.652s'), (b'x-ratelimit-reset-tokens', b'810ms'), (b'x-request-id', b'req_7de7ee602506b525da25398532e716d9'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d27599d586ae0c5-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:50:08,810 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:50:08,810 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:50:08,810 - DEBUG - receive_response_body.complete
2024-10-14 14:50:08,810 - DEBUG - response_closed.started
2024-10-14 14:50:08,810 - DEBUG - response_closed.complete
2024-10-14 14:50:08,810 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:50:09 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '726', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9989', 'x-ratelimit-remaining-tokens': '9865', 'x-ratelimit-reset-requests': '1m33.652s', 'x-ratelimit-reset-tokens': '810ms', 'x-request-id': 'req_7de7ee602506b525da25398532e716d9', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d27599d586ae0c5-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:50:08,810 - DEBUG - request_id: req_7de7ee602506b525da25398532e716d9
2024-10-14 14:50:08,810 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDsOupASRJF9IxdYhuhJBSzcPARG', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_2vTuuPn4KyC5k5brFAFVPcXR', function=Function(arguments='{\n  "contract_type": "airbnb"\n}', name='ContractDetails'), type='function')]))], created=1728906608, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=11, prompt_tokens=184, total_tokens=195, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:50:08,811 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Current state: {'verified_pii_data': [{'name': 'ISPILANTE SENTIMENT BRUSLI', 'address': 'Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR'}, {'name': 'ELENA VASILESCU', 'address': 'Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'parties': {'buyer': 'ISPILANTE SENTIMENT BRUSLI', 'seller': 'ELENA VASILESCU'}, 'contract_details': {'contract_type': 'airbnb', 'additional_info': {}}, 'contract': None, 'current_action': None}\nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish"}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-14 14:50:08,811 - DEBUG - max_retries: 1
2024-10-14 14:50:08,812 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Current state: {'verified_pii_data': [{'name': 'ISPILANTE SENTIMENT BRUSLI', 'address': 'Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR'}, {'name': 'ELENA VASILESCU', 'address': 'Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'parties': {'buyer': 'ISPILANTE SENTIMENT BRUSLI', 'seller': 'ELENA VASILESCU'}, 'contract_details': {'contract_type': 'airbnb', 'additional_info': {}}, 'contract': None, 'current_action': None}\nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-14 14:50:08,813 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:50:08,813 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:50:08,813 - DEBUG - send_request_headers.complete
2024-10-14 14:50:08,813 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:50:08,813 - DEBUG - send_request_body.complete
2024-10-14 14:50:08,813 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:50:09,724 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:50:10 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'751'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9988'), (b'x-ratelimit-remaining-tokens', b'9708'), (b'x-ratelimit-reset-requests', b'1m41.383s'), (b'x-ratelimit-reset-tokens', b'1.748s'), (b'x-request-id', b'req_2e0450b7f34ce3bfcd5fb622d957b0f1'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2759a2e835e0c5-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:50:09,724 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:50:09,724 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:50:09,725 - DEBUG - receive_response_body.complete
2024-10-14 14:50:09,725 - DEBUG - response_closed.started
2024-10-14 14:50:09,725 - DEBUG - response_closed.complete
2024-10-14 14:50:09,725 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:50:10 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '751', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9988', 'x-ratelimit-remaining-tokens': '9708', 'x-ratelimit-reset-requests': '1m41.383s', 'x-ratelimit-reset-tokens': '1.748s', 'x-request-id': 'req_2e0450b7f34ce3bfcd5fb622d957b0f1', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2759a2e835e0c5-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:50:09,725 - DEBUG - request_id: req_2e0450b7f34ce3bfcd5fb622d957b0f1
2024-10-14 14:50:09,725 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDsPd5Q2bEwIXWJLWyp5DeHPLxfb', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_0f7uM1ibk9jebXpazaB2WqhS', function=Function(arguments='{\n"action": "determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728906609, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=11, prompt_tokens=317, total_tokens=328, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:50:20,266 - DEBUG - close.started
2024-10-14 14:50:20,266 - DEBUG - close.complete
2024-10-14 14:50:20,267 - ERROR - Task exception was never retrieved
future: <Task finished name='Task-1' coro=<agent_workflow() done, defined at D:\deve\contract_automation\src\main.py:25> exception=KeyboardInterrupt()>
Traceback (most recent call last):
  File "D:\deve\contract_automation\src\main.py", line 79, in <module>
    asyncio.run(agent_workflow())
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 30, in run
    return loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 92, in run_until_complete
    self._run_once()
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 133, in _run_once
    handle._run()
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 386, in __wakeup
    self.__step()
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 293, in __step
    self.__step_run_and_handle_result(exc)
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 304, in __step_run_and_handle_result
    result = coro.send(None)
             ^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\src\main.py", line 45, in agent_workflow
    contract_type = input("Enter contract type (airbnb, buy-sell, it-consulting): ").lower().replace(" ", "-")
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
2024-10-14 14:51:15,393 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-14 14:51:16,649 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-14 14:51:16,650 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-14 14:51:16,967 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-14 14:51:16,968 - DEBUG - Using proactor: IocpProactor
2024-10-14 14:51:16,986 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 14:51:16,986 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 14:51:16,986 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 14:51:16,986 - DEBUG - Compression method 0
2024-10-14 14:51:16,987 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 14:51:16,987 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 14:51:16,987 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-14 14:51:16,987 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-14 14:51:16,987 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-14 14:51:16,987 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-14 14:51:16,987 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 14:51:16,987 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 14:51:16,987 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 14:51:16,987 - DEBUG - Compression method 0
2024-10-14 14:51:16,987 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 14:51:16,987 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 14:51:16,987 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-14 14:51:16,987 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-14 14:51:16,987 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-14 14:51:16,987 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-14 14:51:16,997 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 14:51:16,997 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 14:51:16,997 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-14 14:51:16,997 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-14 14:51:16,998 - DEBUG - Error closing: Operation on closed image
2024-10-14 14:51:18,969 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 14:51:18,969 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 14:51:18,969 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 14:51:18,969 - DEBUG - Compression method 0
2024-10-14 14:51:18,969 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 14:51:18,969 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 14:51:18,969 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-14 14:51:18,969 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-14 14:51:18,969 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-14 14:51:18,969 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-14 14:51:18,969 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 14:51:18,969 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 14:51:18,969 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 14:51:18,969 - DEBUG - Compression method 0
2024-10-14 14:51:18,969 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 14:51:18,969 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 14:51:18,969 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-14 14:51:18,969 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-14 14:51:18,970 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-14 14:51:18,970 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-14 14:51:18,987 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 14:51:18,987 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 14:51:18,987 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-14 14:51:18,987 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-14 14:51:18,988 - DEBUG - Error closing: Operation on closed image
2024-10-14 14:51:21,464 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 0 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-14 14:51:21,465 - DEBUG - max_retries: 1
2024-10-14 14:51:21,467 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 0 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-14 14:51:21,507 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:51:21,507 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-14 14:51:21,543 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x0000021E8B563230>
2024-10-14 14:51:21,543 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x0000021E8B3C1B50> server_hostname='api.openai.com' timeout=5.0
2024-10-14 14:51:21,550 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x0000021E8B563170>
2024-10-14 14:51:21,550 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:51:21,550 - DEBUG - send_request_headers.complete
2024-10-14 14:51:21,550 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:51:21,550 - DEBUG - send_request_body.complete
2024-10-14 14:51:21,550 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:51:22,687 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:51:22 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'978'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9995'), (b'x-ratelimit-remaining-tokens', b'9821'), (b'x-ratelimit-reset-requests', b'37.286s'), (b'x-ratelimit-reset-tokens', b'1.074s'), (b'x-request-id', b'req_5372c887f1b0332954c61f94ecdbe122'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=oxvvflC.oFiSwueB7RohbeduMDd0pWz7mxxhcR.kco4-1728906682-1.0.1.1-Rz4JoPU3MAu7Q0JxOOVc9q6.R32GI6hrHJNL84z1ymW.wMGoz5kWhvGezpkoR4GLW9mjIgZ2f_I0pzgm45VGUA; path=/; expires=Mon, 14-Oct-24 12:21:22 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=jGhp8L1_.q2XUil9GF9eo7IDvvWmGTSJ3XvzyZItjtI-1728906682974-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d275b698b1ec9e9-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:51:22,688 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:51:22,689 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:51:22,689 - DEBUG - receive_response_body.complete
2024-10-14 14:51:22,689 - DEBUG - response_closed.started
2024-10-14 14:51:22,689 - DEBUG - response_closed.complete
2024-10-14 14:51:22,689 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Mon, 14 Oct 2024 11:51:22 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-kzzh9hik9ryjiou4ftvhondh'), ('openai-processing-ms', '978'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '10000'), ('x-ratelimit-remaining-requests', '9995'), ('x-ratelimit-remaining-tokens', '9821'), ('x-ratelimit-reset-requests', '37.286s'), ('x-ratelimit-reset-tokens', '1.074s'), ('x-request-id', 'req_5372c887f1b0332954c61f94ecdbe122'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=oxvvflC.oFiSwueB7RohbeduMDd0pWz7mxxhcR.kco4-1728906682-1.0.1.1-Rz4JoPU3MAu7Q0JxOOVc9q6.R32GI6hrHJNL84z1ymW.wMGoz5kWhvGezpkoR4GLW9mjIgZ2f_I0pzgm45VGUA; path=/; expires=Mon, 14-Oct-24 12:21:22 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=jGhp8L1_.q2XUil9GF9eo7IDvvWmGTSJ3XvzyZItjtI-1728906682974-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d275b698b1ec9e9-OTP'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-14 14:51:22,690 - DEBUG - request_id: req_5372c887f1b0332954c61f94ecdbe122
2024-10-14 14:51:22,693 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDtaNBU07NyFgV0mVKhduCkSUjnR', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_MZkyIDQoMMOtMOlAFGHnC8zd', function=Function(arguments='\n{\n  "action": "extract_pii"\n}', name='AgentAction'), type='function')]))], created=1728906682, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=12, prompt_tokens=207, total_tokens=219, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:51:22,693 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.PIIData'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}}
2024-10-14 14:51:22,694 - DEBUG - max_retries: 1
2024-10-14 14:51:22,695 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}, 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}]}}
2024-10-14 14:51:22,695 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:51:22,695 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:51:22,696 - DEBUG - send_request_headers.complete
2024-10-14 14:51:22,696 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:51:22,696 - DEBUG - send_request_body.complete
2024-10-14 14:51:22,696 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:51:24,877 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:51:25 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2015'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9994'), (b'x-ratelimit-remaining-tokens', b'9706'), (b'x-ratelimit-reset-requests', b'44.787s'), (b'x-ratelimit-reset-tokens', b'1.758s'), (b'x-request-id', b'req_f30e2a7293bcb3251ea6e5d31a6e39de'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d275b70af88c9e9-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:51:24,877 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:51:24,877 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:51:24,878 - DEBUG - receive_response_body.complete
2024-10-14 14:51:24,878 - DEBUG - response_closed.started
2024-10-14 14:51:24,878 - DEBUG - response_closed.complete
2024-10-14 14:51:24,878 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:51:25 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '2015', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9994', 'x-ratelimit-remaining-tokens': '9706', 'x-ratelimit-reset-requests': '44.787s', 'x-ratelimit-reset-tokens': '1.758s', 'x-request-id': 'req_f30e2a7293bcb3251ea6e5d31a6e39de', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d275b70af88c9e9-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:51:24,878 - DEBUG - request_id: req_f30e2a7293bcb3251ea6e5d31a6e39de
2024-10-14 14:51:24,878 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDtbMigSQVauljqR164dqJn4OPWL', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_tEynhNbPBs7Oc9ybm04qWVYF', function=Function(arguments='{\n"name": "ISPILANTE SENTIMENT BRUSLI",\n"address": "Sos. Giurgiului nr.1 695 TR Videle Jud: Teleorman"\n}', name='PIIData'), type='function')]))], created=1728906683, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=38, prompt_tokens=377, total_tokens=415, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:51:26,949 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.PIIData'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}}
2024-10-14 14:51:26,949 - DEBUG - max_retries: 1
2024-10-14 14:51:26,951 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}, 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}]}}
2024-10-14 14:51:26,952 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:51:26,952 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:51:26,952 - DEBUG - send_request_headers.complete
2024-10-14 14:51:26,952 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:51:26,953 - DEBUG - send_request_body.complete
2024-10-14 14:51:26,953 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:51:29,566 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:51:29 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2443'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9994'), (b'x-ratelimit-remaining-tokens', b'9742'), (b'x-ratelimit-reset-requests', b'49.166s'), (b'x-ratelimit-reset-tokens', b'1.548s'), (b'x-request-id', b'req_d5c1761e2c322da0e67c0e0a97bb3588'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d275b8b49e1c9e9-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:51:29,567 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:51:29,567 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:51:29,567 - DEBUG - receive_response_body.complete
2024-10-14 14:51:29,568 - DEBUG - response_closed.started
2024-10-14 14:51:29,568 - DEBUG - response_closed.complete
2024-10-14 14:51:29,568 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:51:29 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '2443', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9994', 'x-ratelimit-remaining-tokens': '9742', 'x-ratelimit-reset-requests': '49.166s', 'x-ratelimit-reset-tokens': '1.548s', 'x-request-id': 'req_d5c1761e2c322da0e67c0e0a97bb3588', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d275b8b49e1c9e9-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:51:29,568 - DEBUG - request_id: req_d5c1761e2c322da0e67c0e0a97bb3588
2024-10-14 14:51:29,569 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDtfoBXkBll5t9QK7nxcmPp3gH1U', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_KmbYOMRd5vpDfXhW117xtcPa', function=Function(arguments='{\n"name": "ELENA VASILESCU",\n"address": "Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B"\n}', name='PIIData'), type='function')]))], created=1728906687, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=42, prompt_tokens=380, total_tokens=422, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:51:30,942 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-14 14:51:30,942 - DEBUG - max_retries: 1
2024-10-14 14:51:30,943 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-14 14:51:30,944 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:51:30,944 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:51:30,944 - DEBUG - send_request_headers.complete
2024-10-14 14:51:30,944 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:51:30,944 - DEBUG - send_request_body.complete
2024-10-14 14:51:30,944 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:51:32,116 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:51:32 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1022'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9993'), (b'x-ratelimit-remaining-tokens', b'9821'), (b'x-ratelimit-reset-requests', b'53.818s'), (b'x-ratelimit-reset-tokens', b'1.074s'), (b'x-request-id', b'req_6d1f6c7f81f1d91ac8230950461fefe9'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d275ba43d7cc9e9-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:51:32,116 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:51:32,116 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:51:32,116 - DEBUG - receive_response_body.complete
2024-10-14 14:51:32,117 - DEBUG - response_closed.started
2024-10-14 14:51:32,117 - DEBUG - response_closed.complete
2024-10-14 14:51:32,117 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:51:32 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1022', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9993', 'x-ratelimit-remaining-tokens': '9821', 'x-ratelimit-reset-requests': '53.818s', 'x-ratelimit-reset-tokens': '1.074s', 'x-request-id': 'req_6d1f6c7f81f1d91ac8230950461fefe9', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d275ba43d7cc9e9-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:51:32,117 - DEBUG - request_id: req_6d1f6c7f81f1d91ac8230950461fefe9
2024-10-14 14:51:32,117 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDtjKU9tXgrH0qMqYpBUXFdc2YuM', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_5MxzwgtYskQNc7ekeVzS0hVM', function=Function(arguments='\n{\n  "action": "identify_parties"\n}', name='AgentAction'), type='function')]))], created=1728906691, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=12, prompt_tokens=207, total_tokens=219, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:51:32,118 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.ContractParties'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Identify the buyer and seller from the given information:\n\nName: ISPILANTE SENTIMENT BRUSLI, Address: Sos. Giurgiului nr.1 695 TR Videle Jud: Teleorman\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'properties': {'buyer': {'description': 'Name of the buyer', 'title': 'Buyer', 'type': 'string'}, 'seller': {'description': 'Name of the seller', 'title': 'Seller', 'type': 'string'}}, 'required': ['buyer', 'seller'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}}
2024-10-14 14:51:32,118 - DEBUG - max_retries: 1
2024-10-14 14:51:32,119 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Identify the buyer and seller from the given information:\n\nName: ISPILANTE SENTIMENT BRUSLI, Address: Sos. Giurgiului nr.1 695 TR Videle Jud: Teleorman\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}, 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'properties': {'buyer': {'description': 'Name of the buyer', 'title': 'Buyer', 'type': 'string'}, 'seller': {'description': 'Name of the seller', 'title': 'Seller', 'type': 'string'}}, 'required': ['buyer', 'seller'], 'type': 'object'}}}]}}
2024-10-14 14:51:32,120 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:51:32,120 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:51:32,120 - DEBUG - send_request_headers.complete
2024-10-14 14:51:32,120 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:51:32,120 - DEBUG - send_request_body.complete
2024-10-14 14:51:32,120 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:51:34,434 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:51:34 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2162'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9992'), (b'x-ratelimit-remaining-tokens', b'9810'), (b'x-ratelimit-reset-requests', b'1m1.284s'), (b'x-ratelimit-reset-tokens', b'1.135s'), (b'x-request-id', b'req_0a3f47cbe923d13c34398a52d21ebfed'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d275bab9c7ac9e9-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:51:34,435 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:51:34,435 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:51:34,436 - DEBUG - receive_response_body.complete
2024-10-14 14:51:34,436 - DEBUG - response_closed.started
2024-10-14 14:51:34,436 - DEBUG - response_closed.complete
2024-10-14 14:51:34,436 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:51:34 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '2162', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9992', 'x-ratelimit-remaining-tokens': '9810', 'x-ratelimit-reset-requests': '1m1.284s', 'x-ratelimit-reset-tokens': '1.135s', 'x-request-id': 'req_0a3f47cbe923d13c34398a52d21ebfed', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d275bab9c7ac9e9-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:51:34,437 - DEBUG - request_id: req_0a3f47cbe923d13c34398a52d21ebfed
2024-10-14 14:51:34,438 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDtkqtBs1Yn61IbeWs3EUqe3fL0v', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_4DOrnQHETa9tAOUEd73ZtRY7', function=Function(arguments='{\n  "buyer": "ISPILANTE SENTIMENT BRUSLI",\n  "seller": "ELENA VASILESCU"\n}', name='ContractParties'), type='function')]))], created=1728906692, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=30, prompt_tokens=232, total_tokens=262, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:51:34,440 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: Yes\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-14 14:51:34,440 - DEBUG - max_retries: 1
2024-10-14 14:51:34,443 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: Yes\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-14 14:51:34,443 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:51:34,444 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:51:34,444 - DEBUG - send_request_headers.complete
2024-10-14 14:51:34,444 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:51:34,444 - DEBUG - send_request_body.complete
2024-10-14 14:51:34,444 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:51:35,476 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:51:35 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'872'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9992'), (b'x-ratelimit-remaining-tokens', b'9749'), (b'x-ratelimit-reset-requests', b'1m7.598s'), (b'x-ratelimit-reset-tokens', b'1.5s'), (b'x-request-id', b'req_85ab9aaaf960ac91d9345366eef1bb0b'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d275bba1809c9e9-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:51:35,477 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:51:35,477 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:51:35,478 - DEBUG - receive_response_body.complete
2024-10-14 14:51:35,478 - DEBUG - response_closed.started
2024-10-14 14:51:35,478 - DEBUG - response_closed.complete
2024-10-14 14:51:35,478 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:51:35 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '872', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9992', 'x-ratelimit-remaining-tokens': '9749', 'x-ratelimit-reset-requests': '1m7.598s', 'x-ratelimit-reset-tokens': '1.5s', 'x-request-id': 'req_85ab9aaaf960ac91d9345366eef1bb0b', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d275bba1809c9e9-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:51:35,479 - DEBUG - request_id: req_85ab9aaaf960ac91d9345366eef1bb0b
2024-10-14 14:51:35,480 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDtnXiuT0QbjjeOjEJ9tQDShMOPb', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_6zLRcMrrAmnn5dLQz4KWgp6W', function=Function(arguments='\n{\n"action": "determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728906695, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=12, prompt_tokens=207, total_tokens=219, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:51:38,872 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.ContractDetails'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Determine the contract details for a airbnb contract between ISPILANTE SENTIMENT BRUSLI and ELENA VASILESCU.'}], 'tools': [{'type': 'function', 'function': {'name': 'ContractDetails', 'description': 'Correctly extracted `ContractDetails` with all the required parameters with correct types', 'parameters': {'properties': {'contract_type': {'description': 'Type of contract (e.g., airbnb, buy-sell, it-consulting)', 'title': 'Contract Type', 'type': 'string'}, 'additional_info': {'additionalProperties': {'type': 'string'}, 'description': 'Additional information specific to the contract type', 'title': 'Additional Info', 'type': 'object'}}, 'required': ['additional_info', 'contract_type'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'ContractDetails'}}}
2024-10-14 14:51:38,872 - DEBUG - max_retries: 1
2024-10-14 14:51:38,874 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Determine the contract details for a airbnb contract between ISPILANTE SENTIMENT BRUSLI and ELENA VASILESCU.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'ContractDetails'}}, 'tools': [{'type': 'function', 'function': {'name': 'ContractDetails', 'description': 'Correctly extracted `ContractDetails` with all the required parameters with correct types', 'parameters': {'properties': {'contract_type': {'description': 'Type of contract (e.g., airbnb, buy-sell, it-consulting)', 'title': 'Contract Type', 'type': 'string'}, 'additional_info': {'additionalProperties': {'type': 'string'}, 'description': 'Additional information specific to the contract type', 'title': 'Additional Info', 'type': 'object'}}, 'required': ['additional_info', 'contract_type'], 'type': 'object'}}}]}}
2024-10-14 14:51:38,874 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:51:38,875 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:51:38,875 - DEBUG - send_request_headers.complete
2024-10-14 14:51:38,875 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:51:38,875 - DEBUG - send_request_body.complete
2024-10-14 14:51:38,875 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:51:39,784 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:51:40 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'752'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9991'), (b'x-ratelimit-remaining-tokens', b'9865'), (b'x-ratelimit-reset-requests', b'1m11.801s'), (b'x-ratelimit-reset-tokens', b'810ms'), (b'x-request-id', b'req_f2c6558c7bba3baddf692a14ad898872'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d275bd5cc11c9e9-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:51:39,785 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:51:39,785 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:51:39,785 - DEBUG - receive_response_body.complete
2024-10-14 14:51:39,786 - DEBUG - response_closed.started
2024-10-14 14:51:39,786 - DEBUG - response_closed.complete
2024-10-14 14:51:39,786 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:51:40 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '752', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9991', 'x-ratelimit-remaining-tokens': '9865', 'x-ratelimit-reset-requests': '1m11.801s', 'x-ratelimit-reset-tokens': '810ms', 'x-request-id': 'req_f2c6558c7bba3baddf692a14ad898872', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d275bd5cc11c9e9-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:51:39,786 - DEBUG - request_id: req_f2c6558c7bba3baddf692a14ad898872
2024-10-14 14:51:39,787 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDtrBOMrW5TvsEVetJBy2f018GS6', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_FJ6GISMi612qYnnnqJLqmAlC', function=Function(arguments='{\n"contract_type": "airbnb"\n}', name='ContractDetails'), type='function')]))], created=1728906699, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=10, prompt_tokens=184, total_tokens=194, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:51:39,790 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: Yes\n    - Contract type determined: Yes\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-14 14:51:39,790 - DEBUG - max_retries: 1
2024-10-14 14:51:39,793 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: Yes\n    - Contract type determined: Yes\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-14 14:51:39,794 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:51:39,794 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:51:39,794 - DEBUG - send_request_headers.complete
2024-10-14 14:51:39,794 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:51:39,794 - DEBUG - send_request_body.complete
2024-10-14 14:51:39,795 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:51:40,620 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:51:40 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'668'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9990'), (b'x-ratelimit-remaining-tokens', b'9779'), (b'x-ratelimit-reset-requests', b'1m19.528s'), (b'x-ratelimit-reset-tokens', b'1.324s'), (b'x-request-id', b'req_3f1f12e75839c4abf02c27f3e2b60490'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d275bdb8cc4c9e9-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:51:40,621 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:51:40,621 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:51:40,621 - DEBUG - receive_response_body.complete
2024-10-14 14:51:40,621 - DEBUG - response_closed.started
2024-10-14 14:51:40,621 - DEBUG - response_closed.complete
2024-10-14 14:51:40,621 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:51:40 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '668', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9990', 'x-ratelimit-remaining-tokens': '9779', 'x-ratelimit-reset-requests': '1m19.528s', 'x-ratelimit-reset-tokens': '1.324s', 'x-request-id': 'req_3f1f12e75839c4abf02c27f3e2b60490', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d275bdb8cc4c9e9-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:51:40,621 - DEBUG - request_id: req_3f1f12e75839c4abf02c27f3e2b60490
2024-10-14 14:51:40,621 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDtsGAeVL9MYHLrco3DcT2lPYh2x', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_ut7g4p2k6wk8fEOsBA6qvnzQ', function=Function(arguments='\n{\n"action": "construct_contract"\n}', name='AgentAction'), type='function')]))], created=1728906700, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=10, prompt_tokens=207, total_tokens=217, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:51:40,622 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.Contract'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Create a airbnb contract using the following template:\n\nAirbnb Rental Agreement Template (Improved Version)\n\nRental Agreement\n\nThis Rental Agreement ("Agreement") is made on [date] between:\n\n1. Parties\n\nHost: [Host\'s Name], residing at [Host\'s Address].\n\nGuest: [Guest\'s Name], residing at [Guest\'s Address].\n\n2. Property\n\nThe Host agrees to rent the property located at [Property Address] to the Guest for the term specified below.\n\nProperty Type: [Apartment/House/Condo/Other]\n\nBedrooms: [Number]\n\nBathrooms: [Number]\n\nOther Features: [Details]\n\n3. Rental Term\n\nThe Guest shall have access to the property for the following period:\n\nFixed Term: From [Start Date] at [Start Time] to [End Date] at [End Time].\n\nMonth-to-Month Lease: Starting on [Start Date], ending upon notice of [X] days from either party.\n\n4. Rental Amount\n\nTotal Rent: [Total Rent in USD]\n\nPayment Method: [e.g., bank transfer, credit card]\n\nPayment Due Date: [Due Date]\n\n5. Security Deposit\n\nAmount: [Security Deposit in USD]\n\nRefundable within [State\'s Requirement] after the lease ends, minus any deductions for damages.\n\n6. House Rules\n\nQuiet Hours: [Yes/No]. If yes, from [Start Time] to [End Time].\n\nSmoking Policy: [Prohibited/Permitted only in specific areas].\n\nPets: [Allowed/Not Allowed]. If allowed, specify any pet fees or restrictions.\n\n7. Utilities and Services\n\nThe Host shall provide all utilities and services, except for: [List of exceptions].\n\n8. Occupants\n\nThe total number of occupants allowed on the property is [Number of Guests].\n\n9. Parking\n\nParking Availability: [Number of Spaces, Fee (if any), and Description of Parking Space].\n\n10. Fees\n\nThe Guest agrees to pay the following fees upon execution of this Agreement:\n\nCleaning Fee: [Amount in USD]\n\nTaxes: [Amount in USD]\n\nOther Fees: [Specify and list amounts]\n\n11. Subletting\n\nSubletting Rights: [Allowed/Not Allowed]. If allowed, subtenants [must/must not] be approved by the Host prior to occupancy.\n\n12. Inspection and Maintenance\n\nMove-in Inspection: A move-in inspection checklist [will/will not] be completed.\n\nRight to Inspect: The Host has the right to inspect the property with reasonable notice as required by law.\n\nMaintenance: The Guest shall maintain the property in good condition. Any damages caused will be deducted from the Security Deposit.\n\n13. Liability\n\nThe Guest shall be responsible for any damages to the property.\n\nThe Host shall not be liable for injuries sustained by the Guest or their guests.\n\n14. Termination\n\nEither party may terminate this Agreement upon [X] days\' notice. All outstanding payments must be settled.\n\n15. Governing Law\n\nThis Agreement shall be governed by the laws of [Jurisdiction].\n\n16. Entire Agreement\n\nThis Agreement constitutes the entire understanding between the Host and the Guest regarding the rental and supersedes all prior agreements, whether written or oral.\n\n17. Signatures\n\nHost Signature: ______________________\n\nDate: ______________________\n\nGuest Signature: ______________________\n\nDate: ______________________\n\nBuyer: ISPILANTE SENTIMENT BRUSLI, Seller: ELENA VASILESCU, Address: Sos. Giurgiului nr.1 695 TR Videle Jud: Teleorman, Additional Details: {}'}], 'tools': [{'type': 'function', 'function': {'name': 'Contract', 'description': 'Correctly extracted `Contract` with all the required parameters with correct types', 'parameters': {'properties': {'buyer': {'description': 'Name of the buyer', 'title': 'Buyer', 'type': 'string'}, 'seller': {'description': 'Name of the seller', 'title': 'Seller', 'type': 'string'}, 'address': {'description': 'Address where the contract is applicable', 'title': 'Address', 'type': 'string'}, 'terms': {'description': 'Terms of the contract', 'title': 'Terms', 'type': 'string'}}, 'required': ['address', 'buyer', 'seller', 'terms'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'Contract'}}}
2024-10-14 14:51:40,622 - DEBUG - max_retries: 1
2024-10-14 14:51:40,623 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Create a airbnb contract using the following template:\n\nAirbnb Rental Agreement Template (Improved Version)\n\nRental Agreement\n\nThis Rental Agreement ("Agreement") is made on [date] between:\n\n1. Parties\n\nHost: [Host\'s Name], residing at [Host\'s Address].\n\nGuest: [Guest\'s Name], residing at [Guest\'s Address].\n\n2. Property\n\nThe Host agrees to rent the property located at [Property Address] to the Guest for the term specified below.\n\nProperty Type: [Apartment/House/Condo/Other]\n\nBedrooms: [Number]\n\nBathrooms: [Number]\n\nOther Features: [Details]\n\n3. Rental Term\n\nThe Guest shall have access to the property for the following period:\n\nFixed Term: From [Start Date] at [Start Time] to [End Date] at [End Time].\n\nMonth-to-Month Lease: Starting on [Start Date], ending upon notice of [X] days from either party.\n\n4. Rental Amount\n\nTotal Rent: [Total Rent in USD]\n\nPayment Method: [e.g., bank transfer, credit card]\n\nPayment Due Date: [Due Date]\n\n5. Security Deposit\n\nAmount: [Security Deposit in USD]\n\nRefundable within [State\'s Requirement] after the lease ends, minus any deductions for damages.\n\n6. House Rules\n\nQuiet Hours: [Yes/No]. If yes, from [Start Time] to [End Time].\n\nSmoking Policy: [Prohibited/Permitted only in specific areas].\n\nPets: [Allowed/Not Allowed]. If allowed, specify any pet fees or restrictions.\n\n7. Utilities and Services\n\nThe Host shall provide all utilities and services, except for: [List of exceptions].\n\n8. Occupants\n\nThe total number of occupants allowed on the property is [Number of Guests].\n\n9. Parking\n\nParking Availability: [Number of Spaces, Fee (if any), and Description of Parking Space].\n\n10. Fees\n\nThe Guest agrees to pay the following fees upon execution of this Agreement:\n\nCleaning Fee: [Amount in USD]\n\nTaxes: [Amount in USD]\n\nOther Fees: [Specify and list amounts]\n\n11. Subletting\n\nSubletting Rights: [Allowed/Not Allowed]. If allowed, subtenants [must/must not] be approved by the Host prior to occupancy.\n\n12. Inspection and Maintenance\n\nMove-in Inspection: A move-in inspection checklist [will/will not] be completed.\n\nRight to Inspect: The Host has the right to inspect the property with reasonable notice as required by law.\n\nMaintenance: The Guest shall maintain the property in good condition. Any damages caused will be deducted from the Security Deposit.\n\n13. Liability\n\nThe Guest shall be responsible for any damages to the property.\n\nThe Host shall not be liable for injuries sustained by the Guest or their guests.\n\n14. Termination\n\nEither party may terminate this Agreement upon [X] days\' notice. All outstanding payments must be settled.\n\n15. Governing Law\n\nThis Agreement shall be governed by the laws of [Jurisdiction].\n\n16. Entire Agreement\n\nThis Agreement constitutes the entire understanding between the Host and the Guest regarding the rental and supersedes all prior agreements, whether written or oral.\n\n17. Signatures\n\nHost Signature: ______________________\n\nDate: ______________________\n\nGuest Signature: ______________________\n\nDate: ______________________\n\nBuyer: ISPILANTE SENTIMENT BRUSLI, Seller: ELENA VASILESCU, Address: Sos. Giurgiului nr.1 695 TR Videle Jud: Teleorman, Additional Details: {}'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'Contract'}}, 'tools': [{'type': 'function', 'function': {'name': 'Contract', 'description': 'Correctly extracted `Contract` with all the required parameters with correct types', 'parameters': {'properties': {'buyer': {'description': 'Name of the buyer', 'title': 'Buyer', 'type': 'string'}, 'seller': {'description': 'Name of the seller', 'title': 'Seller', 'type': 'string'}, 'address': {'description': 'Address where the contract is applicable', 'title': 'Address', 'type': 'string'}, 'terms': {'description': 'Terms of the contract', 'title': 'Terms', 'type': 'string'}}, 'required': ['address', 'buyer', 'seller', 'terms'], 'type': 'object'}}}]}}
2024-10-14 14:51:40,624 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:51:40,624 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:51:40,624 - DEBUG - send_request_headers.complete
2024-10-14 14:51:40,624 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:51:40,624 - DEBUG - send_request_body.complete
2024-10-14 14:51:40,624 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:51:48,813 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:51:49 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'8031'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9989'), (b'x-ratelimit-remaining-tokens', b'8980'), (b'x-ratelimit-reset-requests', b'1m27.334s'), (b'x-ratelimit-reset-tokens', b'6.119s'), (b'x-request-id', b'req_c5e4fec73703ce9586ce0796c8266e25'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d275be0bbcec9e9-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:51:48,814 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:51:48,815 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:51:48,815 - DEBUG - receive_response_body.complete
2024-10-14 14:51:48,816 - DEBUG - response_closed.started
2024-10-14 14:51:48,816 - DEBUG - response_closed.complete
2024-10-14 14:51:48,816 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:51:49 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '8031', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9989', 'x-ratelimit-remaining-tokens': '8980', 'x-ratelimit-reset-requests': '1m27.334s', 'x-ratelimit-reset-tokens': '6.119s', 'x-request-id': 'req_c5e4fec73703ce9586ce0796c8266e25', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d275be0bbcec9e9-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:51:48,816 - DEBUG - request_id: req_c5e4fec73703ce9586ce0796c8266e25
2024-10-14 14:51:48,817 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDtt2z7WXMQui03AklU0iLWbSUIZ', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_3K8yQYYs8oXQkvD9CFYsgFzi', function=Function(arguments='{\n"buyer": "ISPILANTE SENTIMENT BRUSLI",\n"seller": "ELENA VASILESCU",\n"address": "Sos. Giurgiului nr.1 695 TR Videle Jud: Teleorman",\n"terms": "This Rental Agreement is made between the Host: ELENA VASILESCU and Guest: ISPILANTE SENTIMENT BRUSLI. The property located at Sos. Giurgiului nr.1 695 TR Videle Jud: Teleorman is agreed to be rented to the Guest for the specified term. The total rental amount, payment method, due date, and security deposit details will be provided individually. House rules, utilities and services, occupancy limit, and parking availability will also be clearly defined. Fees, subletting rights, inspection and maintenance regulations, liability distribution, termination protocols, and governing laws are also included in the agreement. The agreement is concluded when both parties sign."\n\n}', name='Contract'), type='function')]))], created=1728906701, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=197, prompt_tokens=892, total_tokens=1089, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:51:48,819 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: Yes\n    - Contract type determined: Yes\n    - Contract constructed: Yes\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-14 14:51:48,820 - DEBUG - max_retries: 1
2024-10-14 14:51:48,821 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: Yes\n    - Contract type determined: Yes\n    - Contract constructed: Yes\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-14 14:51:48,821 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:51:48,822 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:51:48,822 - DEBUG - send_request_headers.complete
2024-10-14 14:51:48,822 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:51:48,822 - DEBUG - send_request_body.complete
2024-10-14 14:51:48,822 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:51:49,751 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:51:50 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'782'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9989'), (b'x-ratelimit-remaining-tokens', b'9656'), (b'x-ratelimit-reset-requests', b'1m27.779s'), (b'x-ratelimit-reset-tokens', b'2.058s'), (b'x-request-id', b'req_35914c998933b3f27ab3e544cd81879a'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d275c13f889c9e9-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:51:49,752 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:51:49,752 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:51:49,753 - DEBUG - receive_response_body.complete
2024-10-14 14:51:49,753 - DEBUG - response_closed.started
2024-10-14 14:51:49,753 - DEBUG - response_closed.complete
2024-10-14 14:51:49,754 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:51:50 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '782', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9989', 'x-ratelimit-remaining-tokens': '9656', 'x-ratelimit-reset-requests': '1m27.779s', 'x-ratelimit-reset-tokens': '2.058s', 'x-request-id': 'req_35914c998933b3f27ab3e544cd81879a', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d275c13f889c9e9-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:51:49,754 - DEBUG - request_id: req_35914c998933b3f27ab3e544cd81879a
2024-10-14 14:51:49,755 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDu1U2mez3v4zxlry0daKfTljb67', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_ZNQhJ3OzgVjANdXj3faKCHzn', function=Function(arguments='\n{\n"action": "finish"\n}', name='AgentAction'), type='function')]))], created=1728906709, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=9, prompt_tokens=207, total_tokens=216, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:51:49,901 - DEBUG - close.started
2024-10-14 14:51:49,901 - DEBUG - close.complete
2024-10-14 14:53:57,547 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-14 14:53:58,812 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-14 14:53:58,813 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-14 14:53:59,137 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-14 14:53:59,137 - DEBUG - Using proactor: IocpProactor
2024-10-14 14:53:59,161 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 14:53:59,161 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 14:53:59,161 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 14:53:59,161 - DEBUG - Compression method 0
2024-10-14 14:53:59,161 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 14:53:59,161 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 14:53:59,161 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-14 14:53:59,161 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-14 14:53:59,161 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-14 14:53:59,161 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-14 14:53:59,161 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 14:53:59,161 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 14:53:59,162 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 14:53:59,162 - DEBUG - Compression method 0
2024-10-14 14:53:59,162 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 14:53:59,162 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 14:53:59,162 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-14 14:53:59,162 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-14 14:53:59,162 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-14 14:53:59,162 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-14 14:53:59,171 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 14:53:59,172 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 14:53:59,172 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-14 14:53:59,172 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-14 14:53:59,172 - DEBUG - Error closing: Operation on closed image
2024-10-14 14:54:01,359 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 14:54:01,359 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 14:54:01,359 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 14:54:01,359 - DEBUG - Compression method 0
2024-10-14 14:54:01,359 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 14:54:01,359 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 14:54:01,359 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-14 14:54:01,359 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-14 14:54:01,359 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-14 14:54:01,359 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-14 14:54:01,359 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 14:54:01,359 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 14:54:01,359 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 14:54:01,359 - DEBUG - Compression method 0
2024-10-14 14:54:01,359 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 14:54:01,360 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 14:54:01,360 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-14 14:54:01,360 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-14 14:54:01,360 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-14 14:54:01,360 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-14 14:54:01,376 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 14:54:01,377 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 14:54:01,377 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-14 14:54:01,377 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-14 14:54:01,378 - DEBUG - Error closing: Operation on closed image
2024-10-14 14:54:03,937 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 0 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-14 14:54:03,937 - DEBUG - max_retries: 1
2024-10-14 14:54:03,940 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 0 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-14 14:54:03,969 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:54:03,970 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-14 14:54:03,983 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000002116634B4A0>
2024-10-14 14:54:03,983 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x00000211661A1B50> server_hostname='api.openai.com' timeout=5.0
2024-10-14 14:54:03,992 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000002116634B3B0>
2024-10-14 14:54:03,992 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:54:03,993 - DEBUG - send_request_headers.complete
2024-10-14 14:54:03,993 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:54:03,993 - DEBUG - send_request_body.complete
2024-10-14 14:54:03,993 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:54:04,939 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:54:05 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'779'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'9821'), (b'x-ratelimit-reset-requests', b'8.64s'), (b'x-ratelimit-reset-tokens', b'1.074s'), (b'x-request-id', b'req_7fe619a7411e9bc8387a44b8fb8c01b4'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=7CLzlczIj3OwHrJp9YzmCqEetjsoUevVMrvVNsfSjco-1728906845-1.0.1.1-jmTQm9PCGRYfFjpZxoCnuMyAAV3UNPy1QwotOre3z3fBF8Kfa_L3Z_Jqvk0y1MTJP0rf6ACRrk1U.i4oq9XJmw; path=/; expires=Mon, 14-Oct-24 12:24:05 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=U1YjgB1e0dKo0_Oo8jJ5Iky1gqiLA54ZMi.opDuLT28-1728906845233-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d275f60d8deb689-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:54:04,940 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:54:04,940 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:54:04,940 - DEBUG - receive_response_body.complete
2024-10-14 14:54:04,941 - DEBUG - response_closed.started
2024-10-14 14:54:04,941 - DEBUG - response_closed.complete
2024-10-14 14:54:04,941 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Mon, 14 Oct 2024 11:54:05 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-kzzh9hik9ryjiou4ftvhondh'), ('openai-processing-ms', '779'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '10000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '9821'), ('x-ratelimit-reset-requests', '8.64s'), ('x-ratelimit-reset-tokens', '1.074s'), ('x-request-id', 'req_7fe619a7411e9bc8387a44b8fb8c01b4'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=7CLzlczIj3OwHrJp9YzmCqEetjsoUevVMrvVNsfSjco-1728906845-1.0.1.1-jmTQm9PCGRYfFjpZxoCnuMyAAV3UNPy1QwotOre3z3fBF8Kfa_L3Z_Jqvk0y1MTJP0rf6ACRrk1U.i4oq9XJmw; path=/; expires=Mon, 14-Oct-24 12:24:05 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=U1YjgB1e0dKo0_Oo8jJ5Iky1gqiLA54ZMi.opDuLT28-1728906845233-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d275f60d8deb689-OTP'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-14 14:54:04,941 - DEBUG - request_id: req_7fe619a7411e9bc8387a44b8fb8c01b4
2024-10-14 14:54:04,943 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDwCv6327TYTk0bn3BDKUnRi5Xff', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_JYLgJyW9Hhvp1NfwtBpZFFVd', function=Function(arguments='\n{\n"action": "extract_pii"\n}', name='AgentAction'), type='function')]))], created=1728906844, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=11, prompt_tokens=207, total_tokens=218, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:54:04,944 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.PIIData'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}}
2024-10-14 14:54:04,944 - DEBUG - max_retries: 1
2024-10-14 14:54:04,945 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}, 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}]}}
2024-10-14 14:54:04,946 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:54:04,946 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:54:04,946 - DEBUG - send_request_headers.complete
2024-10-14 14:54:04,946 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:54:04,946 - DEBUG - send_request_body.complete
2024-10-14 14:54:04,947 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:54:07,257 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:54:07 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2146'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9998'), (b'x-ratelimit-remaining-tokens', b'9676'), (b'x-ratelimit-reset-requests', b'16.326s'), (b'x-ratelimit-reset-tokens', b'1.938s'), (b'x-request-id', b'req_aa08539081db08f3191047a6ab6d9cb9'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d275f66cfb8b689-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:54:07,258 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:54:07,258 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:54:07,258 - DEBUG - receive_response_body.complete
2024-10-14 14:54:07,258 - DEBUG - response_closed.started
2024-10-14 14:54:07,258 - DEBUG - response_closed.complete
2024-10-14 14:54:07,258 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:54:07 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '2146', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9998', 'x-ratelimit-remaining-tokens': '9676', 'x-ratelimit-reset-requests': '16.326s', 'x-ratelimit-reset-tokens': '1.938s', 'x-request-id': 'req_aa08539081db08f3191047a6ab6d9cb9', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d275f66cfb8b689-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:54:07,258 - DEBUG - request_id: req_aa08539081db08f3191047a6ab6d9cb9
2024-10-14 14:54:07,258 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDwDG9JuPuVTTg3HPfSOSjnq2E04', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_3qlpQ6mWsAb8IQhIScpe14iD', function=Function(arguments='{\n"name": "T525M ISPILANTE SENTIMENT BRUSLI",\n"address": "Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR"\n}', name='PIIData'), type='function')]))], created=1728906845, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=42, prompt_tokens=377, total_tokens=419, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:54:09,323 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.PIIData'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}}
2024-10-14 14:54:09,323 - DEBUG - max_retries: 1
2024-10-14 14:54:09,325 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}, 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}]}}
2024-10-14 14:54:09,325 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:54:09,325 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:54:09,325 - DEBUG - send_request_headers.complete
2024-10-14 14:54:09,325 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:54:09,325 - DEBUG - send_request_body.complete
2024-10-14 14:54:09,325 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:54:12,342 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:54:12 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2455'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9997'), (b'x-ratelimit-remaining-tokens', b'9742'), (b'x-ratelimit-reset-requests', b'20.579s'), (b'x-ratelimit-reset-tokens', b'1.548s'), (b'x-request-id', b'req_d3d409e685e6406713b31a7e46f5bdbb'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d275f822cacb689-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:54:12,342 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:54:12,342 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:54:12,342 - DEBUG - receive_response_body.complete
2024-10-14 14:54:12,343 - DEBUG - response_closed.started
2024-10-14 14:54:12,343 - DEBUG - response_closed.complete
2024-10-14 14:54:12,343 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:54:12 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '2455', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9997', 'x-ratelimit-remaining-tokens': '9742', 'x-ratelimit-reset-requests': '20.579s', 'x-ratelimit-reset-tokens': '1.548s', 'x-request-id': 'req_d3d409e685e6406713b31a7e46f5bdbb', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d275f822cacb689-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:54:12,343 - DEBUG - request_id: req_d3d409e685e6406713b31a7e46f5bdbb
2024-10-14 14:54:12,343 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDwIQi22tMvinVFkgorJMyXuYXdq', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_VfJ25PWUUUhiQV4zfGuUE55U', function=Function(arguments='{\n"name": "ELENA VASILESCU",\n"address": "Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B"\n}', name='PIIData'), type='function')]))], created=1728906850, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=42, prompt_tokens=380, total_tokens=422, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:54:13,562 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-14 14:54:13,562 - DEBUG - max_retries: 1
2024-10-14 14:54:13,564 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-14 14:54:13,564 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:54:13,565 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:54:13,565 - DEBUG - send_request_headers.complete
2024-10-14 14:54:13,565 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:54:13,565 - DEBUG - send_request_body.complete
2024-10-14 14:54:13,565 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:54:14,727 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:54:15 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'998'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9997'), (b'x-ratelimit-remaining-tokens', b'9821'), (b'x-ratelimit-reset-requests', b'24.99s'), (b'x-ratelimit-reset-tokens', b'1.074s'), (b'x-request-id', b'req_58b14494d4e368cc4376010b42731bd9'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d275f9ca8feb689-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:54:14,728 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:54:14,729 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:54:14,729 - DEBUG - receive_response_body.complete
2024-10-14 14:54:14,730 - DEBUG - response_closed.started
2024-10-14 14:54:14,730 - DEBUG - response_closed.complete
2024-10-14 14:54:14,730 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:54:15 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '998', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9997', 'x-ratelimit-remaining-tokens': '9821', 'x-ratelimit-reset-requests': '24.99s', 'x-ratelimit-reset-tokens': '1.074s', 'x-request-id': 'req_58b14494d4e368cc4376010b42731bd9', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d275f9ca8feb689-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:54:14,730 - DEBUG - request_id: req_58b14494d4e368cc4376010b42731bd9
2024-10-14 14:54:14,731 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDwMJEejjvBee3Oc95pwuCAMueEI', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_tzpbYtfG46s5MoiuUQ3RkdHw', function=Function(arguments='{\n"action": "identify_parties"\n}', name='AgentAction'), type='function')]))], created=1728906854, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=10, prompt_tokens=207, total_tokens=217, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:54:14,733 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.ContractParties'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Identify the buyer and seller from the given information:\n\nName: T525M ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'properties': {'buyer': {'description': 'Name of the buyer', 'title': 'Buyer', 'type': 'string'}, 'seller': {'description': 'Name of the seller', 'title': 'Seller', 'type': 'string'}}, 'required': ['buyer', 'seller'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}}
2024-10-14 14:54:14,733 - DEBUG - max_retries: 1
2024-10-14 14:54:14,736 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Identify the buyer and seller from the given information:\n\nName: T525M ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}, 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'properties': {'buyer': {'description': 'Name of the buyer', 'title': 'Buyer', 'type': 'string'}, 'seller': {'description': 'Name of the seller', 'title': 'Seller', 'type': 'string'}}, 'required': ['buyer', 'seller'], 'type': 'object'}}}]}}
2024-10-14 14:54:14,736 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:54:14,737 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:54:14,737 - DEBUG - send_request_headers.complete
2024-10-14 14:54:14,737 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:54:14,737 - DEBUG - send_request_body.complete
2024-10-14 14:54:14,737 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:54:16,631 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:54:16 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1730'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9996'), (b'x-ratelimit-remaining-tokens', b'9810'), (b'x-ratelimit-reset-requests', b'32.456s'), (b'x-ratelimit-reset-tokens', b'1.136s'), (b'x-request-id', b'req_8a069d41c7c61d4731ef974925dda71d'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d275fa3f9dab689-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:54:16,632 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:54:16,632 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:54:16,633 - DEBUG - receive_response_body.complete
2024-10-14 14:54:16,633 - DEBUG - response_closed.started
2024-10-14 14:54:16,633 - DEBUG - response_closed.complete
2024-10-14 14:54:16,633 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:54:16 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1730', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9996', 'x-ratelimit-remaining-tokens': '9810', 'x-ratelimit-reset-requests': '32.456s', 'x-ratelimit-reset-tokens': '1.136s', 'x-request-id': 'req_8a069d41c7c61d4731ef974925dda71d', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d275fa3f9dab689-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:54:16,634 - DEBUG - request_id: req_8a069d41c7c61d4731ef974925dda71d
2024-10-14 14:54:16,635 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDwNr9Glj1pS0HkaBVrRka5TFH5T', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_U7XbnNk56pVFwTT6gGEpb9ps', function=Function(arguments='{\n"buyer": "T525M ISPILANTE SENTIMENT BRUSLI",\n"seller": "ELENA VASILESCU"\n}', name='ContractParties'), type='function')]))], created=1728906855, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=31, prompt_tokens=235, total_tokens=266, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:54:16,638 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: Yes\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-14 14:54:16,638 - DEBUG - max_retries: 1
2024-10-14 14:54:16,642 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: Yes\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-14 14:54:16,642 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:54:16,643 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:54:16,643 - DEBUG - send_request_headers.complete
2024-10-14 14:54:16,643 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:54:16,643 - DEBUG - send_request_body.complete
2024-10-14 14:54:16,643 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:54:17,718 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:54:18 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'917'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9995'), (b'x-ratelimit-remaining-tokens', b'9748'), (b'x-ratelimit-reset-requests', b'39.189s'), (b'x-ratelimit-reset-tokens', b'1.506s'), (b'x-request-id', b'req_9c6376f18f02f3a648960848fd38ac20'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d275fafeec5b689-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:54:17,719 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:54:17,719 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:54:17,720 - DEBUG - receive_response_body.complete
2024-10-14 14:54:17,720 - DEBUG - response_closed.started
2024-10-14 14:54:17,720 - DEBUG - response_closed.complete
2024-10-14 14:54:17,720 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:54:18 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '917', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9995', 'x-ratelimit-remaining-tokens': '9748', 'x-ratelimit-reset-requests': '39.189s', 'x-ratelimit-reset-tokens': '1.506s', 'x-request-id': 'req_9c6376f18f02f3a648960848fd38ac20', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d275fafeec5b689-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:54:17,721 - DEBUG - request_id: req_9c6376f18f02f3a648960848fd38ac20
2024-10-14 14:54:17,722 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDwPYSYIWh4BLVJL2DkkbT3mfCrW', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_eE1nFPUzIgNOvzzrcn6dFXk3', function=Function(arguments='\n{\n  "action": "determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728906857, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=13, prompt_tokens=207, total_tokens=220, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:54:22,012 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.ContractDetails'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Determine the contract details for a airbnb contract between T525M ISPILANTE SENTIMENT BRUSLI and ELENA VASILESCU.'}], 'tools': [{'type': 'function', 'function': {'name': 'ContractDetails', 'description': 'Correctly extracted `ContractDetails` with all the required parameters with correct types', 'parameters': {'properties': {'contract_type': {'description': 'Type of contract (e.g., airbnb, buy-sell, it-consulting)', 'title': 'Contract Type', 'type': 'string'}, 'additional_info': {'additionalProperties': {'type': 'string'}, 'description': 'Additional information specific to the contract type', 'title': 'Additional Info', 'type': 'object'}}, 'required': ['additional_info', 'contract_type'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'ContractDetails'}}}
2024-10-14 14:54:22,013 - DEBUG - max_retries: 1
2024-10-14 14:54:22,015 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Determine the contract details for a airbnb contract between T525M ISPILANTE SENTIMENT BRUSLI and ELENA VASILESCU.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'ContractDetails'}}, 'tools': [{'type': 'function', 'function': {'name': 'ContractDetails', 'description': 'Correctly extracted `ContractDetails` with all the required parameters with correct types', 'parameters': {'properties': {'contract_type': {'description': 'Type of contract (e.g., airbnb, buy-sell, it-consulting)', 'title': 'Contract Type', 'type': 'string'}, 'additional_info': {'additionalProperties': {'type': 'string'}, 'description': 'Additional information specific to the contract type', 'title': 'Additional Info', 'type': 'object'}}, 'required': ['additional_info', 'contract_type'], 'type': 'object'}}}]}}
2024-10-14 14:54:22,015 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:54:22,015 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:54:22,016 - DEBUG - send_request_headers.complete
2024-10-14 14:54:22,016 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:54:22,016 - DEBUG - send_request_body.complete
2024-10-14 14:54:22,016 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:54:22,910 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:54:23 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'736'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9995'), (b'x-ratelimit-remaining-tokens', b'9864'), (b'x-ratelimit-reset-requests', b'42.458s'), (b'x-ratelimit-reset-tokens', b'816ms'), (b'x-request-id', b'req_0413adfcf08facf46e54992ef8549415'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d275fd17cb9b689-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:54:22,911 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:54:22,911 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:54:22,911 - DEBUG - receive_response_body.complete
2024-10-14 14:54:22,912 - DEBUG - response_closed.started
2024-10-14 14:54:22,912 - DEBUG - response_closed.complete
2024-10-14 14:54:22,912 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:54:23 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '736', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9995', 'x-ratelimit-remaining-tokens': '9864', 'x-ratelimit-reset-requests': '42.458s', 'x-ratelimit-reset-tokens': '816ms', 'x-request-id': 'req_0413adfcf08facf46e54992ef8549415', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d275fd17cb9b689-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:54:22,912 - DEBUG - request_id: req_0413adfcf08facf46e54992ef8549415
2024-10-14 14:54:22,913 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDwUP4fVC0lE7Wz8NLaiDZjTLCBe', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_zfiU0urlXXASADxlcqNq2Zc7', function=Function(arguments='{\n  "contract_type": "airbnb"\n}', name='ContractDetails'), type='function')]))], created=1728906862, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=11, prompt_tokens=187, total_tokens=198, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:54:22,916 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: Yes\n    - Contract type determined: Yes\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-14 14:54:22,916 - DEBUG - max_retries: 1
2024-10-14 14:54:22,920 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: Yes\n    - Contract type determined: Yes\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-14 14:54:22,920 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:54:22,921 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:54:22,921 - DEBUG - send_request_headers.complete
2024-10-14 14:54:22,921 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:54:22,921 - DEBUG - send_request_body.complete
2024-10-14 14:54:22,921 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:54:24,015 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:54:24 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'939'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9994'), (b'x-ratelimit-remaining-tokens', b'9774'), (b'x-ratelimit-reset-requests', b'50.189s'), (b'x-ratelimit-reset-tokens', b'1.353s'), (b'x-request-id', b'req_9916c4092740f86d9a16df9ff7050b7e'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d275fd71a5bb689-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:54:24,016 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:54:24,016 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:54:24,017 - DEBUG - receive_response_body.complete
2024-10-14 14:54:24,017 - DEBUG - response_closed.started
2024-10-14 14:54:24,017 - DEBUG - response_closed.complete
2024-10-14 14:54:24,017 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:54:24 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '939', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9994', 'x-ratelimit-remaining-tokens': '9774', 'x-ratelimit-reset-requests': '50.189s', 'x-ratelimit-reset-tokens': '1.353s', 'x-request-id': 'req_9916c4092740f86d9a16df9ff7050b7e', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d275fd71a5bb689-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:54:24,017 - DEBUG - request_id: req_9916c4092740f86d9a16df9ff7050b7e
2024-10-14 14:54:24,018 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDwV8d4T0EgaKQau27NxzCUBLro9', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_ab1kQgbvymReKFe0OpeFErxI', function=Function(arguments='\n{\n  "action": "construct_contract"\n}', name='AgentAction'), type='function')]))], created=1728906863, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=11, prompt_tokens=207, total_tokens=218, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:54:24,021 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.Contract'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Create a airbnb contract using the following template:\n\nAirbnb Rental Agreement Template (Improved Version)\n\nRental Agreement\n\nThis Rental Agreement ("Agreement") is made on [date] between:\n\n1. Parties\n\nHost: [Host\'s Name], residing at [Host\'s Address].\n\nGuest: [Guest\'s Name], residing at [Guest\'s Address].\n\n2. Property\n\nThe Host agrees to rent the property located at [Property Address] to the Guest for the term specified below.\n\nProperty Type: [Apartment/House/Condo/Other]\n\nBedrooms: [Number]\n\nBathrooms: [Number]\n\nOther Features: [Details]\n\n3. Rental Term\n\nThe Guest shall have access to the property for the following period:\n\nFixed Term: From [Start Date] at [Start Time] to [End Date] at [End Time].\n\nMonth-to-Month Lease: Starting on [Start Date], ending upon notice of [X] days from either party.\n\n4. Rental Amount\n\nTotal Rent: [Total Rent in USD]\n\nPayment Method: [e.g., bank transfer, credit card]\n\nPayment Due Date: [Due Date]\n\n5. Security Deposit\n\nAmount: [Security Deposit in USD]\n\nRefundable within [State\'s Requirement] after the lease ends, minus any deductions for damages.\n\n6. House Rules\n\nQuiet Hours: [Yes/No]. If yes, from [Start Time] to [End Time].\n\nSmoking Policy: [Prohibited/Permitted only in specific areas].\n\nPets: [Allowed/Not Allowed]. If allowed, specify any pet fees or restrictions.\n\n7. Utilities and Services\n\nThe Host shall provide all utilities and services, except for: [List of exceptions].\n\n8. Occupants\n\nThe total number of occupants allowed on the property is [Number of Guests].\n\n9. Parking\n\nParking Availability: [Number of Spaces, Fee (if any), and Description of Parking Space].\n\n10. Fees\n\nThe Guest agrees to pay the following fees upon execution of this Agreement:\n\nCleaning Fee: [Amount in USD]\n\nTaxes: [Amount in USD]\n\nOther Fees: [Specify and list amounts]\n\n11. Subletting\n\nSubletting Rights: [Allowed/Not Allowed]. If allowed, subtenants [must/must not] be approved by the Host prior to occupancy.\n\n12. Inspection and Maintenance\n\nMove-in Inspection: A move-in inspection checklist [will/will not] be completed.\n\nRight to Inspect: The Host has the right to inspect the property with reasonable notice as required by law.\n\nMaintenance: The Guest shall maintain the property in good condition. Any damages caused will be deducted from the Security Deposit.\n\n13. Liability\n\nThe Guest shall be responsible for any damages to the property.\n\nThe Host shall not be liable for injuries sustained by the Guest or their guests.\n\n14. Termination\n\nEither party may terminate this Agreement upon [X] days\' notice. All outstanding payments must be settled.\n\n15. Governing Law\n\nThis Agreement shall be governed by the laws of [Jurisdiction].\n\n16. Entire Agreement\n\nThis Agreement constitutes the entire understanding between the Host and the Guest regarding the rental and supersedes all prior agreements, whether written or oral.\n\n17. Signatures\n\nHost Signature: ______________________\n\nDate: ______________________\n\nGuest Signature: ______________________\n\nDate: ______________________\n\nBuyer: T525M ISPILANTE SENTIMENT BRUSLI, Seller: ELENA VASILESCU, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR, Additional Details: {}'}], 'tools': [{'type': 'function', 'function': {'name': 'Contract', 'description': 'Correctly extracted `Contract` with all the required parameters with correct types', 'parameters': {'properties': {'buyer': {'description': 'Name of the buyer', 'title': 'Buyer', 'type': 'string'}, 'seller': {'description': 'Name of the seller', 'title': 'Seller', 'type': 'string'}, 'address': {'description': 'Address where the contract is applicable', 'title': 'Address', 'type': 'string'}, 'terms': {'description': 'Terms of the contract', 'title': 'Terms', 'type': 'string'}}, 'required': ['address', 'buyer', 'seller', 'terms'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'Contract'}}}
2024-10-14 14:54:24,022 - DEBUG - max_retries: 1
2024-10-14 14:54:24,026 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Create a airbnb contract using the following template:\n\nAirbnb Rental Agreement Template (Improved Version)\n\nRental Agreement\n\nThis Rental Agreement ("Agreement") is made on [date] between:\n\n1. Parties\n\nHost: [Host\'s Name], residing at [Host\'s Address].\n\nGuest: [Guest\'s Name], residing at [Guest\'s Address].\n\n2. Property\n\nThe Host agrees to rent the property located at [Property Address] to the Guest for the term specified below.\n\nProperty Type: [Apartment/House/Condo/Other]\n\nBedrooms: [Number]\n\nBathrooms: [Number]\n\nOther Features: [Details]\n\n3. Rental Term\n\nThe Guest shall have access to the property for the following period:\n\nFixed Term: From [Start Date] at [Start Time] to [End Date] at [End Time].\n\nMonth-to-Month Lease: Starting on [Start Date], ending upon notice of [X] days from either party.\n\n4. Rental Amount\n\nTotal Rent: [Total Rent in USD]\n\nPayment Method: [e.g., bank transfer, credit card]\n\nPayment Due Date: [Due Date]\n\n5. Security Deposit\n\nAmount: [Security Deposit in USD]\n\nRefundable within [State\'s Requirement] after the lease ends, minus any deductions for damages.\n\n6. House Rules\n\nQuiet Hours: [Yes/No]. If yes, from [Start Time] to [End Time].\n\nSmoking Policy: [Prohibited/Permitted only in specific areas].\n\nPets: [Allowed/Not Allowed]. If allowed, specify any pet fees or restrictions.\n\n7. Utilities and Services\n\nThe Host shall provide all utilities and services, except for: [List of exceptions].\n\n8. Occupants\n\nThe total number of occupants allowed on the property is [Number of Guests].\n\n9. Parking\n\nParking Availability: [Number of Spaces, Fee (if any), and Description of Parking Space].\n\n10. Fees\n\nThe Guest agrees to pay the following fees upon execution of this Agreement:\n\nCleaning Fee: [Amount in USD]\n\nTaxes: [Amount in USD]\n\nOther Fees: [Specify and list amounts]\n\n11. Subletting\n\nSubletting Rights: [Allowed/Not Allowed]. If allowed, subtenants [must/must not] be approved by the Host prior to occupancy.\n\n12. Inspection and Maintenance\n\nMove-in Inspection: A move-in inspection checklist [will/will not] be completed.\n\nRight to Inspect: The Host has the right to inspect the property with reasonable notice as required by law.\n\nMaintenance: The Guest shall maintain the property in good condition. Any damages caused will be deducted from the Security Deposit.\n\n13. Liability\n\nThe Guest shall be responsible for any damages to the property.\n\nThe Host shall not be liable for injuries sustained by the Guest or their guests.\n\n14. Termination\n\nEither party may terminate this Agreement upon [X] days\' notice. All outstanding payments must be settled.\n\n15. Governing Law\n\nThis Agreement shall be governed by the laws of [Jurisdiction].\n\n16. Entire Agreement\n\nThis Agreement constitutes the entire understanding between the Host and the Guest regarding the rental and supersedes all prior agreements, whether written or oral.\n\n17. Signatures\n\nHost Signature: ______________________\n\nDate: ______________________\n\nGuest Signature: ______________________\n\nDate: ______________________\n\nBuyer: T525M ISPILANTE SENTIMENT BRUSLI, Seller: ELENA VASILESCU, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR, Additional Details: {}'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'Contract'}}, 'tools': [{'type': 'function', 'function': {'name': 'Contract', 'description': 'Correctly extracted `Contract` with all the required parameters with correct types', 'parameters': {'properties': {'buyer': {'description': 'Name of the buyer', 'title': 'Buyer', 'type': 'string'}, 'seller': {'description': 'Name of the seller', 'title': 'Seller', 'type': 'string'}, 'address': {'description': 'Address where the contract is applicable', 'title': 'Address', 'type': 'string'}, 'terms': {'description': 'Terms of the contract', 'title': 'Terms', 'type': 'string'}}, 'required': ['address', 'buyer', 'seller', 'terms'], 'type': 'object'}}}]}}
2024-10-14 14:54:24,027 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:54:24,027 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:54:24,027 - DEBUG - send_request_headers.complete
2024-10-14 14:54:24,027 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:54:24,028 - DEBUG - send_request_body.complete
2024-10-14 14:54:24,028 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:54:38,429 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:54:38 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'14242'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9993'), (b'x-ratelimit-remaining-tokens', b'9018'), (b'x-ratelimit-reset-requests', b'57.72s'), (b'x-ratelimit-reset-tokens', b'5.89s'), (b'x-request-id', b'req_08aa3720100dbe8ab33f5c93171176af'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d275fde0950b689-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:54:38,430 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:54:38,430 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:54:38,430 - DEBUG - receive_response_body.complete
2024-10-14 14:54:38,430 - DEBUG - response_closed.started
2024-10-14 14:54:38,430 - DEBUG - response_closed.complete
2024-10-14 14:54:38,430 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:54:38 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '14242', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9993', 'x-ratelimit-remaining-tokens': '9018', 'x-ratelimit-reset-requests': '57.72s', 'x-ratelimit-reset-tokens': '5.89s', 'x-request-id': 'req_08aa3720100dbe8ab33f5c93171176af', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d275fde0950b689-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:54:38,431 - DEBUG - request_id: req_08aa3720100dbe8ab33f5c93171176af
2024-10-14 14:54:38,432 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDwWU7Rb23jYuvhTcuIoO52DfT2j', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_kGd1WCOnrj1diBVYhOu61zNg', function=Function(arguments='{\n"buyer": "T525M ISPILANTE SENTIMENT BRUSLI",\n"seller": "ELENA VASILESCU",\n"address": "Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR",\n"terms": "This Rental Agreement is made on a certain date between:\\n\\nHost: ELENA VASILESCU, residing at a specified address.\\n\\nGuest: T525M ISPILANTE SENTIMENT BRUSLI, residing at a specified address.\\n\\nThe property located at Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR is agreed to be rented to the Guest for a specific term. The Host will provide all utilities and services, with an exception list to be provided.\\n\\nThe total number of occupants allowed on the property is a certain number.\\n\\nAdditional rules regarding subletting, inspection and maintenance, liability, and termination are to be followed. All the terms are to be governed by the laws of a specified jurisdiction.\\n\\nThe Guest agrees to the listed fees, security deposit, and rental amount. Along with the provisions regarding quiet hours, smoking policies, pet policies, and parking details.\\n\\nThis Agreement constitutes the entire understanding between the Host and the Guest regarding the rental and supersedes all prior agreements, whether written or oral."\n}', name='Contract'), type='function')]))], created=1728906864, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=285, prompt_tokens=895, total_tokens=1180, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:54:38,432 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: Yes\n    - Contract type determined: Yes\n    - Contract constructed: Yes\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-14 14:54:38,433 - DEBUG - max_retries: 1
2024-10-14 14:54:38,434 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: Yes\n    - Contract type determined: Yes\n    - Contract constructed: Yes\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-14 14:54:38,434 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:54:38,435 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:54:38,435 - DEBUG - send_request_headers.complete
2024-10-14 14:54:38,435 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:54:38,435 - DEBUG - send_request_body.complete
2024-10-14 14:54:38,435 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:54:39,254 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:54:39 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'661'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9993'), (b'x-ratelimit-remaining-tokens', b'9567'), (b'x-ratelimit-reset-requests', b'51.958s'), (b'x-ratelimit-reset-tokens', b'2.593s'), (b'x-request-id', b'req_4098ba5f09d5ec8219346d783ea63b60'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d276038198db689-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:54:39,254 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:54:39,254 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:54:39,254 - DEBUG - receive_response_body.complete
2024-10-14 14:54:39,255 - DEBUG - response_closed.started
2024-10-14 14:54:39,255 - DEBUG - response_closed.complete
2024-10-14 14:54:39,255 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:54:39 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '661', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9993', 'x-ratelimit-remaining-tokens': '9567', 'x-ratelimit-reset-requests': '51.958s', 'x-ratelimit-reset-tokens': '2.593s', 'x-request-id': 'req_4098ba5f09d5ec8219346d783ea63b60', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d276038198db689-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:54:39,255 - DEBUG - request_id: req_4098ba5f09d5ec8219346d783ea63b60
2024-10-14 14:54:39,255 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDwk8tAmx18LrPBB1Zifc0DTJ9X1', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_egMZ4cHa7eBOoJnIOe8QHrwV', function=Function(arguments='\n{\n"action": "finish"\n}', name='AgentAction'), type='function')]))], created=1728906878, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=9, prompt_tokens=207, total_tokens=216, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:54:39,414 - DEBUG - close.started
2024-10-14 14:54:39,415 - DEBUG - close.complete
2024-10-14 14:55:54,026 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-14 14:55:55,288 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-14 14:55:55,288 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-14 14:55:55,617 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-14 14:55:55,618 - DEBUG - Using proactor: IocpProactor
2024-10-14 14:55:55,637 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 14:55:55,637 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 14:55:55,637 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 14:55:55,637 - DEBUG - Compression method 0
2024-10-14 14:55:55,637 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 14:55:55,637 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 14:55:55,637 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-14 14:55:55,637 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-14 14:55:55,637 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-14 14:55:55,637 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-14 14:55:55,637 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 14:55:55,637 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 14:55:55,637 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 14:55:55,637 - DEBUG - Compression method 0
2024-10-14 14:55:55,637 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 14:55:55,638 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 14:55:55,638 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-14 14:55:55,638 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-14 14:55:55,638 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-14 14:55:55,638 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-14 14:55:55,647 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 14:55:55,647 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 14:55:55,648 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-14 14:55:55,648 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-14 14:55:55,648 - DEBUG - Error closing: Operation on closed image
2024-10-14 14:55:57,829 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 14:55:57,829 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 14:55:57,829 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 14:55:57,829 - DEBUG - Compression method 0
2024-10-14 14:55:57,830 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 14:55:57,830 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 14:55:57,830 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-14 14:55:57,830 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-14 14:55:57,830 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-14 14:55:57,830 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-14 14:55:57,830 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 14:55:57,830 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 14:55:57,830 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 14:55:57,830 - DEBUG - Compression method 0
2024-10-14 14:55:57,830 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 14:55:57,830 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 14:55:57,830 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-14 14:55:57,830 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-14 14:55:57,830 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-14 14:55:57,830 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-14 14:55:57,847 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 14:55:57,847 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 14:55:57,847 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-14 14:55:57,847 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-14 14:55:57,848 - DEBUG - Error closing: Operation on closed image
2024-10-14 14:56:00,505 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 0 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-14 14:56:00,506 - DEBUG - max_retries: 1
2024-10-14 14:56:00,508 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 0 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-14 14:56:00,540 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:56:00,540 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-14 14:56:00,568 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000002027596F7D0>
2024-10-14 14:56:00,568 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x00000202757CDBD0> server_hostname='api.openai.com' timeout=5.0
2024-10-14 14:56:00,578 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000002027596F6E0>
2024-10-14 14:56:00,578 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:56:00,578 - DEBUG - send_request_headers.complete
2024-10-14 14:56:00,578 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:56:00,578 - DEBUG - send_request_body.complete
2024-10-14 14:56:00,578 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:56:01,387 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:56:01 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'641'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'9821'), (b'x-ratelimit-reset-requests', b'8.64s'), (b'x-ratelimit-reset-tokens', b'1.074s'), (b'x-request-id', b'req_17f73dc9e78e64e6cf23eae4a0a384bc'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=EgAsNYfG5PcP4UluAiqCS0rsSGNNT0bWB95_u84F.lI-1728906961-1.0.1.1-o9HMsvWGkbmYvryv9rM7oUwtTktzrVDRyxBGzQ4eUsfnzUMuq7WrV_nO1vqgMQfxyXwza1l8WqhPoWIegpOfHA; path=/; expires=Mon, 14-Oct-24 12:26:01 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=sT_Nq2QPc8mj8j1qiFGCSYDM34GnriOQpAQujSFWk6A-1728906961687-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2762398a87c9e5-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:56:01,388 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:56:01,388 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:56:01,388 - DEBUG - receive_response_body.complete
2024-10-14 14:56:01,388 - DEBUG - response_closed.started
2024-10-14 14:56:01,388 - DEBUG - response_closed.complete
2024-10-14 14:56:01,388 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Mon, 14 Oct 2024 11:56:01 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-kzzh9hik9ryjiou4ftvhondh'), ('openai-processing-ms', '641'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '10000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '9821'), ('x-ratelimit-reset-requests', '8.64s'), ('x-ratelimit-reset-tokens', '1.074s'), ('x-request-id', 'req_17f73dc9e78e64e6cf23eae4a0a384bc'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=EgAsNYfG5PcP4UluAiqCS0rsSGNNT0bWB95_u84F.lI-1728906961-1.0.1.1-o9HMsvWGkbmYvryv9rM7oUwtTktzrVDRyxBGzQ4eUsfnzUMuq7WrV_nO1vqgMQfxyXwza1l8WqhPoWIegpOfHA; path=/; expires=Mon, 14-Oct-24 12:26:01 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=sT_Nq2QPc8mj8j1qiFGCSYDM34GnriOQpAQujSFWk6A-1728906961687-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d2762398a87c9e5-OTP'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-14 14:56:01,388 - DEBUG - request_id: req_17f73dc9e78e64e6cf23eae4a0a384bc
2024-10-14 14:56:01,390 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDy5CrQ9ij6RTNOLGfCIpQ86h4RV', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_xp3RdNT3QD0zZczKBCjefGeZ', function=Function(arguments='\n{\n"action": "extract_pii"\n}', name='AgentAction'), type='function')]))], created=1728906961, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=11, prompt_tokens=207, total_tokens=218, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:56:01,391 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.PIIData'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}}
2024-10-14 14:56:01,391 - DEBUG - max_retries: 1
2024-10-14 14:56:01,393 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}, 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}]}}
2024-10-14 14:56:01,393 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:56:01,393 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:56:01,394 - DEBUG - send_request_headers.complete
2024-10-14 14:56:01,394 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:56:01,394 - DEBUG - send_request_body.complete
2024-10-14 14:56:01,394 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:56:03,713 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:56:04 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2147'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9998'), (b'x-ratelimit-remaining-tokens', b'9657'), (b'x-ratelimit-reset-requests', b'16.441s'), (b'x-ratelimit-reset-tokens', b'2.053s'), (b'x-request-id', b'req_13d075138a6634e0ea077230f5e62c6a'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d27623e9a5ec9e5-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:56:03,714 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:56:03,714 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:56:03,714 - DEBUG - receive_response_body.complete
2024-10-14 14:56:03,714 - DEBUG - response_closed.started
2024-10-14 14:56:03,714 - DEBUG - response_closed.complete
2024-10-14 14:56:03,714 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:56:04 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '2147', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9998', 'x-ratelimit-remaining-tokens': '9657', 'x-ratelimit-reset-requests': '16.441s', 'x-ratelimit-reset-tokens': '2.053s', 'x-request-id': 'req_13d075138a6634e0ea077230f5e62c6a', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d27623e9a5ec9e5-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:56:03,714 - DEBUG - request_id: req_13d075138a6634e0ea077230f5e62c6a
2024-10-14 14:56:03,714 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDy5PyZsEcxoXW9leh6ddLbYkbJh', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_nvrd4Xu0e6kdSSDs5peTYwid', function=Function(arguments='{\n"name": "ISPILANTE SENTIMENT BRUSLI",\n"address": "Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR"\n}', name='PIIData'), type='function')]))], created=1728906961, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=39, prompt_tokens=377, total_tokens=416, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:56:06,894 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.PIIData'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}}
2024-10-14 14:56:06,895 - DEBUG - max_retries: 1
2024-10-14 14:56:06,897 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}, 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}]}}
2024-10-14 14:56:06,897 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:56:06,897 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:56:06,898 - DEBUG - send_request_headers.complete
2024-10-14 14:56:06,898 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:56:06,898 - DEBUG - send_request_body.complete
2024-10-14 14:56:06,898 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:56:08,751 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:56:09 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1705'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9997'), (b'x-ratelimit-remaining-tokens', b'9742'), (b'x-ratelimit-reset-requests', b'19.592s'), (b'x-ratelimit-reset-tokens', b'1.548s'), (b'x-request-id', b'req_77c194b8b8be0204a561d78e12eecc1f'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2762610f0cc9e5-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:56:08,752 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:56:08,752 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:56:08,752 - DEBUG - receive_response_body.complete
2024-10-14 14:56:08,753 - DEBUG - response_closed.started
2024-10-14 14:56:08,753 - DEBUG - response_closed.complete
2024-10-14 14:56:08,753 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:56:09 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1705', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9997', 'x-ratelimit-remaining-tokens': '9742', 'x-ratelimit-reset-requests': '19.592s', 'x-ratelimit-reset-tokens': '1.548s', 'x-request-id': 'req_77c194b8b8be0204a561d78e12eecc1f', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2762610f0cc9e5-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:56:08,753 - DEBUG - request_id: req_77c194b8b8be0204a561d78e12eecc1f
2024-10-14 14:56:08,754 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDyBFAbQN1j904i6VxPmUr55KtoD', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_ii9FHhkSdmEPAXJeev5j6u2Y', function=Function(arguments='{\n"name": "ELENA VASILESCU",\n"address": "Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3"\n}', name='PIIData'), type='function')]))], created=1728906967, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=39, prompt_tokens=380, total_tokens=419, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:56:10,566 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-14 14:56:10,566 - DEBUG - max_retries: 1
2024-10-14 14:56:10,568 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-14 14:56:10,569 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:56:10,569 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:56:10,569 - DEBUG - send_request_headers.complete
2024-10-14 14:56:10,569 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:56:10,569 - DEBUG - send_request_body.complete
2024-10-14 14:56:10,569 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:56:11,435 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:56:11 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'717'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9997'), (b'x-ratelimit-remaining-tokens', b'9821'), (b'x-ratelimit-reset-requests', b'24.565s'), (b'x-ratelimit-reset-tokens', b'1.074s'), (b'x-request-id', b'req_b00bab4a198e72fbf8d1504138624f61'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d276277f863c9e5-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:56:11,435 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:56:11,435 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:56:11,435 - DEBUG - receive_response_body.complete
2024-10-14 14:56:11,435 - DEBUG - response_closed.started
2024-10-14 14:56:11,435 - DEBUG - response_closed.complete
2024-10-14 14:56:11,435 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:56:11 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '717', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9997', 'x-ratelimit-remaining-tokens': '9821', 'x-ratelimit-reset-requests': '24.565s', 'x-ratelimit-reset-tokens': '1.074s', 'x-request-id': 'req_b00bab4a198e72fbf8d1504138624f61', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d276277f863c9e5-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:56:11,436 - DEBUG - request_id: req_b00bab4a198e72fbf8d1504138624f61
2024-10-14 14:56:11,436 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDyFSD3AOe1typr1aq8VgjrU05mj', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_V2mGwgu5PluXWCDNeUxekNj9', function=Function(arguments='\n{\n"action": "identify_parties"\n}', name='AgentAction'), type='function')]))], created=1728906971, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=11, prompt_tokens=207, total_tokens=218, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:56:11,437 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.ContractParties'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Identify the buyer and seller from the given information:\n\nName: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3'}], 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'properties': {'buyer': {'description': 'Name of the buyer', 'title': 'Buyer', 'type': 'string'}, 'seller': {'description': 'Name of the seller', 'title': 'Seller', 'type': 'string'}}, 'required': ['buyer', 'seller'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}}
2024-10-14 14:56:11,437 - DEBUG - max_retries: 1
2024-10-14 14:56:11,439 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Identify the buyer and seller from the given information:\n\nName: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}, 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'properties': {'buyer': {'description': 'Name of the buyer', 'title': 'Buyer', 'type': 'string'}, 'seller': {'description': 'Name of the seller', 'title': 'Seller', 'type': 'string'}}, 'required': ['buyer', 'seller'], 'type': 'object'}}}]}}
2024-10-14 14:56:11,439 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:56:11,439 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:56:11,440 - DEBUG - send_request_headers.complete
2024-10-14 14:56:11,440 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:56:11,440 - DEBUG - send_request_body.complete
2024-10-14 14:56:11,440 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:56:13,120 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:56:13 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1531'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9996'), (b'x-ratelimit-remaining-tokens', b'9763'), (b'x-ratelimit-reset-requests', b'32.326s'), (b'x-ratelimit-reset-tokens', b'1.419s'), (b'x-request-id', b'req_5f08f12c337a0d030d180ec9d872e698'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d27627d69afc9e5-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:56:13,121 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:56:13,121 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:56:13,122 - DEBUG - receive_response_body.complete
2024-10-14 14:56:13,122 - DEBUG - response_closed.started
2024-10-14 14:56:13,122 - DEBUG - response_closed.complete
2024-10-14 14:56:13,122 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:56:13 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1531', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9996', 'x-ratelimit-remaining-tokens': '9763', 'x-ratelimit-reset-requests': '32.326s', 'x-ratelimit-reset-tokens': '1.419s', 'x-request-id': 'req_5f08f12c337a0d030d180ec9d872e698', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d27627d69afc9e5-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:56:13,123 - DEBUG - request_id: req_5f08f12c337a0d030d180ec9d872e698
2024-10-14 14:56:13,124 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDyFPSJCUcdxU5Vui12xGLdkVtig', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_gBt1LoaUP6FqhXkSkQ1Y5l0e', function=Function(arguments='{\n  "buyer": "ELENA VASILESCU",\n  "seller": "ISPILANTE SENTIMENT BRUSLI"\n}', name='ContractParties'), type='function')]))], created=1728906971, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=30, prompt_tokens=229, total_tokens=259, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:56:13,126 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: Yes\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-14 14:56:13,126 - DEBUG - max_retries: 1
2024-10-14 14:56:13,130 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: Yes\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-14 14:56:13,131 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:56:13,131 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:56:13,131 - DEBUG - send_request_headers.complete
2024-10-14 14:56:13,131 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:56:13,132 - DEBUG - send_request_body.complete
2024-10-14 14:56:13,132 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:56:14,104 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:56:14 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'814'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9995'), (b'x-ratelimit-remaining-tokens', b'9751'), (b'x-ratelimit-reset-requests', b'39.278s'), (b'x-ratelimit-reset-tokens', b'1.49s'), (b'x-request-id', b'req_7da5b54b85d5271677a9786b0258aa04'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d276287f96bc9e5-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:56:14,105 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:56:14,105 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:56:14,105 - DEBUG - receive_response_body.complete
2024-10-14 14:56:14,106 - DEBUG - response_closed.started
2024-10-14 14:56:14,106 - DEBUG - response_closed.complete
2024-10-14 14:56:14,107 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:56:14 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '814', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9995', 'x-ratelimit-remaining-tokens': '9751', 'x-ratelimit-reset-requests': '39.278s', 'x-ratelimit-reset-tokens': '1.49s', 'x-request-id': 'req_7da5b54b85d5271677a9786b0258aa04', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d276287f96bc9e5-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:56:14,107 - DEBUG - request_id: req_7da5b54b85d5271677a9786b0258aa04
2024-10-14 14:56:14,108 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDyHxkefJmVeZ0k1hJoy1Jcs7qVF', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_cF7cNH4eK86GcH22gDraPeug', function=Function(arguments='\n{\n"action": "determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728906973, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=12, prompt_tokens=207, total_tokens=219, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:56:18,087 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.ContractDetails'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Determine the contract details for a airbnb contract between ELENA VASILESCU and ISPILANTE SENTIMENT BRUSLI. Who is the host (property owner) and who is the guest?'}], 'tools': [{'type': 'function', 'function': {'name': 'ContractDetails', 'description': 'Correctly extracted `ContractDetails` with all the required parameters with correct types', 'parameters': {'properties': {'contract_type': {'description': 'Type of contract (e.g., airbnb, buy-sell, it-consulting)', 'title': 'Contract Type', 'type': 'string'}, 'additional_info': {'additionalProperties': {'type': 'string'}, 'description': 'Additional information specific to the contract type', 'title': 'Additional Info', 'type': 'object'}}, 'required': ['additional_info', 'contract_type'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'ContractDetails'}}}
2024-10-14 14:56:18,088 - DEBUG - max_retries: 1
2024-10-14 14:56:18,090 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Determine the contract details for a airbnb contract between ELENA VASILESCU and ISPILANTE SENTIMENT BRUSLI. Who is the host (property owner) and who is the guest?'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'ContractDetails'}}, 'tools': [{'type': 'function', 'function': {'name': 'ContractDetails', 'description': 'Correctly extracted `ContractDetails` with all the required parameters with correct types', 'parameters': {'properties': {'contract_type': {'description': 'Type of contract (e.g., airbnb, buy-sell, it-consulting)', 'title': 'Contract Type', 'type': 'string'}, 'additional_info': {'additionalProperties': {'type': 'string'}, 'description': 'Additional information specific to the contract type', 'title': 'Additional Info', 'type': 'object'}}, 'required': ['additional_info', 'contract_type'], 'type': 'object'}}}]}}
2024-10-14 14:56:18,090 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:56:18,090 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:56:18,091 - DEBUG - send_request_headers.complete
2024-10-14 14:56:18,091 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:56:18,091 - DEBUG - send_request_body.complete
2024-10-14 14:56:18,091 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:56:18,950 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:56:19 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'709'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9995'), (b'x-ratelimit-remaining-tokens', b'9852'), (b'x-ratelimit-reset-requests', b'42.956s'), (b'x-ratelimit-reset-tokens', b'888ms'), (b'x-request-id', b'req_bbb985835bc3ddba872ec8e1c235b218'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2762a6ff4cc9e5-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:56:18,951 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:56:18,951 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:56:18,951 - DEBUG - receive_response_body.complete
2024-10-14 14:56:18,952 - DEBUG - response_closed.started
2024-10-14 14:56:18,952 - DEBUG - response_closed.complete
2024-10-14 14:56:18,952 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:56:19 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '709', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9995', 'x-ratelimit-remaining-tokens': '9852', 'x-ratelimit-reset-requests': '42.956s', 'x-ratelimit-reset-tokens': '888ms', 'x-request-id': 'req_bbb985835bc3ddba872ec8e1c235b218', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2762a6ff4cc9e5-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:56:18,952 - DEBUG - request_id: req_bbb985835bc3ddba872ec8e1c235b218
2024-10-14 14:56:18,953 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDyMEaBeztR4cEnTrl49xwvBRrpb', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_1rmhndynXxMhtEYKcW7s6k6x', function=Function(arguments='{\n  "contract_type": "airbnb"\n}', name='ContractDetails'), type='function')]))], created=1728906978, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=11, prompt_tokens=198, total_tokens=209, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:56:30,571 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.ContractDetails'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Determine the contract details for a airbnb contract between ELENA VASILESCU and ISPILANTE SENTIMENT BRUSLI. Who is the host (property owner) and who is the guest?'}], 'tools': [{'type': 'function', 'function': {'name': 'ContractDetails', 'description': 'Correctly extracted `ContractDetails` with all the required parameters with correct types', 'parameters': {'properties': {'contract_type': {'description': 'Type of contract (e.g., airbnb, buy-sell, it-consulting)', 'title': 'Contract Type', 'type': 'string'}, 'additional_info': {'additionalProperties': {'type': 'string'}, 'description': 'Additional information specific to the contract type', 'title': 'Additional Info', 'type': 'object'}}, 'required': ['additional_info', 'contract_type'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'ContractDetails'}}}
2024-10-14 14:56:30,571 - DEBUG - max_retries: 1
2024-10-14 14:56:30,572 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Determine the contract details for a airbnb contract between ELENA VASILESCU and ISPILANTE SENTIMENT BRUSLI. Who is the host (property owner) and who is the guest?'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'ContractDetails'}}, 'tools': [{'type': 'function', 'function': {'name': 'ContractDetails', 'description': 'Correctly extracted `ContractDetails` with all the required parameters with correct types', 'parameters': {'properties': {'contract_type': {'description': 'Type of contract (e.g., airbnb, buy-sell, it-consulting)', 'title': 'Contract Type', 'type': 'string'}, 'additional_info': {'additionalProperties': {'type': 'string'}, 'description': 'Additional information specific to the contract type', 'title': 'Additional Info', 'type': 'object'}}, 'required': ['additional_info', 'contract_type'], 'type': 'object'}}}]}}
2024-10-14 14:56:30,572 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:56:30,573 - DEBUG - close.started
2024-10-14 14:56:30,573 - DEBUG - close.complete
2024-10-14 14:56:30,573 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-14 14:56:30,581 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x00000202759A1A30>
2024-10-14 14:56:30,581 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x00000202757CDBD0> server_hostname='api.openai.com' timeout=5.0
2024-10-14 14:56:30,588 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x00000202759A1CD0>
2024-10-14 14:56:30,588 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:56:30,588 - DEBUG - send_request_headers.complete
2024-10-14 14:56:30,588 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:56:30,588 - DEBUG - send_request_body.complete
2024-10-14 14:56:30,588 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:56:31,411 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:56:31 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'661'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9995'), (b'x-ratelimit-remaining-tokens', b'9852'), (b'x-ratelimit-reset-requests', b'39.102s'), (b'x-ratelimit-reset-tokens', b'888ms'), (b'x-request-id', b'req_ed98c40eecf074841b04436ff410eb47'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2762f51da6c9cd-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:56:31,411 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:56:31,411 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:56:31,412 - DEBUG - receive_response_body.complete
2024-10-14 14:56:31,412 - DEBUG - response_closed.started
2024-10-14 14:56:31,412 - DEBUG - response_closed.complete
2024-10-14 14:56:31,412 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:56:31 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '661', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9995', 'x-ratelimit-remaining-tokens': '9852', 'x-ratelimit-reset-requests': '39.102s', 'x-ratelimit-reset-tokens': '888ms', 'x-request-id': 'req_ed98c40eecf074841b04436ff410eb47', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2762f51da6c9cd-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:56:31,412 - DEBUG - request_id: req_ed98c40eecf074841b04436ff410eb47
2024-10-14 14:56:31,412 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIDyZwtGfYA2dLTOWPdPKhEw7R82J', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_ZruEtElDuoFTtfrbUrIs2QaA', function=Function(arguments='{\n"contract_type": "airbnb"\n}', name='ContractDetails'), type='function')]))], created=1728906991, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=10, prompt_tokens=198, total_tokens=208, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:56:39,490 - DEBUG - close.started
2024-10-14 14:56:39,490 - DEBUG - close.complete
2024-10-14 14:56:39,490 - ERROR - Task exception was never retrieved
future: <Task finished name='Task-1' coro=<agent_workflow() done, defined at D:\deve\contract_automation\src\main.py:25> exception=KeyboardInterrupt()>
Traceback (most recent call last):
  File "D:\deve\contract_automation\src\main.py", line 94, in <module>
    print(f"Address: {state.contract.address}")
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 30, in run
    return loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 92, in run_until_complete
    self._run_once()
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 133, in _run_once
    handle._run()
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 386, in __wakeup
    self.__step()
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 293, in __step
    self.__step_run_and_handle_result(exc)
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 304, in __step_run_and_handle_result
    result = coro.send(None)
             ^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\src\main.py", line 55, in agent_workflow
    contract_type = input("Enter contract type (airbnb, buy-sell, it-consulting): ").lower().replace(" ", "-")
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
2024-10-14 14:58:26,114 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-14 14:59:34,393 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-14 14:59:35,668 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-14 14:59:35,669 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-14 14:59:35,992 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-14 14:59:35,992 - DEBUG - Using proactor: IocpProactor
2024-10-14 14:59:36,011 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 14:59:36,011 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 14:59:36,011 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 14:59:36,011 - DEBUG - Compression method 0
2024-10-14 14:59:36,011 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 14:59:36,011 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 14:59:36,011 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-14 14:59:36,011 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-14 14:59:36,011 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-14 14:59:36,011 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-14 14:59:36,011 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 14:59:36,011 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 14:59:36,011 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 14:59:36,011 - DEBUG - Compression method 0
2024-10-14 14:59:36,011 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 14:59:36,011 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 14:59:36,011 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-14 14:59:36,011 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-14 14:59:36,012 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-14 14:59:36,012 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-14 14:59:36,021 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 14:59:36,021 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 14:59:36,021 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-14 14:59:36,022 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-14 14:59:36,022 - DEBUG - Error closing: Operation on closed image
2024-10-14 14:59:38,158 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 14:59:38,158 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 14:59:38,159 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 14:59:38,159 - DEBUG - Compression method 0
2024-10-14 14:59:38,159 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 14:59:38,159 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 14:59:38,159 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-14 14:59:38,159 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-14 14:59:38,159 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-14 14:59:38,159 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-14 14:59:38,159 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 14:59:38,159 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 14:59:38,159 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 14:59:38,159 - DEBUG - Compression method 0
2024-10-14 14:59:38,159 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 14:59:38,159 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 14:59:38,159 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-14 14:59:38,160 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-14 14:59:38,160 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-14 14:59:38,160 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-14 14:59:38,178 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 14:59:38,178 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 14:59:38,178 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-14 14:59:38,178 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-14 14:59:38,179 - DEBUG - Error closing: Operation on closed image
2024-10-14 14:59:41,310 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 0 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-14 14:59:41,311 - DEBUG - max_retries: 1
2024-10-14 14:59:41,313 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 0 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-14 14:59:41,345 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:59:41,346 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-14 14:59:41,373 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001C6DC89BD70>
2024-10-14 14:59:41,373 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x000001C6DC715B50> server_hostname='api.openai.com' timeout=5.0
2024-10-14 14:59:41,386 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001C6D7227E00>
2024-10-14 14:59:41,386 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:59:41,386 - DEBUG - send_request_headers.complete
2024-10-14 14:59:41,386 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:59:41,386 - DEBUG - send_request_body.complete
2024-10-14 14:59:41,386 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:59:42,347 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:59:42 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'807'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'9821'), (b'x-ratelimit-reset-requests', b'8.64s'), (b'x-ratelimit-reset-tokens', b'1.074s'), (b'x-request-id', b'req_a73f404507a465c28484af8fbc38d380'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=ZtQ7eLrfvlrhWe5HhUQAR5RxwdEwdD17hAYlN9Zr7u4-1728907182-1.0.1.1-uAMvFgPu4ehQTt5kMxzaaSgyjXji2tG68mLoKXdNVI5OzvpXs0_JmwbhrxD2DohgMJx93WRe52045K.vHu.xEg; path=/; expires=Mon, 14-Oct-24 12:29:42 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=5YKKmX11yghMoYxrJUkQwwDUQ4Po1GL8hgodJWHYdCk-1728907182656-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d27679d9a47c9f3-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:59:42,347 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:59:42,347 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:59:42,347 - DEBUG - receive_response_body.complete
2024-10-14 14:59:42,347 - DEBUG - response_closed.started
2024-10-14 14:59:42,348 - DEBUG - response_closed.complete
2024-10-14 14:59:42,348 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Mon, 14 Oct 2024 11:59:42 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-kzzh9hik9ryjiou4ftvhondh'), ('openai-processing-ms', '807'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '10000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '9821'), ('x-ratelimit-reset-requests', '8.64s'), ('x-ratelimit-reset-tokens', '1.074s'), ('x-request-id', 'req_a73f404507a465c28484af8fbc38d380'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=ZtQ7eLrfvlrhWe5HhUQAR5RxwdEwdD17hAYlN9Zr7u4-1728907182-1.0.1.1-uAMvFgPu4ehQTt5kMxzaaSgyjXji2tG68mLoKXdNVI5OzvpXs0_JmwbhrxD2DohgMJx93WRe52045K.vHu.xEg; path=/; expires=Mon, 14-Oct-24 12:29:42 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=5YKKmX11yghMoYxrJUkQwwDUQ4Po1GL8hgodJWHYdCk-1728907182656-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d27679d9a47c9f3-OTP'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-14 14:59:42,348 - DEBUG - request_id: req_a73f404507a465c28484af8fbc38d380
2024-10-14 14:59:42,350 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIE1dKwaRoSWJx8mFmvpcIlB6JtDY', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_fljRW85pByK7E0wnAIXBNMMz', function=Function(arguments='\n{\n  "action": "extract_pii"\n}', name='AgentAction'), type='function')]))], created=1728907181, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=12, prompt_tokens=207, total_tokens=219, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:59:42,351 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.PIIData'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}}
2024-10-14 14:59:42,351 - DEBUG - max_retries: 1
2024-10-14 14:59:42,352 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}, 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}]}}
2024-10-14 14:59:42,352 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:59:42,352 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:59:42,353 - DEBUG - send_request_headers.complete
2024-10-14 14:59:42,353 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:59:42,353 - DEBUG - send_request_body.complete
2024-10-14 14:59:42,353 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:59:44,771 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:59:45 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2264'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9998'), (b'x-ratelimit-remaining-tokens', b'9678'), (b'x-ratelimit-reset-requests', b'16.309s'), (b'x-ratelimit-reset-tokens', b'1.927s'), (b'x-request-id', b'req_eb6c384c03d6e40428da5b19d7bcfcc0'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2767a3ad38c9f3-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:59:44,772 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:59:44,772 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:59:44,772 - DEBUG - receive_response_body.complete
2024-10-14 14:59:44,772 - DEBUG - response_closed.started
2024-10-14 14:59:44,772 - DEBUG - response_closed.complete
2024-10-14 14:59:44,772 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:59:45 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '2264', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9998', 'x-ratelimit-remaining-tokens': '9678', 'x-ratelimit-reset-requests': '16.309s', 'x-ratelimit-reset-tokens': '1.927s', 'x-request-id': 'req_eb6c384c03d6e40428da5b19d7bcfcc0', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2767a3ad38c9f3-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:59:44,772 - DEBUG - request_id: req_eb6c384c03d6e40428da5b19d7bcfcc0
2024-10-14 14:59:44,772 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIE1eRDi3EQ48qtNQJFoZteR4zuBJ', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_t8lRCZ0dLHaEyTvvBSLpTsaP', function=Function(arguments='{\n"name": "ISPILANTE SENTIMENT BRUSLI",\n"address": "Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR"\n}', name='PIIData'), type='function')]))], created=1728907182, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=39, prompt_tokens=377, total_tokens=416, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:59:48,346 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.PIIData'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}}
2024-10-14 14:59:48,347 - DEBUG - max_retries: 1
2024-10-14 14:59:48,349 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}, 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}]}}
2024-10-14 14:59:48,349 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:59:48,350 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:59:48,350 - DEBUG - send_request_headers.complete
2024-10-14 14:59:48,350 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:59:48,350 - DEBUG - send_request_body.complete
2024-10-14 14:59:48,350 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:59:50,391 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:59:50 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1887'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9997'), (b'x-ratelimit-remaining-tokens', b'9742'), (b'x-ratelimit-reset-requests', b'18.96s'), (b'x-ratelimit-reset-tokens', b'1.548s'), (b'x-request-id', b'req_4d1eba1a528fdf780081e74919401457'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2767c92c39c9f3-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:59:50,392 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:59:50,392 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:59:50,393 - DEBUG - receive_response_body.complete
2024-10-14 14:59:50,393 - DEBUG - response_closed.started
2024-10-14 14:59:50,393 - DEBUG - response_closed.complete
2024-10-14 14:59:50,393 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:59:50 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1887', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9997', 'x-ratelimit-remaining-tokens': '9742', 'x-ratelimit-reset-requests': '18.96s', 'x-ratelimit-reset-tokens': '1.548s', 'x-request-id': 'req_4d1eba1a528fdf780081e74919401457', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2767c92c39c9f3-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:59:50,394 - DEBUG - request_id: req_4d1eba1a528fdf780081e74919401457
2024-10-14 14:59:50,394 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIE1kdRFUTdofSFi5GBvH0TZDfpfu', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_A5pEmFFn0Au4eUvAf92oJui6', function=Function(arguments='{\n"name": "ELENA VASILESCU",\n"address": "Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B"\n}', name='PIIData'), type='function')]))], created=1728907188, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=42, prompt_tokens=380, total_tokens=422, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:59:51,577 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-14 14:59:51,577 - DEBUG - max_retries: 1
2024-10-14 14:59:51,579 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-14 14:59:51,579 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:59:51,579 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:59:51,580 - DEBUG - send_request_headers.complete
2024-10-14 14:59:51,580 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:59:51,580 - DEBUG - send_request_body.complete
2024-10-14 14:59:51,580 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:59:52,575 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:59:52 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'834'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9997'), (b'x-ratelimit-remaining-tokens', b'9821'), (b'x-ratelimit-reset-requests', b'24.367s'), (b'x-ratelimit-reset-tokens', b'1.074s'), (b'x-request-id', b'req_c6aba0b20d3b44be5e0b77b678077623'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2767dd5d19c9f3-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:59:52,575 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:59:52,575 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:59:52,576 - DEBUG - receive_response_body.complete
2024-10-14 14:59:52,576 - DEBUG - response_closed.started
2024-10-14 14:59:52,576 - DEBUG - response_closed.complete
2024-10-14 14:59:52,576 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:59:52 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '834', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9997', 'x-ratelimit-remaining-tokens': '9821', 'x-ratelimit-reset-requests': '24.367s', 'x-ratelimit-reset-tokens': '1.074s', 'x-request-id': 'req_c6aba0b20d3b44be5e0b77b678077623', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2767dd5d19c9f3-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:59:52,576 - DEBUG - request_id: req_c6aba0b20d3b44be5e0b77b678077623
2024-10-14 14:59:52,576 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIE1ojcaOyplgfhEbKRx4q5AZZDYQ', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_9jkohtaajErUAF33NcJnE3lJ', function=Function(arguments='{\n  "action": "identify_parties"\n}', name='AgentAction'), type='function')]))], created=1728907192, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=11, prompt_tokens=207, total_tokens=218, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:59:52,578 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.ContractParties'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Identify the buyer and seller from the given information:\n\nName: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'properties': {'buyer': {'description': 'Name of the buyer', 'title': 'Buyer', 'type': 'string'}, 'seller': {'description': 'Name of the seller', 'title': 'Seller', 'type': 'string'}}, 'required': ['buyer', 'seller'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}}
2024-10-14 14:59:52,578 - DEBUG - max_retries: 1
2024-10-14 14:59:52,580 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Identify the buyer and seller from the given information:\n\nName: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}, 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'properties': {'buyer': {'description': 'Name of the buyer', 'title': 'Buyer', 'type': 'string'}, 'seller': {'description': 'Name of the seller', 'title': 'Seller', 'type': 'string'}}, 'required': ['buyer', 'seller'], 'type': 'object'}}}]}}
2024-10-14 14:59:52,581 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:59:52,581 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:59:52,581 - DEBUG - send_request_headers.complete
2024-10-14 14:59:52,582 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:59:52,582 - DEBUG - send_request_body.complete
2024-10-14 14:59:52,582 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:59:54,142 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:59:54 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1403'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9996'), (b'x-ratelimit-remaining-tokens', b'9782'), (b'x-ratelimit-reset-requests', b'32.011s'), (b'x-ratelimit-reset-tokens', b'1.307s'), (b'x-request-id', b'req_a51ad0ff9b117741369f9619930b0c4f'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2767e39fb9c9f3-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:59:54,143 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:59:54,144 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:59:54,144 - DEBUG - receive_response_body.complete
2024-10-14 14:59:54,144 - DEBUG - response_closed.started
2024-10-14 14:59:54,144 - DEBUG - response_closed.complete
2024-10-14 14:59:54,145 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:59:54 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1403', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9996', 'x-ratelimit-remaining-tokens': '9782', 'x-ratelimit-reset-requests': '32.011s', 'x-ratelimit-reset-tokens': '1.307s', 'x-request-id': 'req_a51ad0ff9b117741369f9619930b0c4f', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2767e39fb9c9f3-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:59:54,145 - DEBUG - request_id: req_a51ad0ff9b117741369f9619930b0c4f
2024-10-14 14:59:54,146 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIE1pjVGYd6VZsa0EseyDrwZkcxL7', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_Cjt2BsXpcQEjgzIac7wvOcbl', function=Function(arguments='{\n"buyer": "ISPILANTE SENTIMENT BRUSLI",\n"seller": "ELENA VASILESCU"\n}', name='ContractParties'), type='function')]))], created=1728907193, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=28, prompt_tokens=232, total_tokens=260, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:59:54,149 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: Yes\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-14 14:59:54,149 - DEBUG - max_retries: 1
2024-10-14 14:59:54,153 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: Yes\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-14 14:59:54,154 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:59:54,154 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:59:54,154 - DEBUG - send_request_headers.complete
2024-10-14 14:59:54,154 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:59:54,154 - DEBUG - send_request_body.complete
2024-10-14 14:59:54,154 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 14:59:55,518 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 11:59:55 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1210'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9995'), (b'x-ratelimit-remaining-tokens', b'9752'), (b'x-ratelimit-reset-requests', b'39.072s'), (b'x-ratelimit-reset-tokens', b'1.484s'), (b'x-request-id', b'req_5ce1b914e8f3c969065122e26874f6a8'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2767ed689fc9f3-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 14:59:55,519 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 14:59:55,519 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 14:59:55,520 - DEBUG - receive_response_body.complete
2024-10-14 14:59:55,520 - DEBUG - response_closed.started
2024-10-14 14:59:55,520 - DEBUG - response_closed.complete
2024-10-14 14:59:55,520 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 11:59:55 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1210', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9995', 'x-ratelimit-remaining-tokens': '9752', 'x-ratelimit-reset-requests': '39.072s', 'x-ratelimit-reset-tokens': '1.484s', 'x-request-id': 'req_5ce1b914e8f3c969065122e26874f6a8', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2767ed689fc9f3-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 14:59:55,520 - DEBUG - request_id: req_5ce1b914e8f3c969065122e26874f6a8
2024-10-14 14:59:55,521 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIE1qNEY9St1jC0Py0xdZcWVXBBJs', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_rX8eEFSgEb0Llrz1CDid9i2C', function=Function(arguments='{\n  "action": "determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728907194, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=12, prompt_tokens=207, total_tokens=219, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 14:59:59,199 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.ContractDetails'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Determine the contract details for a airbnb contract between ISPILANTE SENTIMENT BRUSLI and ELENA VASILESCU. Who is the host (property owner) and who is the guest? Please provide the roles in a JSON format with keys 'host' and 'guest' for Airbnb, 'seller' and 'buyer' for buy-sell, or 'consultant' and 'client' for IT consulting."}], 'tools': [{'type': 'function', 'function': {'name': 'ContractDetails', 'description': 'Correctly extracted `ContractDetails` with all the required parameters with correct types', 'parameters': {'properties': {'contract_type': {'description': 'Type of contract (e.g., airbnb, buy-sell, it-consulting)', 'title': 'Contract Type', 'type': 'string'}, 'additional_info': {'additionalProperties': {'type': 'string'}, 'description': 'Additional information specific to the contract type', 'title': 'Additional Info', 'type': 'object'}}, 'required': ['additional_info', 'contract_type'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'ContractDetails'}}}
2024-10-14 14:59:59,200 - DEBUG - max_retries: 1
2024-10-14 14:59:59,202 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Determine the contract details for a airbnb contract between ISPILANTE SENTIMENT BRUSLI and ELENA VASILESCU. Who is the host (property owner) and who is the guest? Please provide the roles in a JSON format with keys 'host' and 'guest' for Airbnb, 'seller' and 'buyer' for buy-sell, or 'consultant' and 'client' for IT consulting."}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'ContractDetails'}}, 'tools': [{'type': 'function', 'function': {'name': 'ContractDetails', 'description': 'Correctly extracted `ContractDetails` with all the required parameters with correct types', 'parameters': {'properties': {'contract_type': {'description': 'Type of contract (e.g., airbnb, buy-sell, it-consulting)', 'title': 'Contract Type', 'type': 'string'}, 'additional_info': {'additionalProperties': {'type': 'string'}, 'description': 'Additional information specific to the contract type', 'title': 'Additional Info', 'type': 'object'}}, 'required': ['additional_info', 'contract_type'], 'type': 'object'}}}]}}
2024-10-14 14:59:59,202 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 14:59:59,203 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 14:59:59,203 - DEBUG - send_request_headers.complete
2024-10-14 14:59:59,203 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 14:59:59,203 - DEBUG - send_request_body.complete
2024-10-14 14:59:59,203 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 15:00:00,088 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 12:00:00 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'725'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9995'), (b'x-ratelimit-remaining-tokens', b'9810'), (b'x-ratelimit-reset-requests', b'42.658s'), (b'x-ratelimit-reset-tokens', b'1.14s'), (b'x-request-id', b'req_ab619858b39edd7c237822d66e8d22a7'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d27680cfd50c9f3-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 15:00:00,089 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 15:00:00,089 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 15:00:00,090 - DEBUG - receive_response_body.complete
2024-10-14 15:00:00,090 - DEBUG - response_closed.started
2024-10-14 15:00:00,090 - DEBUG - response_closed.complete
2024-10-14 15:00:00,090 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 12:00:00 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '725', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9995', 'x-ratelimit-remaining-tokens': '9810', 'x-ratelimit-reset-requests': '42.658s', 'x-ratelimit-reset-tokens': '1.14s', 'x-request-id': 'req_ab619858b39edd7c237822d66e8d22a7', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d27680cfd50c9f3-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 15:00:00,091 - DEBUG - request_id: req_ab619858b39edd7c237822d66e8d22a7
2024-10-14 15:00:00,092 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIE1vHAqpvYiW3eJtZF3n6PnIlNoZ', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_yiXJLHsb1tY5anokbsTFgyn5', function=Function(arguments='{\n  "contract_type": "airbnb"\n}', name='ContractDetails'), type='function')]))], created=1728907199, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=11, prompt_tokens=243, total_tokens=254, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 15:00:26,571 - DEBUG - close.started
2024-10-14 15:00:26,572 - DEBUG - close.complete
2024-10-14 15:00:26,572 - ERROR - Task exception was never retrieved
future: <Task finished name='Task-1' coro=<agent_workflow() done, defined at D:\deve\contract_automation\src\main.py:25> exception=KeyboardInterrupt()>
Traceback (most recent call last):
  File "D:\deve\contract_automation\src\main.py", line 105, in <module>
    asyncio.run(agent_workflow())
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 30, in run
    return loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 92, in run_until_complete
    self._run_once()
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 133, in _run_once
    handle._run()
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 386, in __wakeup
    self.__step()
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 293, in __step
    self.__step_run_and_handle_result(exc)
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 304, in __step_run_and_handle_result
    result = coro.send(None)
             ^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\src\main.py", line 66, in agent_workflow
    confirmation = input("Is this role assignment correct? (yes/no): ").lower()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
2024-10-14 15:01:13,558 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-14 15:01:14,811 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-14 15:01:14,811 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-14 15:01:15,146 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-14 15:01:15,147 - DEBUG - Using proactor: IocpProactor
2024-10-14 15:01:15,167 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 15:01:15,167 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 15:01:15,167 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 15:01:15,167 - DEBUG - Compression method 0
2024-10-14 15:01:15,167 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 15:01:15,167 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 15:01:15,167 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-14 15:01:15,167 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-14 15:01:15,167 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-14 15:01:15,167 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-14 15:01:15,167 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 15:01:15,167 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 15:01:15,167 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 15:01:15,167 - DEBUG - Compression method 0
2024-10-14 15:01:15,167 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 15:01:15,167 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 15:01:15,167 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-14 15:01:15,167 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-14 15:01:15,167 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-14 15:01:15,168 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-14 15:01:15,177 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 15:01:15,177 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 15:01:15,177 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-14 15:01:15,177 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-14 15:01:15,178 - DEBUG - Error closing: Operation on closed image
2024-10-14 15:01:17,195 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 15:01:17,195 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 15:01:17,195 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 15:01:17,195 - DEBUG - Compression method 0
2024-10-14 15:01:17,196 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 15:01:17,196 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 15:01:17,196 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-14 15:01:17,196 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-14 15:01:17,196 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-14 15:01:17,196 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-14 15:01:17,196 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 15:01:17,196 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 15:01:17,196 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 15:01:17,196 - DEBUG - Compression method 0
2024-10-14 15:01:17,196 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 15:01:17,196 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 15:01:17,196 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-14 15:01:17,196 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-14 15:01:17,196 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-14 15:01:17,196 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-14 15:01:17,213 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 15:01:17,213 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 15:01:17,213 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-14 15:01:17,213 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-14 15:01:17,214 - DEBUG - Error closing: Operation on closed image
2024-10-14 15:01:19,678 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 0 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-14 15:01:19,679 - DEBUG - max_retries: 1
2024-10-14 15:01:19,681 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 0 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-14 15:01:19,719 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 15:01:19,719 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-14 15:01:19,731 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001D56A5E7CE0>
2024-10-14 15:01:19,731 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x000001D56A465B50> server_hostname='api.openai.com' timeout=5.0
2024-10-14 15:01:19,737 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001D56A5E7A70>
2024-10-14 15:01:19,738 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 15:01:19,738 - DEBUG - send_request_headers.complete
2024-10-14 15:01:19,738 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 15:01:19,738 - DEBUG - send_request_body.complete
2024-10-14 15:01:19,738 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 15:01:20,676 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 12:01:20 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'779'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'9821'), (b'x-ratelimit-reset-requests', b'8.64s'), (b'x-ratelimit-reset-tokens', b'1.074s'), (b'x-request-id', b'req_7321a29598c781e65b1fc3d4c135eab4'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=EYKhdskg55SC4U09..2ewBo5wcU_rWSOZ10cGtDtFzk-1728907280-1.0.1.1-BBQFmrbyYkf__CYvX0rzbYLq3AdWaDELBXVd1pyHW4jcrBW4pBG87zARP9b1aHwRT1klXCs6blN0OnD8umXnWA; path=/; expires=Mon, 14-Oct-24 12:31:20 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=KBcdjWOPsNS8_IwIqOz15yiOfBKEsQsZoowb5L1qeso-1728907280989-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d276a045bbcc9ed-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 15:01:20,677 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 15:01:20,677 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 15:01:20,677 - DEBUG - receive_response_body.complete
2024-10-14 15:01:20,677 - DEBUG - response_closed.started
2024-10-14 15:01:20,678 - DEBUG - response_closed.complete
2024-10-14 15:01:20,678 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Mon, 14 Oct 2024 12:01:20 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-kzzh9hik9ryjiou4ftvhondh'), ('openai-processing-ms', '779'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '10000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '9821'), ('x-ratelimit-reset-requests', '8.64s'), ('x-ratelimit-reset-tokens', '1.074s'), ('x-request-id', 'req_7321a29598c781e65b1fc3d4c135eab4'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=EYKhdskg55SC4U09..2ewBo5wcU_rWSOZ10cGtDtFzk-1728907280-1.0.1.1-BBQFmrbyYkf__CYvX0rzbYLq3AdWaDELBXVd1pyHW4jcrBW4pBG87zARP9b1aHwRT1klXCs6blN0OnD8umXnWA; path=/; expires=Mon, 14-Oct-24 12:31:20 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=KBcdjWOPsNS8_IwIqOz15yiOfBKEsQsZoowb5L1qeso-1728907280989-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d276a045bbcc9ed-OTP'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-14 15:01:20,678 - DEBUG - request_id: req_7321a29598c781e65b1fc3d4c135eab4
2024-10-14 15:01:20,680 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIE3EfATVXjDcptAfOLnJJvVVnrQ0', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_ub6lqtrW9qgYLYTGsuZpDF2R', function=Function(arguments='{\n"action": "extract_pii"\n}', name='AgentAction'), type='function')]))], created=1728907280, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=10, prompt_tokens=207, total_tokens=217, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 15:01:20,681 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.PIIData'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}}
2024-10-14 15:01:20,681 - DEBUG - max_retries: 1
2024-10-14 15:01:20,682 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}, 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}]}}
2024-10-14 15:01:20,683 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 15:01:20,683 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 15:01:20,683 - DEBUG - send_request_headers.complete
2024-10-14 15:01:20,683 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 15:01:20,683 - DEBUG - send_request_body.complete
2024-10-14 15:01:20,683 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 15:01:23,965 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 12:01:24 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'3131'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9998'), (b'x-ratelimit-remaining-tokens', b'9676'), (b'x-ratelimit-reset-requests', b'16.336s'), (b'x-ratelimit-reset-tokens', b'1.942s'), (b'x-request-id', b'req_87547e70ba6c484e3e8ba121bd22dc5c'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d276a0a3f55c9ed-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 15:01:23,966 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 15:01:23,967 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 15:01:23,967 - DEBUG - receive_response_body.complete
2024-10-14 15:01:23,967 - DEBUG - response_closed.started
2024-10-14 15:01:23,967 - DEBUG - response_closed.complete
2024-10-14 15:01:23,968 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 12:01:24 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '3131', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9998', 'x-ratelimit-remaining-tokens': '9676', 'x-ratelimit-reset-requests': '16.336s', 'x-ratelimit-reset-tokens': '1.942s', 'x-request-id': 'req_87547e70ba6c484e3e8ba121bd22dc5c', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d276a0a3f55c9ed-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 15:01:23,968 - DEBUG - request_id: req_87547e70ba6c484e3e8ba121bd22dc5c
2024-10-14 15:01:23,969 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIE3FTPeR61Yl64xWKBFccxT1wH2T', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_PYJAQImzCXztrnINCbjrPCQG', function=Function(arguments='{\n"name": "ISPILANTE SENTIMENT BRUSLI",\n"address": "Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR"\n}', name='PIIData'), type='function')]))], created=1728907281, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=39, prompt_tokens=377, total_tokens=416, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 15:01:26,547 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.PIIData'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}}
2024-10-14 15:01:26,547 - DEBUG - max_retries: 1
2024-10-14 15:01:26,550 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}, 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}]}}
2024-10-14 15:01:26,551 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 15:01:26,551 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 15:01:26,551 - DEBUG - send_request_headers.complete
2024-10-14 15:01:26,552 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 15:01:26,552 - DEBUG - send_request_body.complete
2024-10-14 15:01:26,552 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 15:01:28,743 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 12:01:29 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2039'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9997'), (b'x-ratelimit-remaining-tokens', b'9742'), (b'x-ratelimit-reset-requests', b'19.102s'), (b'x-ratelimit-reset-tokens', b'1.548s'), (b'x-request-id', b'req_ab8aba45250f6893f81feb66511e2357'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d276a2ef87ec9ed-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 15:01:28,744 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 15:01:28,744 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 15:01:28,744 - DEBUG - receive_response_body.complete
2024-10-14 15:01:28,744 - DEBUG - response_closed.started
2024-10-14 15:01:28,744 - DEBUG - response_closed.complete
2024-10-14 15:01:28,744 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 12:01:29 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '2039', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9997', 'x-ratelimit-remaining-tokens': '9742', 'x-ratelimit-reset-requests': '19.102s', 'x-ratelimit-reset-tokens': '1.548s', 'x-request-id': 'req_ab8aba45250f6893f81feb66511e2357', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d276a2ef87ec9ed-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 15:01:28,744 - DEBUG - request_id: req_ab8aba45250f6893f81feb66511e2357
2024-10-14 15:01:28,744 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIE3L0sMA4rdWoVAkfiYCNlvFjcbt', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_22QgfAjDc995b1DTVYIWE2DY', function=Function(arguments='{\n"name": "VASILESCU ELENA",\n"address": "Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3"\n}', name='PIIData'), type='function')]))], created=1728907287, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=38, prompt_tokens=380, total_tokens=418, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 15:01:33,182 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-14 15:01:33,183 - DEBUG - max_retries: 1
2024-10-14 15:01:33,185 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-14 15:01:33,185 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 15:01:33,185 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 15:01:33,186 - DEBUG - send_request_headers.complete
2024-10-14 15:01:33,186 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 15:01:33,186 - DEBUG - send_request_body.complete
2024-10-14 15:01:33,186 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 15:01:34,004 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 12:01:34 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'665'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9997'), (b'x-ratelimit-remaining-tokens', b'9821'), (b'x-ratelimit-reset-requests', b'21.11s'), (b'x-ratelimit-reset-tokens', b'1.074s'), (b'x-request-id', b'req_5ff77b095760cff0f654df758665e30c'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d276a586d5cc9ed-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 15:01:34,005 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 15:01:34,006 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 15:01:34,006 - DEBUG - receive_response_body.complete
2024-10-14 15:01:34,007 - DEBUG - response_closed.started
2024-10-14 15:01:34,007 - DEBUG - response_closed.complete
2024-10-14 15:01:34,007 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 12:01:34 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '665', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9997', 'x-ratelimit-remaining-tokens': '9821', 'x-ratelimit-reset-requests': '21.11s', 'x-ratelimit-reset-tokens': '1.074s', 'x-request-id': 'req_5ff77b095760cff0f654df758665e30c', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d276a586d5cc9ed-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 15:01:34,007 - DEBUG - request_id: req_5ff77b095760cff0f654df758665e30c
2024-10-14 15:01:34,008 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIE3RZADzu8ycJyzlUNG46n5bEwgS', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_WUELmfJ3k3sKuOFzMqxTDa2t', function=Function(arguments='\n{\n"action": "identify_parties"\n}', name='AgentAction'), type='function')]))], created=1728907293, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=11, prompt_tokens=207, total_tokens=218, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 15:01:34,009 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.ContractParties'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Identify the buyer and seller from the given information:\n\nName: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: VASILESCU ELENA, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3'}], 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'properties': {'buyer': {'description': 'Name of the buyer', 'title': 'Buyer', 'type': 'string'}, 'seller': {'description': 'Name of the seller', 'title': 'Seller', 'type': 'string'}}, 'required': ['buyer', 'seller'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}}
2024-10-14 15:01:34,009 - DEBUG - max_retries: 1
2024-10-14 15:01:34,012 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Identify the buyer and seller from the given information:\n\nName: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: VASILESCU ELENA, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}, 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'properties': {'buyer': {'description': 'Name of the buyer', 'title': 'Buyer', 'type': 'string'}, 'seller': {'description': 'Name of the seller', 'title': 'Seller', 'type': 'string'}}, 'required': ['buyer', 'seller'], 'type': 'object'}}}]}}
2024-10-14 15:01:34,012 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 15:01:34,012 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 15:01:34,013 - DEBUG - send_request_headers.complete
2024-10-14 15:01:34,013 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 15:01:34,013 - DEBUG - send_request_body.complete
2024-10-14 15:01:34,013 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 15:01:35,906 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 12:01:36 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1738'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9996'), (b'x-ratelimit-remaining-tokens', b'9754'), (b'x-ratelimit-reset-requests', b'28.926s'), (b'x-ratelimit-reset-tokens', b'1.473s'), (b'x-request-id', b'req_a7c3c7eaa651e26baed039ef99d03e71'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d276a5d9d15c9ed-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 15:01:35,906 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 15:01:35,906 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 15:01:35,906 - DEBUG - receive_response_body.complete
2024-10-14 15:01:35,906 - DEBUG - response_closed.started
2024-10-14 15:01:35,906 - DEBUG - response_closed.complete
2024-10-14 15:01:35,906 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 12:01:36 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1738', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9996', 'x-ratelimit-remaining-tokens': '9754', 'x-ratelimit-reset-requests': '28.926s', 'x-ratelimit-reset-tokens': '1.473s', 'x-request-id': 'req_a7c3c7eaa651e26baed039ef99d03e71', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d276a5d9d15c9ed-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 15:01:35,906 - DEBUG - request_id: req_a7c3c7eaa651e26baed039ef99d03e71
2024-10-14 15:01:35,906 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIE3SyTG7I8zbncuYzELKTXD4HxV5', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_jPlDDHA91TtDQtxQGnKyxtwe', function=Function(arguments='{\n"buyer": "ISPILANTE SENTIMENT BRUSLI",\n"seller": "VASILESCU ELENA"\n}', name='ContractParties'), type='function')]))], created=1728907294, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=27, prompt_tokens=229, total_tokens=256, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 15:01:35,908 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: Yes\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-14 15:01:35,908 - DEBUG - max_retries: 1
2024-10-14 15:01:35,909 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: Yes\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-14 15:01:35,910 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 15:01:35,910 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 15:01:35,910 - DEBUG - send_request_headers.complete
2024-10-14 15:01:35,910 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 15:01:35,910 - DEBUG - send_request_body.complete
2024-10-14 15:01:35,910 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 15:01:36,840 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 12:01:37 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'773'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9995'), (b'x-ratelimit-remaining-tokens', b'9754'), (b'x-ratelimit-reset-requests', b'35.669s'), (b'x-ratelimit-reset-tokens', b'1.473s'), (b'x-request-id', b'req_975e827cb3c6c338e577fc070ce29fbb'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d276a696c25c9ed-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 15:01:36,840 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 15:01:36,840 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 15:01:36,840 - DEBUG - receive_response_body.complete
2024-10-14 15:01:36,840 - DEBUG - response_closed.started
2024-10-14 15:01:36,840 - DEBUG - response_closed.complete
2024-10-14 15:01:36,840 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 12:01:37 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '773', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9995', 'x-ratelimit-remaining-tokens': '9754', 'x-ratelimit-reset-requests': '35.669s', 'x-ratelimit-reset-tokens': '1.473s', 'x-request-id': 'req_975e827cb3c6c338e577fc070ce29fbb', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d276a696c25c9ed-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 15:01:36,840 - DEBUG - request_id: req_975e827cb3c6c338e577fc070ce29fbb
2024-10-14 15:01:36,841 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIE3UewmrfxjYg1iMFOwdfCtbpRl9', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_9jkohtaajErUAF33NcJnE3lJ', function=Function(arguments='\n{\n  "action": "determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728907296, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=13, prompt_tokens=207, total_tokens=220, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 15:01:39,460 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.ContractDetails'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Determine the contract details for a airbnb contract between ISPILANTE SENTIMENT BRUSLI and VASILESCU ELENA. Who is the host (property owner) and who is the guest? Please provide the roles in a JSON format with keys 'host' and 'guest' for Airbnb, 'seller' and 'buyer' for buy-sell, or 'consultant' and 'client' for IT consulting."}], 'tools': [{'type': 'function', 'function': {'name': 'ContractDetails', 'description': 'Correctly extracted `ContractDetails` with all the required parameters with correct types', 'parameters': {'properties': {'contract_type': {'description': 'Type of contract (e.g., airbnb, buy-sell, it-consulting)', 'title': 'Contract Type', 'type': 'string'}, 'additional_info': {'additionalProperties': {'type': 'string'}, 'description': 'Additional information specific to the contract type', 'title': 'Additional Info', 'type': 'object'}}, 'required': ['additional_info', 'contract_type'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'ContractDetails'}}}
2024-10-14 15:01:39,461 - DEBUG - max_retries: 1
2024-10-14 15:01:39,463 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Determine the contract details for a airbnb contract between ISPILANTE SENTIMENT BRUSLI and VASILESCU ELENA. Who is the host (property owner) and who is the guest? Please provide the roles in a JSON format with keys 'host' and 'guest' for Airbnb, 'seller' and 'buyer' for buy-sell, or 'consultant' and 'client' for IT consulting."}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'ContractDetails'}}, 'tools': [{'type': 'function', 'function': {'name': 'ContractDetails', 'description': 'Correctly extracted `ContractDetails` with all the required parameters with correct types', 'parameters': {'properties': {'contract_type': {'description': 'Type of contract (e.g., airbnb, buy-sell, it-consulting)', 'title': 'Contract Type', 'type': 'string'}, 'additional_info': {'additionalProperties': {'type': 'string'}, 'description': 'Additional information specific to the contract type', 'title': 'Additional Info', 'type': 'object'}}, 'required': ['additional_info', 'contract_type'], 'type': 'object'}}}]}}
2024-10-14 15:01:39,463 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 15:01:39,463 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 15:01:39,464 - DEBUG - send_request_headers.complete
2024-10-14 15:01:39,464 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 15:01:39,464 - DEBUG - send_request_body.complete
2024-10-14 15:01:39,464 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 15:01:40,327 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 12:01:40 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'707'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9995'), (b'x-ratelimit-remaining-tokens', b'9810'), (b'x-ratelimit-reset-requests', b'40.746s'), (b'x-ratelimit-reset-tokens', b'1.14s'), (b'x-request-id', b'req_3173e2583e3358bff837b00bb80950ca'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d276a7fadc3c9ed-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 15:01:40,328 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 15:01:40,328 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 15:01:40,328 - DEBUG - receive_response_body.complete
2024-10-14 15:01:40,328 - DEBUG - response_closed.started
2024-10-14 15:01:40,328 - DEBUG - response_closed.complete
2024-10-14 15:01:40,328 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 12:01:40 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '707', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9995', 'x-ratelimit-remaining-tokens': '9810', 'x-ratelimit-reset-requests': '40.746s', 'x-ratelimit-reset-tokens': '1.14s', 'x-request-id': 'req_3173e2583e3358bff837b00bb80950ca', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d276a7fadc3c9ed-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 15:01:40,328 - DEBUG - request_id: req_3173e2583e3358bff837b00bb80950ca
2024-10-14 15:01:40,328 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIE3YhTmy0kZKhuzHgX0mXuuWjGwv', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_c6ruOAcJ2htz0sT8evaGz7bZ', function=Function(arguments='{\n  "contract_type": "airbnb"\n}', name='ContractDetails'), type='function')]))], created=1728907300, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=11, prompt_tokens=243, total_tokens=254, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 15:05:21,990 - DEBUG - close.started
2024-10-14 15:05:21,990 - DEBUG - close.complete
2024-10-14 15:05:21,991 - ERROR - Task exception was never retrieved
future: <Task finished name='Task-1' coro=<agent_workflow() done, defined at D:\deve\contract_automation\src\main.py:25> exception=KeyboardInterrupt()>
Traceback (most recent call last):
  File "D:\deve\contract_automation\src\main.py", line 105, in <module>
    asyncio.run(agent_workflow())
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 30, in run
    return loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 92, in run_until_complete
    self._run_once()
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 133, in _run_once
    handle._run()
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 386, in __wakeup
    self.__step()
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 293, in __step
    self.__step_run_and_handle_result(exc)
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 304, in __step_run_and_handle_result
    result = coro.send(None)
             ^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\src\main.py", line 66, in agent_workflow
    confirmation = input("Is this role assignment correct? (yes/no): ").lower()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
2024-10-14 19:33:44,925 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-14 19:33:46,200 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-14 19:33:46,201 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-14 19:33:46,528 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-14 19:33:46,529 - DEBUG - Using proactor: IocpProactor
2024-10-14 19:33:46,555 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 19:33:46,555 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 19:33:46,555 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 19:33:46,555 - DEBUG - Compression method 0
2024-10-14 19:33:46,555 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 19:33:46,555 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 19:33:46,555 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-14 19:33:46,555 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-14 19:33:46,555 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-14 19:33:46,555 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-14 19:33:46,555 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 19:33:46,555 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 19:33:46,555 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 19:33:46,555 - DEBUG - Compression method 0
2024-10-14 19:33:46,555 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 19:33:46,555 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 19:33:46,555 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-14 19:33:46,555 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-14 19:33:46,555 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-14 19:33:46,555 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-14 19:33:46,565 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 19:33:46,565 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 19:33:46,565 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-14 19:33:46,565 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-14 19:33:46,565 - DEBUG - Error closing: Operation on closed image
2024-10-14 19:33:48,511 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 19:33:48,511 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 19:33:48,511 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 19:33:48,511 - DEBUG - Compression method 0
2024-10-14 19:33:48,511 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 19:33:48,511 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 19:33:48,512 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-14 19:33:48,512 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-14 19:33:48,512 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-14 19:33:48,512 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-14 19:33:48,512 - DEBUG - STREAM b'IHDR' 16 13
2024-10-14 19:33:48,512 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-14 19:33:48,512 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-14 19:33:48,512 - DEBUG - Compression method 0
2024-10-14 19:33:48,512 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-14 19:33:48,512 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-14 19:33:48,512 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-14 19:33:48,512 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-14 19:33:48,512 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-14 19:33:48,512 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-14 19:33:48,529 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 19:33:48,529 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-14 19:33:48,529 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-14 19:33:48,529 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-14 19:33:48,530 - DEBUG - Error closing: Operation on closed image
2024-10-14 19:33:51,005 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 0 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-14 19:33:51,006 - DEBUG - max_retries: 1
2024-10-14 19:33:51,008 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 0 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-14 19:33:51,046 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 19:33:51,046 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-14 19:33:51,078 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x00000183AF4C6F60>
2024-10-14 19:33:51,078 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x00000183AF3CEBD0> server_hostname='api.openai.com' timeout=5.0
2024-10-14 19:33:51,085 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x00000183AF563A70>
2024-10-14 19:33:51,086 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 19:33:51,086 - DEBUG - send_request_headers.complete
2024-10-14 19:33:51,086 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 19:33:51,086 - DEBUG - send_request_body.complete
2024-10-14 19:33:51,086 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 19:33:52,408 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 16:33:53 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1155'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'9821'), (b'x-ratelimit-reset-requests', b'8.64s'), (b'x-ratelimit-reset-tokens', b'1.074s'), (b'x-request-id', b'req_c8c568ca824d3b8da4e3d165927a63fb'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=61L3ph7fE0ca2l0asRFEseoVCECF4mU68SxMY2Dz540-1728923633-1.0.1.1-WVBeRuxx6N1ox.NLnsULqp0ArUgCNIJWSX30alVPkHf2J9Hf4teac3uQPt6g4p_EsYN8IVl7Zdubl7p3lgBvgw; path=/; expires=Mon, 14-Oct-24 17:03:53 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=qct0kpH1N4VGGLA56Q5xbIzdHprlmy8sRPycFKe8JCQ-1728923633411-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d28f93c9ff8c9e9-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 19:33:52,409 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 19:33:52,409 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 19:33:52,409 - DEBUG - receive_response_body.complete
2024-10-14 19:33:52,409 - DEBUG - response_closed.started
2024-10-14 19:33:52,409 - DEBUG - response_closed.complete
2024-10-14 19:33:52,409 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Mon, 14 Oct 2024 16:33:53 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-kzzh9hik9ryjiou4ftvhondh'), ('openai-processing-ms', '1155'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '10000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '9821'), ('x-ratelimit-reset-requests', '8.64s'), ('x-ratelimit-reset-tokens', '1.074s'), ('x-request-id', 'req_c8c568ca824d3b8da4e3d165927a63fb'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=61L3ph7fE0ca2l0asRFEseoVCECF4mU68SxMY2Dz540-1728923633-1.0.1.1-WVBeRuxx6N1ox.NLnsULqp0ArUgCNIJWSX30alVPkHf2J9Hf4teac3uQPt6g4p_EsYN8IVl7Zdubl7p3lgBvgw; path=/; expires=Mon, 14-Oct-24 17:03:53 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=qct0kpH1N4VGGLA56Q5xbIzdHprlmy8sRPycFKe8JCQ-1728923633411-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d28f93c9ff8c9e9-OTP'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-14 19:33:52,409 - DEBUG - request_id: req_c8c568ca824d3b8da4e3d165927a63fb
2024-10-14 19:33:52,411 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIIIyohFxb260Ofai5icydfMsmL6W', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_nt8EYOi6OKtI2STZNdqrWdNi', function=Function(arguments='\n{\n  "action": "extract_pii"\n}', name='AgentAction'), type='function')]))], created=1728923632, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=12, prompt_tokens=207, total_tokens=219, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 19:33:52,412 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.PIIData'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}}
2024-10-14 19:33:52,412 - DEBUG - max_retries: 1
2024-10-14 19:33:52,413 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}, 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}]}}
2024-10-14 19:33:52,414 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 19:33:52,414 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 19:33:52,414 - DEBUG - send_request_headers.complete
2024-10-14 19:33:52,414 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 19:33:52,414 - DEBUG - send_request_body.complete
2024-10-14 19:33:52,414 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 19:33:54,536 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 16:33:55 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1966'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9998'), (b'x-ratelimit-remaining-tokens', b'9720'), (b'x-ratelimit-reset-requests', b'15.962s'), (b'x-ratelimit-reset-tokens', b'1.675s'), (b'x-request-id', b'req_a5493fd3e21a418e9fcd15a29dab3de5'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d28f944e9aec9e9-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 19:33:54,536 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 19:33:54,536 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 19:33:54,537 - DEBUG - receive_response_body.complete
2024-10-14 19:33:54,537 - DEBUG - response_closed.started
2024-10-14 19:33:54,537 - DEBUG - response_closed.complete
2024-10-14 19:33:54,537 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 16:33:55 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1966', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9998', 'x-ratelimit-remaining-tokens': '9720', 'x-ratelimit-reset-requests': '15.962s', 'x-ratelimit-reset-tokens': '1.675s', 'x-request-id': 'req_a5493fd3e21a418e9fcd15a29dab3de5', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d28f944e9aec9e9-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 19:33:54,537 - DEBUG - request_id: req_a5493fd3e21a418e9fcd15a29dab3de5
2024-10-14 19:33:54,537 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIIIzJQDKOZDE080BuRixhBc2l8bM', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_qAnrsv92lTLReYcxF18tiB6g', function=Function(arguments='{\n"name": "ISPILANTE SENTIMENT BRUSLI",\n"address": "Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR"\n}', name='PIIData'), type='function')]))], created=1728923633, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=39, prompt_tokens=377, total_tokens=416, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 19:33:57,991 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.PIIData'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}}
2024-10-14 19:33:57,991 - DEBUG - max_retries: 1
2024-10-14 19:33:57,992 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}, 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}]}}
2024-10-14 19:33:57,993 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 19:33:57,993 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 19:33:57,993 - DEBUG - send_request_headers.complete
2024-10-14 19:33:57,993 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 19:33:57,993 - DEBUG - send_request_body.complete
2024-10-14 19:33:57,993 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 19:34:03,875 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 16:34:04 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'5725'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9997'), (b'x-ratelimit-remaining-tokens', b'9742'), (b'x-ratelimit-reset-requests', b'19.022s'), (b'x-ratelimit-reset-tokens', b'1.548s'), (b'x-request-id', b'req_2a3ad4d7be3588f8ad0b308999488ba5'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d28f967cbe9c9e9-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 19:34:03,876 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 19:34:03,876 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 19:34:03,876 - DEBUG - receive_response_body.complete
2024-10-14 19:34:03,876 - DEBUG - response_closed.started
2024-10-14 19:34:03,876 - DEBUG - response_closed.complete
2024-10-14 19:34:03,876 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 16:34:04 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '5725', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9997', 'x-ratelimit-remaining-tokens': '9742', 'x-ratelimit-reset-requests': '19.022s', 'x-ratelimit-reset-tokens': '1.548s', 'x-request-id': 'req_2a3ad4d7be3588f8ad0b308999488ba5', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d28f967cbe9c9e9-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 19:34:03,876 - DEBUG - request_id: req_2a3ad4d7be3588f8ad0b308999488ba5
2024-10-14 19:34:03,877 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIIJ5POSNFPJZCmwHL9qImxtMldGz', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_459jewx1l27RV8fQKmAnovvr', function=Function(arguments='{\n"name": "VASILESCU ELENA",\n"address": "Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3"\n}', name='PIIData'), type='function')]))], created=1728923639, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=38, prompt_tokens=380, total_tokens=418, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 19:34:06,915 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-14 19:34:06,916 - DEBUG - max_retries: 1
2024-10-14 19:34:06,917 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-14 19:34:06,917 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 19:34:06,917 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 19:34:06,918 - DEBUG - send_request_headers.complete
2024-10-14 19:34:06,918 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 19:34:06,918 - DEBUG - send_request_body.complete
2024-10-14 19:34:06,918 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 19:34:08,335 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 16:34:09 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1263'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9997'), (b'x-ratelimit-remaining-tokens', b'9821'), (b'x-ratelimit-reset-requests', b'18.739s'), (b'x-ratelimit-reset-tokens', b'1.074s'), (b'x-request-id', b'req_9285ec825a07d0cfaaf099832355f82a'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d28f99f891bc9e9-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 19:34:08,336 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 19:34:08,337 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 19:34:08,337 - DEBUG - receive_response_body.complete
2024-10-14 19:34:08,338 - DEBUG - response_closed.started
2024-10-14 19:34:08,338 - DEBUG - response_closed.complete
2024-10-14 19:34:08,338 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 16:34:09 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1263', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9997', 'x-ratelimit-remaining-tokens': '9821', 'x-ratelimit-reset-requests': '18.739s', 'x-ratelimit-reset-tokens': '1.074s', 'x-request-id': 'req_9285ec825a07d0cfaaf099832355f82a', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d28f99f891bc9e9-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 19:34:08,338 - DEBUG - request_id: req_9285ec825a07d0cfaaf099832355f82a
2024-10-14 19:34:08,339 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIIJEBP3KWDNGemzX7Sz8lVYobO8K', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_0khp6IPec4efAAsMpquLrkMe', function=Function(arguments='\n{\n"action": "identify_parties"\n}', name='AgentAction'), type='function')]))], created=1728923648, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=11, prompt_tokens=207, total_tokens=218, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 19:34:08,342 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.ContractParties'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Identify the buyer and seller from the given information:\n\nName: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: VASILESCU ELENA, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3'}], 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'properties': {'buyer': {'description': 'Name of the buyer', 'title': 'Buyer', 'type': 'string'}, 'seller': {'description': 'Name of the seller', 'title': 'Seller', 'type': 'string'}}, 'required': ['buyer', 'seller'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}}
2024-10-14 19:34:08,342 - DEBUG - max_retries: 1
2024-10-14 19:34:08,343 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Identify the buyer and seller from the given information:\n\nName: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: VASILESCU ELENA, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}, 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'properties': {'buyer': {'description': 'Name of the buyer', 'title': 'Buyer', 'type': 'string'}, 'seller': {'description': 'Name of the seller', 'title': 'Seller', 'type': 'string'}}, 'required': ['buyer', 'seller'], 'type': 'object'}}}]}}
2024-10-14 19:34:08,344 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 19:34:08,344 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 19:34:08,344 - DEBUG - send_request_headers.complete
2024-10-14 19:34:08,344 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 19:34:08,344 - DEBUG - send_request_body.complete
2024-10-14 19:34:08,344 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 19:34:10,034 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 16:34:11 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1536'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9996'), (b'x-ratelimit-remaining-tokens', b'9820'), (b'x-ratelimit-reset-requests', b'25.954s'), (b'x-ratelimit-reset-tokens', b'1.077s'), (b'x-request-id', b'req_ad5f9887804e60aca6c0dd3e21172170'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d28f9a87a72c9e9-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 19:34:10,034 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 19:34:10,035 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 19:34:10,035 - DEBUG - receive_response_body.complete
2024-10-14 19:34:10,035 - DEBUG - response_closed.started
2024-10-14 19:34:10,035 - DEBUG - response_closed.complete
2024-10-14 19:34:10,035 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 16:34:11 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1536', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9996', 'x-ratelimit-remaining-tokens': '9820', 'x-ratelimit-reset-requests': '25.954s', 'x-ratelimit-reset-tokens': '1.077s', 'x-request-id': 'req_ad5f9887804e60aca6c0dd3e21172170', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d28f9a87a72c9e9-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 19:34:10,035 - DEBUG - request_id: req_ad5f9887804e60aca6c0dd3e21172170
2024-10-14 19:34:10,035 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIIJFjxY8cNsHqihgeO4HVer9gsP4', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_jsDnQaVSvU7l7ThFmeYUdDpP', function=Function(arguments='{\n"buyer": "ISPILANTE SENTIMENT BRUSLI",\n"seller": "VASILESCU ELENA"\n}', name='ContractParties'), type='function')]))], created=1728923649, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=27, prompt_tokens=229, total_tokens=256, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 19:34:10,036 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: Yes\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-14 19:34:10,036 - DEBUG - max_retries: 1
2024-10-14 19:34:10,038 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: Yes\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-14 19:34:10,038 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-14 19:34:10,038 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-14 19:34:10,038 - DEBUG - send_request_headers.complete
2024-10-14 19:34:10,038 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-14 19:34:10,038 - DEBUG - send_request_body.complete
2024-10-14 19:34:10,038 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-14 19:34:11,167 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 14 Oct 2024 16:34:12 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'980'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9996'), (b'x-ratelimit-remaining-tokens', b'9753'), (b'x-ratelimit-reset-requests', b'32.902s'), (b'x-ratelimit-reset-tokens', b'1.479s'), (b'x-request-id', b'req_be5c4d8d1e44662792b8e06a5f5e0088'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d28f9b308dfc9e9-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-14 19:34:11,168 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-14 19:34:11,168 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-14 19:34:11,169 - DEBUG - receive_response_body.complete
2024-10-14 19:34:11,169 - DEBUG - response_closed.started
2024-10-14 19:34:11,169 - DEBUG - response_closed.complete
2024-10-14 19:34:11,169 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Mon, 14 Oct 2024 16:34:12 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '980', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9996', 'x-ratelimit-remaining-tokens': '9753', 'x-ratelimit-reset-requests': '32.902s', 'x-ratelimit-reset-tokens': '1.479s', 'x-request-id': 'req_be5c4d8d1e44662792b8e06a5f5e0088', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d28f9b308dfc9e9-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-14 19:34:11,170 - DEBUG - request_id: req_be5c4d8d1e44662792b8e06a5f5e0088
2024-10-14 19:34:11,171 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIIJHl81SHi9JEFti9d5HFJgkqi4V', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_kP6qbzN1ZExoatR4q5W6TFbr', function=Function(arguments='\n{\n  "action": "determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728923651, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=13, prompt_tokens=207, total_tokens=220, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-14 19:34:15,434 - DEBUG - close.started
2024-10-14 19:34:15,435 - DEBUG - close.complete
2024-10-14 19:34:15,435 - ERROR - Task exception was never retrieved
future: <Task finished name='Task-1' coro=<agent_workflow() done, defined at D:\deve\contract_automation\src\main.py:25> exception=KeyboardInterrupt()>
Traceback (most recent call last):
  File "D:\deve\contract_automation\src\main.py", line 105, in <module>
    asyncio.run(agent_workflow())
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 30, in run
    return loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 92, in run_until_complete
    self._run_once()
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 133, in _run_once
    handle._run()
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 386, in __wakeup
    self.__step()
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 293, in __step
    self.__step_run_and_handle_result(exc)
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 304, in __step_run_and_handle_result
    result = coro.send(None)
             ^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\src\main.py", line 55, in agent_workflow
    contract_type = input("Enter contract type (airbnb, buy-sell, it-consulting): ").lower().replace(" ", "-")
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
2024-10-15 10:12:15,251 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-15 10:12:16,591 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-15 10:12:16,591 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-15 10:12:16,912 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-15 10:12:16,914 - DEBUG - Using proactor: IocpProactor
2024-10-15 10:12:16,944 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:12:16,944 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:12:16,944 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:12:16,944 - DEBUG - Compression method 0
2024-10-15 10:12:16,944 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:12:16,944 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:12:16,944 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 10:12:16,944 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 10:12:16,944 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 10:12:16,944 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 10:12:16,944 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:12:16,944 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:12:16,944 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:12:16,944 - DEBUG - Compression method 0
2024-10-15 10:12:16,945 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:12:16,945 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:12:16,945 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 10:12:16,945 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 10:12:16,945 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 10:12:16,945 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 10:12:16,955 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:12:16,955 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:12:16,955 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 10:12:16,955 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 10:12:16,956 - DEBUG - Error closing: Operation on closed image
2024-10-15 10:12:19,020 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:12:19,020 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:12:19,020 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:12:19,020 - DEBUG - Compression method 0
2024-10-15 10:12:19,020 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:12:19,020 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:12:19,020 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 10:12:19,020 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 10:12:19,020 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 10:12:19,020 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 10:12:19,020 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:12:19,020 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:12:19,020 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:12:19,020 - DEBUG - Compression method 0
2024-10-15 10:12:19,020 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:12:19,021 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:12:19,021 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 10:12:19,021 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 10:12:19,021 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 10:12:19,021 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 10:12:19,038 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:12:19,038 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:12:19,038 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 10:12:19,038 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 10:12:19,039 - DEBUG - Error closing: Operation on closed image
2024-10-15 10:12:21,552 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 0 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 10:12:21,553 - DEBUG - max_retries: 1
2024-10-15 10:12:21,555 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 0 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 10:12:21,589 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:12:21,589 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-15 10:12:21,601 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001707FE3EBD0>
2024-10-15 10:12:21,601 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x000001700212EBD0> server_hostname='api.openai.com' timeout=5.0
2024-10-15 10:12:21,613 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x00000170022C3DA0>
2024-10-15 10:12:21,613 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:12:21,613 - DEBUG - send_request_headers.complete
2024-10-15 10:12:21,613 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:12:21,614 - DEBUG - send_request_body.complete
2024-10-15 10:12:21,614 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:12:22,537 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:12:23 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'742'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'9821'), (b'x-ratelimit-reset-requests', b'8.64s'), (b'x-ratelimit-reset-tokens', b'1.074s'), (b'x-request-id', b'req_1faf861c990892eed48dcec7eb50457b'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=LeVz0LlIaNDc2ID8MibhcJXmrWYJ4nRqUsKzbUx_xMA-1728976343-1.0.1.1-d8Und4TXdlKskAKfGiATISfAaaTVPUdrULr1EGcRJjFXA43IGk8QpYMsmrjziiGSLY25dQT7tt9BF9.Q4PHN6Q; path=/; expires=Tue, 15-Oct-24 07:42:23 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=49CvAmWenD6sZ0aMrbS.yQ430COQ7DekJDFBlcYqOgE-1728976343500-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e001d1b7bb9e9-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:12:22,538 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:12:22,538 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:12:22,538 - DEBUG - receive_response_body.complete
2024-10-15 10:12:22,538 - DEBUG - response_closed.started
2024-10-15 10:12:22,538 - DEBUG - response_closed.complete
2024-10-15 10:12:22,538 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Tue, 15 Oct 2024 07:12:23 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-kzzh9hik9ryjiou4ftvhondh'), ('openai-processing-ms', '742'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '10000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '9821'), ('x-ratelimit-reset-requests', '8.64s'), ('x-ratelimit-reset-tokens', '1.074s'), ('x-request-id', 'req_1faf861c990892eed48dcec7eb50457b'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=LeVz0LlIaNDc2ID8MibhcJXmrWYJ4nRqUsKzbUx_xMA-1728976343-1.0.1.1-d8Und4TXdlKskAKfGiATISfAaaTVPUdrULr1EGcRJjFXA43IGk8QpYMsmrjziiGSLY25dQT7tt9BF9.Q4PHN6Q; path=/; expires=Tue, 15-Oct-24 07:42:23 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=49CvAmWenD6sZ0aMrbS.yQ430COQ7DekJDFBlcYqOgE-1728976343500-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d2e001d1b7bb9e9-OTP'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-15 10:12:22,538 - DEBUG - request_id: req_1faf861c990892eed48dcec7eb50457b
2024-10-15 10:12:22,540 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIW18DZMOXnT96zOLa5fFh9RCDruX', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_ofNHUmxs5vayOHlHNm59WjzP', function=Function(arguments='{\n"action": "extract_pii"\n}', name='AgentAction'), type='function')]))], created=1728976342, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=10, prompt_tokens=207, total_tokens=217, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:12:22,541 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.PIIData'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}}
2024-10-15 10:12:22,541 - DEBUG - max_retries: 1
2024-10-15 10:12:22,543 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}, 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}]}}
2024-10-15 10:12:22,543 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:12:22,543 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:12:22,543 - DEBUG - send_request_headers.complete
2024-10-15 10:12:22,543 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:12:22,543 - DEBUG - send_request_body.complete
2024-10-15 10:12:22,543 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:12:25,031 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:12:25 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2331'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9998'), (b'x-ratelimit-remaining-tokens', b'9672'), (b'x-ratelimit-reset-requests', b'16.356s'), (b'x-ratelimit-reset-tokens', b'1.962s'), (b'x-request-id', b'req_3213e2d080436d3ad851cf2e695d3a91'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e0022e929b9e9-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:12:25,032 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:12:25,032 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:12:25,032 - DEBUG - receive_response_body.complete
2024-10-15 10:12:25,032 - DEBUG - response_closed.started
2024-10-15 10:12:25,032 - DEBUG - response_closed.complete
2024-10-15 10:12:25,032 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:12:25 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '2331', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9998', 'x-ratelimit-remaining-tokens': '9672', 'x-ratelimit-reset-requests': '16.356s', 'x-ratelimit-reset-tokens': '1.962s', 'x-request-id': 'req_3213e2d080436d3ad851cf2e695d3a91', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e0022e929b9e9-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:12:25,032 - DEBUG - request_id: req_3213e2d080436d3ad851cf2e695d3a91
2024-10-15 10:12:25,032 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIW19K9VDUxRJe8snqBunISc0vpF5', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_gku8rrelBiOjI1P7D9VHEcLM', function=Function(arguments='{\n"name": "ISPILANTE SENTIMENT BRUSLI",\n"address": "Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR"\n}', name='PIIData'), type='function')]))], created=1728976343, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=39, prompt_tokens=377, total_tokens=416, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:12:27,998 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.PIIData'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}}
2024-10-15 10:12:27,998 - DEBUG - max_retries: 1
2024-10-15 10:12:28,001 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}, 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}]}}
2024-10-15 10:12:28,002 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:12:28,002 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:12:28,002 - DEBUG - send_request_headers.complete
2024-10-15 10:12:28,002 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:12:28,002 - DEBUG - send_request_body.complete
2024-10-15 10:12:28,003 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:12:31,708 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:12:32 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'3556'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9997'), (b'x-ratelimit-remaining-tokens', b'9742'), (b'x-ratelimit-reset-requests', b'19.537s'), (b'x-ratelimit-reset-tokens', b'1.548s'), (b'x-request-id', b'req_64011c11cbf044885dde52479800162f'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e00450c17b9e9-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:12:31,709 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:12:31,709 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:12:31,709 - DEBUG - receive_response_body.complete
2024-10-15 10:12:31,710 - DEBUG - response_closed.started
2024-10-15 10:12:31,710 - DEBUG - response_closed.complete
2024-10-15 10:12:31,710 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:12:32 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '3556', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9997', 'x-ratelimit-remaining-tokens': '9742', 'x-ratelimit-reset-requests': '19.537s', 'x-ratelimit-reset-tokens': '1.548s', 'x-request-id': 'req_64011c11cbf044885dde52479800162f', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e00450c17b9e9-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:12:31,710 - DEBUG - request_id: req_64011c11cbf044885dde52479800162f
2024-10-15 10:12:31,711 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIW1FSEt0zpdJN23LQPDqULXDYRoy', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_PjSV1cg7gjcEeQ952Dcgy8um', function=Function(arguments='{\n"name": "ELENA VASILESCU",\n"address": "Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B"\n}', name='PIIData'), type='function')]))], created=1728976349, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=42, prompt_tokens=380, total_tokens=422, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:12:33,052 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 10:12:33,052 - DEBUG - max_retries: 1
2024-10-15 10:12:33,055 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 10:12:33,056 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:12:33,056 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:12:33,056 - DEBUG - send_request_headers.complete
2024-10-15 10:12:33,056 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:12:33,057 - DEBUG - send_request_body.complete
2024-10-15 10:12:33,057 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:12:34,101 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:12:35 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'894'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9997'), (b'x-ratelimit-remaining-tokens', b'9821'), (b'x-ratelimit-reset-requests', b'23.126s'), (b'x-ratelimit-reset-tokens', b'1.074s'), (b'x-request-id', b'req_37401caef4db1ad505278939960d9c09'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e0064ab13b9e9-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:12:34,101 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:12:34,101 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:12:34,101 - DEBUG - receive_response_body.complete
2024-10-15 10:12:34,101 - DEBUG - response_closed.started
2024-10-15 10:12:34,101 - DEBUG - response_closed.complete
2024-10-15 10:12:34,101 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:12:35 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '894', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9997', 'x-ratelimit-remaining-tokens': '9821', 'x-ratelimit-reset-requests': '23.126s', 'x-ratelimit-reset-tokens': '1.074s', 'x-request-id': 'req_37401caef4db1ad505278939960d9c09', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e0064ab13b9e9-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:12:34,101 - DEBUG - request_id: req_37401caef4db1ad505278939960d9c09
2024-10-15 10:12:34,102 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIW1K8Tr6szVcVXPKNS286eUyhZ29', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_D7bE980JUcqMeoQ9quMBgJgX', function=Function(arguments='\n{\n  "action": "identify_parties"\n}', name='AgentAction'), type='function')]))], created=1728976354, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=12, prompt_tokens=207, total_tokens=219, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:12:34,102 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.ContractParties'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Identify the buyer and seller from the given information:\n\nName: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'properties': {'buyer': {'description': 'Name of the buyer', 'title': 'Buyer', 'type': 'string'}, 'seller': {'description': 'Name of the seller', 'title': 'Seller', 'type': 'string'}}, 'required': ['buyer', 'seller'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}}
2024-10-15 10:12:34,102 - DEBUG - max_retries: 1
2024-10-15 10:12:34,104 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Identify the buyer and seller from the given information:\n\nName: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}, 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'properties': {'buyer': {'description': 'Name of the buyer', 'title': 'Buyer', 'type': 'string'}, 'seller': {'description': 'Name of the seller', 'title': 'Seller', 'type': 'string'}}, 'required': ['buyer', 'seller'], 'type': 'object'}}}]}}
2024-10-15 10:12:34,104 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:12:34,104 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:12:34,104 - DEBUG - send_request_headers.complete
2024-10-15 10:12:34,104 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:12:34,104 - DEBUG - send_request_body.complete
2024-10-15 10:12:34,105 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:12:36,601 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:12:37 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2329'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9996'), (b'x-ratelimit-remaining-tokens', b'9792'), (b'x-ratelimit-reset-requests', b'30.699s'), (b'x-ratelimit-reset-tokens', b'1.242s'), (b'x-request-id', b'req_1d6132ab2d0ee7fb57ff1cc1e00e56ec'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e006b398ab9e9-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:12:36,601 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:12:36,601 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:12:36,601 - DEBUG - receive_response_body.complete
2024-10-15 10:12:36,601 - DEBUG - response_closed.started
2024-10-15 10:12:36,601 - DEBUG - response_closed.complete
2024-10-15 10:12:36,601 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:12:37 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '2329', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9996', 'x-ratelimit-remaining-tokens': '9792', 'x-ratelimit-reset-requests': '30.699s', 'x-ratelimit-reset-tokens': '1.242s', 'x-request-id': 'req_1d6132ab2d0ee7fb57ff1cc1e00e56ec', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e006b398ab9e9-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:12:36,601 - DEBUG - request_id: req_1d6132ab2d0ee7fb57ff1cc1e00e56ec
2024-10-15 10:12:36,602 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIW1L7QhPz4GMq5CxYcLWcRf8CLCw', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_LwYZ11TpVlKDBDShOfhSIja5', function=Function(arguments='{\n  "buyer": "ELENA VASILESCU",\n  "seller": "ISPILANTE SENTIMENT BRUSLI"\n}', name='ContractParties'), type='function')]))], created=1728976355, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=30, prompt_tokens=232, total_tokens=262, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:12:36,602 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: Yes\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 10:12:36,602 - DEBUG - max_retries: 1
2024-10-15 10:12:36,604 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: Yes\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 10:12:36,604 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:12:36,604 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:12:36,605 - DEBUG - send_request_headers.complete
2024-10-15 10:12:36,605 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:12:36,605 - DEBUG - send_request_body.complete
2024-10-15 10:12:36,605 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:12:38,065 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:12:39 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1312'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9995'), (b'x-ratelimit-remaining-tokens', b'9748'), (b'x-ratelimit-reset-requests', b'36.857s'), (b'x-ratelimit-reset-tokens', b'1.507s'), (b'x-request-id', b'req_88fbad4e843273e0c327558b33bfd7fe'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e007ad984b9e9-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:12:38,065 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:12:38,065 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:12:38,065 - DEBUG - receive_response_body.complete
2024-10-15 10:12:38,065 - DEBUG - response_closed.started
2024-10-15 10:12:38,065 - DEBUG - response_closed.complete
2024-10-15 10:12:38,065 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:12:39 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1312', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9995', 'x-ratelimit-remaining-tokens': '9748', 'x-ratelimit-reset-requests': '36.857s', 'x-ratelimit-reset-tokens': '1.507s', 'x-request-id': 'req_88fbad4e843273e0c327558b33bfd7fe', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e007ad984b9e9-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:12:38,065 - DEBUG - request_id: req_88fbad4e843273e0c327558b33bfd7fe
2024-10-15 10:12:38,066 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIW1NYIFBSguZLMBQHkXjh05rzqaD', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_atRNvy5syro5L1VNLVczSurD', function=Function(arguments='{\n"action": "determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728976357, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=11, prompt_tokens=207, total_tokens=218, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:12:41,878 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.ContractDetails'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "For an Airbnb contract between ELENA VASILESCU and ISPILANTE SENTIMENT BRUSLI, who is the host (property owner) and who is the guest? Respond in JSON format with keys 'host' and 'guest'."}], 'tools': [{'type': 'function', 'function': {'name': 'ContractDetails', 'description': 'Correctly extracted `ContractDetails` with all the required parameters with correct types', 'parameters': {'properties': {'contract_type': {'description': 'Type of contract (e.g., airbnb, buy-sell, it-consulting)', 'title': 'Contract Type', 'type': 'string'}, 'additional_info': {'additionalProperties': {'type': 'string'}, 'description': 'Additional information specific to the contract type', 'title': 'Additional Info', 'type': 'object'}}, 'required': ['additional_info', 'contract_type'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'ContractDetails'}}}
2024-10-15 10:12:41,878 - DEBUG - max_retries: 1
2024-10-15 10:12:41,880 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "For an Airbnb contract between ELENA VASILESCU and ISPILANTE SENTIMENT BRUSLI, who is the host (property owner) and who is the guest? Respond in JSON format with keys 'host' and 'guest'."}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'ContractDetails'}}, 'tools': [{'type': 'function', 'function': {'name': 'ContractDetails', 'description': 'Correctly extracted `ContractDetails` with all the required parameters with correct types', 'parameters': {'properties': {'contract_type': {'description': 'Type of contract (e.g., airbnb, buy-sell, it-consulting)', 'title': 'Contract Type', 'type': 'string'}, 'additional_info': {'additionalProperties': {'type': 'string'}, 'description': 'Additional information specific to the contract type', 'title': 'Additional Info', 'type': 'object'}}, 'required': ['additional_info', 'contract_type'], 'type': 'object'}}}]}}
2024-10-15 10:12:41,880 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:12:41,880 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:12:41,881 - DEBUG - send_request_headers.complete
2024-10-15 10:12:41,881 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:12:41,881 - DEBUG - send_request_body.complete
2024-10-15 10:12:41,881 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:12:42,925 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:12:43 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'892'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9995'), (b'x-ratelimit-remaining-tokens', b'9846'), (b'x-ratelimit-reset-requests', b'40.215s'), (b'x-ratelimit-reset-tokens', b'924ms'), (b'x-request-id', b'req_87733c2cded77e356edd1e5e72dae6b9'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e009bcb0eb9e9-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:12:42,925 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:12:42,925 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:12:42,925 - DEBUG - receive_response_body.complete
2024-10-15 10:12:42,925 - DEBUG - response_closed.started
2024-10-15 10:12:42,925 - DEBUG - response_closed.complete
2024-10-15 10:12:42,926 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:12:43 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '892', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9995', 'x-ratelimit-remaining-tokens': '9846', 'x-ratelimit-reset-requests': '40.215s', 'x-ratelimit-reset-tokens': '924ms', 'x-request-id': 'req_87733c2cded77e356edd1e5e72dae6b9', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e009bcb0eb9e9-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:12:42,926 - DEBUG - request_id: req_87733c2cded77e356edd1e5e72dae6b9
2024-10-15 10:12:42,926 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIW1Tijuqa4k6SQFNjIu9aQKHe0qy', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_YbO5jOX4I7dDyUbh6B1uwQTL', function=Function(arguments='{\n  "contract_type": "airbnb"\n}', name='ContractDetails'), type='function')]))], created=1728976363, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=11, prompt_tokens=205, total_tokens=216, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:12:47,841 - DEBUG - close.started
2024-10-15 10:12:47,842 - DEBUG - close.complete
2024-10-15 10:12:47,842 - ERROR - Task exception was never retrieved
future: <Task finished name='Task-1' coro=<agent_workflow() done, defined at D:\deve\contract_automation\src\main.py:25> exception=KeyboardInterrupt()>
Traceback (most recent call last):
  File "D:\deve\contract_automation\src\main.py", line 105, in <module>
    asyncio.run(agent_workflow())
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 30, in run
    return loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 92, in run_until_complete
    self._run_once()
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 133, in _run_once
    handle._run()
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 386, in __wakeup
    self.__step()
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 293, in __step
    self.__step_run_and_handle_result(exc)
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 304, in __step_run_and_handle_result
    result = coro.send(None)
             ^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\src\main.py", line 64, in agent_workflow
    confirmation = input("Is this role assignment correct? (yes/no): ").lower()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
2024-10-15 10:16:42,755 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-15 10:16:44,004 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-15 10:16:44,005 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-15 10:16:44,328 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-15 10:16:44,328 - DEBUG - Using proactor: IocpProactor
2024-10-15 10:16:44,348 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:16:44,348 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:16:44,348 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:16:44,348 - DEBUG - Compression method 0
2024-10-15 10:16:44,349 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:16:44,349 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:16:44,349 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 10:16:44,349 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 10:16:44,349 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 10:16:44,349 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 10:16:44,349 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:16:44,349 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:16:44,349 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:16:44,349 - DEBUG - Compression method 0
2024-10-15 10:16:44,349 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:16:44,349 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:16:44,349 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 10:16:44,349 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 10:16:44,349 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 10:16:44,349 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 10:16:44,358 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:16:44,358 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:16:44,358 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 10:16:44,358 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 10:16:44,359 - DEBUG - Error closing: Operation on closed image
2024-10-15 10:16:46,470 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:16:46,470 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:16:46,470 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:16:46,470 - DEBUG - Compression method 0
2024-10-15 10:16:46,470 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:16:46,470 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:16:46,470 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 10:16:46,471 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 10:16:46,471 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 10:16:46,471 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 10:16:46,471 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:16:46,471 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:16:46,471 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:16:46,471 - DEBUG - Compression method 0
2024-10-15 10:16:46,471 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:16:46,471 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:16:46,471 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 10:16:46,471 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 10:16:46,471 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 10:16:46,471 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 10:16:46,488 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:16:46,488 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:16:46,488 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 10:16:46,488 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 10:16:46,489 - DEBUG - Error closing: Operation on closed image
2024-10-15 10:16:49,004 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 0 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 10:16:49,005 - DEBUG - max_retries: 1
2024-10-15 10:16:49,007 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 0 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 10:16:49,050 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:16:49,051 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-15 10:16:49,136 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x00000267FFD63DD0>
2024-10-15 10:16:49,136 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x00000267FFBCE7D0> server_hostname='api.openai.com' timeout=5.0
2024-10-15 10:16:49,145 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x00000267FFD63D10>
2024-10-15 10:16:49,146 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:16:49,146 - DEBUG - send_request_headers.complete
2024-10-15 10:16:49,146 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:16:49,146 - DEBUG - send_request_body.complete
2024-10-15 10:16:49,146 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:16:50,445 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:16:51 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1129'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'9821'), (b'x-ratelimit-reset-requests', b'8.64s'), (b'x-ratelimit-reset-tokens', b'1.074s'), (b'x-request-id', b'req_bd89dd0d64472da058bebdcd207408dd'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=uGrVeh0CaDwA8VYy7W3GAEUVLTxEiiyd2jAYL_x5E1c-1728976611-1.0.1.1-CRlb1YtJfawoJGGemzoCU0xM9sCEzn0n6Dn6dQTbM_SAonPKpWUAb8p2qrnsYFxD91hx8yheZrOnulGmewXDog; path=/; expires=Tue, 15-Oct-24 07:46:51 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=rF42ArDStIMn9QPFerASPuVW6FZOGO7GyQtT2xlulg0-1728976611419-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e06a54a8fca20-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:16:50,445 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:16:50,445 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:16:50,445 - DEBUG - receive_response_body.complete
2024-10-15 10:16:50,445 - DEBUG - response_closed.started
2024-10-15 10:16:50,445 - DEBUG - response_closed.complete
2024-10-15 10:16:50,446 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Tue, 15 Oct 2024 07:16:51 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-kzzh9hik9ryjiou4ftvhondh'), ('openai-processing-ms', '1129'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '10000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '9821'), ('x-ratelimit-reset-requests', '8.64s'), ('x-ratelimit-reset-tokens', '1.074s'), ('x-request-id', 'req_bd89dd0d64472da058bebdcd207408dd'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=uGrVeh0CaDwA8VYy7W3GAEUVLTxEiiyd2jAYL_x5E1c-1728976611-1.0.1.1-CRlb1YtJfawoJGGemzoCU0xM9sCEzn0n6Dn6dQTbM_SAonPKpWUAb8p2qrnsYFxD91hx8yheZrOnulGmewXDog; path=/; expires=Tue, 15-Oct-24 07:46:51 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=rF42ArDStIMn9QPFerASPuVW6FZOGO7GyQtT2xlulg0-1728976611419-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d2e06a54a8fca20-OTP'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-15 10:16:50,446 - DEBUG - request_id: req_bd89dd0d64472da058bebdcd207408dd
2024-10-15 10:16:50,448 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIW5SYiO8cI7CUZmapl1I8qmnbJgU', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_yrUCm5LjIk7Rg8qRDRAHqLOy', function=Function(arguments='\n{\n  "action": "extract_pii"\n}', name='AgentAction'), type='function')]))], created=1728976610, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=12, prompt_tokens=207, total_tokens=219, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:16:50,449 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.PIIData'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}}
2024-10-15 10:16:50,449 - DEBUG - max_retries: 1
2024-10-15 10:16:50,450 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}, 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}]}}
2024-10-15 10:16:50,450 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:16:50,450 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:16:50,451 - DEBUG - send_request_headers.complete
2024-10-15 10:16:50,451 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:16:50,451 - DEBUG - send_request_body.complete
2024-10-15 10:16:50,451 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:16:52,939 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:16:53 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2345'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9998'), (b'x-ratelimit-remaining-tokens', b'9719'), (b'x-ratelimit-reset-requests', b'15.984s'), (b'x-ratelimit-reset-tokens', b'1.684s'), (b'x-request-id', b'req_a591614bf4f0b20f3cb1cf1a704f261e'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e06ad68e4ca20-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:16:52,939 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:16:52,940 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:16:52,940 - DEBUG - receive_response_body.complete
2024-10-15 10:16:52,940 - DEBUG - response_closed.started
2024-10-15 10:16:52,940 - DEBUG - response_closed.complete
2024-10-15 10:16:52,940 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:16:53 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '2345', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9998', 'x-ratelimit-remaining-tokens': '9719', 'x-ratelimit-reset-requests': '15.984s', 'x-ratelimit-reset-tokens': '1.684s', 'x-request-id': 'req_a591614bf4f0b20f3cb1cf1a704f261e', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e06ad68e4ca20-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:16:52,940 - DEBUG - request_id: req_a591614bf4f0b20f3cb1cf1a704f261e
2024-10-15 10:16:52,940 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIW5TmwObnG8lCN7UlRomTz28CAlu', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_8dUzadWSb7CdyjX5jSb5Ij9O', function=Function(arguments='{\n"name": "ISPILANTE SENTIMENT BRUSLI",\n"address": "Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR"\n}', name='PIIData'), type='function')]))], created=1728976611, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=39, prompt_tokens=377, total_tokens=416, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:16:55,473 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.PIIData'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}}
2024-10-15 10:16:55,473 - DEBUG - max_retries: 1
2024-10-15 10:16:55,475 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}, 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}]}}
2024-10-15 10:16:55,475 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:16:55,475 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:16:55,476 - DEBUG - send_request_headers.complete
2024-10-15 10:16:55,476 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:16:55,476 - DEBUG - send_request_body.complete
2024-10-15 10:16:55,476 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:16:57,771 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:16:58 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2143'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9997'), (b'x-ratelimit-remaining-tokens', b'9742'), (b'x-ratelimit-reset-requests', b'19.594s'), (b'x-ratelimit-reset-tokens', b'1.548s'), (b'x-request-id', b'req_9bf2d9ca106a08e3771c3a51a89514c2'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e06ccdb1cca20-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:16:57,771 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:16:57,771 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:16:57,771 - DEBUG - receive_response_body.complete
2024-10-15 10:16:57,771 - DEBUG - response_closed.started
2024-10-15 10:16:57,771 - DEBUG - response_closed.complete
2024-10-15 10:16:57,771 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:16:58 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '2143', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9997', 'x-ratelimit-remaining-tokens': '9742', 'x-ratelimit-reset-requests': '19.594s', 'x-ratelimit-reset-tokens': '1.548s', 'x-request-id': 'req_9bf2d9ca106a08e3771c3a51a89514c2', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e06ccdb1cca20-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:16:57,771 - DEBUG - request_id: req_9bf2d9ca106a08e3771c3a51a89514c2
2024-10-15 10:16:57,772 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIW5Y77UlOkKGuJT4wp4iYcFxRCjm', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_bI6oM6ejxn6ly8BhZSD5qvGQ', function=Function(arguments='{\n"name": "VASILESCU ELENA",\n"address": "Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3"\n}', name='PIIData'), type='function')]))], created=1728976616, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=38, prompt_tokens=380, total_tokens=418, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:16:59,172 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 10:16:59,172 - DEBUG - max_retries: 1
2024-10-15 10:16:59,174 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 10:16:59,174 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:16:59,174 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:16:59,174 - DEBUG - send_request_headers.complete
2024-10-15 10:16:59,174 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:16:59,174 - DEBUG - send_request_body.complete
2024-10-15 10:16:59,175 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:17:00,272 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:17:01 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'946'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9997'), (b'x-ratelimit-remaining-tokens', b'9821'), (b'x-ratelimit-reset-requests', b'24.538s'), (b'x-ratelimit-reset-tokens', b'1.074s'), (b'x-request-id', b'req_8d9c39eec9b7aa0e78e349a05d0758b4'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e06e3fc9aca20-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:17:00,272 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:17:00,272 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:17:00,272 - DEBUG - receive_response_body.complete
2024-10-15 10:17:00,272 - DEBUG - response_closed.started
2024-10-15 10:17:00,272 - DEBUG - response_closed.complete
2024-10-15 10:17:00,272 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:17:01 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '946', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9997', 'x-ratelimit-remaining-tokens': '9821', 'x-ratelimit-reset-requests': '24.538s', 'x-ratelimit-reset-tokens': '1.074s', 'x-request-id': 'req_8d9c39eec9b7aa0e78e349a05d0758b4', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e06e3fc9aca20-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:17:00,272 - DEBUG - request_id: req_8d9c39eec9b7aa0e78e349a05d0758b4
2024-10-15 10:17:00,273 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIW5cLDLHL2768IJPxd8J2yVtl7Ve', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_dzd0FxOZy4f6Fb6IIaG2uW6W', function=Function(arguments='\n{\n  "action": "identify_parties"\n}', name='AgentAction'), type='function')]))], created=1728976620, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=12, prompt_tokens=207, total_tokens=219, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:17:00,273 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.ContractParties'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Identify the buyer and seller from the given information:\n\nName: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: VASILESCU ELENA, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3'}], 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'properties': {'buyer': {'description': 'Name of the buyer', 'title': 'Buyer', 'type': 'string'}, 'seller': {'description': 'Name of the seller', 'title': 'Seller', 'type': 'string'}}, 'required': ['buyer', 'seller'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}}
2024-10-15 10:17:00,274 - DEBUG - max_retries: 1
2024-10-15 10:17:00,275 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Identify the buyer and seller from the given information:\n\nName: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: VASILESCU ELENA, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}, 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'properties': {'buyer': {'description': 'Name of the buyer', 'title': 'Buyer', 'type': 'string'}, 'seller': {'description': 'Name of the seller', 'title': 'Seller', 'type': 'string'}}, 'required': ['buyer', 'seller'], 'type': 'object'}}}]}}
2024-10-15 10:17:00,275 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:17:00,275 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:17:00,275 - DEBUG - send_request_headers.complete
2024-10-15 10:17:00,275 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:17:00,276 - DEBUG - send_request_body.complete
2024-10-15 10:17:00,276 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:17:01,919 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:17:02 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1497'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9996'), (b'x-ratelimit-remaining-tokens', b'9799'), (b'x-ratelimit-reset-requests', b'32.075s'), (b'x-ratelimit-reset-tokens', b'1.2s'), (b'x-request-id', b'req_00db35d5178af84b320664ebd29c772e'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e06eadf34ca20-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:17:01,919 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:17:01,919 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:17:01,919 - DEBUG - receive_response_body.complete
2024-10-15 10:17:01,919 - DEBUG - response_closed.started
2024-10-15 10:17:01,919 - DEBUG - response_closed.complete
2024-10-15 10:17:01,919 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:17:02 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1497', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9996', 'x-ratelimit-remaining-tokens': '9799', 'x-ratelimit-reset-requests': '32.075s', 'x-ratelimit-reset-tokens': '1.2s', 'x-request-id': 'req_00db35d5178af84b320664ebd29c772e', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e06eadf34ca20-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:17:01,919 - DEBUG - request_id: req_00db35d5178af84b320664ebd29c772e
2024-10-15 10:17:01,920 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIW5dhSRh6RyhcKMTCBagFGmCtTcu', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_qn1GqP5DtIQiNK9f8s5PqgSm', function=Function(arguments='{\n"buyer": "ISPILANTE SENTIMENT BRUSLI",\n"seller": "VASILESCU ELENA"\n}', name='ContractParties'), type='function')]))], created=1728976621, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=27, prompt_tokens=229, total_tokens=256, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:17:01,920 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: Yes\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 10:17:01,921 - DEBUG - max_retries: 1
2024-10-15 10:17:01,922 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: Yes\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 10:17:01,922 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:17:01,923 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:17:01,923 - DEBUG - send_request_headers.complete
2024-10-15 10:17:01,923 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:17:01,923 - DEBUG - send_request_body.complete
2024-10-15 10:17:01,923 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:17:03,255 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:17:04 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1185'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9995'), (b'x-ratelimit-remaining-tokens', b'9752'), (b'x-ratelimit-reset-requests', b'39.07s'), (b'x-ratelimit-reset-tokens', b'1.482s'), (b'x-request-id', b'req_02953b51eab55b6ba44499962d629df2'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e06f52c08ca20-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:17:03,256 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:17:03,256 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:17:03,256 - DEBUG - receive_response_body.complete
2024-10-15 10:17:03,256 - DEBUG - response_closed.started
2024-10-15 10:17:03,256 - DEBUG - response_closed.complete
2024-10-15 10:17:03,256 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:17:04 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1185', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9995', 'x-ratelimit-remaining-tokens': '9752', 'x-ratelimit-reset-requests': '39.07s', 'x-ratelimit-reset-tokens': '1.482s', 'x-request-id': 'req_02953b51eab55b6ba44499962d629df2', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e06f52c08ca20-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:17:03,256 - DEBUG - request_id: req_02953b51eab55b6ba44499962d629df2
2024-10-15 10:17:03,257 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIW5fBOWVDzt1pUtRRz3j5K2lyyEQ', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_k3dC6XI4n75yLrvI7O3obKaf', function=Function(arguments='\n{\n  "action": "determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728976623, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=13, prompt_tokens=207, total_tokens=220, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:17:07,615 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.ContractDetails'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "For an Airbnb contract between ISPILANTE SENTIMENT BRUSLI and VASILESCU ELENA, who is the host (property owner) and who is the guest? Would you like to assign yourself a role in this contract? Respond in JSON format with keys 'host' and 'guest'."}], 'tools': [{'type': 'function', 'function': {'name': 'ContractDetails', 'description': 'Correctly extracted `ContractDetails` with all the required parameters with correct types', 'parameters': {'properties': {'contract_type': {'description': 'Type of contract (e.g., airbnb, buy-sell, it-consulting)', 'title': 'Contract Type', 'type': 'string'}, 'additional_info': {'additionalProperties': {'type': 'string'}, 'description': 'Additional information specific to the contract type', 'title': 'Additional Info', 'type': 'object'}}, 'required': ['additional_info', 'contract_type'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'ContractDetails'}}}
2024-10-15 10:17:07,616 - DEBUG - max_retries: 1
2024-10-15 10:17:07,618 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "For an Airbnb contract between ISPILANTE SENTIMENT BRUSLI and VASILESCU ELENA, who is the host (property owner) and who is the guest? Would you like to assign yourself a role in this contract? Respond in JSON format with keys 'host' and 'guest'."}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'ContractDetails'}}, 'tools': [{'type': 'function', 'function': {'name': 'ContractDetails', 'description': 'Correctly extracted `ContractDetails` with all the required parameters with correct types', 'parameters': {'properties': {'contract_type': {'description': 'Type of contract (e.g., airbnb, buy-sell, it-consulting)', 'title': 'Contract Type', 'type': 'string'}, 'additional_info': {'additionalProperties': {'type': 'string'}, 'description': 'Additional information specific to the contract type', 'title': 'Additional Info', 'type': 'object'}}, 'required': ['additional_info', 'contract_type'], 'type': 'object'}}}]}}
2024-10-15 10:17:07,619 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:17:07,619 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:17:07,620 - DEBUG - send_request_headers.complete
2024-10-15 10:17:07,620 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:17:07,620 - DEBUG - send_request_body.complete
2024-10-15 10:17:07,620 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:17:08,635 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:17:09 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'873'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9995'), (b'x-ratelimit-remaining-tokens', b'9831'), (b'x-ratelimit-reset-requests', b'42.014s'), (b'x-ratelimit-reset-tokens', b'1.014s'), (b'x-request-id', b'req_7a04461733f2a164c36b5174be57b343'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e0718bd8bca20-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:17:08,636 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:17:08,636 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:17:08,636 - DEBUG - receive_response_body.complete
2024-10-15 10:17:08,636 - DEBUG - response_closed.started
2024-10-15 10:17:08,636 - DEBUG - response_closed.complete
2024-10-15 10:17:08,636 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:17:09 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '873', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9995', 'x-ratelimit-remaining-tokens': '9831', 'x-ratelimit-reset-requests': '42.014s', 'x-ratelimit-reset-tokens': '1.014s', 'x-request-id': 'req_7a04461733f2a164c36b5174be57b343', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e0718bd8bca20-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:17:08,636 - DEBUG - request_id: req_7a04461733f2a164c36b5174be57b343
2024-10-15 10:17:08,637 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIW5k9S7Zu0j38mKNhw7SOgCeeLIy', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_uSro3Ayhb2fzLf6KWGobXh4R', function=Function(arguments='{\n  "contract_type": "airbnb"\n}', name='ContractDetails'), type='function')]))], created=1728976628, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=11, prompt_tokens=217, total_tokens=228, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:17:18,058 - DEBUG - close.started
2024-10-15 10:17:18,059 - DEBUG - close.complete
2024-10-15 10:17:18,059 - ERROR - Task exception was never retrieved
future: <Task finished name='Task-1' coro=<agent_workflow() done, defined at D:\deve\contract_automation\src\main.py:25> exception=KeyboardInterrupt()>
Traceback (most recent call last):
  File "D:\deve\contract_automation\src\main.py", line 105, in <module>
    asyncio.run(agent_workflow())
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 30, in run
    return loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 92, in run_until_complete
    self._run_once()
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 133, in _run_once
    handle._run()
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 386, in __wakeup
    self.__step()
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 293, in __step
    self.__step_run_and_handle_result(exc)
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 304, in __step_run_and_handle_result
    result = coro.send(None)
             ^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\src\main.py", line 64, in agent_workflow
    confirmation = input("Is this role assignment correct? (yes/no): ").lower()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
2024-10-15 10:17:22,998 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-15 10:17:24,247 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-15 10:17:24,248 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-15 10:17:24,570 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-15 10:17:24,570 - DEBUG - Using proactor: IocpProactor
2024-10-15 10:17:24,592 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:17:24,592 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:17:24,592 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:17:24,592 - DEBUG - Compression method 0
2024-10-15 10:17:24,593 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:17:24,593 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:17:24,593 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 10:17:24,593 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 10:17:24,593 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 10:17:24,593 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 10:17:24,593 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:17:24,593 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:17:24,593 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:17:24,593 - DEBUG - Compression method 0
2024-10-15 10:17:24,594 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:17:24,594 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:17:24,594 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 10:17:24,594 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 10:17:24,594 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 10:17:24,594 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 10:17:24,605 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:17:24,605 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:17:24,605 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 10:17:24,605 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 10:17:24,606 - DEBUG - Error closing: Operation on closed image
2024-10-15 10:17:26,691 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:17:26,691 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:17:26,692 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:17:26,692 - DEBUG - Compression method 0
2024-10-15 10:17:26,692 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:17:26,692 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:17:26,692 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 10:17:26,692 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 10:17:26,692 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 10:17:26,692 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 10:17:26,692 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:17:26,692 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:17:26,692 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:17:26,692 - DEBUG - Compression method 0
2024-10-15 10:17:26,692 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:17:26,692 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:17:26,692 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 10:17:26,692 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 10:17:26,692 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 10:17:26,692 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 10:17:26,709 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:17:26,709 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:17:26,709 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 10:17:26,709 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 10:17:26,710 - DEBUG - Error closing: Operation on closed image
2024-10-15 10:17:29,247 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 0 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 10:17:29,248 - DEBUG - max_retries: 1
2024-10-15 10:17:29,250 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 0 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 10:17:29,287 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:17:29,287 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-15 10:17:29,313 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x00000297FF866F60>
2024-10-15 10:17:29,313 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x00000297FF76E7D0> server_hostname='api.openai.com' timeout=5.0
2024-10-15 10:17:29,321 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x00000297FF903B30>
2024-10-15 10:17:29,321 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:17:29,321 - DEBUG - send_request_headers.complete
2024-10-15 10:17:29,321 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:17:29,322 - DEBUG - send_request_body.complete
2024-10-15 10:17:29,322 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:17:30,520 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:17:31 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1047'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9996'), (b'x-ratelimit-remaining-tokens', b'9821'), (b'x-ratelimit-reset-requests', b'28.943s'), (b'x-ratelimit-reset-tokens', b'1.074s'), (b'x-request-id', b'req_e09b0384dffa910bbc6363b3bee08f7b'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=rydEj2GQKjbYDTmViMUtl1lm0jWwlX0csyu76J3DewU-1728976651-1.0.1.1-K3HQr0bvOdgZhecEnRFs.vH7QhZy075YuI_U_cJWbwwgXB7aSj9OUY1u.8e_woycH3.jbF.tfBGLYPXIsXedVw; path=/; expires=Tue, 15-Oct-24 07:47:31 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=VepnojqgQp7h6qIBfxjVy9SlnqjSPsHq8HvNTQo7wtQ-1728976651496-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e07a06855e0c5-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:17:30,521 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:17:30,521 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:17:30,521 - DEBUG - receive_response_body.complete
2024-10-15 10:17:30,523 - DEBUG - response_closed.started
2024-10-15 10:17:30,523 - DEBUG - response_closed.complete
2024-10-15 10:17:30,523 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Tue, 15 Oct 2024 07:17:31 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-kzzh9hik9ryjiou4ftvhondh'), ('openai-processing-ms', '1047'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '10000'), ('x-ratelimit-remaining-requests', '9996'), ('x-ratelimit-remaining-tokens', '9821'), ('x-ratelimit-reset-requests', '28.943s'), ('x-ratelimit-reset-tokens', '1.074s'), ('x-request-id', 'req_e09b0384dffa910bbc6363b3bee08f7b'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=rydEj2GQKjbYDTmViMUtl1lm0jWwlX0csyu76J3DewU-1728976651-1.0.1.1-K3HQr0bvOdgZhecEnRFs.vH7QhZy075YuI_U_cJWbwwgXB7aSj9OUY1u.8e_woycH3.jbF.tfBGLYPXIsXedVw; path=/; expires=Tue, 15-Oct-24 07:47:31 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=VepnojqgQp7h6qIBfxjVy9SlnqjSPsHq8HvNTQo7wtQ-1728976651496-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d2e07a06855e0c5-OTP'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-15 10:17:30,523 - DEBUG - request_id: req_e09b0384dffa910bbc6363b3bee08f7b
2024-10-15 10:17:30,525 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIW66JLgNJ0mDPSafb9G8vlupaTuo', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_xhdlq1E6Z2eKuc4EvnV0YKNe', function=Function(arguments='\n{\n  "action": "extract_pii"\n}', name='AgentAction'), type='function')]))], created=1728976650, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=12, prompt_tokens=207, total_tokens=219, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:17:30,526 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.PIIData'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}}
2024-10-15 10:17:30,526 - DEBUG - max_retries: 1
2024-10-15 10:17:30,527 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}, 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}]}}
2024-10-15 10:17:30,527 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:17:30,528 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:17:30,528 - DEBUG - send_request_headers.complete
2024-10-15 10:17:30,528 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:17:30,528 - DEBUG - send_request_body.complete
2024-10-15 10:17:30,528 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:17:32,995 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:17:33 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2319'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9995'), (b'x-ratelimit-remaining-tokens', b'9716'), (b'x-ratelimit-reset-requests', b'36.384s'), (b'x-ratelimit-reset-tokens', b'1.699s'), (b'x-request-id', b'req_b5796c2ada8f4217e4f8b7784c360063'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e07a7ec56e0c5-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:17:32,996 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:17:32,997 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:17:32,997 - DEBUG - receive_response_body.complete
2024-10-15 10:17:32,997 - DEBUG - response_closed.started
2024-10-15 10:17:32,998 - DEBUG - response_closed.complete
2024-10-15 10:17:32,998 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:17:33 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '2319', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9995', 'x-ratelimit-remaining-tokens': '9716', 'x-ratelimit-reset-requests': '36.384s', 'x-ratelimit-reset-tokens': '1.699s', 'x-request-id': 'req_b5796c2ada8f4217e4f8b7784c360063', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e07a7ec56e0c5-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:17:32,998 - DEBUG - request_id: req_b5796c2ada8f4217e4f8b7784c360063
2024-10-15 10:17:32,999 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIW67XuMXRE7BHvTmBFMJ3irivzjC', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_Y5k4jwZMX1heOUtOL6oHlAb6', function=Function(arguments='{\n"name": "ISPILANTE SENTIMENT BRUSLI",\n"address": "Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR"\n}', name='PIIData'), type='function')]))], created=1728976651, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=39, prompt_tokens=377, total_tokens=416, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:17:35,960 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.PIIData'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}}
2024-10-15 10:17:35,960 - DEBUG - max_retries: 1
2024-10-15 10:17:35,962 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}, 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}]}}
2024-10-15 10:17:35,962 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:17:35,962 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:17:35,962 - DEBUG - send_request_headers.complete
2024-10-15 10:17:35,962 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:17:35,962 - DEBUG - send_request_body.complete
2024-10-15 10:17:35,962 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:17:38,804 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:17:39 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2689'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9995'), (b'x-ratelimit-remaining-tokens', b'9742'), (b'x-ratelimit-reset-requests', b'39.584s'), (b'x-ratelimit-reset-tokens', b'1.548s'), (b'x-request-id', b'req_0e5a847b96400c05249f1a3cd0ed0ade'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e07c9e80ae0c5-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:17:38,805 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:17:38,805 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:17:38,805 - DEBUG - receive_response_body.complete
2024-10-15 10:17:38,805 - DEBUG - response_closed.started
2024-10-15 10:17:38,805 - DEBUG - response_closed.complete
2024-10-15 10:17:38,805 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:17:39 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '2689', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9995', 'x-ratelimit-remaining-tokens': '9742', 'x-ratelimit-reset-requests': '39.584s', 'x-ratelimit-reset-tokens': '1.548s', 'x-request-id': 'req_0e5a847b96400c05249f1a3cd0ed0ade', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e07c9e80ae0c5-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:17:38,805 - DEBUG - request_id: req_0e5a847b96400c05249f1a3cd0ed0ade
2024-10-15 10:17:38,806 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIW6DwfhHpbV2t19ZK6XxYIVF4efp', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_067R8FHHk4bDy5iedLoZfoph', function=Function(arguments='{\n"name": "ELENA VASILESCU",\n"address": "Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B"\n}', name='PIIData'), type='function')]))], created=1728976657, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=42, prompt_tokens=380, total_tokens=422, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:17:39,785 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 10:17:39,785 - DEBUG - max_retries: 1
2024-10-15 10:17:39,788 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 10:17:39,788 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:17:39,788 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:17:39,789 - DEBUG - send_request_headers.complete
2024-10-15 10:17:39,789 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:17:39,789 - DEBUG - send_request_body.complete
2024-10-15 10:17:39,789 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:17:44,495 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:17:45 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'4542'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9994'), (b'x-ratelimit-remaining-tokens', b'9821'), (b'x-ratelimit-reset-requests', b'44.4s'), (b'x-ratelimit-reset-tokens', b'1.074s'), (b'x-request-id', b'req_c8c46f42358b98951ba4954fc93409b4'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e07e1cbf6e0c5-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:17:44,496 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:17:44,497 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:17:44,497 - DEBUG - receive_response_body.complete
2024-10-15 10:17:44,497 - DEBUG - response_closed.started
2024-10-15 10:17:44,497 - DEBUG - response_closed.complete
2024-10-15 10:17:44,497 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:17:45 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '4542', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9994', 'x-ratelimit-remaining-tokens': '9821', 'x-ratelimit-reset-requests': '44.4s', 'x-ratelimit-reset-tokens': '1.074s', 'x-request-id': 'req_c8c46f42358b98951ba4954fc93409b4', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e07e1cbf6e0c5-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:17:44,497 - DEBUG - request_id: req_c8c46f42358b98951ba4954fc93409b4
2024-10-15 10:17:44,498 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIW6Gk8Ooh5G7IdRqUU0z1YcuB4OX', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_7lhEokHUCTp68DGfH6vh9cOG', function=Function(arguments='\n{\n"action": "identify_parties"\n}', name='AgentAction'), type='function')]))], created=1728976660, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=11, prompt_tokens=207, total_tokens=218, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:17:44,498 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.ContractParties'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Identify the buyer and seller from the given information:\n\nName: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'properties': {'buyer': {'description': 'Name of the buyer', 'title': 'Buyer', 'type': 'string'}, 'seller': {'description': 'Name of the seller', 'title': 'Seller', 'type': 'string'}}, 'required': ['buyer', 'seller'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}}
2024-10-15 10:17:44,498 - DEBUG - max_retries: 1
2024-10-15 10:17:44,500 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Identify the buyer and seller from the given information:\n\nName: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}, 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'properties': {'buyer': {'description': 'Name of the buyer', 'title': 'Buyer', 'type': 'string'}, 'seller': {'description': 'Name of the seller', 'title': 'Seller', 'type': 'string'}}, 'required': ['buyer', 'seller'], 'type': 'object'}}}]}}
2024-10-15 10:17:44,500 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:17:44,500 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:17:44,500 - DEBUG - send_request_headers.complete
2024-10-15 10:17:44,500 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:17:44,500 - DEBUG - send_request_body.complete
2024-10-15 10:17:44,500 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:17:46,714 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:17:47 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2060'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9994'), (b'x-ratelimit-remaining-tokens', b'9818'), (b'x-ratelimit-reset-requests', b'48.333s'), (b'x-ratelimit-reset-tokens', b'1.091s'), (b'x-request-id', b'req_260a7e1d047b2ca972083b7597e28859'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e07ff4d35e0c5-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:17:46,714 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:17:46,714 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:17:46,714 - DEBUG - receive_response_body.complete
2024-10-15 10:17:46,714 - DEBUG - response_closed.started
2024-10-15 10:17:46,714 - DEBUG - response_closed.complete
2024-10-15 10:17:46,715 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:17:47 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '2060', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9994', 'x-ratelimit-remaining-tokens': '9818', 'x-ratelimit-reset-requests': '48.333s', 'x-ratelimit-reset-tokens': '1.091s', 'x-request-id': 'req_260a7e1d047b2ca972083b7597e28859', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e07ff4d35e0c5-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:17:46,715 - DEBUG - request_id: req_260a7e1d047b2ca972083b7597e28859
2024-10-15 10:17:46,715 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIW6LZHbopqCARbpvUhbSIkpnHhiI', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_EkP1RWlMYEpg9tcZBg7vemUc', function=Function(arguments='{\n  "buyer": "ISPILANTE SENTIMENT BRUSLI",\n  "seller": "ELENA VASILESCU"\n}', name='ContractParties'), type='function')]))], created=1728976665, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=30, prompt_tokens=232, total_tokens=262, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:17:46,716 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: Yes\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 10:17:46,716 - DEBUG - max_retries: 1
2024-10-15 10:17:46,717 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: Yes\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 10:17:46,718 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:17:46,718 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:17:46,718 - DEBUG - send_request_headers.complete
2024-10-15 10:17:46,718 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:17:46,718 - DEBUG - send_request_body.complete
2024-10-15 10:17:46,718 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:17:47,907 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:17:48 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1045'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9993'), (b'x-ratelimit-remaining-tokens', b'9749'), (b'x-ratelimit-reset-requests', b'54.755s'), (b'x-ratelimit-reset-tokens', b'1.502s'), (b'x-request-id', b'req_b816eb8a8a5bc459f0c32daad1920765'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e080d1989e0c5-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:17:47,907 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:17:47,907 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:17:47,907 - DEBUG - receive_response_body.complete
2024-10-15 10:17:47,907 - DEBUG - response_closed.started
2024-10-15 10:17:47,908 - DEBUG - response_closed.complete
2024-10-15 10:17:47,908 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:17:48 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1045', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9993', 'x-ratelimit-remaining-tokens': '9749', 'x-ratelimit-reset-requests': '54.755s', 'x-ratelimit-reset-tokens': '1.502s', 'x-request-id': 'req_b816eb8a8a5bc459f0c32daad1920765', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e080d1989e0c5-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:17:47,908 - DEBUG - request_id: req_b816eb8a8a5bc459f0c32daad1920765
2024-10-15 10:17:47,908 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIW6NLjP7fbjuyHQadYBXDUjZFgUZ', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_tFYNZHmd0Ldj79P0YVkAN2x0', function=Function(arguments='\n{\n"action": "determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728976667, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=12, prompt_tokens=207, total_tokens=219, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:17:52,427 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.ContractDetails'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "For an Airbnb contract between ISPILANTE SENTIMENT BRUSLI and ELENA VASILESCU, who is the host (property owner) and who is the guest? Would you like to assign yourself a role in this contract? Respond in JSON format with keys 'host' and 'guest'."}], 'tools': [{'type': 'function', 'function': {'name': 'ContractDetails', 'description': 'Correctly extracted `ContractDetails` with all the required parameters with correct types', 'parameters': {'properties': {'contract_type': {'description': 'Type of contract (e.g., airbnb, buy-sell, it-consulting)', 'title': 'Contract Type', 'type': 'string'}, 'additional_info': {'additionalProperties': {'type': 'string'}, 'description': 'Additional information specific to the contract type', 'title': 'Additional Info', 'type': 'object'}}, 'required': ['additional_info', 'contract_type'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'ContractDetails'}}}
2024-10-15 10:17:52,427 - DEBUG - max_retries: 1
2024-10-15 10:17:52,430 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "For an Airbnb contract between ISPILANTE SENTIMENT BRUSLI and ELENA VASILESCU, who is the host (property owner) and who is the guest? Would you like to assign yourself a role in this contract? Respond in JSON format with keys 'host' and 'guest'."}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'ContractDetails'}}, 'tools': [{'type': 'function', 'function': {'name': 'ContractDetails', 'description': 'Correctly extracted `ContractDetails` with all the required parameters with correct types', 'parameters': {'properties': {'contract_type': {'description': 'Type of contract (e.g., airbnb, buy-sell, it-consulting)', 'title': 'Contract Type', 'type': 'string'}, 'additional_info': {'additionalProperties': {'type': 'string'}, 'description': 'Additional information specific to the contract type', 'title': 'Additional Info', 'type': 'object'}}, 'required': ['additional_info', 'contract_type'], 'type': 'object'}}}]}}
2024-10-15 10:17:52,430 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:17:52,430 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:17:52,431 - DEBUG - send_request_headers.complete
2024-10-15 10:17:52,431 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:17:52,431 - DEBUG - send_request_body.complete
2024-10-15 10:17:52,431 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:17:53,499 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:17:54 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'902'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9993'), (b'x-ratelimit-remaining-tokens', b'9831'), (b'x-ratelimit-reset-requests', b'57.665s'), (b'x-ratelimit-reset-tokens', b'1.014s'), (b'x-request-id', b'req_25c7e6f0abbc02ed218b8256c5190c76'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e0830dae4e0c5-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:17:53,499 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:17:53,499 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:17:53,499 - DEBUG - receive_response_body.complete
2024-10-15 10:17:53,499 - DEBUG - response_closed.started
2024-10-15 10:17:53,499 - DEBUG - response_closed.complete
2024-10-15 10:17:53,500 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:17:54 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '902', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9993', 'x-ratelimit-remaining-tokens': '9831', 'x-ratelimit-reset-requests': '57.665s', 'x-ratelimit-reset-tokens': '1.014s', 'x-request-id': 'req_25c7e6f0abbc02ed218b8256c5190c76', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e0830dae4e0c5-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:17:53,500 - DEBUG - request_id: req_25c7e6f0abbc02ed218b8256c5190c76
2024-10-15 10:17:53,500 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIW6THABY6B1vjj3B1b4NQPweyICn', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_gPvqHpzaRGhvcmoRxF9zHOby', function=Function(arguments='{\n"contract_type": "airbnb"\n}', name='ContractDetails'), type='function')]))], created=1728976673, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=10, prompt_tokens=217, total_tokens=227, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:18:03,226 - DEBUG - close.started
2024-10-15 10:18:03,226 - DEBUG - close.complete
2024-10-15 10:18:03,226 - ERROR - Task exception was never retrieved
future: <Task finished name='Task-1' coro=<agent_workflow() done, defined at D:\deve\contract_automation\src\main.py:25> exception=KeyboardInterrupt()>
Traceback (most recent call last):
  File "D:\deve\contract_automation\src\main.py", line 105, in <module>
    asyncio.run(agent_workflow())
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 30, in run
    return loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 92, in run_until_complete
    self._run_once()
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 133, in _run_once
    handle._run()
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 386, in __wakeup
    self.__step()
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 293, in __step
    self.__step_run_and_handle_result(exc)
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 304, in __step_run_and_handle_result
    result = coro.send(None)
             ^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\src\main.py", line 64, in agent_workflow
    confirmation = input("Is this role assignment correct? (yes/no): ").lower()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
2024-10-15 10:22:52,775 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-15 10:22:54,021 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-15 10:22:54,021 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-15 10:22:54,341 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-15 10:22:54,342 - DEBUG - Using proactor: IocpProactor
2024-10-15 10:22:54,367 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:22:54,367 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:22:54,367 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:22:54,368 - DEBUG - Compression method 0
2024-10-15 10:22:54,368 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:22:54,368 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:22:54,368 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 10:22:54,368 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 10:22:54,368 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 10:22:54,368 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 10:22:54,368 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:22:54,368 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:22:54,368 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:22:54,368 - DEBUG - Compression method 0
2024-10-15 10:22:54,368 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:22:54,368 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:22:54,368 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 10:22:54,368 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 10:22:54,368 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 10:22:54,368 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 10:22:54,380 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:22:54,380 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:22:54,380 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 10:22:54,380 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 10:22:54,381 - DEBUG - Error closing: Operation on closed image
2024-10-15 10:22:56,372 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:22:56,372 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:22:56,372 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:22:56,372 - DEBUG - Compression method 0
2024-10-15 10:22:56,372 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:22:56,372 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:22:56,373 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 10:22:56,373 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 10:22:56,373 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 10:22:56,373 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 10:22:56,373 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:22:56,373 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:22:56,373 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:22:56,373 - DEBUG - Compression method 0
2024-10-15 10:22:56,373 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:22:56,373 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:22:56,373 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 10:22:56,373 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 10:22:56,373 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 10:22:56,373 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 10:22:56,390 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:22:56,390 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:22:56,390 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 10:22:56,390 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 10:22:56,391 - DEBUG - Error closing: Operation on closed image
2024-10-15 10:22:58,900 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 0 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 10:22:58,900 - DEBUG - max_retries: 1
2024-10-15 10:22:58,902 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 0 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 10:22:58,947 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:22:58,947 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-15 10:22:59,033 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000002143CB33DD0>
2024-10-15 10:22:59,033 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x000002143C99E7D0> server_hostname='api.openai.com' timeout=5.0
2024-10-15 10:22:59,040 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000002143CB33CE0>
2024-10-15 10:22:59,040 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:22:59,040 - DEBUG - send_request_headers.complete
2024-10-15 10:22:59,040 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:22:59,040 - DEBUG - send_request_body.complete
2024-10-15 10:22:59,040 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:23:00,610 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:23:01 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1420'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'9821'), (b'x-ratelimit-reset-requests', b'8.64s'), (b'x-ratelimit-reset-tokens', b'1.074s'), (b'x-request-id', b'req_da596944b1161c6872f3aa43c5a14be5'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=ZGvAW_cpePTgImofcbRXEWvewhoR6svLB4VzkkpaVoY-1728976981-1.0.1.1-vVj1w4gNCHstOZPDlIabPdcnVWcYRNxuwUDP6aQhzGCBZXurCroKzghmPDS0mLyistk5qW5y7k3Nuc__i.ybgA; path=/; expires=Tue, 15-Oct-24 07:53:01 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=Hs3aorYl4GmFf4O_Kgz1nM3IEN1563O72d.MHmsIe00-1728976981600-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e0fad3b54ca20-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:23:00,611 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:23:00,611 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:23:00,612 - DEBUG - receive_response_body.complete
2024-10-15 10:23:00,612 - DEBUG - response_closed.started
2024-10-15 10:23:00,612 - DEBUG - response_closed.complete
2024-10-15 10:23:00,612 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Tue, 15 Oct 2024 07:23:01 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-kzzh9hik9ryjiou4ftvhondh'), ('openai-processing-ms', '1420'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '10000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '9821'), ('x-ratelimit-reset-requests', '8.64s'), ('x-ratelimit-reset-tokens', '1.074s'), ('x-request-id', 'req_da596944b1161c6872f3aa43c5a14be5'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=ZGvAW_cpePTgImofcbRXEWvewhoR6svLB4VzkkpaVoY-1728976981-1.0.1.1-vVj1w4gNCHstOZPDlIabPdcnVWcYRNxuwUDP6aQhzGCBZXurCroKzghmPDS0mLyistk5qW5y7k3Nuc__i.ybgA; path=/; expires=Tue, 15-Oct-24 07:53:01 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=Hs3aorYl4GmFf4O_Kgz1nM3IEN1563O72d.MHmsIe00-1728976981600-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d2e0fad3b54ca20-OTP'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-15 10:23:00,612 - DEBUG - request_id: req_da596944b1161c6872f3aa43c5a14be5
2024-10-15 10:23:00,614 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWBQWBqRcd2vikQASXOjHdd8KaCr', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_YieN2sp8kZIXD3Y2O9wDmQ7C', function=Function(arguments='{\n"action": "extract_pii"\n}', name='AgentAction'), type='function')]))], created=1728976980, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=10, prompt_tokens=207, total_tokens=217, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:23:00,615 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.PIIData'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}}
2024-10-15 10:23:00,615 - DEBUG - max_retries: 1
2024-10-15 10:23:00,617 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}, 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}]}}
2024-10-15 10:23:00,617 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:23:00,617 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:23:00,618 - DEBUG - send_request_headers.complete
2024-10-15 10:23:00,618 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:23:00,618 - DEBUG - send_request_body.complete
2024-10-15 10:23:00,618 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:23:03,180 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:23:04 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2408'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9998'), (b'x-ratelimit-remaining-tokens', b'9723'), (b'x-ratelimit-reset-requests', b'15.695s'), (b'x-ratelimit-reset-tokens', b'1.66s'), (b'x-request-id', b'req_baa30b37a6ffd12873cbb9cf9ec5c048'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e0fb71ce5ca20-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:23:03,180 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:23:03,180 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:23:03,181 - DEBUG - receive_response_body.complete
2024-10-15 10:23:03,181 - DEBUG - response_closed.started
2024-10-15 10:23:03,181 - DEBUG - response_closed.complete
2024-10-15 10:23:03,181 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:23:04 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '2408', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9998', 'x-ratelimit-remaining-tokens': '9723', 'x-ratelimit-reset-requests': '15.695s', 'x-ratelimit-reset-tokens': '1.66s', 'x-request-id': 'req_baa30b37a6ffd12873cbb9cf9ec5c048', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e0fb71ce5ca20-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:23:03,181 - DEBUG - request_id: req_baa30b37a6ffd12873cbb9cf9ec5c048
2024-10-15 10:23:03,181 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWBR2b92WCtjPHAq7Mj63KSnnuAT', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_yltmkZZT2jcNAfbJ8dr0dNzl', function=Function(arguments='{\n"name": "SENTIMENT BRUSLI",\n"address": "Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR"\n}', name='PIIData'), type='function')]))], created=1728976981, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=36, prompt_tokens=377, total_tokens=413, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:23:08,264 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.PIIData'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}}
2024-10-15 10:23:08,264 - DEBUG - max_retries: 1
2024-10-15 10:23:08,267 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}, 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}]}}
2024-10-15 10:23:08,267 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:23:08,267 - DEBUG - close.started
2024-10-15 10:23:08,268 - DEBUG - close.complete
2024-10-15 10:23:08,268 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-15 10:23:08,273 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000002143CB6FFB0>
2024-10-15 10:23:08,273 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x000002143C99E7D0> server_hostname='api.openai.com' timeout=5.0
2024-10-15 10:23:08,281 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000002143CB6E180>
2024-10-15 10:23:08,281 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:23:08,281 - DEBUG - send_request_headers.complete
2024-10-15 10:23:08,281 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:23:08,281 - DEBUG - send_request_body.complete
2024-10-15 10:23:08,281 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:23:11,002 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:23:11 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2573'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9998'), (b'x-ratelimit-remaining-tokens', b'9742'), (b'x-ratelimit-reset-requests', b'16.679s'), (b'x-ratelimit-reset-tokens', b'1.548s'), (b'x-request-id', b'req_b0f37fee10aca23aa3a9cda75518a28a'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e0fe6f87ac9e9-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:23:11,003 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:23:11,003 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:23:11,004 - DEBUG - receive_response_body.complete
2024-10-15 10:23:11,004 - DEBUG - response_closed.started
2024-10-15 10:23:11,004 - DEBUG - response_closed.complete
2024-10-15 10:23:11,004 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:23:11 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '2573', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9998', 'x-ratelimit-remaining-tokens': '9742', 'x-ratelimit-reset-requests': '16.679s', 'x-ratelimit-reset-tokens': '1.548s', 'x-request-id': 'req_b0f37fee10aca23aa3a9cda75518a28a', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e0fe6f87ac9e9-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:23:11,004 - DEBUG - request_id: req_b0f37fee10aca23aa3a9cda75518a28a
2024-10-15 10:23:11,005 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWBZxi1xxJKjFkq3wjR13509jnBy', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_S0DVzLYAdObp3paw4Vn7UsjP', function=Function(arguments='{\n  "name": "ELENA VASILESCU",\n  "address": "Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3"\n}', name='PIIData'), type='function')]))], created=1728976989, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=42, prompt_tokens=380, total_tokens=422, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:23:12,130 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 10:23:12,130 - DEBUG - max_retries: 1
2024-10-15 10:23:12,132 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 10:23:12,133 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:23:12,133 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:23:12,133 - DEBUG - send_request_headers.complete
2024-10-15 10:23:12,133 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:23:12,133 - DEBUG - send_request_body.complete
2024-10-15 10:23:12,133 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:23:13,242 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:23:14 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'954'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9997'), (b'x-ratelimit-remaining-tokens', b'9821'), (b'x-ratelimit-reset-requests', b'21.469s'), (b'x-ratelimit-reset-tokens', b'1.074s'), (b'x-request-id', b'req_6c5864dc563405ce3cde2a52ec871555'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e0fff0d56c9e9-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:23:13,243 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:23:13,243 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:23:13,244 - DEBUG - receive_response_body.complete
2024-10-15 10:23:13,244 - DEBUG - response_closed.started
2024-10-15 10:23:13,244 - DEBUG - response_closed.complete
2024-10-15 10:23:13,245 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:23:14 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '954', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9997', 'x-ratelimit-remaining-tokens': '9821', 'x-ratelimit-reset-requests': '21.469s', 'x-ratelimit-reset-tokens': '1.074s', 'x-request-id': 'req_6c5864dc563405ce3cde2a52ec871555', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e0fff0d56c9e9-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:23:13,245 - DEBUG - request_id: req_6c5864dc563405ce3cde2a52ec871555
2024-10-15 10:23:13,246 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWBdFCxDxmQczJYKyGoELQcmQZSC', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_GuOPWFikVZgbidfFJ8NE7KBK', function=Function(arguments='\n{\n"action": "identify_parties"\n}', name='AgentAction'), type='function')]))], created=1728976993, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=11, prompt_tokens=207, total_tokens=218, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:23:13,249 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.ContractParties'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Identify the buyer and seller from the given information:\n\nName: SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3'}], 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'properties': {'buyer': {'description': 'Name of the buyer', 'title': 'Buyer', 'type': 'string'}, 'seller': {'description': 'Name of the seller', 'title': 'Seller', 'type': 'string'}}, 'required': ['buyer', 'seller'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}}
2024-10-15 10:23:13,249 - DEBUG - max_retries: 1
2024-10-15 10:23:13,250 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Identify the buyer and seller from the given information:\n\nName: SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}, 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'properties': {'buyer': {'description': 'Name of the buyer', 'title': 'Buyer', 'type': 'string'}, 'seller': {'description': 'Name of the seller', 'title': 'Seller', 'type': 'string'}}, 'required': ['buyer', 'seller'], 'type': 'object'}}}]}}
2024-10-15 10:23:13,250 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:23:13,250 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:23:13,251 - DEBUG - send_request_headers.complete
2024-10-15 10:23:13,251 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:23:13,251 - DEBUG - send_request_body.complete
2024-10-15 10:23:13,251 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:23:14,809 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:23:15 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1411'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9996'), (b'x-ratelimit-remaining-tokens', b'9806'), (b'x-ratelimit-reset-requests', b'28.988s'), (b'x-ratelimit-reset-tokens', b'1.158s'), (b'x-request-id', b'req_58b16e62e1f9fd48e55b9a6a66381cdb'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e100609ddc9e9-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:23:14,810 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:23:14,810 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:23:14,811 - DEBUG - receive_response_body.complete
2024-10-15 10:23:14,811 - DEBUG - response_closed.started
2024-10-15 10:23:14,811 - DEBUG - response_closed.complete
2024-10-15 10:23:14,811 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:23:15 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1411', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9996', 'x-ratelimit-remaining-tokens': '9806', 'x-ratelimit-reset-requests': '28.988s', 'x-ratelimit-reset-tokens': '1.158s', 'x-request-id': 'req_58b16e62e1f9fd48e55b9a6a66381cdb', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e100609ddc9e9-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:23:14,812 - DEBUG - request_id: req_58b16e62e1f9fd48e55b9a6a66381cdb
2024-10-15 10:23:14,813 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWBeXXyPFnDn6qD885FiBm3MwcXl', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_66Fo3GZ7Mjyix3baXCel8qA2', function=Function(arguments='{\n  "buyer": "SENTIMENT BRUSLI",\n  "seller": "ELENA VASILESCU"\n}', name='ContractParties'), type='function')]))], created=1728976994, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=27, prompt_tokens=226, total_tokens=253, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:23:14,816 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: Yes\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 10:23:14,816 - DEBUG - max_retries: 1
2024-10-15 10:23:14,821 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: Yes\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 10:23:14,821 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:23:14,821 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:23:14,822 - DEBUG - send_request_headers.complete
2024-10-15 10:23:14,822 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:23:14,822 - DEBUG - send_request_body.complete
2024-10-15 10:23:14,822 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:23:15,835 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:23:16 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'857'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9995'), (b'x-ratelimit-remaining-tokens', b'9753'), (b'x-ratelimit-reset-requests', b'36.06s'), (b'x-ratelimit-reset-tokens', b'1.476s'), (b'x-request-id', b'req_78c4c37f9574bac011dacc1731226bd7'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e100fde8ac9e9-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:23:15,835 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:23:15,835 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:23:15,836 - DEBUG - receive_response_body.complete
2024-10-15 10:23:15,836 - DEBUG - response_closed.started
2024-10-15 10:23:15,836 - DEBUG - response_closed.complete
2024-10-15 10:23:15,836 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:23:16 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '857', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9995', 'x-ratelimit-remaining-tokens': '9753', 'x-ratelimit-reset-requests': '36.06s', 'x-ratelimit-reset-tokens': '1.476s', 'x-request-id': 'req_78c4c37f9574bac011dacc1731226bd7', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e100fde8ac9e9-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:23:15,836 - DEBUG - request_id: req_78c4c37f9574bac011dacc1731226bd7
2024-10-15 10:23:15,837 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWBgUWO6MuyzREnXEagwez4xWbuf', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_IZFK3pqVUONH8KctOWMGawrK', function=Function(arguments='\n{\n  "action": "determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728976996, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=13, prompt_tokens=207, total_tokens=220, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:23:19,325 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.ContractDetails'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "For an Airbnb contract between SENTIMENT BRUSLI and ELENA VASILESCU, who is the host (property owner) and who is the guest? Would you like to assign yourself a role in this contract? Respond in JSON format with keys 'host' and 'guest'."}], 'tools': [{'type': 'function', 'function': {'name': 'ContractDetails', 'description': 'Correctly extracted `ContractDetails` with all the required parameters with correct types', 'parameters': {'properties': {'contract_type': {'description': 'Type of contract (e.g., airbnb, buy-sell, it-consulting)', 'title': 'Contract Type', 'type': 'string'}, 'additional_info': {'additionalProperties': {'type': 'string'}, 'description': 'Additional information specific to the contract type', 'title': 'Additional Info', 'type': 'object'}}, 'required': ['additional_info', 'contract_type'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'ContractDetails'}}}
2024-10-15 10:23:19,325 - DEBUG - max_retries: 1
2024-10-15 10:23:19,327 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "For an Airbnb contract between SENTIMENT BRUSLI and ELENA VASILESCU, who is the host (property owner) and who is the guest? Would you like to assign yourself a role in this contract? Respond in JSON format with keys 'host' and 'guest'."}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'ContractDetails'}}, 'tools': [{'type': 'function', 'function': {'name': 'ContractDetails', 'description': 'Correctly extracted `ContractDetails` with all the required parameters with correct types', 'parameters': {'properties': {'contract_type': {'description': 'Type of contract (e.g., airbnb, buy-sell, it-consulting)', 'title': 'Contract Type', 'type': 'string'}, 'additional_info': {'additionalProperties': {'type': 'string'}, 'description': 'Additional information specific to the contract type', 'title': 'Additional Info', 'type': 'object'}}, 'required': ['additional_info', 'contract_type'], 'type': 'object'}}}]}}
2024-10-15 10:23:19,328 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:23:19,328 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:23:19,328 - DEBUG - send_request_headers.complete
2024-10-15 10:23:19,328 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:23:19,328 - DEBUG - send_request_body.complete
2024-10-15 10:23:19,328 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:23:20,598 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:23:21 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1120'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9995'), (b'x-ratelimit-remaining-tokens', b'9834'), (b'x-ratelimit-reset-requests', b'40.206s'), (b'x-ratelimit-reset-tokens', b'996ms'), (b'x-request-id', b'req_ce70bb417e05c425569b9d50f93a263e'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e102c0a55c9e9-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:23:20,598 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:23:20,599 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:23:20,599 - DEBUG - receive_response_body.complete
2024-10-15 10:23:20,599 - DEBUG - response_closed.started
2024-10-15 10:23:20,599 - DEBUG - response_closed.complete
2024-10-15 10:23:20,599 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:23:21 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1120', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9995', 'x-ratelimit-remaining-tokens': '9834', 'x-ratelimit-reset-requests': '40.206s', 'x-ratelimit-reset-tokens': '996ms', 'x-request-id': 'req_ce70bb417e05c425569b9d50f93a263e', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e102c0a55c9e9-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:23:20,600 - DEBUG - request_id: req_ce70bb417e05c425569b9d50f93a263e
2024-10-15 10:23:20,601 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWBkWfpC35zNG0VEov64fopYZDQQ', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_9uVcrJkQoZrqemHd1JuwJwyK', function=Function(arguments='{\n  "contract_type": "airbnb"\n}', name='ContractDetails'), type='function')]))], created=1728977000, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=11, prompt_tokens=214, total_tokens=225, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:23:25,887 - DEBUG - close.started
2024-10-15 10:23:25,888 - DEBUG - close.complete
2024-10-15 10:23:25,888 - ERROR - Task exception was never retrieved
future: <Task finished name='Task-1' coro=<agent_workflow() done, defined at D:\deve\contract_automation\src\main.py:25> exception=KeyboardInterrupt()>
Traceback (most recent call last):
  File "D:\deve\contract_automation\src\main.py", line 105, in <module>
    asyncio.run(agent_workflow())
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 30, in run
    return loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 92, in run_until_complete
    self._run_once()
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 133, in _run_once
    handle._run()
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 386, in __wakeup
    self.__step()
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 293, in __step
    self.__step_run_and_handle_result(exc)
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 304, in __step_run_and_handle_result
    result = coro.send(None)
             ^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\src\main.py", line 64, in agent_workflow
    confirmation = input("Is this role assignment correct? (yes/no): ").lower()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
2024-10-15 10:23:32,462 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-15 10:23:33,718 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-15 10:23:33,718 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-15 10:23:34,040 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-15 10:23:34,041 - DEBUG - Using proactor: IocpProactor
2024-10-15 10:23:34,059 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:23:34,060 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:23:34,060 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:23:34,060 - DEBUG - Compression method 0
2024-10-15 10:23:34,060 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:23:34,060 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:23:34,060 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 10:23:34,060 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 10:23:34,060 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 10:23:34,060 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 10:23:34,060 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:23:34,060 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:23:34,060 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:23:34,060 - DEBUG - Compression method 0
2024-10-15 10:23:34,060 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:23:34,060 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:23:34,060 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 10:23:34,060 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 10:23:34,060 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 10:23:34,060 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 10:23:34,070 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:23:34,070 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:23:34,070 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 10:23:34,070 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 10:23:34,071 - DEBUG - Error closing: Operation on closed image
2024-10-15 10:23:36,152 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:23:36,152 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:23:36,152 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:23:36,152 - DEBUG - Compression method 0
2024-10-15 10:23:36,152 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:23:36,152 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:23:36,152 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 10:23:36,152 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 10:23:36,152 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 10:23:36,152 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 10:23:36,152 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:23:36,153 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:23:36,153 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:23:36,153 - DEBUG - Compression method 0
2024-10-15 10:23:36,153 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:23:36,153 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:23:36,153 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 10:23:36,153 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 10:23:36,153 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 10:23:36,153 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 10:23:36,170 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:23:36,170 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:23:36,170 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 10:23:36,170 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 10:23:36,171 - DEBUG - Error closing: Operation on closed image
2024-10-15 10:23:38,690 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 0 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 10:23:38,691 - DEBUG - max_retries: 1
2024-10-15 10:23:38,693 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 0 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 10:23:38,729 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:23:38,730 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-15 10:23:38,754 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000002D834756F60>
2024-10-15 10:23:38,754 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x000002D83465E7D0> server_hostname='api.openai.com' timeout=5.0
2024-10-15 10:23:38,762 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000002D833235070>
2024-10-15 10:23:38,762 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:23:38,763 - DEBUG - send_request_headers.complete
2024-10-15 10:23:38,763 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:23:38,763 - DEBUG - send_request_body.complete
2024-10-15 10:23:38,763 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:23:39,949 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:23:40 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1033'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9996'), (b'x-ratelimit-remaining-tokens', b'9821'), (b'x-ratelimit-reset-requests', b'29.392s'), (b'x-ratelimit-reset-tokens', b'1.074s'), (b'x-request-id', b'req_c9427b6e989fbe966920c8f0dc66c150'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=ik24An1LsuEjzzaY7Z3wrwBzVdROe8.bTtE.64yaQ4A-1728977020-1.0.1.1-9lWNkEBvyswMCrRc2Tbh3jJIcNf_9tDQhK1kpltXoSo3CtvnqutQtZtxDzXdMwqx.qZtsPn4WqMA0DPwjq9Wpw; path=/; expires=Tue, 15-Oct-24 07:53:40 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=hitMbsVcMrBBNMzEHsdPf26TwvHn3RXfEL8cF9F.A0w-1728977020939-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e10a578030538-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:23:39,949 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:23:39,949 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:23:39,949 - DEBUG - receive_response_body.complete
2024-10-15 10:23:39,950 - DEBUG - response_closed.started
2024-10-15 10:23:39,950 - DEBUG - response_closed.complete
2024-10-15 10:23:39,950 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Tue, 15 Oct 2024 07:23:40 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-kzzh9hik9ryjiou4ftvhondh'), ('openai-processing-ms', '1033'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '10000'), ('x-ratelimit-remaining-requests', '9996'), ('x-ratelimit-remaining-tokens', '9821'), ('x-ratelimit-reset-requests', '29.392s'), ('x-ratelimit-reset-tokens', '1.074s'), ('x-request-id', 'req_c9427b6e989fbe966920c8f0dc66c150'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=ik24An1LsuEjzzaY7Z3wrwBzVdROe8.bTtE.64yaQ4A-1728977020-1.0.1.1-9lWNkEBvyswMCrRc2Tbh3jJIcNf_9tDQhK1kpltXoSo3CtvnqutQtZtxDzXdMwqx.qZtsPn4WqMA0DPwjq9Wpw; path=/; expires=Tue, 15-Oct-24 07:53:40 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=hitMbsVcMrBBNMzEHsdPf26TwvHn3RXfEL8cF9F.A0w-1728977020939-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d2e10a578030538-OTP'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-15 10:23:39,950 - DEBUG - request_id: req_c9427b6e989fbe966920c8f0dc66c150
2024-10-15 10:23:39,952 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWC4C6GA48xgsegnpDsKAO6phC7f', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_FJjeST80VAfHdWtyVmCqCTKs', function=Function(arguments='\n{\n  "action": "extract_pii"\n}', name='AgentAction'), type='function')]))], created=1728977020, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=12, prompt_tokens=207, total_tokens=219, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:23:39,953 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.PIIData'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}}
2024-10-15 10:23:39,953 - DEBUG - max_retries: 1
2024-10-15 10:23:39,955 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}, 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}]}}
2024-10-15 10:23:39,955 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:23:39,955 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:23:39,956 - DEBUG - send_request_headers.complete
2024-10-15 10:23:39,956 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:23:39,956 - DEBUG - send_request_body.complete
2024-10-15 10:23:39,956 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:23:42,143 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:23:43 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2039'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9995'), (b'x-ratelimit-remaining-tokens', b'9715'), (b'x-ratelimit-reset-requests', b'36.842s'), (b'x-ratelimit-reset-tokens', b'1.708s'), (b'x-request-id', b'req_ab939578ee86247e81260a455ab6aa62'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e10acef5d0538-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:23:42,144 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:23:42,144 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:23:42,144 - DEBUG - receive_response_body.complete
2024-10-15 10:23:42,144 - DEBUG - response_closed.started
2024-10-15 10:23:42,144 - DEBUG - response_closed.complete
2024-10-15 10:23:42,144 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:23:43 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '2039', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9995', 'x-ratelimit-remaining-tokens': '9715', 'x-ratelimit-reset-requests': '36.842s', 'x-ratelimit-reset-tokens': '1.708s', 'x-request-id': 'req_ab939578ee86247e81260a455ab6aa62', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e10acef5d0538-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:23:42,144 - DEBUG - request_id: req_ab939578ee86247e81260a455ab6aa62
2024-10-15 10:23:42,144 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWC5wvq6NA8oaffenXfoiN0lNqNN', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_XPzjTJJjVYjbLrxWrxVamQUS', function=Function(arguments='{\n"name": "SENTIMENT BRUSLI",\n"address": "Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR"\n}', name='PIIData'), type='function')]))], created=1728977021, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=36, prompt_tokens=377, total_tokens=413, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:24:53,180 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.PIIData'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}}
2024-10-15 10:24:53,180 - DEBUG - max_retries: 1
2024-10-15 10:24:53,183 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}, 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}]}}
2024-10-15 10:24:53,184 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:24:53,184 - DEBUG - close.started
2024-10-15 10:24:53,185 - DEBUG - close.complete
2024-10-15 10:24:53,185 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-15 10:24:53,192 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000002D83482FEF0>
2024-10-15 10:24:53,192 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x000002D83465E7D0> server_hostname='api.openai.com' timeout=5.0
2024-10-15 10:24:53,200 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000002D83482E060>
2024-10-15 10:24:53,200 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:24:53,201 - DEBUG - send_request_headers.complete
2024-10-15 10:24:53,201 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:24:53,201 - DEBUG - send_request_body.complete
2024-10-15 10:24:53,201 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:24:55,954 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:24:56 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2591'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'9742'), (b'x-ratelimit-reset-requests', b'8.64s'), (b'x-ratelimit-reset-tokens', b'1.548s'), (b'x-request-id', b'req_fc1be82b672b4d01b9e62190399333a8'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e1276be4de0c5-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:24:55,955 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:24:55,955 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:24:55,956 - DEBUG - receive_response_body.complete
2024-10-15 10:24:55,956 - DEBUG - response_closed.started
2024-10-15 10:24:55,956 - DEBUG - response_closed.complete
2024-10-15 10:24:55,956 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:24:56 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '2591', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9999', 'x-ratelimit-remaining-tokens': '9742', 'x-ratelimit-reset-requests': '8.64s', 'x-ratelimit-reset-tokens': '1.548s', 'x-request-id': 'req_fc1be82b672b4d01b9e62190399333a8', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e1276be4de0c5-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:24:55,956 - DEBUG - request_id: req_fc1be82b672b4d01b9e62190399333a8
2024-10-15 10:24:55,958 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWDGTJGwYcMgXUmLO9DuAxVPsLdy', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_qeIE5CsiUDTe2UJQ4hCFdVH2', function=Function(arguments='{\n"name": "ELENA VASILESCU",\n"address": "Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B"\n}', name='PIIData'), type='function')]))], created=1728977094, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=42, prompt_tokens=380, total_tokens=422, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:24:57,510 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 10:24:57,510 - DEBUG - max_retries: 1
2024-10-15 10:24:57,511 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 10:24:57,512 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:24:57,512 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:24:57,512 - DEBUG - send_request_headers.complete
2024-10-15 10:24:57,512 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:24:57,512 - DEBUG - send_request_body.complete
2024-10-15 10:24:57,512 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:24:58,426 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:24:59 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'769'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9998'), (b'x-ratelimit-remaining-tokens', b'9821'), (b'x-ratelimit-reset-requests', b'12.971s'), (b'x-ratelimit-reset-tokens', b'1.074s'), (b'x-request-id', b'req_7a9fc11e09193cd4486a50e1f94a2d44'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e1291af11e0c5-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:24:58,426 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:24:58,427 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:24:58,427 - DEBUG - receive_response_body.complete
2024-10-15 10:24:58,427 - DEBUG - response_closed.started
2024-10-15 10:24:58,427 - DEBUG - response_closed.complete
2024-10-15 10:24:58,427 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:24:59 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '769', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9998', 'x-ratelimit-remaining-tokens': '9821', 'x-ratelimit-reset-requests': '12.971s', 'x-ratelimit-reset-tokens': '1.074s', 'x-request-id': 'req_7a9fc11e09193cd4486a50e1f94a2d44', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e1291af11e0c5-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:24:58,427 - DEBUG - request_id: req_7a9fc11e09193cd4486a50e1f94a2d44
2024-10-15 10:24:58,427 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWDKzlBuUy5iWywlKoGV4U1y4H5x', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_geRO9Xk4OHqH0lXApDkmH8z6', function=Function(arguments='\n{\n  "action": "identify_parties"\n}', name='AgentAction'), type='function')]))], created=1728977098, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=12, prompt_tokens=207, total_tokens=219, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:24:58,428 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.ContractParties'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Identify the buyer and seller from the given information:\n\nName: SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'properties': {'buyer': {'description': 'Name of the buyer', 'title': 'Buyer', 'type': 'string'}, 'seller': {'description': 'Name of the seller', 'title': 'Seller', 'type': 'string'}}, 'required': ['buyer', 'seller'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}}
2024-10-15 10:24:58,428 - DEBUG - max_retries: 1
2024-10-15 10:24:58,430 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Identify the buyer and seller from the given information:\n\nName: SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}, 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'properties': {'buyer': {'description': 'Name of the buyer', 'title': 'Buyer', 'type': 'string'}, 'seller': {'description': 'Name of the seller', 'title': 'Seller', 'type': 'string'}}, 'required': ['buyer', 'seller'], 'type': 'object'}}}]}}
2024-10-15 10:24:58,430 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:24:58,430 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:24:58,431 - DEBUG - send_request_headers.complete
2024-10-15 10:24:58,431 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:24:58,431 - DEBUG - send_request_body.complete
2024-10-15 10:24:58,431 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:25:00,382 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:25:01 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1805'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9997'), (b'x-ratelimit-remaining-tokens', b'9769'), (b'x-ratelimit-reset-requests', b'20.693s'), (b'x-ratelimit-reset-tokens', b'1.38s'), (b'x-request-id', b'req_99c9363533e01fd40c9816d52ac5c0cf'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e12976e69e0c5-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:25:00,382 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:25:00,382 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:25:00,382 - DEBUG - receive_response_body.complete
2024-10-15 10:25:00,382 - DEBUG - response_closed.started
2024-10-15 10:25:00,382 - DEBUG - response_closed.complete
2024-10-15 10:25:00,383 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:25:01 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1805', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9997', 'x-ratelimit-remaining-tokens': '9769', 'x-ratelimit-reset-requests': '20.693s', 'x-ratelimit-reset-tokens': '1.38s', 'x-request-id': 'req_99c9363533e01fd40c9816d52ac5c0cf', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e12976e69e0c5-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:25:00,383 - DEBUG - request_id: req_99c9363533e01fd40c9816d52ac5c0cf
2024-10-15 10:25:00,383 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWDLidXYvHnpFYbvuuFFmw4pDUD1', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_yqL8XBpTsVk78zGD82KGavW6', function=Function(arguments='{\n  "buyer": "SENTIMENT BRUSLI", \n  "seller": "ELENA VASILESCU"\n}', name='ContractParties'), type='function')]))], created=1728977099, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=28, prompt_tokens=229, total_tokens=257, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:25:00,384 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: Yes\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 10:25:00,384 - DEBUG - max_retries: 1
2024-10-15 10:25:00,385 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: Yes\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 10:25:00,386 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:25:00,386 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:25:00,386 - DEBUG - send_request_headers.complete
2024-10-15 10:25:00,386 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:25:00,386 - DEBUG - send_request_body.complete
2024-10-15 10:25:00,386 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:25:01,469 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:25:02 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'929'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9996'), (b'x-ratelimit-remaining-tokens', b'9751'), (b'x-ratelimit-reset-requests', b'27.375s'), (b'x-ratelimit-reset-tokens', b'1.491s'), (b'x-request-id', b'req_e7bc9514f58b46d1a1d34a90526ad70c'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e12a3afc9e0c5-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:25:01,469 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:25:01,469 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:25:01,469 - DEBUG - receive_response_body.complete
2024-10-15 10:25:01,469 - DEBUG - response_closed.started
2024-10-15 10:25:01,469 - DEBUG - response_closed.complete
2024-10-15 10:25:01,469 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:25:02 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '929', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9996', 'x-ratelimit-remaining-tokens': '9751', 'x-ratelimit-reset-requests': '27.375s', 'x-ratelimit-reset-tokens': '1.491s', 'x-request-id': 'req_e7bc9514f58b46d1a1d34a90526ad70c', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e12a3afc9e0c5-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:25:01,469 - DEBUG - request_id: req_e7bc9514f58b46d1a1d34a90526ad70c
2024-10-15 10:25:01,470 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWDNLRdhWilsXc3mwIzzxW8NB0V6', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_pscrd7Qj89z9fdLU9gGqCn0n', function=Function(arguments='{\n"action": "determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728977101, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=11, prompt_tokens=207, total_tokens=218, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:25:05,458 - ERROR - Error in determine_contract_details: object of type 'ContractParties' has no len()
2024-10-15 10:25:05,618 - DEBUG - close.started
2024-10-15 10:25:05,618 - DEBUG - close.complete
2024-10-15 10:26:53,990 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-15 10:26:55,255 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-15 10:26:55,256 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-15 10:26:55,584 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-15 10:26:55,585 - DEBUG - Using proactor: IocpProactor
2024-10-15 10:26:55,605 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:26:55,605 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:26:55,605 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:26:55,605 - DEBUG - Compression method 0
2024-10-15 10:26:55,605 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:26:55,605 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:26:55,605 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 10:26:55,605 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 10:26:55,605 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 10:26:55,605 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 10:26:55,605 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:26:55,605 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:26:55,605 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:26:55,605 - DEBUG - Compression method 0
2024-10-15 10:26:55,605 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:26:55,605 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:26:55,605 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 10:26:55,605 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 10:26:55,605 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 10:26:55,605 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 10:26:55,615 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:26:55,615 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:26:55,615 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 10:26:55,615 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 10:26:55,615 - DEBUG - Error closing: Operation on closed image
2024-10-15 10:26:57,677 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:26:57,677 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:26:57,677 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:26:57,677 - DEBUG - Compression method 0
2024-10-15 10:26:57,677 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:26:57,677 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:26:57,677 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 10:26:57,677 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 10:26:57,677 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 10:26:57,677 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 10:26:57,677 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:26:57,677 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:26:57,677 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:26:57,677 - DEBUG - Compression method 0
2024-10-15 10:26:57,677 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:26:57,677 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:26:57,677 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 10:26:57,677 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 10:26:57,677 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 10:26:57,677 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 10:26:57,694 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:26:57,694 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:26:57,694 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 10:26:57,695 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 10:26:57,695 - DEBUG - Error closing: Operation on closed image
2024-10-15 10:27:00,207 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 0 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 10:27:00,208 - DEBUG - max_retries: 1
2024-10-15 10:27:00,210 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 0 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 10:27:00,246 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:27:00,246 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-15 10:27:00,325 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001C4ED223E60>
2024-10-15 10:27:00,325 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x000001C4ED08E7D0> server_hostname='api.openai.com' timeout=5.0
2024-10-15 10:27:00,335 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001C4ED223DA0>
2024-10-15 10:27:00,335 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:27:00,335 - DEBUG - send_request_headers.complete
2024-10-15 10:27:00,335 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:27:00,335 - DEBUG - send_request_body.complete
2024-10-15 10:27:00,335 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:27:01,809 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:27:02 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1311'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'9821'), (b'x-ratelimit-reset-requests', b'8.64s'), (b'x-ratelimit-reset-tokens', b'1.074s'), (b'x-request-id', b'req_1089ad9da908ed8e2453e68c389b56d2'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=OCPjSbBdWfQaaw0A4sDmOGlJWyQ.mILX8hmOXsOdqGQ-1728977222-1.0.1.1-R_vQ7LEbaS5gXFicVtMSJBPQtEE7d7Nuo99HYWSN4T0kV5a0nUG.oELfQxxCDIAcO7aRfaz4Iaq0VAzacqthxQ; path=/; expires=Tue, 15-Oct-24 07:57:02 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=nJDoDac8uGahioAR6Tt.yy.r1w.zjBPU6s1bw8s4lxc-1728977222809-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e15915852c9d4-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:27:01,810 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:27:01,810 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:27:01,811 - DEBUG - receive_response_body.complete
2024-10-15 10:27:01,811 - DEBUG - response_closed.started
2024-10-15 10:27:01,811 - DEBUG - response_closed.complete
2024-10-15 10:27:01,811 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Tue, 15 Oct 2024 07:27:02 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-kzzh9hik9ryjiou4ftvhondh'), ('openai-processing-ms', '1311'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '10000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '9821'), ('x-ratelimit-reset-requests', '8.64s'), ('x-ratelimit-reset-tokens', '1.074s'), ('x-request-id', 'req_1089ad9da908ed8e2453e68c389b56d2'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=OCPjSbBdWfQaaw0A4sDmOGlJWyQ.mILX8hmOXsOdqGQ-1728977222-1.0.1.1-R_vQ7LEbaS5gXFicVtMSJBPQtEE7d7Nuo99HYWSN4T0kV5a0nUG.oELfQxxCDIAcO7aRfaz4Iaq0VAzacqthxQ; path=/; expires=Tue, 15-Oct-24 07:57:02 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=nJDoDac8uGahioAR6Tt.yy.r1w.zjBPU6s1bw8s4lxc-1728977222809-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d2e15915852c9d4-OTP'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-15 10:27:01,811 - DEBUG - request_id: req_1089ad9da908ed8e2453e68c389b56d2
2024-10-15 10:27:01,813 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWFJMhjL0hogzrLRb7VRIsT37sa7', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_R9WAd06H31yQED2jrmQwLloa', function=Function(arguments='\n{\n  "action": "extract_pii"\n}', name='AgentAction'), type='function')]))], created=1728977221, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=12, prompt_tokens=207, total_tokens=219, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:27:01,814 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.PIIData'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}}
2024-10-15 10:27:01,814 - DEBUG - max_retries: 1
2024-10-15 10:27:01,815 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}, 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}]}}
2024-10-15 10:27:01,816 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:27:01,816 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:27:01,816 - DEBUG - send_request_headers.complete
2024-10-15 10:27:01,816 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:27:01,816 - DEBUG - send_request_body.complete
2024-10-15 10:27:01,816 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:27:03,860 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:27:04 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1881'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9998'), (b'x-ratelimit-remaining-tokens', b'9722'), (b'x-ratelimit-reset-requests', b'15.793s'), (b'x-ratelimit-reset-tokens', b'1.665s'), (b'x-request-id', b'req_157a1e3ab2dad9ea0d5d4c819d66745f'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e159a9f91c9d4-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:27:03,860 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:27:03,860 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:27:03,861 - DEBUG - receive_response_body.complete
2024-10-15 10:27:03,861 - DEBUG - response_closed.started
2024-10-15 10:27:03,861 - DEBUG - response_closed.complete
2024-10-15 10:27:03,861 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:27:04 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1881', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9998', 'x-ratelimit-remaining-tokens': '9722', 'x-ratelimit-reset-requests': '15.793s', 'x-ratelimit-reset-tokens': '1.665s', 'x-request-id': 'req_157a1e3ab2dad9ea0d5d4c819d66745f', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e159a9f91c9d4-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:27:03,861 - DEBUG - request_id: req_157a1e3ab2dad9ea0d5d4c819d66745f
2024-10-15 10:27:03,861 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWFLca1hJK6nMsEfLvYSKTpNGFoy', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_z47j8Em8cymcCDKI38zZuEMB', function=Function(arguments='{\n"name": "ISPILANTE SENTIMENT BRUSLI",\n"address": "Sos. Giurgiului nr.1, Videle Jud: Teleorman"\n}', name='PIIData'), type='function')]))], created=1728977223, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=36, prompt_tokens=377, total_tokens=413, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:27:30,932 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.PIIData'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}}
2024-10-15 10:27:30,933 - DEBUG - max_retries: 1
2024-10-15 10:27:30,935 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}, 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}]}}
2024-10-15 10:27:30,935 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:27:30,935 - DEBUG - close.started
2024-10-15 10:27:30,935 - DEBUG - close.complete
2024-10-15 10:27:30,935 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-15 10:27:30,965 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001C4ED25FF50>
2024-10-15 10:27:30,965 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x000001C4ED08E7D0> server_hostname='api.openai.com' timeout=5.0
2024-10-15 10:27:30,973 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001C4ED25E1E0>
2024-10-15 10:27:30,973 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:27:30,973 - DEBUG - send_request_headers.complete
2024-10-15 10:27:30,973 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:27:30,973 - DEBUG - send_request_body.complete
2024-10-15 10:27:30,973 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:27:33,537 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:27:34 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2410'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'9742'), (b'x-ratelimit-reset-requests', b'8.64s'), (b'x-ratelimit-reset-tokens', b'1.548s'), (b'x-request-id', b'req_e98cb82c6518f505f47622ec3d4665ca'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e1650ddc26afa-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:27:33,538 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:27:33,539 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:27:33,539 - DEBUG - receive_response_body.complete
2024-10-15 10:27:33,540 - DEBUG - response_closed.started
2024-10-15 10:27:33,540 - DEBUG - response_closed.complete
2024-10-15 10:27:33,540 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:27:34 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '2410', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9999', 'x-ratelimit-remaining-tokens': '9742', 'x-ratelimit-reset-requests': '8.64s', 'x-ratelimit-reset-tokens': '1.548s', 'x-request-id': 'req_e98cb82c6518f505f47622ec3d4665ca', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e1650ddc26afa-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:27:33,540 - DEBUG - request_id: req_e98cb82c6518f505f47622ec3d4665ca
2024-10-15 10:27:33,541 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWFoMCgUMMPmODt9Zy4s0kMzx29S', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_87hW3c2TEUialy4ObpdC93UA', function=Function(arguments='{\n"name": "ELENA VASILESCU",\n"address": "Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B"\n}', name='PIIData'), type='function')]))], created=1728977252, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=42, prompt_tokens=380, total_tokens=422, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:27:34,850 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 10:27:34,850 - DEBUG - max_retries: 1
2024-10-15 10:27:34,851 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 10:27:34,852 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:27:34,852 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:27:34,852 - DEBUG - send_request_headers.complete
2024-10-15 10:27:34,852 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:27:34,852 - DEBUG - send_request_body.complete
2024-10-15 10:27:34,853 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:27:35,970 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:27:36 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'933'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9998'), (b'x-ratelimit-remaining-tokens', b'9821'), (b'x-ratelimit-reset-requests', b'13.412s'), (b'x-ratelimit-reset-tokens', b'1.074s'), (b'x-request-id', b'req_4ea4ab7538fa9350d2cc6bef975b331f'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e16691f426afa-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:27:35,971 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:27:35,971 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:27:35,971 - DEBUG - receive_response_body.complete
2024-10-15 10:27:35,972 - DEBUG - response_closed.started
2024-10-15 10:27:35,972 - DEBUG - response_closed.complete
2024-10-15 10:27:35,972 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:27:36 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '933', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9998', 'x-ratelimit-remaining-tokens': '9821', 'x-ratelimit-reset-requests': '13.412s', 'x-ratelimit-reset-tokens': '1.074s', 'x-request-id': 'req_4ea4ab7538fa9350d2cc6bef975b331f', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e16691f426afa-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:27:35,972 - DEBUG - request_id: req_4ea4ab7538fa9350d2cc6bef975b331f
2024-10-15 10:27:35,973 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWFsfpqVph3XSnvx8TsgyGHDEDix', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_3sG7jirgN8hiNQUpyPQ0kT42', function=Function(arguments='\n{\n"action": "identify_parties"\n}', name='AgentAction'), type='function')]))], created=1728977256, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=11, prompt_tokens=207, total_tokens=218, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:27:35,976 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.ContractParties'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Identify the buyer and seller from the given information:\n\nName: ISPILANTE SENTIMENT BRUSLI, Address: Sos. Giurgiului nr.1, Videle Jud: Teleorman\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'properties': {'buyer': {'description': 'Name of the buyer', 'title': 'Buyer', 'type': 'string'}, 'seller': {'description': 'Name of the seller', 'title': 'Seller', 'type': 'string'}}, 'required': ['buyer', 'seller'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}}
2024-10-15 10:27:35,976 - DEBUG - max_retries: 1
2024-10-15 10:27:35,977 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Identify the buyer and seller from the given information:\n\nName: ISPILANTE SENTIMENT BRUSLI, Address: Sos. Giurgiului nr.1, Videle Jud: Teleorman\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}, 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'properties': {'buyer': {'description': 'Name of the buyer', 'title': 'Buyer', 'type': 'string'}, 'seller': {'description': 'Name of the seller', 'title': 'Seller', 'type': 'string'}}, 'required': ['buyer', 'seller'], 'type': 'object'}}}]}}
2024-10-15 10:27:35,977 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:27:35,978 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:27:35,978 - DEBUG - send_request_headers.complete
2024-10-15 10:27:35,978 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:27:35,978 - DEBUG - send_request_body.complete
2024-10-15 10:27:35,978 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:27:38,135 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:27:39 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2001'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9997'), (b'x-ratelimit-remaining-tokens', b'9806'), (b'x-ratelimit-reset-requests', b'20.914s'), (b'x-ratelimit-reset-tokens', b'1.16s'), (b'x-request-id', b'req_140aeda8855ed9e4a2b11ec0d21e0fac'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e16702e0b6afa-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:27:38,135 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:27:38,136 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:27:38,136 - DEBUG - receive_response_body.complete
2024-10-15 10:27:38,136 - DEBUG - response_closed.started
2024-10-15 10:27:38,136 - DEBUG - response_closed.complete
2024-10-15 10:27:38,136 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:27:39 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '2001', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9997', 'x-ratelimit-remaining-tokens': '9806', 'x-ratelimit-reset-requests': '20.914s', 'x-ratelimit-reset-tokens': '1.16s', 'x-request-id': 'req_140aeda8855ed9e4a2b11ec0d21e0fac', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e16702e0b6afa-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:27:38,136 - DEBUG - request_id: req_140aeda8855ed9e4a2b11ec0d21e0fac
2024-10-15 10:27:38,136 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWFt3gVYMjRGgmkgz3DqSuKKAlKe', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_WWoE0pGNKONWlidFKFtBTzT4', function=Function(arguments='{\n  "buyer": "ISPILANTE SENTIMENT BRUSLI",\n  "seller": "ELENA VASILESCU"\n}', name='ContractParties'), type='function')]))], created=1728977257, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=30, prompt_tokens=230, total_tokens=260, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:27:38,138 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: Yes\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 10:27:38,138 - DEBUG - max_retries: 1
2024-10-15 10:27:38,140 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: Yes\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 10:27:38,140 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:27:38,141 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:27:38,141 - DEBUG - send_request_headers.complete
2024-10-15 10:27:38,141 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:27:38,141 - DEBUG - send_request_body.complete
2024-10-15 10:27:38,141 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:27:39,001 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:27:40 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'709'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9996'), (b'x-ratelimit-remaining-tokens', b'9750'), (b'x-ratelimit-reset-requests', b'27.393s'), (b'x-ratelimit-reset-tokens', b'1.497s'), (b'x-request-id', b'req_f413edf264943ae898657d395a2fd91f'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e167dac956afa-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:27:39,001 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:27:39,002 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:27:39,002 - DEBUG - receive_response_body.complete
2024-10-15 10:27:39,002 - DEBUG - response_closed.started
2024-10-15 10:27:39,003 - DEBUG - response_closed.complete
2024-10-15 10:27:39,003 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:27:40 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '709', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9996', 'x-ratelimit-remaining-tokens': '9750', 'x-ratelimit-reset-requests': '27.393s', 'x-ratelimit-reset-tokens': '1.497s', 'x-request-id': 'req_f413edf264943ae898657d395a2fd91f', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e167dac956afa-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:27:39,003 - DEBUG - request_id: req_f413edf264943ae898657d395a2fd91f
2024-10-15 10:27:39,004 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWFvztBfkwJj3tgQdbIhvkS4PIRL', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_473iRm7Xo81gU6AhaHLMUBQc', function=Function(arguments='{\n"action": "determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728977259, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=11, prompt_tokens=207, total_tokens=218, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:27:42,858 - DEBUG - max_retries: 1
2024-10-15 10:27:42,861 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Assign roles: 'host' and 'guest'. Participants are: ISPILANTE SENTIMENT BRUSLI, ELENA VASILESCU. Respond strictly in JSON format with keys 'host' and 'guest'."}], 'model': 'gpt-4', 'response_format': {'type': 'json_object', 'strict': True}}}
2024-10-15 10:27:42,861 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:27:42,861 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:27:42,861 - DEBUG - send_request_headers.complete
2024-10-15 10:27:42,862 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:27:42,862 - DEBUG - send_request_body.complete
2024-10-15 10:27:42,862 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:27:43,035 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 400, b'Bad Request', [(b'Date', b'Tue, 15 Oct 2024 07:27:44 GMT'), (b'Content-Type', b'application/json'), (b'Content-Length', b'191'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'13'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9996'), (b'x-ratelimit-remaining-tokens', b'9853'), (b'x-ratelimit-reset-requests', b'31.305s'), (b'x-ratelimit-reset-tokens', b'882ms'), (b'x-request-id', b'req_79cb6cadebe8189e3a3893f624c8f99c'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e169b28d06afa-OTP'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:27:43,036 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-10-15 10:27:43,036 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:27:43,036 - DEBUG - receive_response_body.complete
2024-10-15 10:27:43,037 - DEBUG - response_closed.started
2024-10-15 10:27:43,037 - DEBUG - response_closed.complete
2024-10-15 10:27:43,037 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "400 Bad Request" Headers({'date': 'Tue, 15 Oct 2024 07:27:44 GMT', 'content-type': 'application/json', 'content-length': '191', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '13', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9996', 'x-ratelimit-remaining-tokens': '9853', 'x-ratelimit-reset-requests': '31.305s', 'x-ratelimit-reset-tokens': '882ms', 'x-request-id': 'req_79cb6cadebe8189e3a3893f624c8f99c', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e169b28d06afa-OTP', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:27:43,037 - DEBUG - request_id: req_79cb6cadebe8189e3a3893f624c8f99c
2024-10-15 10:27:43,037 - DEBUG - Encountered httpx.HTTPStatusError
Traceback (most recent call last):
  File "D:\deve\contract_automation\.venv\Lib\site-packages\openai\_base_client.py", line 1030, in _request
    response.raise_for_status()
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpx\_models.py", line 763, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '400 Bad Request' for url 'https://api.openai.com/v1/chat/completions'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400
2024-10-15 10:27:43,041 - DEBUG - Not retrying
2024-10-15 10:27:43,041 - DEBUG - Re-raising status error
2024-10-15 10:27:43,042 - ERROR - Error in determine_contract_details: Error code: 400 - {'error': {'message': "Unknown parameter: 'response_format.strict'.", 'type': 'invalid_request_error', 'param': 'response_format.strict', 'code': 'unknown_parameter'}}
2024-10-15 10:27:43,218 - DEBUG - close.started
2024-10-15 10:27:43,218 - DEBUG - close.complete
2024-10-15 10:29:08,560 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-15 10:29:09,812 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-15 10:29:09,813 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-15 10:29:10,130 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-15 10:29:10,131 - DEBUG - Using proactor: IocpProactor
2024-10-15 10:29:10,149 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:29:10,149 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:29:10,149 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:29:10,150 - DEBUG - Compression method 0
2024-10-15 10:29:10,150 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:29:10,150 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:29:10,150 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 10:29:10,150 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 10:29:10,150 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 10:29:10,150 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 10:29:10,150 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:29:10,150 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:29:10,150 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:29:10,150 - DEBUG - Compression method 0
2024-10-15 10:29:10,150 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:29:10,150 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:29:10,150 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 10:29:10,150 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 10:29:10,150 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 10:29:10,150 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 10:29:10,159 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:29:10,159 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:29:10,159 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 10:29:10,159 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 10:29:10,161 - DEBUG - Error closing: Operation on closed image
2024-10-15 10:29:12,174 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:29:12,174 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:29:12,174 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:29:12,174 - DEBUG - Compression method 0
2024-10-15 10:29:12,174 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:29:12,174 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:29:12,174 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 10:29:12,174 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 10:29:12,174 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 10:29:12,174 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 10:29:12,174 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:29:12,174 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:29:12,174 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:29:12,174 - DEBUG - Compression method 0
2024-10-15 10:29:12,174 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:29:12,174 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:29:12,174 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 10:29:12,174 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 10:29:12,174 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 10:29:12,174 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 10:29:12,191 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:29:12,191 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:29:12,191 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 10:29:12,191 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 10:29:12,192 - DEBUG - Error closing: Operation on closed image
2024-10-15 10:29:14,744 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 0 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 10:29:14,745 - DEBUG - max_retries: 1
2024-10-15 10:29:14,747 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 0 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 10:29:14,784 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:29:14,784 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-15 10:29:14,818 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001DC87B93C80>
2024-10-15 10:29:14,818 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x000001DC879FE7D0> server_hostname='api.openai.com' timeout=5.0
2024-10-15 10:29:14,826 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001DC87B93BC0>
2024-10-15 10:29:14,826 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:29:14,826 - DEBUG - send_request_headers.complete
2024-10-15 10:29:14,826 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:29:14,827 - DEBUG - send_request_body.complete
2024-10-15 10:29:14,827 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:29:15,818 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:29:16 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'810'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'9821'), (b'x-ratelimit-reset-requests', b'8.64s'), (b'x-ratelimit-reset-tokens', b'1.074s'), (b'x-request-id', b'req_c2e26c2753e336f412a3ce2b86d29d3b'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=iY_u_qdVvQgKIMmKRNqldEMfF_Revwd3h1ItZAVB3Rw-1728977356-1.0.1.1-xu9uBevvX6sTKh2MYpNBMW_A_WHVzpFoz.pPiyXaEEkSjcJalFWt2yBOUkfc5iHBSeQSXeqEcqOcM_qCClcR2g; path=/; expires=Tue, 15-Oct-24 07:59:16 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=qvnpT1iaydYcpBFiaJ5Fm5ZnZrlzc7xrkBsKQXVeCkk-1728977356803-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e18d9deb9b9e7-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:29:15,819 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:29:15,819 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:29:15,819 - DEBUG - receive_response_body.complete
2024-10-15 10:29:15,819 - DEBUG - response_closed.started
2024-10-15 10:29:15,819 - DEBUG - response_closed.complete
2024-10-15 10:29:15,819 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Tue, 15 Oct 2024 07:29:16 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-kzzh9hik9ryjiou4ftvhondh'), ('openai-processing-ms', '810'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '10000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '9821'), ('x-ratelimit-reset-requests', '8.64s'), ('x-ratelimit-reset-tokens', '1.074s'), ('x-request-id', 'req_c2e26c2753e336f412a3ce2b86d29d3b'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=iY_u_qdVvQgKIMmKRNqldEMfF_Revwd3h1ItZAVB3Rw-1728977356-1.0.1.1-xu9uBevvX6sTKh2MYpNBMW_A_WHVzpFoz.pPiyXaEEkSjcJalFWt2yBOUkfc5iHBSeQSXeqEcqOcM_qCClcR2g; path=/; expires=Tue, 15-Oct-24 07:59:16 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=qvnpT1iaydYcpBFiaJ5Fm5ZnZrlzc7xrkBsKQXVeCkk-1728977356803-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d2e18d9deb9b9e7-OTP'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-15 10:29:15,819 - DEBUG - request_id: req_c2e26c2753e336f412a3ce2b86d29d3b
2024-10-15 10:29:15,821 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWHUkr67xZPRyN0FwNrL7PzOV47p', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_EZ39ENjGpshS1QhCoJLPm9PL', function=Function(arguments='\n{\n"action": "extract_pii"\n}', name='AgentAction'), type='function')]))], created=1728977356, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=11, prompt_tokens=207, total_tokens=218, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:29:15,822 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.PIIData'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}}
2024-10-15 10:29:15,822 - DEBUG - max_retries: 1
2024-10-15 10:29:15,824 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}, 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}]}}
2024-10-15 10:29:15,824 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:29:15,824 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:29:15,824 - DEBUG - send_request_headers.complete
2024-10-15 10:29:15,825 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:29:15,825 - DEBUG - send_request_body.complete
2024-10-15 10:29:15,825 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:29:17,963 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:29:18 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1978'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9998'), (b'x-ratelimit-remaining-tokens', b'9680'), (b'x-ratelimit-reset-requests', b'16.305s'), (b'x-ratelimit-reset-tokens', b'1.917s'), (b'x-request-id', b'req_1a5b58d6841532c36dc11c38ed394673'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e18e01dfeb9e7-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:29:17,963 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:29:17,964 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:29:17,964 - DEBUG - receive_response_body.complete
2024-10-15 10:29:17,964 - DEBUG - response_closed.started
2024-10-15 10:29:17,965 - DEBUG - response_closed.complete
2024-10-15 10:29:17,965 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:29:18 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1978', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9998', 'x-ratelimit-remaining-tokens': '9680', 'x-ratelimit-reset-requests': '16.305s', 'x-ratelimit-reset-tokens': '1.917s', 'x-request-id': 'req_1a5b58d6841532c36dc11c38ed394673', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e18e01dfeb9e7-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:29:17,965 - DEBUG - request_id: req_1a5b58d6841532c36dc11c38ed394673
2024-10-15 10:29:17,966 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWHVaLl3J6BlvO0JMXsVTk63dBzi', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_6f5xv56QDdawZzPU2sZdMMHW', function=Function(arguments='{\n"name": "SENTIMENT BRUSLI",\n"address": "Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR"\n}', name='PIIData'), type='function')]))], created=1728977357, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=36, prompt_tokens=377, total_tokens=413, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:29:28,155 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.PIIData'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}}
2024-10-15 10:29:28,156 - DEBUG - max_retries: 1
2024-10-15 10:29:28,158 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}, 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}]}}
2024-10-15 10:29:28,158 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:29:28,159 - DEBUG - close.started
2024-10-15 10:29:28,159 - DEBUG - close.complete
2024-10-15 10:29:28,159 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-15 10:29:28,179 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001DC87BCFE00>
2024-10-15 10:29:28,179 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x000001DC879FE7D0> server_hostname='api.openai.com' timeout=5.0
2024-10-15 10:29:28,188 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001DC87BCE030>
2024-10-15 10:29:28,188 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:29:28,188 - DEBUG - send_request_headers.complete
2024-10-15 10:29:28,188 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:29:28,188 - DEBUG - send_request_body.complete
2024-10-15 10:29:28,188 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:29:30,325 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:29:31 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1966'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9998'), (b'x-ratelimit-remaining-tokens', b'9742'), (b'x-ratelimit-reset-requests', b'12.581s'), (b'x-ratelimit-reset-tokens', b'1.548s'), (b'x-request-id', b'req_24a005041299dcd2b00f0b6e5d02e2d0'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e192d5a0d70cf-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:29:30,325 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:29:30,325 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:29:30,326 - DEBUG - receive_response_body.complete
2024-10-15 10:29:30,326 - DEBUG - response_closed.started
2024-10-15 10:29:30,326 - DEBUG - response_closed.complete
2024-10-15 10:29:30,326 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:29:31 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1966', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9998', 'x-ratelimit-remaining-tokens': '9742', 'x-ratelimit-reset-requests': '12.581s', 'x-ratelimit-reset-tokens': '1.548s', 'x-request-id': 'req_24a005041299dcd2b00f0b6e5d02e2d0', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e192d5a0d70cf-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:29:30,326 - DEBUG - request_id: req_24a005041299dcd2b00f0b6e5d02e2d0
2024-10-15 10:29:30,326 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWHhDiJruEBpGAFm18c9ebi4GO6z', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_pEz91fqLMZGxDconU7tNkMq1', function=Function(arguments='{\n"name": "ELENA VASILESCU",\n"address": "Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B"\n}', name='PIIData'), type='function')]))], created=1728977369, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=42, prompt_tokens=380, total_tokens=422, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:29:31,396 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 10:29:31,396 - DEBUG - max_retries: 1
2024-10-15 10:29:31,398 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 10:29:31,398 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:29:31,398 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:29:31,399 - DEBUG - send_request_headers.complete
2024-10-15 10:29:31,399 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:29:31,399 - DEBUG - send_request_body.complete
2024-10-15 10:29:31,399 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:29:32,306 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:29:33 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'754'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9997'), (b'x-ratelimit-remaining-tokens', b'9821'), (b'x-ratelimit-reset-requests', b'18.017s'), (b'x-ratelimit-reset-tokens', b'1.074s'), (b'x-request-id', b'req_e1b6bc2f0bb130bbe7042d7728e181ec'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e1941699c70cf-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:29:32,306 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:29:32,307 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:29:32,307 - DEBUG - receive_response_body.complete
2024-10-15 10:29:32,307 - DEBUG - response_closed.started
2024-10-15 10:29:32,308 - DEBUG - response_closed.complete
2024-10-15 10:29:32,308 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:29:33 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '754', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9997', 'x-ratelimit-remaining-tokens': '9821', 'x-ratelimit-reset-requests': '18.017s', 'x-ratelimit-reset-tokens': '1.074s', 'x-request-id': 'req_e1b6bc2f0bb130bbe7042d7728e181ec', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e1941699c70cf-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:29:32,308 - DEBUG - request_id: req_e1b6bc2f0bb130bbe7042d7728e181ec
2024-10-15 10:29:32,309 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWHkqUOoknu2tAeSj0nCHCNAbkUb', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_RSqLJUPbnDCrY3F2MyM9JDGT', function=Function(arguments='\n{\n  "action": "identify_parties"\n}', name='AgentAction'), type='function')]))], created=1728977372, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=12, prompt_tokens=207, total_tokens=219, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:29:32,312 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.ContractParties'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Identify the buyer and seller from the given information:\n\nName: SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'properties': {'buyer': {'description': 'Name of the buyer', 'title': 'Buyer', 'type': 'string'}, 'seller': {'description': 'Name of the seller', 'title': 'Seller', 'type': 'string'}}, 'required': ['buyer', 'seller'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}}
2024-10-15 10:29:32,312 - DEBUG - max_retries: 1
2024-10-15 10:29:32,315 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Identify the buyer and seller from the given information:\n\nName: SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}, 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'properties': {'buyer': {'description': 'Name of the buyer', 'title': 'Buyer', 'type': 'string'}, 'seller': {'description': 'Name of the seller', 'title': 'Seller', 'type': 'string'}}, 'required': ['buyer', 'seller'], 'type': 'object'}}}]}}
2024-10-15 10:29:32,316 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:29:32,316 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:29:32,316 - DEBUG - send_request_headers.complete
2024-10-15 10:29:32,316 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:29:32,316 - DEBUG - send_request_body.complete
2024-10-15 10:29:32,317 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:29:33,764 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:29:34 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1299'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9997'), (b'x-ratelimit-remaining-tokens', b'9769'), (b'x-ratelimit-reset-requests', b'25.741s'), (b'x-ratelimit-reset-tokens', b'1.381s'), (b'x-request-id', b'req_fd80e50cee9bb058acd942d452bff461'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e19472fb770cf-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:29:33,765 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:29:33,766 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:29:33,766 - DEBUG - receive_response_body.complete
2024-10-15 10:29:33,766 - DEBUG - response_closed.started
2024-10-15 10:29:33,766 - DEBUG - response_closed.complete
2024-10-15 10:29:33,767 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:29:34 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1299', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9997', 'x-ratelimit-remaining-tokens': '9769', 'x-ratelimit-reset-requests': '25.741s', 'x-ratelimit-reset-tokens': '1.381s', 'x-request-id': 'req_fd80e50cee9bb058acd942d452bff461', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e19472fb770cf-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:29:33,767 - DEBUG - request_id: req_fd80e50cee9bb058acd942d452bff461
2024-10-15 10:29:33,768 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWHl1sreb53bWCRD2bWhXMC2I7os', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_SA9VwFt6Qmi2sVEhUn7M7YKp', function=Function(arguments='{\n"buyer": "ELENA VASILESCU",\n"seller": "SENTIMENT BRUSLI"\n}', name='ContractParties'), type='function')]))], created=1728977373, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=25, prompt_tokens=229, total_tokens=254, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:29:33,770 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: Yes\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 10:29:33,771 - DEBUG - max_retries: 1
2024-10-15 10:29:33,772 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: Yes\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 10:29:33,772 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:29:33,772 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:29:33,773 - DEBUG - send_request_headers.complete
2024-10-15 10:29:33,773 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:29:33,773 - DEBUG - send_request_body.complete
2024-10-15 10:29:33,773 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:29:34,821 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:29:35 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'889'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9996'), (b'x-ratelimit-remaining-tokens', b'9744'), (b'x-ratelimit-reset-requests', b'32.916s'), (b'x-ratelimit-reset-tokens', b'1.53s'), (b'x-request-id', b'req_20f1bb8e5d233049a7ab9605c13e6ec4'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e1950398270cf-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:29:34,822 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:29:34,822 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:29:34,823 - DEBUG - receive_response_body.complete
2024-10-15 10:29:34,823 - DEBUG - response_closed.started
2024-10-15 10:29:34,823 - DEBUG - response_closed.complete
2024-10-15 10:29:34,823 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:29:35 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '889', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9996', 'x-ratelimit-remaining-tokens': '9744', 'x-ratelimit-reset-requests': '32.916s', 'x-ratelimit-reset-tokens': '1.53s', 'x-request-id': 'req_20f1bb8e5d233049a7ab9605c13e6ec4', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e1950398270cf-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:29:34,823 - DEBUG - request_id: req_20f1bb8e5d233049a7ab9605c13e6ec4
2024-10-15 10:29:34,824 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWHmXK7ZTqwyboMMaUT2J8FopoBz', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_9atRvM4fi25YQiJzvvH3aU8L', function=Function(arguments='{\n"action": "determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728977374, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=11, prompt_tokens=207, total_tokens=218, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:29:38,602 - DEBUG - max_retries: 1
2024-10-15 10:29:38,604 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Assign roles: 'host' and 'guest'. Participants are: ELENA VASILESCU, SENTIMENT BRUSLI. Respond strictly in JSON format with keys 'host' and 'guest'."}], 'model': 'gpt-4', 'response_format': {'type': 'json_object', 'strict': True}}}
2024-10-15 10:29:38,604 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:29:38,604 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:29:38,604 - DEBUG - send_request_headers.complete
2024-10-15 10:29:38,604 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:29:38,605 - DEBUG - send_request_body.complete
2024-10-15 10:29:38,605 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:29:38,799 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 400, b'Bad Request', [(b'Date', b'Tue, 15 Oct 2024 07:29:39 GMT'), (b'Content-Type', b'application/json'), (b'Content-Length', b'191'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'19'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9995'), (b'x-ratelimit-remaining-tokens', b'9855'), (b'x-ratelimit-reset-requests', b'36.727s'), (b'x-ratelimit-reset-tokens', b'870ms'), (b'x-request-id', b'req_7a7253c0f8fcfb9022d9bee782051026'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e196e6b6470cf-OTP'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:29:38,800 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-10-15 10:29:38,801 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:29:38,801 - DEBUG - receive_response_body.complete
2024-10-15 10:29:38,801 - DEBUG - response_closed.started
2024-10-15 10:29:38,801 - DEBUG - response_closed.complete
2024-10-15 10:29:38,801 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "400 Bad Request" Headers({'date': 'Tue, 15 Oct 2024 07:29:39 GMT', 'content-type': 'application/json', 'content-length': '191', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '19', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9995', 'x-ratelimit-remaining-tokens': '9855', 'x-ratelimit-reset-requests': '36.727s', 'x-ratelimit-reset-tokens': '870ms', 'x-request-id': 'req_7a7253c0f8fcfb9022d9bee782051026', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e196e6b6470cf-OTP', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:29:38,802 - DEBUG - request_id: req_7a7253c0f8fcfb9022d9bee782051026
2024-10-15 10:29:38,802 - DEBUG - Encountered httpx.HTTPStatusError
Traceback (most recent call last):
  File "D:\deve\contract_automation\.venv\Lib\site-packages\openai\_base_client.py", line 1030, in _request
    response.raise_for_status()
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpx\_models.py", line 763, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '400 Bad Request' for url 'https://api.openai.com/v1/chat/completions'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400
2024-10-15 10:29:38,808 - DEBUG - Not retrying
2024-10-15 10:29:38,808 - DEBUG - Re-raising status error
2024-10-15 10:29:38,809 - ERROR - Error in determine_contract_details: Error code: 400 - {'error': {'message': "Unknown parameter: 'response_format.strict'.", 'type': 'invalid_request_error', 'param': 'response_format.strict', 'code': 'unknown_parameter'}}
2024-10-15 10:29:38,971 - DEBUG - close.started
2024-10-15 10:29:38,972 - DEBUG - close.complete
2024-10-15 10:31:39,892 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-15 10:31:41,167 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-15 10:31:41,168 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-15 10:31:41,485 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-15 10:31:41,486 - DEBUG - Using proactor: IocpProactor
2024-10-15 10:31:41,504 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:31:41,504 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:31:41,504 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:31:41,504 - DEBUG - Compression method 0
2024-10-15 10:31:41,504 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:31:41,504 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:31:41,504 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 10:31:41,504 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 10:31:41,504 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 10:31:41,504 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 10:31:41,505 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:31:41,505 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:31:41,505 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:31:41,505 - DEBUG - Compression method 0
2024-10-15 10:31:41,505 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:31:41,505 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:31:41,505 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 10:31:41,505 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 10:31:41,505 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 10:31:41,505 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 10:31:41,514 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:31:41,514 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:31:41,514 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 10:31:41,514 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 10:31:41,515 - DEBUG - Error closing: Operation on closed image
2024-10-15 10:31:43,607 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:31:43,607 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:31:43,607 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:31:43,607 - DEBUG - Compression method 0
2024-10-15 10:31:43,607 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:31:43,607 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:31:43,607 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 10:31:43,607 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 10:31:43,607 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 10:31:43,607 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 10:31:43,607 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:31:43,607 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:31:43,607 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:31:43,607 - DEBUG - Compression method 0
2024-10-15 10:31:43,607 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:31:43,607 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:31:43,607 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 10:31:43,607 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 10:31:43,607 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 10:31:43,608 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 10:31:43,625 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:31:43,625 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:31:43,625 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 10:31:43,625 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 10:31:43,626 - DEBUG - Error closing: Operation on closed image
2024-10-15 10:31:46,200 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 0 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 10:31:46,201 - DEBUG - max_retries: 1
2024-10-15 10:31:46,203 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 0 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 10:31:46,241 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:31:46,241 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-15 10:31:46,268 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001D344CB6690>
2024-10-15 10:31:46,268 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x000001D344B92750> server_hostname='api.openai.com' timeout=5.0
2024-10-15 10:31:46,276 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001D344D1FE00>
2024-10-15 10:31:46,276 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:31:46,276 - DEBUG - send_request_headers.complete
2024-10-15 10:31:46,276 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:31:46,276 - DEBUG - send_request_body.complete
2024-10-15 10:31:46,276 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:31:47,711 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:31:48 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1262'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'9821'), (b'x-ratelimit-reset-requests', b'8.64s'), (b'x-ratelimit-reset-tokens', b'1.074s'), (b'x-request-id', b'req_a7eb15acde844f0b763b87a0156e3315'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=lVHLPZ2t0NczU6R50UMY_mHaFfLiU58Rah9DtJLA.cQ-1728977508-1.0.1.1-uLMQv1lOcJMdgRvSe_ViHYPrVupz2AguS9YlRGBQmcxIhf0Eojh4wCy3V1wfct4gTnO1W2gFWgzrbqFQb5rPrw; path=/; expires=Tue, 15-Oct-24 08:01:48 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=9gaCxMdGL63RmPXimz2g7GZPehneJ2EFGQvINiBTbu0-1728977508661-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e1c8c3ceec9ec-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:31:47,712 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:31:47,712 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:31:47,712 - DEBUG - receive_response_body.complete
2024-10-15 10:31:47,712 - DEBUG - response_closed.started
2024-10-15 10:31:47,712 - DEBUG - response_closed.complete
2024-10-15 10:31:47,712 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Tue, 15 Oct 2024 07:31:48 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-kzzh9hik9ryjiou4ftvhondh'), ('openai-processing-ms', '1262'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '10000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '9821'), ('x-ratelimit-reset-requests', '8.64s'), ('x-ratelimit-reset-tokens', '1.074s'), ('x-request-id', 'req_a7eb15acde844f0b763b87a0156e3315'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=lVHLPZ2t0NczU6R50UMY_mHaFfLiU58Rah9DtJLA.cQ-1728977508-1.0.1.1-uLMQv1lOcJMdgRvSe_ViHYPrVupz2AguS9YlRGBQmcxIhf0Eojh4wCy3V1wfct4gTnO1W2gFWgzrbqFQb5rPrw; path=/; expires=Tue, 15-Oct-24 08:01:48 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=9gaCxMdGL63RmPXimz2g7GZPehneJ2EFGQvINiBTbu0-1728977508661-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d2e1c8c3ceec9ec-OTP'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-15 10:31:47,712 - DEBUG - request_id: req_a7eb15acde844f0b763b87a0156e3315
2024-10-15 10:31:47,714 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWJvksLzwxnCIK5Q2CN8sCS1JFPT', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_C5XwGsvjn027DBgbWNTGRRri', function=Function(arguments='\n{\n"action": "extract_pii"\n}', name='AgentAction'), type='function')]))], created=1728977507, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=11, prompt_tokens=207, total_tokens=218, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:31:47,715 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.PIIData'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}}
2024-10-15 10:31:47,715 - DEBUG - max_retries: 1
2024-10-15 10:31:47,717 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}, 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}]}}
2024-10-15 10:31:47,717 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:31:47,717 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:31:47,717 - DEBUG - send_request_headers.complete
2024-10-15 10:31:47,718 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:31:47,718 - DEBUG - send_request_body.complete
2024-10-15 10:31:47,718 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:31:50,293 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:31:51 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2417'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9998'), (b'x-ratelimit-remaining-tokens', b'9720'), (b'x-ratelimit-reset-requests', b'15.844s'), (b'x-ratelimit-reset-tokens', b'1.675s'), (b'x-request-id', b'req_125d94be9396082231c04feb6520287c'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e1c953dc5c9ec-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:31:50,294 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:31:50,295 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:31:50,295 - DEBUG - receive_response_body.complete
2024-10-15 10:31:50,295 - DEBUG - response_closed.started
2024-10-15 10:31:50,295 - DEBUG - response_closed.complete
2024-10-15 10:31:50,296 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:31:51 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '2417', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9998', 'x-ratelimit-remaining-tokens': '9720', 'x-ratelimit-reset-requests': '15.844s', 'x-ratelimit-reset-tokens': '1.675s', 'x-request-id': 'req_125d94be9396082231c04feb6520287c', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e1c953dc5c9ec-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:31:50,296 - DEBUG - request_id: req_125d94be9396082231c04feb6520287c
2024-10-15 10:31:50,297 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWJw9nSTuqDK1eBSStsfLhCfGG09', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_iI7c16Q6o1LN8sUYEFCF5asf', function=Function(arguments='{\n"name": "ISPILANTE SENTIMENT BRUSLI",\n"address": "Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR"\n}', name='PIIData'), type='function')]))], created=1728977508, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=39, prompt_tokens=377, total_tokens=416, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:31:52,344 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.PIIData'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}}
2024-10-15 10:31:52,344 - DEBUG - max_retries: 1
2024-10-15 10:31:52,345 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}, 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}]}}
2024-10-15 10:31:52,346 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:31:52,346 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:31:52,346 - DEBUG - send_request_headers.complete
2024-10-15 10:31:52,346 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:31:52,346 - DEBUG - send_request_body.complete
2024-10-15 10:31:52,346 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:31:54,879 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:31:55 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2369'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9997'), (b'x-ratelimit-remaining-tokens', b'9742'), (b'x-ratelimit-reset-requests', b'19.845s'), (b'x-ratelimit-reset-tokens', b'1.548s'), (b'x-request-id', b'req_32bee0a9c8d8bddf19e4c497e5b7ac7e'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e1cb21fe8c9ec-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:31:54,879 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:31:54,879 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:31:54,879 - DEBUG - receive_response_body.complete
2024-10-15 10:31:54,879 - DEBUG - response_closed.started
2024-10-15 10:31:54,879 - DEBUG - response_closed.complete
2024-10-15 10:31:54,879 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:31:55 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '2369', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9997', 'x-ratelimit-remaining-tokens': '9742', 'x-ratelimit-reset-requests': '19.845s', 'x-ratelimit-reset-tokens': '1.548s', 'x-request-id': 'req_32bee0a9c8d8bddf19e4c497e5b7ac7e', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e1cb21fe8c9ec-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:31:54,879 - DEBUG - request_id: req_32bee0a9c8d8bddf19e4c497e5b7ac7e
2024-10-15 10:31:54,880 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWK1LIBIxKh7CAHO2jwSAs9lT9NX', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_AaQUtSHxcEKEdOeWrtr79yVE', function=Function(arguments='{\n"name": "ELENA VASILESCU",\n"address": "Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B"\n}', name='PIIData'), type='function')]))], created=1728977513, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=42, prompt_tokens=380, total_tokens=422, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:31:56,146 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 10:31:56,146 - DEBUG - max_retries: 1
2024-10-15 10:31:56,148 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 10:31:56,148 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:31:56,149 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:31:56,149 - DEBUG - send_request_headers.complete
2024-10-15 10:31:56,149 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:31:56,149 - DEBUG - send_request_body.complete
2024-10-15 10:31:56,149 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:31:57,233 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:31:58 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'935'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9997'), (b'x-ratelimit-remaining-tokens', b'9821'), (b'x-ratelimit-reset-requests', b'24.697s'), (b'x-ratelimit-reset-tokens', b'1.074s'), (b'x-request-id', b'req_4799d3e1a3d7303287a067727057b43a'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e1cc9ed93c9ec-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:31:57,234 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:31:57,235 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:31:57,235 - DEBUG - receive_response_body.complete
2024-10-15 10:31:57,235 - DEBUG - response_closed.started
2024-10-15 10:31:57,236 - DEBUG - response_closed.complete
2024-10-15 10:31:57,236 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:31:58 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '935', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9997', 'x-ratelimit-remaining-tokens': '9821', 'x-ratelimit-reset-requests': '24.697s', 'x-ratelimit-reset-tokens': '1.074s', 'x-request-id': 'req_4799d3e1a3d7303287a067727057b43a', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e1cc9ed93c9ec-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:31:57,236 - DEBUG - request_id: req_4799d3e1a3d7303287a067727057b43a
2024-10-15 10:31:57,237 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWK5oG51tLIaHN2OnJyb0u9spypF', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_HkITpMRz924Hq0IJJKYvynQt', function=Function(arguments='\n{\n"action": "identify_parties"\n}', name='AgentAction'), type='function')]))], created=1728977517, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=11, prompt_tokens=207, total_tokens=218, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:31:57,239 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.ContractParties'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Identify the buyer and seller from the given information:\n\nName: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'properties': {'buyer': {'description': 'Name of the buyer', 'title': 'Buyer', 'type': 'string'}, 'seller': {'description': 'Name of the seller', 'title': 'Seller', 'type': 'string'}}, 'required': ['buyer', 'seller'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}}
2024-10-15 10:31:57,239 - DEBUG - max_retries: 1
2024-10-15 10:31:57,242 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Identify the buyer and seller from the given information:\n\nName: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}, 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'properties': {'buyer': {'description': 'Name of the buyer', 'title': 'Buyer', 'type': 'string'}, 'seller': {'description': 'Name of the seller', 'title': 'Seller', 'type': 'string'}}, 'required': ['buyer', 'seller'], 'type': 'object'}}}]}}
2024-10-15 10:31:57,242 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:31:57,242 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:31:57,243 - DEBUG - send_request_headers.complete
2024-10-15 10:31:57,243 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:31:57,243 - DEBUG - send_request_body.complete
2024-10-15 10:31:57,243 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:31:59,037 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:31:59 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1641'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9996'), (b'x-ratelimit-remaining-tokens', b'9796'), (b'x-ratelimit-reset-requests', b'32.257s'), (b'x-ratelimit-reset-tokens', b'1.223s'), (b'x-request-id', b'req_ac84de243d695ea31f8a06c5946bacc4'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e1cd0befdc9ec-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:31:59,037 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:31:59,037 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:31:59,037 - DEBUG - receive_response_body.complete
2024-10-15 10:31:59,037 - DEBUG - response_closed.started
2024-10-15 10:31:59,037 - DEBUG - response_closed.complete
2024-10-15 10:31:59,037 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:31:59 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1641', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9996', 'x-ratelimit-remaining-tokens': '9796', 'x-ratelimit-reset-requests': '32.257s', 'x-ratelimit-reset-tokens': '1.223s', 'x-request-id': 'req_ac84de243d695ea31f8a06c5946bacc4', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e1cd0befdc9ec-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:31:59,037 - DEBUG - request_id: req_ac84de243d695ea31f8a06c5946bacc4
2024-10-15 10:31:59,038 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWK6yjbWbgJadQtkAOL3MCAGMGS9', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_Q1kn6neExtRwTaO9HkQCmdg2', function=Function(arguments='{\n"buyer": "ISPILANTE SENTIMENT BRUSLI",\n"seller": "ELENA VASILESCU"\n}', name='ContractParties'), type='function')]))], created=1728977518, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=28, prompt_tokens=232, total_tokens=260, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:31:59,038 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: Yes\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 10:31:59,039 - DEBUG - max_retries: 1
2024-10-15 10:31:59,040 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: Yes\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 10:31:59,040 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:31:59,040 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:31:59,041 - DEBUG - send_request_headers.complete
2024-10-15 10:31:59,041 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:31:59,041 - DEBUG - send_request_body.complete
2024-10-15 10:31:59,041 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:32:00,356 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:32:01 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'967'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9995'), (b'x-ratelimit-remaining-tokens', b'9754'), (b'x-ratelimit-reset-requests', b'39.079s'), (b'x-ratelimit-reset-tokens', b'1.474s'), (b'x-request-id', b'req_2ce5db4c6aa3d09f4d100a06b4b6a966'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e1cdbfbf1c9ec-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:32:00,357 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:32:00,358 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:32:00,358 - DEBUG - receive_response_body.complete
2024-10-15 10:32:00,358 - DEBUG - response_closed.started
2024-10-15 10:32:00,358 - DEBUG - response_closed.complete
2024-10-15 10:32:00,359 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:32:01 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '967', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9995', 'x-ratelimit-remaining-tokens': '9754', 'x-ratelimit-reset-requests': '39.079s', 'x-ratelimit-reset-tokens': '1.474s', 'x-request-id': 'req_2ce5db4c6aa3d09f4d100a06b4b6a966', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e1cdbfbf1c9ec-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:32:00,359 - DEBUG - request_id: req_2ce5db4c6aa3d09f4d100a06b4b6a966
2024-10-15 10:32:00,361 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWK8YO264tTk6qs0vJaDVVOUsjGa', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_wji7B1vHsrooOsylT3iMnLy5', function=Function(arguments='\n{\n  "action": "determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728977520, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=13, prompt_tokens=207, total_tokens=220, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:32:03,271 - DEBUG - max_retries: 1
2024-10-15 10:32:03,273 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Assign roles: 'host' and 'guest'. Participants: ISPILANTE SENTIMENT BRUSLI, ELENA VASILESCU. Respond in JSON format with keys 'host' and 'guest'."}], 'model': 'gpt-4', 'function_call': 'auto'}}
2024-10-15 10:32:03,273 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:32:03,273 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:32:03,274 - DEBUG - send_request_headers.complete
2024-10-15 10:32:03,274 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:32:03,274 - DEBUG - send_request_body.complete
2024-10-15 10:32:03,274 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:32:03,435 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 400, b'Bad Request', [(b'Date', b'Tue, 15 Oct 2024 07:32:04 GMT'), (b'Content-Type', b'application/json'), (b'Content-Length', b'221'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'13'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9994'), (b'x-ratelimit-remaining-tokens', b'9856'), (b'x-ratelimit-reset-requests', b'43.488s'), (b'x-ratelimit-reset-tokens', b'864ms'), (b'x-request-id', b'req_429474eeba8e868bb0f9368889c4d395'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e1cf669c7c9ec-OTP'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:32:03,436 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2024-10-15 10:32:03,437 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:32:03,437 - DEBUG - receive_response_body.complete
2024-10-15 10:32:03,437 - DEBUG - response_closed.started
2024-10-15 10:32:03,437 - DEBUG - response_closed.complete
2024-10-15 10:32:03,437 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "400 Bad Request" Headers({'date': 'Tue, 15 Oct 2024 07:32:04 GMT', 'content-type': 'application/json', 'content-length': '221', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '13', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9994', 'x-ratelimit-remaining-tokens': '9856', 'x-ratelimit-reset-requests': '43.488s', 'x-ratelimit-reset-tokens': '864ms', 'x-request-id': 'req_429474eeba8e868bb0f9368889c4d395', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e1cf669c7c9ec-OTP', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:32:03,438 - DEBUG - request_id: req_429474eeba8e868bb0f9368889c4d395
2024-10-15 10:32:03,438 - DEBUG - Encountered httpx.HTTPStatusError
Traceback (most recent call last):
  File "D:\deve\contract_automation\.venv\Lib\site-packages\openai\_base_client.py", line 1030, in _request
    response.raise_for_status()
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpx\_models.py", line 763, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '400 Bad Request' for url 'https://api.openai.com/v1/chat/completions'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400
2024-10-15 10:32:03,444 - DEBUG - Not retrying
2024-10-15 10:32:03,444 - DEBUG - Re-raising status error
2024-10-15 10:32:03,445 - ERROR - Error in determine_contract_details: Error code: 400 - {'error': {'message': "Invalid value for 'function_call': 'function_call' is only allowed when 'functions' are specified.", 'type': 'invalid_request_error', 'param': 'function_call', 'code': None}}
2024-10-15 10:32:03,605 - DEBUG - close.started
2024-10-15 10:32:03,606 - DEBUG - close.complete
2024-10-15 10:33:39,479 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-15 10:33:40,735 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-15 10:33:40,736 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-15 10:33:41,048 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-15 10:33:41,049 - DEBUG - Using proactor: IocpProactor
2024-10-15 10:33:41,067 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:33:41,067 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:33:41,067 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:33:41,067 - DEBUG - Compression method 0
2024-10-15 10:33:41,067 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:33:41,067 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:33:41,067 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 10:33:41,067 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 10:33:41,067 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 10:33:41,067 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 10:33:41,067 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:33:41,067 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:33:41,067 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:33:41,067 - DEBUG - Compression method 0
2024-10-15 10:33:41,067 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:33:41,067 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:33:41,067 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 10:33:41,068 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 10:33:41,068 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 10:33:41,068 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 10:33:41,077 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:33:41,077 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:33:41,077 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 10:33:41,077 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 10:33:41,077 - DEBUG - Error closing: Operation on closed image
2024-10-15 10:33:43,094 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:33:43,094 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:33:43,094 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:33:43,094 - DEBUG - Compression method 0
2024-10-15 10:33:43,094 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:33:43,094 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:33:43,094 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 10:33:43,094 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 10:33:43,094 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 10:33:43,094 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 10:33:43,094 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:33:43,094 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:33:43,094 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:33:43,094 - DEBUG - Compression method 0
2024-10-15 10:33:43,094 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:33:43,094 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:33:43,094 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 10:33:43,094 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 10:33:43,094 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 10:33:43,094 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 10:33:43,111 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:33:43,111 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:33:43,111 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 10:33:43,111 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 10:33:43,112 - DEBUG - Error closing: Operation on closed image
2024-10-15 10:33:45,735 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 0 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 10:33:45,736 - DEBUG - max_retries: 1
2024-10-15 10:33:45,738 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 0 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 10:33:45,774 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:33:45,776 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-15 10:33:45,805 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x0000018669713E00>
2024-10-15 10:33:45,805 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x000001866957E750> server_hostname='api.openai.com' timeout=5.0
2024-10-15 10:33:45,814 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x0000018669713D10>
2024-10-15 10:33:45,814 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:33:45,814 - DEBUG - send_request_headers.complete
2024-10-15 10:33:45,815 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:33:45,815 - DEBUG - send_request_body.complete
2024-10-15 10:33:45,815 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:33:46,645 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:33:47 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'677'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'9821'), (b'x-ratelimit-reset-requests', b'8.64s'), (b'x-ratelimit-reset-tokens', b'1.074s'), (b'x-request-id', b'req_56debeae8995b9f2ff026ff15a75ef9e'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=J1kHjuPFXerDuUqrjxNRGLW.0hXbhS0zbM70B_aJtKE-1728977627-1.0.1.1-uTtuCYXmNOAEQsSP9BYq5aLMsc4L_li2gGXegnYHAAi358pM3mfOxC4SPpBy3A1dy8SHFbA5K0Az4ZmchKQMpw; path=/; expires=Tue, 15-Oct-24 08:03:47 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=k6dK1mSIK8lku_5_2bl3VktuIYHFBzlOJDDUQ7im_Cc-1728977627568-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e1f772c5cc9e0-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:33:46,647 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:33:46,647 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:33:46,648 - DEBUG - receive_response_body.complete
2024-10-15 10:33:46,648 - DEBUG - response_closed.started
2024-10-15 10:33:46,648 - DEBUG - response_closed.complete
2024-10-15 10:33:46,648 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Tue, 15 Oct 2024 07:33:47 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-kzzh9hik9ryjiou4ftvhondh'), ('openai-processing-ms', '677'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '10000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '9821'), ('x-ratelimit-reset-requests', '8.64s'), ('x-ratelimit-reset-tokens', '1.074s'), ('x-request-id', 'req_56debeae8995b9f2ff026ff15a75ef9e'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=J1kHjuPFXerDuUqrjxNRGLW.0hXbhS0zbM70B_aJtKE-1728977627-1.0.1.1-uTtuCYXmNOAEQsSP9BYq5aLMsc4L_li2gGXegnYHAAi358pM3mfOxC4SPpBy3A1dy8SHFbA5K0Az4ZmchKQMpw; path=/; expires=Tue, 15-Oct-24 08:03:47 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=k6dK1mSIK8lku_5_2bl3VktuIYHFBzlOJDDUQ7im_Cc-1728977627568-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d2e1f772c5cc9e0-OTP'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-15 10:33:46,649 - DEBUG - request_id: req_56debeae8995b9f2ff026ff15a75ef9e
2024-10-15 10:33:46,655 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWLqxTlZT4s3bTJUWaAMymkOyTLM', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_kPCTgzQclvHBagIli9bjCyci', function=Function(arguments='{\n"action": "extract_pii"\n}', name='AgentAction'), type='function')]))], created=1728977626, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=10, prompt_tokens=207, total_tokens=217, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:33:46,657 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.PIIData'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}}
2024-10-15 10:33:46,657 - DEBUG - max_retries: 1
2024-10-15 10:33:46,659 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}, 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}]}}
2024-10-15 10:33:46,659 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:33:46,659 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:33:46,660 - DEBUG - send_request_headers.complete
2024-10-15 10:33:46,660 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:33:46,660 - DEBUG - send_request_body.complete
2024-10-15 10:33:46,660 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:33:49,594 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:33:50 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2778'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9998'), (b'x-ratelimit-remaining-tokens', b'9657'), (b'x-ratelimit-reset-requests', b'16.449s'), (b'x-ratelimit-reset-tokens', b'2.055s'), (b'x-request-id', b'req_0252a72fb457b8f19b0cc748fea5c817'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e1f7c6b89c9e0-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:33:49,595 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:33:49,595 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:33:49,595 - DEBUG - receive_response_body.complete
2024-10-15 10:33:49,595 - DEBUG - response_closed.started
2024-10-15 10:33:49,595 - DEBUG - response_closed.complete
2024-10-15 10:33:49,595 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:33:50 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '2778', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9998', 'x-ratelimit-remaining-tokens': '9657', 'x-ratelimit-reset-requests': '16.449s', 'x-ratelimit-reset-tokens': '2.055s', 'x-request-id': 'req_0252a72fb457b8f19b0cc748fea5c817', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e1f7c6b89c9e0-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:33:49,595 - DEBUG - request_id: req_0252a72fb457b8f19b0cc748fea5c817
2024-10-15 10:33:49,595 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWLr3rhJLnmm3BwMsl0f58nPpai9', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_a3bMRq6wNKQ0ZpawdhlYLx4j', function=Function(arguments='{\n"name": "ISPILANTE SENTIMENT BRUSLI",\n"address": "Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR"\n}', name='PIIData'), type='function')]))], created=1728977627, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=39, prompt_tokens=377, total_tokens=416, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:33:53,294 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.PIIData'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}}
2024-10-15 10:33:53,294 - DEBUG - max_retries: 1
2024-10-15 10:33:53,296 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}, 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}]}}
2024-10-15 10:33:53,297 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:33:53,297 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:33:53,297 - DEBUG - send_request_headers.complete
2024-10-15 10:33:53,297 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:33:53,297 - DEBUG - send_request_body.complete
2024-10-15 10:33:53,298 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:33:55,833 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:33:56 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2364'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9997'), (b'x-ratelimit-remaining-tokens', b'9742'), (b'x-ratelimit-reset-requests', b'18.427s'), (b'x-ratelimit-reset-tokens', b'1.548s'), (b'x-request-id', b'req_4b615c78a651154c8ed62325862b5392'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e1fa5e836c9e0-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:33:55,834 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:33:55,834 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:33:55,834 - DEBUG - receive_response_body.complete
2024-10-15 10:33:55,835 - DEBUG - response_closed.started
2024-10-15 10:33:55,835 - DEBUG - response_closed.complete
2024-10-15 10:33:55,835 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:33:56 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '2364', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9997', 'x-ratelimit-remaining-tokens': '9742', 'x-ratelimit-reset-requests': '18.427s', 'x-ratelimit-reset-tokens': '1.548s', 'x-request-id': 'req_4b615c78a651154c8ed62325862b5392', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e1fa5e836c9e0-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:33:55,835 - DEBUG - request_id: req_4b615c78a651154c8ed62325862b5392
2024-10-15 10:33:55,836 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWLyWt79NMZxbU9crIyMUWLIsl6r', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_bK6TRb5ArqEmvce9nX1U0HeT', function=Function(arguments='{\n"name": "ELENA VASILESCU",\n"address": "Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3"\n}', name='PIIData'), type='function')]))], created=1728977634, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=39, prompt_tokens=380, total_tokens=419, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:34:09,853 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 10:34:09,853 - DEBUG - max_retries: 1
2024-10-15 10:34:09,855 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 10:34:09,856 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:34:09,856 - DEBUG - close.started
2024-10-15 10:34:09,856 - DEBUG - close.complete
2024-10-15 10:34:09,856 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-15 10:34:09,862 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x0000018669946AB0>
2024-10-15 10:34:09,863 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x000001866957E750> server_hostname='api.openai.com' timeout=5.0
2024-10-15 10:34:09,870 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x0000018669946660>
2024-10-15 10:34:09,870 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:34:09,870 - DEBUG - send_request_headers.complete
2024-10-15 10:34:09,870 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:34:09,870 - DEBUG - send_request_body.complete
2024-10-15 10:34:09,871 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:34:11,441 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:34:12 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1417'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9998'), (b'x-ratelimit-remaining-tokens', b'9821'), (b'x-ratelimit-reset-requests', b'10.51s'), (b'x-ratelimit-reset-tokens', b'1.074s'), (b'x-request-id', b'req_861c0d2537b40839691acc571e0141b7'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e200d7819c9f1-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:34:11,442 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:34:11,442 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:34:11,442 - DEBUG - receive_response_body.complete
2024-10-15 10:34:11,442 - DEBUG - response_closed.started
2024-10-15 10:34:11,442 - DEBUG - response_closed.complete
2024-10-15 10:34:11,442 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:34:12 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1417', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9998', 'x-ratelimit-remaining-tokens': '9821', 'x-ratelimit-reset-requests': '10.51s', 'x-ratelimit-reset-tokens': '1.074s', 'x-request-id': 'req_861c0d2537b40839691acc571e0141b7', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e200d7819c9f1-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:34:11,442 - DEBUG - request_id: req_861c0d2537b40839691acc571e0141b7
2024-10-15 10:34:11,442 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWMFq4XO0W5s6gokfpHFuTHUjPKn', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_s6uD6wKHBYdnRqysaSDiESfO', function=Function(arguments='\n{\n"action": "identify_parties"\n}', name='AgentAction'), type='function')]))], created=1728977651, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=11, prompt_tokens=207, total_tokens=218, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:34:11,443 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.ContractParties'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Identify the buyer and seller from the given information:\n\nName: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3'}], 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'properties': {'buyer': {'description': 'Name of the buyer', 'title': 'Buyer', 'type': 'string'}, 'seller': {'description': 'Name of the seller', 'title': 'Seller', 'type': 'string'}}, 'required': ['buyer', 'seller'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}}
2024-10-15 10:34:11,443 - DEBUG - max_retries: 1
2024-10-15 10:34:11,446 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Identify the buyer and seller from the given information:\n\nName: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}, 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'properties': {'buyer': {'description': 'Name of the buyer', 'title': 'Buyer', 'type': 'string'}, 'seller': {'description': 'Name of the seller', 'title': 'Seller', 'type': 'string'}}, 'required': ['buyer', 'seller'], 'type': 'object'}}}]}}
2024-10-15 10:34:11,446 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:34:11,446 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:34:11,447 - DEBUG - send_request_headers.complete
2024-10-15 10:34:11,447 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:34:11,447 - DEBUG - send_request_body.complete
2024-10-15 10:34:11,447 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:34:13,171 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:34:14 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1561'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9997'), (b'x-ratelimit-remaining-tokens', b'9816'), (b'x-ratelimit-reset-requests', b'17.593s'), (b'x-ratelimit-reset-tokens', b'1.098s'), (b'x-request-id', b'req_1e2d238427068f5e7786a380fcb7fb56'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e20174a16c9f1-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:34:13,172 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:34:13,172 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:34:13,173 - DEBUG - receive_response_body.complete
2024-10-15 10:34:13,173 - DEBUG - response_closed.started
2024-10-15 10:34:13,173 - DEBUG - response_closed.complete
2024-10-15 10:34:13,173 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:34:14 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1561', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9997', 'x-ratelimit-remaining-tokens': '9816', 'x-ratelimit-reset-requests': '17.593s', 'x-ratelimit-reset-tokens': '1.098s', 'x-request-id': 'req_1e2d238427068f5e7786a380fcb7fb56', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e20174a16c9f1-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:34:13,174 - DEBUG - request_id: req_1e2d238427068f5e7786a380fcb7fb56
2024-10-15 10:34:13,175 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWMGUbh71CNNptJZcBWbBZQ9Wcx6', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_L35jwUYZlkurXCred0l24lXH', function=Function(arguments='{\n"buyer": "ISPILANTE SENTIMENT BRUSLI",\n"seller": "ELENA VASILESCU"\n}', name='ContractParties'), type='function')]))], created=1728977652, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=28, prompt_tokens=229, total_tokens=257, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:34:13,178 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: Yes\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 10:34:13,178 - DEBUG - max_retries: 1
2024-10-15 10:34:13,181 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: Yes\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 10:34:13,182 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:34:13,182 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:34:13,182 - DEBUG - send_request_headers.complete
2024-10-15 10:34:13,182 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:34:13,182 - DEBUG - send_request_body.complete
2024-10-15 10:34:13,182 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:34:15,180 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:34:16 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1825'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9997'), (b'x-ratelimit-remaining-tokens', b'9756'), (b'x-ratelimit-reset-requests', b'24.482s'), (b'x-ratelimit-reset-tokens', b'1.461s'), (b'x-request-id', b'req_09985ba85c9899a426f9cd0a55954369'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e20222ef5c9f1-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:34:15,180 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:34:15,180 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:34:15,180 - DEBUG - receive_response_body.complete
2024-10-15 10:34:15,180 - DEBUG - response_closed.started
2024-10-15 10:34:15,180 - DEBUG - response_closed.complete
2024-10-15 10:34:15,181 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:34:16 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1825', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9997', 'x-ratelimit-remaining-tokens': '9756', 'x-ratelimit-reset-requests': '24.482s', 'x-ratelimit-reset-tokens': '1.461s', 'x-request-id': 'req_09985ba85c9899a426f9cd0a55954369', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e20222ef5c9f1-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:34:15,181 - DEBUG - request_id: req_09985ba85c9899a426f9cd0a55954369
2024-10-15 10:34:15,181 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWMIyZsaH5ig5xpopM1BZYSvTHaU', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_CZIRsUk3DBqUH0230j2WVmei', function=Function(arguments='\n{\n  "action": "determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728977654, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=13, prompt_tokens=207, total_tokens=220, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:34:17,869 - DEBUG - max_retries: 1
2024-10-15 10:34:17,871 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Assign roles: 'host' and 'guest'. Participants: ISPILANTE SENTIMENT BRUSLI, ELENA VASILESCU. Respond in JSON format with keys 'host' and 'guest'."}], 'model': 'gpt-4'}}
2024-10-15 10:34:17,872 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:34:17,872 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:34:17,872 - DEBUG - send_request_headers.complete
2024-10-15 10:34:17,872 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:34:17,872 - DEBUG - send_request_body.complete
2024-10-15 10:34:17,872 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:34:19,751 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:34:20 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1723'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9996'), (b'x-ratelimit-remaining-tokens', b'9856'), (b'x-ratelimit-reset-requests', b'28.43s'), (b'x-ratelimit-reset-tokens', b'864ms'), (b'x-request-id', b'req_7803de3d7340524f04667f1b1f4ea0ad'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e203f78c0c9f1-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:34:19,752 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:34:19,752 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:34:19,753 - DEBUG - receive_response_body.complete
2024-10-15 10:34:19,753 - DEBUG - response_closed.started
2024-10-15 10:34:19,753 - DEBUG - response_closed.complete
2024-10-15 10:34:19,753 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:34:20 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1723', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9996', 'x-ratelimit-remaining-tokens': '9856', 'x-ratelimit-reset-requests': '28.43s', 'x-ratelimit-reset-tokens': '864ms', 'x-request-id': 'req_7803de3d7340524f04667f1b1f4ea0ad', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e203f78c0c9f1-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:34:19,753 - DEBUG - request_id: req_7803de3d7340524f04667f1b1f4ea0ad
2024-10-15 10:34:19,755 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWMMvL989SE7FIYueUlHHMdeHdLc', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='{\n  "host": "ISPILANTE SENTIMENT BRUSLI",\n  "guest": "ELENA VASILESCU"\n}', refusal=None, role='assistant', function_call=None, tool_calls=None))], created=1728977658, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=30, prompt_tokens=127, total_tokens=157, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:34:19,755 - DEBUG - No response model, returning response as is
2024-10-15 10:34:19,755 - ERROR - Error in determine_contract_details: No valid response received from the API.
2024-10-15 10:34:19,926 - DEBUG - close.started
2024-10-15 10:34:19,927 - DEBUG - close.complete
2024-10-15 10:34:57,138 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-15 10:34:58,390 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-15 10:34:58,391 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-15 10:34:58,702 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-15 10:34:58,703 - DEBUG - Using proactor: IocpProactor
2024-10-15 10:34:58,722 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:34:58,722 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:34:58,722 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:34:58,722 - DEBUG - Compression method 0
2024-10-15 10:34:58,722 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:34:58,722 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:34:58,722 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 10:34:58,722 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 10:34:58,722 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 10:34:58,722 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 10:34:58,722 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:34:58,722 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:34:58,722 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:34:58,722 - DEBUG - Compression method 0
2024-10-15 10:34:58,722 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:34:58,722 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:34:58,722 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 10:34:58,722 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 10:34:58,722 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 10:34:58,722 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 10:34:58,732 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:34:58,732 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:34:58,732 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 10:34:58,732 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 10:34:58,733 - DEBUG - Error closing: Operation on closed image
2024-10-15 10:35:00,745 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:35:00,745 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:35:00,745 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:35:00,745 - DEBUG - Compression method 0
2024-10-15 10:35:00,745 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:35:00,745 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:35:00,745 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 10:35:00,745 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 10:35:00,745 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 10:35:00,745 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 10:35:00,745 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:35:00,745 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:35:00,746 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:35:00,746 - DEBUG - Compression method 0
2024-10-15 10:35:00,746 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:35:00,746 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:35:00,746 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 10:35:00,746 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 10:35:00,746 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 10:35:00,746 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 10:35:00,763 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:35:00,763 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:35:00,763 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 10:35:00,763 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 10:35:00,764 - DEBUG - Error closing: Operation on closed image
2024-10-15 10:35:03,292 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 0 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 10:35:03,292 - DEBUG - max_retries: 1
2024-10-15 10:35:03,294 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 0 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 10:35:03,331 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:35:03,331 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-15 10:35:03,423 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001A3F2206690>
2024-10-15 10:35:03,423 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x000001A3F20DE750> server_hostname='api.openai.com' timeout=5.0
2024-10-15 10:35:03,434 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001A3F20CB020>
2024-10-15 10:35:03,434 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:35:03,434 - DEBUG - send_request_headers.complete
2024-10-15 10:35:03,434 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:35:03,434 - DEBUG - send_request_body.complete
2024-10-15 10:35:03,434 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:35:04,525 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:35:05 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'939'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'9821'), (b'x-ratelimit-reset-requests', b'8.64s'), (b'x-ratelimit-reset-tokens', b'1.074s'), (b'x-request-id', b'req_4c3aad689455cf39bd09866742f6af45'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=ldhhz_TWadjiUz0gHwfBPGE2YztQ2lu16AxvZ9dmnlw-1728977705-1.0.1.1-9.cL.9gjc_kN04tnGHdJxinpWy_y94zpmSYUXZzqwd95zOUiNfCp_qQbaeOndlT9G8PiaW_3tgtjxEng84uyAw; path=/; expires=Tue, 15-Oct-24 08:05:05 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=uW2mfPXUuOyLIFbN4zg3qF7d4Vf29uko1_pMm4ROiho-1728977705432-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e215c2bcb625c-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:35:04,525 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:35:04,526 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:35:04,526 - DEBUG - receive_response_body.complete
2024-10-15 10:35:04,526 - DEBUG - response_closed.started
2024-10-15 10:35:04,526 - DEBUG - response_closed.complete
2024-10-15 10:35:04,526 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Tue, 15 Oct 2024 07:35:05 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-kzzh9hik9ryjiou4ftvhondh'), ('openai-processing-ms', '939'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '10000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '9821'), ('x-ratelimit-reset-requests', '8.64s'), ('x-ratelimit-reset-tokens', '1.074s'), ('x-request-id', 'req_4c3aad689455cf39bd09866742f6af45'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=ldhhz_TWadjiUz0gHwfBPGE2YztQ2lu16AxvZ9dmnlw-1728977705-1.0.1.1-9.cL.9gjc_kN04tnGHdJxinpWy_y94zpmSYUXZzqwd95zOUiNfCp_qQbaeOndlT9G8PiaW_3tgtjxEng84uyAw; path=/; expires=Tue, 15-Oct-24 08:05:05 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=uW2mfPXUuOyLIFbN4zg3qF7d4Vf29uko1_pMm4ROiho-1728977705432-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d2e215c2bcb625c-OTP'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-15 10:35:04,526 - DEBUG - request_id: req_4c3aad689455cf39bd09866742f6af45
2024-10-15 10:35:04,528 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWN6NUxNUpuI5J1MH7egY8xzHQdr', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_KE5r3JO9vVfiMatL2dtXhyaT', function=Function(arguments='\n{\n  "action": "extract_pii"\n}', name='AgentAction'), type='function')]))], created=1728977704, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=12, prompt_tokens=207, total_tokens=219, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:35:04,529 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.PIIData'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}}
2024-10-15 10:35:04,529 - DEBUG - max_retries: 1
2024-10-15 10:35:04,530 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}, 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}]}}
2024-10-15 10:35:04,531 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:35:04,531 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:35:04,531 - DEBUG - send_request_headers.complete
2024-10-15 10:35:04,531 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:35:04,531 - DEBUG - send_request_body.complete
2024-10-15 10:35:04,531 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:35:07,209 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:35:08 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2517'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9998'), (b'x-ratelimit-remaining-tokens', b'9702'), (b'x-ratelimit-reset-requests', b'16.168s'), (b'x-ratelimit-reset-tokens', b'1.786s'), (b'x-request-id', b'req_5ddbce1d5096328a137822404749b3c5'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e216308b7625c-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:35:07,210 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:35:07,210 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:35:07,211 - DEBUG - receive_response_body.complete
2024-10-15 10:35:07,211 - DEBUG - response_closed.started
2024-10-15 10:35:07,211 - DEBUG - response_closed.complete
2024-10-15 10:35:07,211 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:35:08 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '2517', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9998', 'x-ratelimit-remaining-tokens': '9702', 'x-ratelimit-reset-requests': '16.168s', 'x-ratelimit-reset-tokens': '1.786s', 'x-request-id': 'req_5ddbce1d5096328a137822404749b3c5', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e216308b7625c-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:35:07,211 - DEBUG - request_id: req_5ddbce1d5096328a137822404749b3c5
2024-10-15 10:35:07,213 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWN7SDEEyJ93XCzeWlnY8Xnad6T5', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_QWQVP5hOBaCYH4csjFWVqRhg', function=Function(arguments='{\n"name": "ISPILANTE SENTIMENT BRUSLI",\n"address": "Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR"\n}', name='PIIData'), type='function')]))], created=1728977705, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=39, prompt_tokens=377, total_tokens=416, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:35:09,766 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.PIIData'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}}
2024-10-15 10:35:09,766 - DEBUG - max_retries: 1
2024-10-15 10:35:09,769 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}, 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}]}}
2024-10-15 10:35:09,770 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:35:09,770 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:35:09,770 - DEBUG - send_request_headers.complete
2024-10-15 10:35:09,770 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:35:09,770 - DEBUG - send_request_body.complete
2024-10-15 10:35:09,770 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:35:12,311 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:35:13 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2367'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9997'), (b'x-ratelimit-remaining-tokens', b'9742'), (b'x-ratelimit-reset-requests', b'19.561s'), (b'x-ratelimit-reset-tokens', b'1.548s'), (b'x-request-id', b'req_7529a29545b3403168ef27c63ad0f738'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e2183bd5b625c-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:35:12,311 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:35:12,312 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:35:12,312 - DEBUG - receive_response_body.complete
2024-10-15 10:35:12,312 - DEBUG - response_closed.started
2024-10-15 10:35:12,313 - DEBUG - response_closed.complete
2024-10-15 10:35:12,313 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:35:13 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '2367', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9997', 'x-ratelimit-remaining-tokens': '9742', 'x-ratelimit-reset-requests': '19.561s', 'x-ratelimit-reset-tokens': '1.548s', 'x-request-id': 'req_7529a29545b3403168ef27c63ad0f738', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e2183bd5b625c-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:35:12,313 - DEBUG - request_id: req_7529a29545b3403168ef27c63ad0f738
2024-10-15 10:35:12,314 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWNDYfGUs3xhqZpUv9BdeOlrA04z', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_Y0Vk3vuyl513lxVDDfX7Loyv', function=Function(arguments='{\n"name": "ELENA VASILESCU",\n"address": "Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B"\n}', name='PIIData'), type='function')]))], created=1728977711, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=42, prompt_tokens=380, total_tokens=422, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:35:13,473 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 10:35:13,473 - DEBUG - max_retries: 1
2024-10-15 10:35:13,475 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 10:35:13,475 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:35:13,475 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:35:13,476 - DEBUG - send_request_headers.complete
2024-10-15 10:35:13,476 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:35:13,476 - DEBUG - send_request_body.complete
2024-10-15 10:35:13,476 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:35:14,531 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:35:15 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'896'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9997'), (b'x-ratelimit-remaining-tokens', b'9821'), (b'x-ratelimit-reset-requests', b'24.501s'), (b'x-ratelimit-reset-tokens', b'1.074s'), (b'x-request-id', b'req_0e9bf02abdf4bd079cf39ac71b156868'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e219aec87625c-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:35:14,531 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:35:14,532 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:35:14,533 - DEBUG - receive_response_body.complete
2024-10-15 10:35:14,533 - DEBUG - response_closed.started
2024-10-15 10:35:14,533 - DEBUG - response_closed.complete
2024-10-15 10:35:14,533 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:35:15 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '896', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9997', 'x-ratelimit-remaining-tokens': '9821', 'x-ratelimit-reset-requests': '24.501s', 'x-ratelimit-reset-tokens': '1.074s', 'x-request-id': 'req_0e9bf02abdf4bd079cf39ac71b156868', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e219aec87625c-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:35:14,533 - DEBUG - request_id: req_0e9bf02abdf4bd079cf39ac71b156868
2024-10-15 10:35:14,535 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWNGGYO6anoKxdnyrfQkGyLA6ahw', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_EQEm5VrDnzGgdGKQs8pPsg04', function=Function(arguments='\n{\n"action": "identify_parties"\n}', name='AgentAction'), type='function')]))], created=1728977714, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=11, prompt_tokens=207, total_tokens=218, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:35:14,537 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.ContractParties'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Identify the buyer and seller from the given information:\n\nName: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'properties': {'buyer': {'description': 'Name of the buyer', 'title': 'Buyer', 'type': 'string'}, 'seller': {'description': 'Name of the seller', 'title': 'Seller', 'type': 'string'}}, 'required': ['buyer', 'seller'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}}
2024-10-15 10:35:14,537 - DEBUG - max_retries: 1
2024-10-15 10:35:14,539 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Identify the buyer and seller from the given information:\n\nName: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}, 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'properties': {'buyer': {'description': 'Name of the buyer', 'title': 'Buyer', 'type': 'string'}, 'seller': {'description': 'Name of the seller', 'title': 'Seller', 'type': 'string'}}, 'required': ['buyer', 'seller'], 'type': 'object'}}}]}}
2024-10-15 10:35:14,539 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:35:14,539 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:35:14,539 - DEBUG - send_request_headers.complete
2024-10-15 10:35:14,539 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:35:14,539 - DEBUG - send_request_body.complete
2024-10-15 10:35:14,539 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:35:16,086 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:35:16 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1386'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9996'), (b'x-ratelimit-remaining-tokens', b'9792'), (b'x-ratelimit-reset-requests', b'32.083s'), (b'x-ratelimit-reset-tokens', b'1.245s'), (b'x-request-id', b'req_774a3c9b0f36c876c8c303f0c9aeda48'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e21a188b5625c-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:35:16,086 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:35:16,086 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:35:16,086 - DEBUG - receive_response_body.complete
2024-10-15 10:35:16,086 - DEBUG - response_closed.started
2024-10-15 10:35:16,086 - DEBUG - response_closed.complete
2024-10-15 10:35:16,087 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:35:16 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1386', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9996', 'x-ratelimit-remaining-tokens': '9792', 'x-ratelimit-reset-requests': '32.083s', 'x-ratelimit-reset-tokens': '1.245s', 'x-request-id': 'req_774a3c9b0f36c876c8c303f0c9aeda48', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e21a188b5625c-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:35:16,087 - DEBUG - request_id: req_774a3c9b0f36c876c8c303f0c9aeda48
2024-10-15 10:35:16,087 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWNHYECOjrLPA2x5XFQjXwcPVEsa', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_jQwmeXKqwjpwIGcnos9iD9q3', function=Function(arguments='{\n"buyer": "ISPILANTE SENTIMENT BRUSLI",\n"seller": "ELENA VASILESCU"\n}', name='ContractParties'), type='function')]))], created=1728977715, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=28, prompt_tokens=232, total_tokens=260, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:35:16,089 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: Yes\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 10:35:16,089 - DEBUG - max_retries: 1
2024-10-15 10:35:16,093 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: Yes\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 10:35:16,093 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:35:16,094 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:35:16,094 - DEBUG - send_request_headers.complete
2024-10-15 10:35:16,094 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:35:16,094 - DEBUG - send_request_body.complete
2024-10-15 10:35:16,094 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:35:17,501 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:35:18 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1237'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9995'), (b'x-ratelimit-remaining-tokens', b'9751'), (b'x-ratelimit-reset-requests', b'39.174s'), (b'x-ratelimit-reset-tokens', b'1.49s'), (b'x-request-id', b'req_22dd08ad15f841260d7eec27b00d991b'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e21ab4f78625c-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:35:17,502 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:35:17,502 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:35:17,502 - DEBUG - receive_response_body.complete
2024-10-15 10:35:17,503 - DEBUG - response_closed.started
2024-10-15 10:35:17,503 - DEBUG - response_closed.complete
2024-10-15 10:35:17,503 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:35:18 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1237', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9995', 'x-ratelimit-remaining-tokens': '9751', 'x-ratelimit-reset-requests': '39.174s', 'x-ratelimit-reset-tokens': '1.49s', 'x-request-id': 'req_22dd08ad15f841260d7eec27b00d991b', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e21ab4f78625c-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:35:17,503 - DEBUG - request_id: req_22dd08ad15f841260d7eec27b00d991b
2024-10-15 10:35:17,504 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWNJo3w2wUupEajmRLmTwU1rA7gg', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_TSShGdjSJFwyvJO57IpYo3iH', function=Function(arguments='\n{\n"action": "determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728977717, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=12, prompt_tokens=207, total_tokens=219, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:35:21,147 - DEBUG - max_retries: 1
2024-10-15 10:35:21,149 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Assign roles: 'host' and 'guest'. Participants: ISPILANTE SENTIMENT BRUSLI, ELENA VASILESCU. Respond in JSON format with keys 'host' and 'guest'."}], 'model': 'gpt-4'}}
2024-10-15 10:35:21,149 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:35:21,149 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:35:21,150 - DEBUG - send_request_headers.complete
2024-10-15 10:35:21,150 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:35:21,150 - DEBUG - send_request_body.complete
2024-10-15 10:35:21,150 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:35:23,423 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:35:24 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2111'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9995'), (b'x-ratelimit-remaining-tokens', b'9856'), (b'x-ratelimit-reset-requests', b'42.754s'), (b'x-ratelimit-reset-tokens', b'864ms'), (b'x-request-id', b'req_a42146fbb288a09c4cf300ec7cccbbc7'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e21cadd56625c-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:35:23,424 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:35:23,424 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:35:23,424 - DEBUG - receive_response_body.complete
2024-10-15 10:35:23,424 - DEBUG - response_closed.started
2024-10-15 10:35:23,424 - DEBUG - response_closed.complete
2024-10-15 10:35:23,424 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:35:24 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '2111', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9995', 'x-ratelimit-remaining-tokens': '9856', 'x-ratelimit-reset-requests': '42.754s', 'x-ratelimit-reset-tokens': '864ms', 'x-request-id': 'req_a42146fbb288a09c4cf300ec7cccbbc7', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e21cadd56625c-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:35:23,424 - DEBUG - request_id: req_a42146fbb288a09c4cf300ec7cccbbc7
2024-10-15 10:35:23,424 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWNOlgEeq1L8zqO9r8dX0dBiVEPz', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content='{\n  "host": "ISPILANTE SENTIMENT BRUSLI",\n  "guest": "ELENA VASILESCU"\n}', refusal=None, role='assistant', function_call=None, tool_calls=None))], created=1728977722, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=30, prompt_tokens=127, total_tokens=157, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:35:23,424 - DEBUG - No response model, returning response as is
2024-10-15 10:35:23,425 - ERROR - Error in determine_contract_details: No valid response received from the API.
2024-10-15 10:35:23,582 - DEBUG - close.started
2024-10-15 10:35:23,582 - DEBUG - close.complete
2024-10-15 10:36:10,825 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-15 10:36:12,083 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-15 10:36:12,083 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-15 10:36:12,399 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-15 10:36:12,399 - DEBUG - Using proactor: IocpProactor
2024-10-15 10:36:12,418 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:36:12,418 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:36:12,418 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:36:12,418 - DEBUG - Compression method 0
2024-10-15 10:36:12,418 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:36:12,418 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:36:12,418 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 10:36:12,418 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 10:36:12,418 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 10:36:12,418 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 10:36:12,418 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:36:12,418 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:36:12,418 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:36:12,418 - DEBUG - Compression method 0
2024-10-15 10:36:12,418 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:36:12,418 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:36:12,418 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 10:36:12,418 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 10:36:12,418 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 10:36:12,418 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 10:36:12,428 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:36:12,428 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:36:12,428 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 10:36:12,428 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 10:36:12,429 - DEBUG - Error closing: Operation on closed image
2024-10-15 10:36:14,483 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:36:14,483 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:36:14,483 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:36:14,483 - DEBUG - Compression method 0
2024-10-15 10:36:14,484 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:36:14,484 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:36:14,484 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 10:36:14,484 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 10:36:14,484 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 10:36:14,484 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 10:36:14,484 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:36:14,484 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:36:14,484 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:36:14,484 - DEBUG - Compression method 0
2024-10-15 10:36:14,484 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:36:14,484 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:36:14,484 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 10:36:14,484 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 10:36:14,484 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 10:36:14,484 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 10:36:14,501 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:36:14,501 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:36:14,501 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 10:36:14,501 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 10:36:14,502 - DEBUG - Error closing: Operation on closed image
2024-10-15 10:36:17,694 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 0 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 10:36:17,695 - DEBUG - max_retries: 1
2024-10-15 10:36:17,697 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 0 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 10:36:17,745 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:36:17,746 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-15 10:36:17,837 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001F46C833E00>
2024-10-15 10:36:17,837 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x000001F46C69E750> server_hostname='api.openai.com' timeout=5.0
2024-10-15 10:36:17,847 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001F46C833B30>
2024-10-15 10:36:17,847 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:36:17,848 - DEBUG - send_request_headers.complete
2024-10-15 10:36:17,848 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:36:17,848 - DEBUG - send_request_body.complete
2024-10-15 10:36:17,848 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:36:18,725 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:36:19 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'721'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'9821'), (b'x-ratelimit-reset-requests', b'8.64s'), (b'x-ratelimit-reset-tokens', b'1.074s'), (b'x-request-id', b'req_591c7e590ac38c3576abb8d720ef46a4'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=9TMp0oQJThiRHnjJ215pz76nhVLmJtkKvpkbo2JYR6k-1728977779-1.0.1.1-hbrUzLcwKib0RBcgMFPpk64.7MCE7bzY4GZdVLffQXviLiQEsUiQyWLMr5mN27b0DVWWB.VsH.ENVweDISrHJA; path=/; expires=Tue, 15-Oct-24 08:06:19 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=vpx15I.Xp0_9tIKXm3Fo_nEfo8s9Kh_Sgs2cmMBeAII-1728977779616-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e232d2dc1b9ea-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:36:18,727 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:36:18,727 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:36:18,728 - DEBUG - receive_response_body.complete
2024-10-15 10:36:18,728 - DEBUG - response_closed.started
2024-10-15 10:36:18,728 - DEBUG - response_closed.complete
2024-10-15 10:36:18,728 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Tue, 15 Oct 2024 07:36:19 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-kzzh9hik9ryjiou4ftvhondh'), ('openai-processing-ms', '721'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '10000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '9821'), ('x-ratelimit-reset-requests', '8.64s'), ('x-ratelimit-reset-tokens', '1.074s'), ('x-request-id', 'req_591c7e590ac38c3576abb8d720ef46a4'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=9TMp0oQJThiRHnjJ215pz76nhVLmJtkKvpkbo2JYR6k-1728977779-1.0.1.1-hbrUzLcwKib0RBcgMFPpk64.7MCE7bzY4GZdVLffQXviLiQEsUiQyWLMr5mN27b0DVWWB.VsH.ENVweDISrHJA; path=/; expires=Tue, 15-Oct-24 08:06:19 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=vpx15I.Xp0_9tIKXm3Fo_nEfo8s9Kh_Sgs2cmMBeAII-1728977779616-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d2e232d2dc1b9ea-OTP'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-15 10:36:18,728 - DEBUG - request_id: req_591c7e590ac38c3576abb8d720ef46a4
2024-10-15 10:36:18,733 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWOIbmsHT5HMup7vI02NUxS0HNX6', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_EveD3mCEhCT4CS6HzGAIhKkh', function=Function(arguments='{\n"action": "extract_pii"\n}', name='AgentAction'), type='function')]))], created=1728977778, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=10, prompt_tokens=207, total_tokens=217, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:36:18,735 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.PIIData'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}}
2024-10-15 10:36:18,736 - DEBUG - max_retries: 1
2024-10-15 10:36:18,740 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}, 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}]}}
2024-10-15 10:36:18,741 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:36:18,741 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:36:18,741 - DEBUG - send_request_headers.complete
2024-10-15 10:36:18,742 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:36:18,742 - DEBUG - send_request_body.complete
2024-10-15 10:36:18,742 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:36:20,988 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:36:21 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2097'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9998'), (b'x-ratelimit-remaining-tokens', b'9667'), (b'x-ratelimit-reset-requests', b'16.386s'), (b'x-ratelimit-reset-tokens', b'1.992s'), (b'x-request-id', b'req_e45b468b9ded2e6334a1ddc04ee84c69'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e2332bb2db9ea-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:36:20,988 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:36:20,988 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:36:20,988 - DEBUG - receive_response_body.complete
2024-10-15 10:36:20,989 - DEBUG - response_closed.started
2024-10-15 10:36:20,989 - DEBUG - response_closed.complete
2024-10-15 10:36:20,989 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:36:21 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '2097', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9998', 'x-ratelimit-remaining-tokens': '9667', 'x-ratelimit-reset-requests': '16.386s', 'x-ratelimit-reset-tokens': '1.992s', 'x-request-id': 'req_e45b468b9ded2e6334a1ddc04ee84c69', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e2332bb2db9ea-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:36:20,989 - DEBUG - request_id: req_e45b468b9ded2e6334a1ddc04ee84c69
2024-10-15 10:36:20,989 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWOJ3g8MsWEjQ3VZawfuLjyb4n3N', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_jwBd2eAEFfejQUAKiGfy3Yxo', function=Function(arguments='{\n"name": "ISPILANTE SENTIMENT BRUSLI",\n"address": "Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR"\n}', name='PIIData'), type='function')]))], created=1728977779, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=39, prompt_tokens=377, total_tokens=416, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:36:26,377 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.PIIData'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}}
2024-10-15 10:36:26,378 - DEBUG - max_retries: 1
2024-10-15 10:36:26,381 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}, 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}]}}
2024-10-15 10:36:26,381 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:36:26,382 - DEBUG - close.started
2024-10-15 10:36:26,382 - DEBUG - close.complete
2024-10-15 10:36:26,382 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-15 10:36:26,387 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001F46C86FF50>
2024-10-15 10:36:26,387 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x000001F46C69E750> server_hostname='api.openai.com' timeout=5.0
2024-10-15 10:36:26,396 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001F46B2116D0>
2024-10-15 10:36:26,396 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:36:26,396 - DEBUG - send_request_headers.complete
2024-10-15 10:36:26,396 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:36:26,396 - DEBUG - send_request_body.complete
2024-10-15 10:36:26,396 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:36:28,531 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:36:29 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1974'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9997'), (b'x-ratelimit-remaining-tokens', b'9742'), (b'x-ratelimit-reset-requests', b'17.374s'), (b'x-ratelimit-reset-tokens', b'1.548s'), (b'x-request-id', b'req_3fbe9c85501dfb097f533536d272ea8a'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e23628c67b9ea-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:36:28,532 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:36:28,533 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:36:28,534 - DEBUG - receive_response_body.complete
2024-10-15 10:36:28,534 - DEBUG - response_closed.started
2024-10-15 10:36:28,534 - DEBUG - response_closed.complete
2024-10-15 10:36:28,534 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:36:29 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1974', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9997', 'x-ratelimit-remaining-tokens': '9742', 'x-ratelimit-reset-requests': '17.374s', 'x-ratelimit-reset-tokens': '1.548s', 'x-request-id': 'req_3fbe9c85501dfb097f533536d272ea8a', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e23628c67b9ea-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:36:28,534 - DEBUG - request_id: req_3fbe9c85501dfb097f533536d272ea8a
2024-10-15 10:36:28,536 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWORop1w6ZR9fr9jRVdfIepFLyD1', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_ACMsOebAESoxxJbrtN50tQTf', function=Function(arguments='{\n"name": "ELENA VASILESCU",\n"address": "Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B"\n}', name='PIIData'), type='function')]))], created=1728977787, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=42, prompt_tokens=380, total_tokens=422, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:36:30,555 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 10:36:30,555 - DEBUG - max_retries: 1
2024-10-15 10:36:30,557 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 10:36:30,558 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:36:30,558 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:36:30,558 - DEBUG - send_request_headers.complete
2024-10-15 10:36:30,558 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:36:30,558 - DEBUG - send_request_body.complete
2024-10-15 10:36:30,558 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:36:31,500 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:36:32 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'769'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9997'), (b'x-ratelimit-remaining-tokens', b'9821'), (b'x-ratelimit-reset-requests', b'21.849s'), (b'x-ratelimit-reset-tokens', b'1.074s'), (b'x-request-id', b'req_2a4870f56ef6c8c1f38f14be9a0ccb46'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e237c8ca9b9ea-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:36:31,500 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:36:31,501 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:36:31,501 - DEBUG - receive_response_body.complete
2024-10-15 10:36:31,501 - DEBUG - response_closed.started
2024-10-15 10:36:31,501 - DEBUG - response_closed.complete
2024-10-15 10:36:31,501 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:36:32 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '769', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9997', 'x-ratelimit-remaining-tokens': '9821', 'x-ratelimit-reset-requests': '21.849s', 'x-ratelimit-reset-tokens': '1.074s', 'x-request-id': 'req_2a4870f56ef6c8c1f38f14be9a0ccb46', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e237c8ca9b9ea-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:36:31,502 - DEBUG - request_id: req_2a4870f56ef6c8c1f38f14be9a0ccb46
2024-10-15 10:36:31,502 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWOVwMCgoSVNRNrem1I57VkPWv8N', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_3scFQY9fdl1o3uDq2UKAFREf', function=Function(arguments='{\n"action": "identify_parties"\n}', name='AgentAction'), type='function')]))], created=1728977791, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=10, prompt_tokens=207, total_tokens=217, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:36:31,504 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.ContractParties'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Identify the buyer and seller from the given information:\n\nName: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'properties': {'buyer': {'description': 'Name of the buyer', 'title': 'Buyer', 'type': 'string'}, 'seller': {'description': 'Name of the seller', 'title': 'Seller', 'type': 'string'}}, 'required': ['buyer', 'seller'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}}
2024-10-15 10:36:31,504 - DEBUG - max_retries: 1
2024-10-15 10:36:31,506 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Identify the buyer and seller from the given information:\n\nName: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}, 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'properties': {'buyer': {'description': 'Name of the buyer', 'title': 'Buyer', 'type': 'string'}, 'seller': {'description': 'Name of the seller', 'title': 'Seller', 'type': 'string'}}, 'required': ['buyer', 'seller'], 'type': 'object'}}}]}}
2024-10-15 10:36:31,507 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:36:31,507 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:36:31,507 - DEBUG - send_request_headers.complete
2024-10-15 10:36:31,507 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:36:31,507 - DEBUG - send_request_body.complete
2024-10-15 10:36:31,507 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:36:33,615 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:36:34 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1951'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9996'), (b'x-ratelimit-remaining-tokens', b'9774'), (b'x-ratelimit-reset-requests', b'29.544s'), (b'x-ratelimit-reset-tokens', b'1.353s'), (b'x-request-id', b'req_89a401beb1d3be99df000edf0ed8b737'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e23827a42b9ea-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:36:33,615 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:36:33,616 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:36:33,616 - DEBUG - receive_response_body.complete
2024-10-15 10:36:33,616 - DEBUG - response_closed.started
2024-10-15 10:36:33,616 - DEBUG - response_closed.complete
2024-10-15 10:36:33,616 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:36:34 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1951', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9996', 'x-ratelimit-remaining-tokens': '9774', 'x-ratelimit-reset-requests': '29.544s', 'x-ratelimit-reset-tokens': '1.353s', 'x-request-id': 'req_89a401beb1d3be99df000edf0ed8b737', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e23827a42b9ea-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:36:33,616 - DEBUG - request_id: req_89a401beb1d3be99df000edf0ed8b737
2024-10-15 10:36:33,617 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWOW5hgYUYbijQcmRhW1KPixVTrL', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_0RjkIGuKJ8uXbTxRJZmXkAqs', function=Function(arguments='{\n  "buyer": "ISPILANTE SENTIMENT BRUSLI",\n  "seller": "ELENA VASILESCU"\n}', name='ContractParties'), type='function')]))], created=1728977792, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=30, prompt_tokens=232, total_tokens=262, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:36:33,619 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: Yes\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 10:36:33,619 - DEBUG - max_retries: 1
2024-10-15 10:36:33,622 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: Yes\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 10:36:33,622 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:36:33,622 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:36:33,622 - DEBUG - send_request_headers.complete
2024-10-15 10:36:33,623 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:36:33,623 - DEBUG - send_request_body.complete
2024-10-15 10:36:33,623 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:36:34,964 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:36:35 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1185'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9995'), (b'x-ratelimit-remaining-tokens', b'9749'), (b'x-ratelimit-reset-requests', b'36.069s'), (b'x-ratelimit-reset-tokens', b'1.502s'), (b'x-request-id', b'req_cb51e4ad3af942aac421c7062dbe2b32'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e238fb816b9ea-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:36:34,965 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:36:34,965 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:36:34,965 - DEBUG - receive_response_body.complete
2024-10-15 10:36:34,965 - DEBUG - response_closed.started
2024-10-15 10:36:34,965 - DEBUG - response_closed.complete
2024-10-15 10:36:34,965 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:36:35 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1185', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9995', 'x-ratelimit-remaining-tokens': '9749', 'x-ratelimit-reset-requests': '36.069s', 'x-ratelimit-reset-tokens': '1.502s', 'x-request-id': 'req_cb51e4ad3af942aac421c7062dbe2b32', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e238fb816b9ea-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:36:34,965 - DEBUG - request_id: req_cb51e4ad3af942aac421c7062dbe2b32
2024-10-15 10:36:34,965 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWOYzexuc3MMRDl2SJv181LwlMle', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_IM4wOy4Z42O7iTjCn5lgJeFF', function=Function(arguments='\n{\n  "action": "determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728977794, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=13, prompt_tokens=207, total_tokens=220, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:36:37,562 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.ContractDetails'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Assign roles: 'host' and 'guest'. Participants: ISPILANTE SENTIMENT BRUSLI, ELENA VASILESCU."}], 'tools': [{'type': 'function', 'function': {'name': 'ContractDetails', 'description': 'Correctly extracted `ContractDetails` with all the required parameters with correct types', 'parameters': {'properties': {'contract_type': {'description': 'Type of contract (e.g., airbnb, buy-sell, it-consulting)', 'title': 'Contract Type', 'type': 'string'}, 'additional_info': {'additionalProperties': {'type': 'string'}, 'description': 'Additional information specific to the contract type', 'title': 'Additional Info', 'type': 'object'}}, 'required': ['additional_info', 'contract_type'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'ContractDetails'}}}
2024-10-15 10:36:37,562 - DEBUG - max_retries: 1
2024-10-15 10:36:37,564 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Assign roles: 'host' and 'guest'. Participants: ISPILANTE SENTIMENT BRUSLI, ELENA VASILESCU."}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'ContractDetails'}}, 'tools': [{'type': 'function', 'function': {'name': 'ContractDetails', 'description': 'Correctly extracted `ContractDetails` with all the required parameters with correct types', 'parameters': {'properties': {'contract_type': {'description': 'Type of contract (e.g., airbnb, buy-sell, it-consulting)', 'title': 'Contract Type', 'type': 'string'}, 'additional_info': {'additionalProperties': {'type': 'string'}, 'description': 'Additional information specific to the contract type', 'title': 'Additional Info', 'type': 'object'}}, 'required': ['additional_info', 'contract_type'], 'type': 'object'}}}]}}
2024-10-15 10:36:37,565 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:36:37,565 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:36:37,565 - DEBUG - send_request_headers.complete
2024-10-15 10:36:37,565 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:36:37,565 - DEBUG - send_request_body.complete
2024-10-15 10:36:37,566 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:36:38,691 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:36:39 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'958'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9995'), (b'x-ratelimit-remaining-tokens', b'9869'), (b'x-ratelimit-reset-requests', b'40.753s'), (b'x-ratelimit-reset-tokens', b'786ms'), (b'x-request-id', b'req_8bf030d89721c410ec7241126ef1ce12'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e23a85924b9ea-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:36:38,692 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:36:38,692 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:36:38,692 - DEBUG - receive_response_body.complete
2024-10-15 10:36:38,692 - DEBUG - response_closed.started
2024-10-15 10:36:38,692 - DEBUG - response_closed.complete
2024-10-15 10:36:38,692 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:36:39 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '958', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9995', 'x-ratelimit-remaining-tokens': '9869', 'x-ratelimit-reset-requests': '40.753s', 'x-ratelimit-reset-tokens': '786ms', 'x-request-id': 'req_8bf030d89721c410ec7241126ef1ce12', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e23a85924b9ea-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:36:38,692 - DEBUG - request_id: req_8bf030d89721c410ec7241126ef1ce12
2024-10-15 10:36:38,692 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWOcxrcIl4z66GnGy0T2CBfA5JCf', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_0AH8wT4IHaJrQng4ywe9DAeJ', function=Function(arguments='{\n  "contract_type": "airbnb"\n}', name='ContractDetails'), type='function')]))], created=1728977798, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=11, prompt_tokens=185, total_tokens=196, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:36:55,321 - DEBUG - close.started
2024-10-15 10:36:55,322 - DEBUG - close.complete
2024-10-15 10:36:55,322 - ERROR - Task exception was never retrieved
future: <Task finished name='Task-1' coro=<agent_workflow() done, defined at D:\deve\contract_automation\src\main.py:25> exception=KeyboardInterrupt()>
Traceback (most recent call last):
  File "D:\deve\contract_automation\src\main.py", line 105, in <module>
    asyncio.run(agent_workflow())
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 30, in run
    return loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 92, in run_until_complete
    self._run_once()
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 133, in _run_once
    handle._run()
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 386, in __wakeup
    self.__step()
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 293, in __step
    self.__step_run_and_handle_result(exc)
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 304, in __step_run_and_handle_result
    result = coro.send(None)
             ^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\src\main.py", line 55, in agent_workflow
    contract_type = input("Enter contract type (airbnb, buy-sell, it-consulting): ").lower().replace(" ", "-")
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
2024-10-15 10:37:43,658 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-15 10:37:44,931 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-15 10:37:44,932 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-15 10:37:45,259 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-15 10:37:45,260 - DEBUG - Using proactor: IocpProactor
2024-10-15 10:37:45,281 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:37:45,281 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:37:45,281 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:37:45,281 - DEBUG - Compression method 0
2024-10-15 10:37:45,281 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:37:45,281 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:37:45,281 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 10:37:45,282 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 10:37:45,282 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 10:37:45,282 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 10:37:45,282 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:37:45,282 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:37:45,282 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:37:45,282 - DEBUG - Compression method 0
2024-10-15 10:37:45,282 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:37:45,282 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:37:45,282 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 10:37:45,282 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 10:37:45,282 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 10:37:45,282 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 10:37:45,291 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:37:45,291 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:37:45,291 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 10:37:45,292 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 10:37:45,292 - DEBUG - Error closing: Operation on closed image
2024-10-15 10:37:47,300 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:37:47,300 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:37:47,300 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:37:47,300 - DEBUG - Compression method 0
2024-10-15 10:37:47,300 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:37:47,300 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:37:47,300 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 10:37:47,300 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 10:37:47,300 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 10:37:47,300 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 10:37:47,301 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:37:47,301 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:37:47,301 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:37:47,301 - DEBUG - Compression method 0
2024-10-15 10:37:47,301 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:37:47,301 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:37:47,301 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 10:37:47,301 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 10:37:47,301 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 10:37:47,301 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 10:37:47,318 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:37:47,318 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:37:47,318 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 10:37:47,318 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 10:37:47,319 - DEBUG - Error closing: Operation on closed image
2024-10-15 10:37:49,843 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 0 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 10:37:49,844 - DEBUG - max_retries: 1
2024-10-15 10:37:49,845 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 0 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 10:37:49,883 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:37:49,883 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-15 10:37:49,915 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x00000219F0DD3D40>
2024-10-15 10:37:49,915 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x00000219F0C3E7D0> server_hostname='api.openai.com' timeout=5.0
2024-10-15 10:37:49,930 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x00000219F0DD3C50>
2024-10-15 10:37:49,930 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:37:49,931 - DEBUG - send_request_headers.complete
2024-10-15 10:37:49,931 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:37:49,931 - DEBUG - send_request_body.complete
2024-10-15 10:37:49,931 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:37:50,922 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:37:51 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'814'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'9821'), (b'x-ratelimit-reset-requests', b'8.64s'), (b'x-ratelimit-reset-tokens', b'1.074s'), (b'x-request-id', b'req_64bea75a4fbba629bb625f0a057d353f'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=QoI_LUPpqn0zoGG2Hc_j.Gn2hF9wdkWXtvK0R18rT2E-1728977871-1.0.1.1-ucewDtHpOu_gJhpA7iYhSw0g7rLe5YR5KeU5tkvkI14INi37ZxF_vjRmP.TwbnGskK6CHAQYuOKyeeasywTWSQ; path=/; expires=Tue, 15-Oct-24 08:07:51 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=cq.N0dLnG7hvdXSWD0.sqpyASphFL9J7V_5Gz_XORbI-1728977871790-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e256c8ca0b68b-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:37:50,924 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:37:50,924 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:37:50,925 - DEBUG - receive_response_body.complete
2024-10-15 10:37:50,926 - DEBUG - response_closed.started
2024-10-15 10:37:50,926 - DEBUG - response_closed.complete
2024-10-15 10:37:50,926 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Tue, 15 Oct 2024 07:37:51 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-kzzh9hik9ryjiou4ftvhondh'), ('openai-processing-ms', '814'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '10000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '9821'), ('x-ratelimit-reset-requests', '8.64s'), ('x-ratelimit-reset-tokens', '1.074s'), ('x-request-id', 'req_64bea75a4fbba629bb625f0a057d353f'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=QoI_LUPpqn0zoGG2Hc_j.Gn2hF9wdkWXtvK0R18rT2E-1728977871-1.0.1.1-ucewDtHpOu_gJhpA7iYhSw0g7rLe5YR5KeU5tkvkI14INi37ZxF_vjRmP.TwbnGskK6CHAQYuOKyeeasywTWSQ; path=/; expires=Tue, 15-Oct-24 08:07:51 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=cq.N0dLnG7hvdXSWD0.sqpyASphFL9J7V_5Gz_XORbI-1728977871790-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d2e256c8ca0b68b-OTP'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-15 10:37:50,927 - DEBUG - request_id: req_64bea75a4fbba629bb625f0a057d353f
2024-10-15 10:37:50,934 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWPnSXHDfiAU6F2IbaJ5PWm8HxRI', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_W05IkL9ac3iP7dLBdDj8sXnZ', function=Function(arguments='\n{\n  "action": "extract_pii"\n}', name='AgentAction'), type='function')]))], created=1728977871, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=12, prompt_tokens=207, total_tokens=219, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:37:50,935 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.PIIData'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}}
2024-10-15 10:37:50,935 - DEBUG - max_retries: 1
2024-10-15 10:37:50,937 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}, 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}]}}
2024-10-15 10:37:50,938 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:37:50,938 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:37:50,938 - DEBUG - send_request_headers.complete
2024-10-15 10:37:50,938 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:37:50,938 - DEBUG - send_request_body.complete
2024-10-15 10:37:50,938 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:37:53,044 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:37:53 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1947'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9998'), (b'x-ratelimit-remaining-tokens', b'9683'), (b'x-ratelimit-reset-requests', b'16.283s'), (b'x-ratelimit-reset-tokens', b'1.901s'), (b'x-request-id', b'req_d3934a24a9408aee134d34b68192e2c6'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e2572db30b68b-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:37:53,044 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:37:53,044 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:37:53,044 - DEBUG - receive_response_body.complete
2024-10-15 10:37:53,044 - DEBUG - response_closed.started
2024-10-15 10:37:53,044 - DEBUG - response_closed.complete
2024-10-15 10:37:53,044 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:37:53 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1947', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9998', 'x-ratelimit-remaining-tokens': '9683', 'x-ratelimit-reset-requests': '16.283s', 'x-ratelimit-reset-tokens': '1.901s', 'x-request-id': 'req_d3934a24a9408aee134d34b68192e2c6', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e2572db30b68b-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:37:53,044 - DEBUG - request_id: req_d3934a24a9408aee134d34b68192e2c6
2024-10-15 10:37:53,045 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWPoqnhvECzlesObFG3T294tyQh8', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_p8dSu7oa20M0eFPmcwdrA2Vq', function=Function(arguments='{\n"name": "ISPILANTE SENTIMENT BRUSLI",\n"address": "Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR"\n}', name='PIIData'), type='function')]))], created=1728977872, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=39, prompt_tokens=377, total_tokens=416, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:37:55,015 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.PIIData'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}}
2024-10-15 10:37:55,016 - DEBUG - max_retries: 1
2024-10-15 10:37:55,018 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}, 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}]}}
2024-10-15 10:37:55,019 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:37:55,019 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:37:55,019 - DEBUG - send_request_headers.complete
2024-10-15 10:37:55,020 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:37:55,020 - DEBUG - send_request_body.complete
2024-10-15 10:37:55,020 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:37:57,515 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:37:58 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2344'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9997'), (b'x-ratelimit-remaining-tokens', b'9742'), (b'x-ratelimit-reset-requests', b'20.851s'), (b'x-ratelimit-reset-tokens', b'1.548s'), (b'x-request-id', b'req_7704b3ffeb871423e1ab6abaf4f01849'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e258c5e87b68b-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:37:57,515 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:37:57,516 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:37:57,516 - DEBUG - receive_response_body.complete
2024-10-15 10:37:57,516 - DEBUG - response_closed.started
2024-10-15 10:37:57,517 - DEBUG - response_closed.complete
2024-10-15 10:37:57,517 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:37:58 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '2344', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9997', 'x-ratelimit-remaining-tokens': '9742', 'x-ratelimit-reset-requests': '20.851s', 'x-ratelimit-reset-tokens': '1.548s', 'x-request-id': 'req_7704b3ffeb871423e1ab6abaf4f01849', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e258c5e87b68b-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:37:57,517 - DEBUG - request_id: req_7704b3ffeb871423e1ab6abaf4f01849
2024-10-15 10:37:57,518 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWPsAQNumaqEBfppUbBvr09rykVh', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_v95K7Bfc1JxMisdVjTxBp2SJ', function=Function(arguments='{\n"name": "VASILESCU ELENA",\n"address": "Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B"\n}', name='PIIData'), type='function')]))], created=1728977876, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=41, prompt_tokens=380, total_tokens=421, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:37:58,665 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 10:37:58,665 - DEBUG - max_retries: 1
2024-10-15 10:37:58,667 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 10:37:58,667 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:37:58,667 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:37:58,667 - DEBUG - send_request_headers.complete
2024-10-15 10:37:58,667 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:37:58,667 - DEBUG - send_request_body.complete
2024-10-15 10:37:58,667 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:37:59,703 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:38:00 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'879'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9997'), (b'x-ratelimit-remaining-tokens', b'9821'), (b'x-ratelimit-reset-requests', b'25.838s'), (b'x-ratelimit-reset-tokens', b'1.074s'), (b'x-request-id', b'req_47063f5833a9625d11c7678033f12b62'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e25a318dcb68b-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:37:59,703 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:37:59,703 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:37:59,704 - DEBUG - receive_response_body.complete
2024-10-15 10:37:59,704 - DEBUG - response_closed.started
2024-10-15 10:37:59,704 - DEBUG - response_closed.complete
2024-10-15 10:37:59,704 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:38:00 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '879', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9997', 'x-ratelimit-remaining-tokens': '9821', 'x-ratelimit-reset-requests': '25.838s', 'x-ratelimit-reset-tokens': '1.074s', 'x-request-id': 'req_47063f5833a9625d11c7678033f12b62', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e25a318dcb68b-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:37:59,704 - DEBUG - request_id: req_47063f5833a9625d11c7678033f12b62
2024-10-15 10:37:59,704 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWPveKjSQPpqjgkHhb8SskzNJ6is', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_HVDc0lyQUbrVtV3ZOizs8Sfo', function=Function(arguments='\n{\n  "action": "identify_parties"\n}', name='AgentAction'), type='function')]))], created=1728977879, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=12, prompt_tokens=207, total_tokens=219, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:37:59,705 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.ContractParties'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Identify the buyer and seller from the given information:\n\nName: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: VASILESCU ELENA, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'properties': {'buyer': {'description': 'Name of the buyer', 'title': 'Buyer', 'type': 'string'}, 'seller': {'description': 'Name of the seller', 'title': 'Seller', 'type': 'string'}}, 'required': ['buyer', 'seller'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}}
2024-10-15 10:37:59,705 - DEBUG - max_retries: 1
2024-10-15 10:37:59,706 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Identify the buyer and seller from the given information:\n\nName: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: VASILESCU ELENA, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}, 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'properties': {'buyer': {'description': 'Name of the buyer', 'title': 'Buyer', 'type': 'string'}, 'seller': {'description': 'Name of the seller', 'title': 'Seller', 'type': 'string'}}, 'required': ['buyer', 'seller'], 'type': 'object'}}}]}}
2024-10-15 10:37:59,706 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:37:59,706 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:37:59,707 - DEBUG - send_request_headers.complete
2024-10-15 10:37:59,707 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:37:59,707 - DEBUG - send_request_body.complete
2024-10-15 10:37:59,707 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:38:01,347 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:38:02 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1491'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9996'), (b'x-ratelimit-remaining-tokens', b'9787'), (b'x-ratelimit-reset-requests', b'33.441s'), (b'x-ratelimit-reset-tokens', b'1.273s'), (b'x-request-id', b'req_46470309af51c7b4ccc9ed2d75125a64'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e25a99f78b68b-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:38:01,347 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:38:01,347 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:38:01,347 - DEBUG - receive_response_body.complete
2024-10-15 10:38:01,347 - DEBUG - response_closed.started
2024-10-15 10:38:01,347 - DEBUG - response_closed.complete
2024-10-15 10:38:01,347 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:38:02 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1491', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9996', 'x-ratelimit-remaining-tokens': '9787', 'x-ratelimit-reset-requests': '33.441s', 'x-ratelimit-reset-tokens': '1.273s', 'x-request-id': 'req_46470309af51c7b4ccc9ed2d75125a64', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e25a99f78b68b-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:38:01,347 - DEBUG - request_id: req_46470309af51c7b4ccc9ed2d75125a64
2024-10-15 10:38:01,348 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWPw6lvwVqxMJgJcHpYTvFnRi7BK', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_JqhJBCoULDvATLwniDLtqdkN', function=Function(arguments='{\n"buyer": "ISPILANTE SENTIMENT BRUSLI",\n"seller": "VASILESCU ELENA"\n}', name='ContractParties'), type='function')]))], created=1728977880, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=27, prompt_tokens=232, total_tokens=259, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:38:01,349 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: Yes\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 10:38:01,349 - DEBUG - max_retries: 1
2024-10-15 10:38:01,350 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: Yes\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 10:38:01,351 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:38:01,351 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:38:01,351 - DEBUG - send_request_headers.complete
2024-10-15 10:38:01,351 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:38:01,351 - DEBUG - send_request_body.complete
2024-10-15 10:38:01,351 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:38:02,787 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:38:03 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1274'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9995'), (b'x-ratelimit-remaining-tokens', b'9751'), (b'x-ratelimit-reset-requests', b'40.437s'), (b'x-ratelimit-reset-tokens', b'1.488s'), (b'x-request-id', b'req_dd16e515a06492863a53fda6a29cdb79'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e25b3ea27b68b-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:38:02,787 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:38:02,787 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:38:02,787 - DEBUG - receive_response_body.complete
2024-10-15 10:38:02,787 - DEBUG - response_closed.started
2024-10-15 10:38:02,787 - DEBUG - response_closed.complete
2024-10-15 10:38:02,787 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:38:03 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1274', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9995', 'x-ratelimit-remaining-tokens': '9751', 'x-ratelimit-reset-requests': '40.437s', 'x-ratelimit-reset-tokens': '1.488s', 'x-request-id': 'req_dd16e515a06492863a53fda6a29cdb79', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e25b3ea27b68b-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:38:02,787 - DEBUG - request_id: req_dd16e515a06492863a53fda6a29cdb79
2024-10-15 10:38:02,788 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWPyphwnO1ILZSIytGA41Hx0Bz0z', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_y2GoGkUyM70SdFcC9jPe6dzu', function=Function(arguments='\n{\n"action": "determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728977882, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=12, prompt_tokens=207, total_tokens=219, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:38:05,827 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.ContractDetails'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Assign roles 'host' and 'guest' to ISPILANTE SENTIMENT BRUSLI and VASILESCU ELENA for an Airbnb contract."}], 'tools': [{'type': 'function', 'function': {'name': 'ContractDetails', 'description': 'Correctly extracted `ContractDetails` with all the required parameters with correct types', 'parameters': {'properties': {'contract_type': {'description': 'Type of contract (e.g., airbnb, buy-sell, it-consulting)', 'title': 'Contract Type', 'type': 'string'}, 'additional_info': {'additionalProperties': {'type': 'string'}, 'description': 'Additional information specific to the contract type', 'title': 'Additional Info', 'type': 'object'}}, 'required': ['additional_info', 'contract_type'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'ContractDetails'}}}
2024-10-15 10:38:05,827 - DEBUG - max_retries: 1
2024-10-15 10:38:05,829 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Assign roles 'host' and 'guest' to ISPILANTE SENTIMENT BRUSLI and VASILESCU ELENA for an Airbnb contract."}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'ContractDetails'}}, 'tools': [{'type': 'function', 'function': {'name': 'ContractDetails', 'description': 'Correctly extracted `ContractDetails` with all the required parameters with correct types', 'parameters': {'properties': {'contract_type': {'description': 'Type of contract (e.g., airbnb, buy-sell, it-consulting)', 'title': 'Contract Type', 'type': 'string'}, 'additional_info': {'additionalProperties': {'type': 'string'}, 'description': 'Additional information specific to the contract type', 'title': 'Additional Info', 'type': 'object'}}, 'required': ['additional_info', 'contract_type'], 'type': 'object'}}}]}}
2024-10-15 10:38:05,829 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:38:05,829 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:38:05,829 - DEBUG - send_request_headers.complete
2024-10-15 10:38:05,829 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:38:05,830 - DEBUG - send_request_body.complete
2024-10-15 10:38:05,830 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:38:06,894 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:38:07 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'912'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9994'), (b'x-ratelimit-remaining-tokens', b'9866'), (b'x-ratelimit-reset-requests', b'44.602s'), (b'x-ratelimit-reset-tokens', b'804ms'), (b'x-request-id', b'req_68ca60e3b4cd314aaf12632f139b3932'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e25cfd9d3b68b-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:38:06,895 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:38:06,895 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:38:06,895 - DEBUG - receive_response_body.complete
2024-10-15 10:38:06,895 - DEBUG - response_closed.started
2024-10-15 10:38:06,895 - DEBUG - response_closed.complete
2024-10-15 10:38:06,895 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:38:07 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '912', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9994', 'x-ratelimit-remaining-tokens': '9866', 'x-ratelimit-reset-requests': '44.602s', 'x-ratelimit-reset-tokens': '804ms', 'x-request-id': 'req_68ca60e3b4cd314aaf12632f139b3932', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e25cfd9d3b68b-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:38:06,895 - DEBUG - request_id: req_68ca60e3b4cd314aaf12632f139b3932
2024-10-15 10:38:06,895 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWQ31h8tMKG7MPmsRRzrtUQOZxL7', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_pRc2gyx2YfPOytSCYzY81fjM', function=Function(arguments='{\n"contract_type": "Airbnb"\n}', name='ContractDetails'), type='function')]))], created=1728977887, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=10, prompt_tokens=187, total_tokens=197, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:38:06,896 - DEBUG - Contract type: Airbnb
2024-10-15 10:38:06,896 - DEBUG - Additional info: {}
2024-10-15 10:38:06,896 - ERROR - Error in determine_contract_details: No roles assigned in the API response
2024-10-15 10:38:07,053 - DEBUG - close.started
2024-10-15 10:38:07,053 - DEBUG - close.complete
2024-10-15 10:39:14,543 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-15 10:39:15,809 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-15 10:39:15,809 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-15 10:39:16,130 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-15 10:39:16,131 - DEBUG - Using proactor: IocpProactor
2024-10-15 10:39:16,149 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:39:16,149 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:39:16,149 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:39:16,149 - DEBUG - Compression method 0
2024-10-15 10:39:16,150 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:39:16,150 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:39:16,150 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 10:39:16,150 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 10:39:16,150 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 10:39:16,150 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 10:39:16,150 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:39:16,150 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:39:16,150 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:39:16,150 - DEBUG - Compression method 0
2024-10-15 10:39:16,150 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:39:16,150 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:39:16,150 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 10:39:16,150 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 10:39:16,150 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 10:39:16,150 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 10:39:16,160 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:39:16,160 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:39:16,160 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 10:39:16,160 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 10:39:16,161 - DEBUG - Error closing: Operation on closed image
2024-10-15 10:39:18,160 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:39:18,160 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:39:18,160 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:39:18,160 - DEBUG - Compression method 0
2024-10-15 10:39:18,160 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:39:18,160 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:39:18,160 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 10:39:18,160 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 10:39:18,160 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 10:39:18,160 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 10:39:18,160 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:39:18,160 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:39:18,160 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:39:18,160 - DEBUG - Compression method 0
2024-10-15 10:39:18,160 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:39:18,160 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:39:18,160 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 10:39:18,160 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 10:39:18,160 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 10:39:18,160 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 10:39:18,177 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:39:18,177 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:39:18,177 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 10:39:18,177 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 10:39:18,178 - DEBUG - Error closing: Operation on closed image
2024-10-15 10:39:20,671 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 0 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 10:39:20,672 - DEBUG - max_retries: 1
2024-10-15 10:39:20,674 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 0 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 10:39:20,711 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:39:20,712 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-15 10:39:20,801 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x00000223FFD8C170>
2024-10-15 10:39:20,801 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x00000223FFBBE7D0> server_hostname='api.openai.com' timeout=5.0
2024-10-15 10:39:20,808 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x00000223FFD53B30>
2024-10-15 10:39:20,808 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:39:20,809 - DEBUG - send_request_headers.complete
2024-10-15 10:39:20,809 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:39:20,809 - DEBUG - send_request_body.complete
2024-10-15 10:39:20,809 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:39:21,823 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:39:22 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'848'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'9821'), (b'x-ratelimit-reset-requests', b'8.64s'), (b'x-ratelimit-reset-tokens', b'1.074s'), (b'x-request-id', b'req_89d0d672b08cd4f9e6721ce9b6b5f263'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=aFpN19VyLBkvme_nsK2vbLkWwy7_uvkrNfXYntfATBU-1728977962-1.0.1.1-1sl9tZrTgglGDjAO1AFAqD0zebi1cKbphw0Mzh9_DE_n6RBT66Txr5i0KcKVqTsxzTYUOxTeT.AZUDsnBoe1MA; path=/; expires=Tue, 15-Oct-24 08:09:22 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=b.OSKuYeKbiXCNk0NfgFmQBV6Vt1ZQuwjjGXO8Fw9Tk-1728977962672-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e27a46be6623d-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:39:21,823 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:39:21,824 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:39:21,824 - DEBUG - receive_response_body.complete
2024-10-15 10:39:21,824 - DEBUG - response_closed.started
2024-10-15 10:39:21,824 - DEBUG - response_closed.complete
2024-10-15 10:39:21,824 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Tue, 15 Oct 2024 07:39:22 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-kzzh9hik9ryjiou4ftvhondh'), ('openai-processing-ms', '848'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '10000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '9821'), ('x-ratelimit-reset-requests', '8.64s'), ('x-ratelimit-reset-tokens', '1.074s'), ('x-request-id', 'req_89d0d672b08cd4f9e6721ce9b6b5f263'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=aFpN19VyLBkvme_nsK2vbLkWwy7_uvkrNfXYntfATBU-1728977962-1.0.1.1-1sl9tZrTgglGDjAO1AFAqD0zebi1cKbphw0Mzh9_DE_n6RBT66Txr5i0KcKVqTsxzTYUOxTeT.AZUDsnBoe1MA; path=/; expires=Tue, 15-Oct-24 08:09:22 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=b.OSKuYeKbiXCNk0NfgFmQBV6Vt1ZQuwjjGXO8Fw9Tk-1728977962672-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d2e27a46be6623d-OTP'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-15 10:39:21,824 - DEBUG - request_id: req_89d0d672b08cd4f9e6721ce9b6b5f263
2024-10-15 10:39:21,826 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWRFKliyNraBtmQ3xy4tcwVdSZAh', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_LxDI73is01oRYNS0iuhHLp4a', function=Function(arguments='\n{\n  "action": "extract_pii"\n}', name='AgentAction'), type='function')]))], created=1728977961, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=12, prompt_tokens=207, total_tokens=219, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:39:21,827 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.PIIData'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}}
2024-10-15 10:39:21,827 - DEBUG - max_retries: 1
2024-10-15 10:39:21,828 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}, 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}]}}
2024-10-15 10:39:21,829 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:39:21,829 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:39:21,829 - DEBUG - send_request_headers.complete
2024-10-15 10:39:21,829 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:39:21,829 - DEBUG - send_request_body.complete
2024-10-15 10:39:21,829 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:39:26,404 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:39:27 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'4396'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9998'), (b'x-ratelimit-remaining-tokens', b'9686'), (b'x-ratelimit-reset-requests', b'16.264s'), (b'x-ratelimit-reset-tokens', b'1.882s'), (b'x-request-id', b'req_fb64552cb30f7e91ce598f3ae913262e'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e27aac951623d-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:39:26,405 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:39:26,406 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:39:26,407 - DEBUG - receive_response_body.complete
2024-10-15 10:39:26,407 - DEBUG - response_closed.started
2024-10-15 10:39:26,407 - DEBUG - response_closed.complete
2024-10-15 10:39:26,408 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:39:27 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '4396', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9998', 'x-ratelimit-remaining-tokens': '9686', 'x-ratelimit-reset-requests': '16.264s', 'x-ratelimit-reset-tokens': '1.882s', 'x-request-id': 'req_fb64552cb30f7e91ce598f3ae913262e', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e27aac951623d-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:39:26,408 - DEBUG - request_id: req_fb64552cb30f7e91ce598f3ae913262e
2024-10-15 10:39:26,409 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWRHMpwmz9OJzG4chV6IyqTLv3Au', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_O7Y3qwq326R2y2USLBfSJRw0', function=Function(arguments='{\n"name": "ISPILANTE SENTIMENT BRUSLI",\n"address": "Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR"\n}', name='PIIData'), type='function')]))], created=1728977963, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=39, prompt_tokens=377, total_tokens=416, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:39:28,816 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.PIIData'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}}
2024-10-15 10:39:28,816 - DEBUG - max_retries: 1
2024-10-15 10:39:28,818 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}, 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}]}}
2024-10-15 10:39:28,818 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:39:28,818 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:39:28,819 - DEBUG - send_request_headers.complete
2024-10-15 10:39:28,819 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:39:28,819 - DEBUG - send_request_body.complete
2024-10-15 10:39:28,819 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:39:31,463 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:39:32 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2495'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9997'), (b'x-ratelimit-remaining-tokens', b'9742'), (b'x-ratelimit-reset-requests', b'17.93s'), (b'x-ratelimit-reset-tokens', b'1.548s'), (b'x-request-id', b'req_7682b72884e58a6e790cb539adc83a94'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e27d6691b623d-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:39:31,465 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:39:31,466 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:39:31,466 - DEBUG - receive_response_body.complete
2024-10-15 10:39:31,466 - DEBUG - response_closed.started
2024-10-15 10:39:31,467 - DEBUG - response_closed.complete
2024-10-15 10:39:31,467 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:39:32 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '2495', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9997', 'x-ratelimit-remaining-tokens': '9742', 'x-ratelimit-reset-requests': '17.93s', 'x-ratelimit-reset-tokens': '1.548s', 'x-request-id': 'req_7682b72884e58a6e790cb539adc83a94', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e27d6691b623d-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:39:31,467 - DEBUG - request_id: req_7682b72884e58a6e790cb539adc83a94
2024-10-15 10:39:31,468 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWROzbbvjnfFyoGdLI0C4nrthvia', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_afxx0xRBus6Qh1DZfYNpr7Bl', function=Function(arguments='{\n"name": "ELENA VASILESCU",\n"address": "Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B"\n}', name='PIIData'), type='function')]))], created=1728977970, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=42, prompt_tokens=380, total_tokens=422, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:39:32,854 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 10:39:32,854 - DEBUG - max_retries: 1
2024-10-15 10:39:32,856 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 10:39:32,856 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:39:32,856 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:39:32,856 - DEBUG - send_request_headers.complete
2024-10-15 10:39:32,856 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:39:32,856 - DEBUG - send_request_body.complete
2024-10-15 10:39:32,856 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:39:33,901 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:39:34 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'896'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9997'), (b'x-ratelimit-remaining-tokens', b'9821'), (b'x-ratelimit-reset-requests', b'22.531s'), (b'x-ratelimit-reset-tokens', b'1.074s'), (b'x-request-id', b'req_fdb238d808a0ca16f67aab77908ee498'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e27efa8f2623d-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:39:33,901 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:39:33,901 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:39:33,901 - DEBUG - receive_response_body.complete
2024-10-15 10:39:33,901 - DEBUG - response_closed.started
2024-10-15 10:39:33,901 - DEBUG - response_closed.complete
2024-10-15 10:39:33,901 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:39:34 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '896', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9997', 'x-ratelimit-remaining-tokens': '9821', 'x-ratelimit-reset-requests': '22.531s', 'x-ratelimit-reset-tokens': '1.074s', 'x-request-id': 'req_fdb238d808a0ca16f67aab77908ee498', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e27efa8f2623d-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:39:33,901 - DEBUG - request_id: req_fdb238d808a0ca16f67aab77908ee498
2024-10-15 10:39:33,902 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWRSsQjvLD3IayBB1VnGvUvOiIe8', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_MEUHx4d8z2zh9SUafgzkaPKc', function=Function(arguments='\n{\n"action": "identify_parties"\n}', name='AgentAction'), type='function')]))], created=1728977974, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=11, prompt_tokens=207, total_tokens=218, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:39:33,902 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.ContractParties'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Identify the buyer and seller from the given information:\n\nName: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'properties': {'buyer': {'description': 'Name of the buyer', 'title': 'Buyer', 'type': 'string'}, 'seller': {'description': 'Name of the seller', 'title': 'Seller', 'type': 'string'}}, 'required': ['buyer', 'seller'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}}
2024-10-15 10:39:33,902 - DEBUG - max_retries: 1
2024-10-15 10:39:33,904 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Identify the buyer and seller from the given information:\n\nName: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}, 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'properties': {'buyer': {'description': 'Name of the buyer', 'title': 'Buyer', 'type': 'string'}, 'seller': {'description': 'Name of the seller', 'title': 'Seller', 'type': 'string'}}, 'required': ['buyer', 'seller'], 'type': 'object'}}}]}}
2024-10-15 10:39:33,904 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:39:33,904 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:39:33,904 - DEBUG - send_request_headers.complete
2024-10-15 10:39:33,904 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:39:33,904 - DEBUG - send_request_body.complete
2024-10-15 10:39:33,905 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:39:36,035 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:39:36 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1959'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9996'), (b'x-ratelimit-remaining-tokens', b'9794'), (b'x-ratelimit-reset-requests', b'30.102s'), (b'x-ratelimit-reset-tokens', b'1.235s'), (b'x-request-id', b'req_26747874c4d632ace9665afadca114b7'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e27f6380e623d-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:39:36,036 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:39:36,036 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:39:36,036 - DEBUG - receive_response_body.complete
2024-10-15 10:39:36,037 - DEBUG - response_closed.started
2024-10-15 10:39:36,037 - DEBUG - response_closed.complete
2024-10-15 10:39:36,037 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:39:36 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1959', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9996', 'x-ratelimit-remaining-tokens': '9794', 'x-ratelimit-reset-requests': '30.102s', 'x-ratelimit-reset-tokens': '1.235s', 'x-request-id': 'req_26747874c4d632ace9665afadca114b7', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e27f6380e623d-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:39:36,037 - DEBUG - request_id: req_26747874c4d632ace9665afadca114b7
2024-10-15 10:39:36,038 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWRSrolnBRyUDdqDr6GI559NXv0q', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_EW7RzqL4atEepc3wPISVDLkr', function=Function(arguments='{\n"buyer": "ISPILANTE SENTIMENT BRUSLI",\n"seller": "ELENA VASILESCU"\n}', name='ContractParties'), type='function')]))], created=1728977974, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=28, prompt_tokens=232, total_tokens=260, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:39:36,040 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: Yes\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 10:39:36,040 - DEBUG - max_retries: 1
2024-10-15 10:39:36,043 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: Yes\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 10:39:36,044 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:39:36,044 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:39:36,044 - DEBUG - send_request_headers.complete
2024-10-15 10:39:36,044 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:39:36,044 - DEBUG - send_request_body.complete
2024-10-15 10:39:36,044 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:39:37,025 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:39:37 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'824'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9995'), (b'x-ratelimit-remaining-tokens', b'9752'), (b'x-ratelimit-reset-requests', b'36.619s'), (b'x-ratelimit-reset-tokens', b'1.484s'), (b'x-request-id', b'req_3efff67641080d609b5bfa62397f6684'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e28039dea623d-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:39:37,026 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:39:37,026 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:39:37,026 - DEBUG - receive_response_body.complete
2024-10-15 10:39:37,026 - DEBUG - response_closed.started
2024-10-15 10:39:37,026 - DEBUG - response_closed.complete
2024-10-15 10:39:37,026 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:39:37 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '824', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9995', 'x-ratelimit-remaining-tokens': '9752', 'x-ratelimit-reset-requests': '36.619s', 'x-ratelimit-reset-tokens': '1.484s', 'x-request-id': 'req_3efff67641080d609b5bfa62397f6684', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e28039dea623d-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:39:37,026 - DEBUG - request_id: req_3efff67641080d609b5bfa62397f6684
2024-10-15 10:39:37,026 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWRVUUroLbCIlIeg15VdjmcN1akK', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_hogSkUSbHxjX3CDragkyciYG', function=Function(arguments='\n{\n    "action": "determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728977977, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=13, prompt_tokens=207, total_tokens=220, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:39:40,159 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.ContractDetails'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Assign roles 'host' and 'guest' to ISPILANTE SENTIMENT BRUSLI and ELENA VASILESCU for an Airbnb contract."}], 'tools': [{'type': 'function', 'function': {'name': 'ContractDetails', 'description': 'Correctly extracted `ContractDetails` with all the required parameters with correct types', 'parameters': {'properties': {'contract_type': {'description': 'Type of contract (e.g., airbnb, buy-sell, it-consulting)', 'title': 'Contract Type', 'type': 'string'}, 'additional_info': {'additionalProperties': {'type': 'string'}, 'description': 'Additional information specific to the contract type', 'title': 'Additional Info', 'type': 'object'}}, 'required': ['additional_info', 'contract_type'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'ContractDetails'}}}
2024-10-15 10:39:40,160 - DEBUG - max_retries: 1
2024-10-15 10:39:40,162 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Assign roles 'host' and 'guest' to ISPILANTE SENTIMENT BRUSLI and ELENA VASILESCU for an Airbnb contract."}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'ContractDetails'}}, 'tools': [{'type': 'function', 'function': {'name': 'ContractDetails', 'description': 'Correctly extracted `ContractDetails` with all the required parameters with correct types', 'parameters': {'properties': {'contract_type': {'description': 'Type of contract (e.g., airbnb, buy-sell, it-consulting)', 'title': 'Contract Type', 'type': 'string'}, 'additional_info': {'additionalProperties': {'type': 'string'}, 'description': 'Additional information specific to the contract type', 'title': 'Additional Info', 'type': 'object'}}, 'required': ['additional_info', 'contract_type'], 'type': 'object'}}}]}}
2024-10-15 10:39:40,162 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:39:40,162 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:39:40,163 - DEBUG - send_request_headers.complete
2024-10-15 10:39:40,163 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:39:40,163 - DEBUG - send_request_body.complete
2024-10-15 10:39:40,163 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:39:41,228 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:39:42 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'896'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9995'), (b'x-ratelimit-remaining-tokens', b'9866'), (b'x-ratelimit-reset-requests', b'41.143s'), (b'x-ratelimit-reset-tokens', b'804ms'), (b'x-request-id', b'req_ae65d82654688ebcd2622717879966cd'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e281d5f41623d-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:39:41,228 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:39:41,228 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:39:41,228 - DEBUG - receive_response_body.complete
2024-10-15 10:39:41,228 - DEBUG - response_closed.started
2024-10-15 10:39:41,228 - DEBUG - response_closed.complete
2024-10-15 10:39:41,228 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:39:42 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '896', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9995', 'x-ratelimit-remaining-tokens': '9866', 'x-ratelimit-reset-requests': '41.143s', 'x-ratelimit-reset-tokens': '804ms', 'x-request-id': 'req_ae65d82654688ebcd2622717879966cd', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e281d5f41623d-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:39:41,228 - DEBUG - request_id: req_ae65d82654688ebcd2622717879966cd
2024-10-15 10:39:41,229 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWRZSfOMy2ztnZFvk3KtX165kvTV', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_4Ng7LIhsWccI04QS3njk2B3b', function=Function(arguments='{\n  "contract_type": "airbnb"\n}', name='ContractDetails'), type='function')]))], created=1728977981, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=11, prompt_tokens=187, total_tokens=198, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:39:41,229 - DEBUG - Contract type: airbnb
2024-10-15 10:39:41,229 - DEBUG - Additional info: {}
2024-10-15 10:39:51,932 - DEBUG - close.started
2024-10-15 10:39:51,932 - DEBUG - close.complete
2024-10-15 10:39:51,932 - ERROR - Task exception was never retrieved
future: <Task finished name='Task-1' coro=<agent_workflow() done, defined at D:\deve\contract_automation\src\main.py:25> exception=KeyboardInterrupt()>
Traceback (most recent call last):
  File "D:\deve\contract_automation\src\main.py", line 110, in <module>
    asyncio.run(agent_workflow())
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 30, in run
    return loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 92, in run_until_complete
    self._run_once()
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 133, in _run_once
    handle._run()
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 386, in __wakeup
    self.__step()
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 293, in __step
    self.__step_run_and_handle_result(exc)
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 304, in __step_run_and_handle_result
    result = coro.send(None)
             ^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\src\main.py", line 65, in agent_workflow
    confirmation = input("Is this role assignment correct? (yes/no): ").lower()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
2024-10-15 10:41:34,846 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-15 10:41:36,108 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-15 10:41:36,108 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-15 10:41:36,428 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-15 10:41:36,429 - DEBUG - Using proactor: IocpProactor
2024-10-15 10:41:36,448 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:41:36,448 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:41:36,448 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:41:36,448 - DEBUG - Compression method 0
2024-10-15 10:41:36,448 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:41:36,448 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:41:36,448 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 10:41:36,448 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 10:41:36,448 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 10:41:36,448 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 10:41:36,448 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:41:36,449 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:41:36,449 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:41:36,449 - DEBUG - Compression method 0
2024-10-15 10:41:36,449 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:41:36,449 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:41:36,449 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 10:41:36,449 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 10:41:36,449 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 10:41:36,449 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 10:41:36,458 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:41:36,458 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:41:36,458 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 10:41:36,458 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 10:41:36,459 - DEBUG - Error closing: Operation on closed image
2024-10-15 10:41:38,537 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:41:38,537 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:41:38,537 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:41:38,537 - DEBUG - Compression method 0
2024-10-15 10:41:38,537 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:41:38,537 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:41:38,537 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 10:41:38,537 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 10:41:38,537 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 10:41:38,537 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 10:41:38,537 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:41:38,537 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:41:38,537 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:41:38,537 - DEBUG - Compression method 0
2024-10-15 10:41:38,537 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:41:38,537 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:41:38,537 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 10:41:38,537 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 10:41:38,537 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 10:41:38,537 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 10:41:38,555 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:41:38,555 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:41:38,555 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 10:41:38,555 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 10:41:38,556 - DEBUG - Error closing: Operation on closed image
2024-10-15 10:41:41,064 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 0 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 10:41:41,065 - DEBUG - max_retries: 1
2024-10-15 10:41:41,067 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 0 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 10:41:41,104 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:41:41,105 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-15 10:41:41,197 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x00000232AB3CC200>
2024-10-15 10:41:41,197 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x00000232AB1FE7D0> server_hostname='api.openai.com' timeout=5.0
2024-10-15 10:41:41,206 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x00000232AB19EE40>
2024-10-15 10:41:41,206 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:41:41,206 - DEBUG - send_request_headers.complete
2024-10-15 10:41:41,206 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:41:41,206 - DEBUG - send_request_body.complete
2024-10-15 10:41:41,206 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:41:42,304 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:41:43 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'949'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'9821'), (b'x-ratelimit-reset-requests', b'8.64s'), (b'x-ratelimit-reset-tokens', b'1.074s'), (b'x-request-id', b'req_10be574a97464c86cbbf74f596759865'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=zRA9RZZ8Y5Iz6XwglcPxtmFq.3PQKvhRZhhofy0IDPg-1728978103-1.0.1.1-54Rpcn50bNc4s2w2xQDefJvJU5gB0Rqd088_WAbtJDEZJi3zkGqvT6FrkDmuAtwiev4vn8y4fXgFMicfV1zfhQ; path=/; expires=Tue, 15-Oct-24 08:11:43 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=CBBFM_rGygOYBrLtHMhARFAfdSnC5FIVKWCRDJFv5bI-1728978103122-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e2b11a859c9f1-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:41:42,305 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:41:42,305 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:41:42,306 - DEBUG - receive_response_body.complete
2024-10-15 10:41:42,306 - DEBUG - response_closed.started
2024-10-15 10:41:42,306 - DEBUG - response_closed.complete
2024-10-15 10:41:42,306 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Tue, 15 Oct 2024 07:41:43 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-kzzh9hik9ryjiou4ftvhondh'), ('openai-processing-ms', '949'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '10000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '9821'), ('x-ratelimit-reset-requests', '8.64s'), ('x-ratelimit-reset-tokens', '1.074s'), ('x-request-id', 'req_10be574a97464c86cbbf74f596759865'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=zRA9RZZ8Y5Iz6XwglcPxtmFq.3PQKvhRZhhofy0IDPg-1728978103-1.0.1.1-54Rpcn50bNc4s2w2xQDefJvJU5gB0Rqd088_WAbtJDEZJi3zkGqvT6FrkDmuAtwiev4vn8y4fXgFMicfV1zfhQ; path=/; expires=Tue, 15-Oct-24 08:11:43 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=CBBFM_rGygOYBrLtHMhARFAfdSnC5FIVKWCRDJFv5bI-1728978103122-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d2e2b11a859c9f1-OTP'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-15 10:41:42,306 - DEBUG - request_id: req_10be574a97464c86cbbf74f596759865
2024-10-15 10:41:42,310 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWTWRyp0aVzYa6xE6z0s6PKvpTpO', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_wZwyUwlPY1PzJi3fxkJ9Teav', function=Function(arguments='\n{\n  "action": "extract_pii"\n}', name='AgentAction'), type='function')]))], created=1728978102, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=12, prompt_tokens=207, total_tokens=219, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:41:42,312 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.PIIData'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}}
2024-10-15 10:41:42,312 - DEBUG - max_retries: 1
2024-10-15 10:41:42,313 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}, 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}]}}
2024-10-15 10:41:42,314 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:41:42,314 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:41:42,314 - DEBUG - send_request_headers.complete
2024-10-15 10:41:42,314 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:41:42,314 - DEBUG - send_request_body.complete
2024-10-15 10:41:42,314 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:41:44,667 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:41:45 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2204'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9998'), (b'x-ratelimit-remaining-tokens', b'9701'), (b'x-ratelimit-reset-requests', b'16.171s'), (b'x-ratelimit-reset-tokens', b'1.789s'), (b'x-request-id', b'req_6322c0e313d40058e212e09e551e9b68'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e2b189d6fc9f1-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:41:44,668 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:41:44,668 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:41:44,669 - DEBUG - receive_response_body.complete
2024-10-15 10:41:44,669 - DEBUG - response_closed.started
2024-10-15 10:41:44,669 - DEBUG - response_closed.complete
2024-10-15 10:41:44,669 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:41:45 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '2204', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9998', 'x-ratelimit-remaining-tokens': '9701', 'x-ratelimit-reset-requests': '16.171s', 'x-ratelimit-reset-tokens': '1.789s', 'x-request-id': 'req_6322c0e313d40058e212e09e551e9b68', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e2b189d6fc9f1-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:41:44,669 - DEBUG - request_id: req_6322c0e313d40058e212e09e551e9b68
2024-10-15 10:41:44,669 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWTX3PsZvTXUscNbAJZMtxQDo6z4', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_zc8vyovMOWbQVcBSndxVXhwL', function=Function(arguments='{\n"name": "T525M ISPILANTE SENTIMENT BRUSLI",\n"address": "Videle, Jud: Teleorman, Sos. Giurgiului nr.1, 695 TR"\n}', name='PIIData'), type='function')]))], created=1728978103, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=45, prompt_tokens=377, total_tokens=422, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:41:46,999 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.PIIData'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}}
2024-10-15 10:41:46,999 - DEBUG - max_retries: 1
2024-10-15 10:41:47,002 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}, 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}]}}
2024-10-15 10:41:47,002 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:41:47,002 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:41:47,003 - DEBUG - send_request_headers.complete
2024-10-15 10:41:47,003 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:41:47,003 - DEBUG - send_request_body.complete
2024-10-15 10:41:47,003 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:41:49,133 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:41:49 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1983'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9997'), (b'x-ratelimit-remaining-tokens', b'9742'), (b'x-ratelimit-reset-requests', b'20.126s'), (b'x-ratelimit-reset-tokens', b'1.548s'), (b'x-request-id', b'req_869eca0f998c75885af0c6a53a9a7dbc'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e2b35ea91c9f1-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:41:49,134 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:41:49,135 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:41:49,135 - DEBUG - receive_response_body.complete
2024-10-15 10:41:49,135 - DEBUG - response_closed.started
2024-10-15 10:41:49,136 - DEBUG - response_closed.complete
2024-10-15 10:41:49,136 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:41:49 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1983', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9997', 'x-ratelimit-remaining-tokens': '9742', 'x-ratelimit-reset-requests': '20.126s', 'x-ratelimit-reset-tokens': '1.548s', 'x-request-id': 'req_869eca0f998c75885af0c6a53a9a7dbc', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e2b35ea91c9f1-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:41:49,136 - DEBUG - request_id: req_869eca0f998c75885af0c6a53a9a7dbc
2024-10-15 10:41:49,137 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWTbNuPhSPlYxnM2Dhnn1rCj51Rl', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_3FW1thymIwxj6H4UKBPLYZ9Y', function=Function(arguments='{\n"name": "ELENA VASILESCU",\n"address": "Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B"\n}', name='PIIData'), type='function')]))], created=1728978107, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=42, prompt_tokens=380, total_tokens=422, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:41:50,041 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 10:41:50,041 - DEBUG - max_retries: 1
2024-10-15 10:41:50,043 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 10:41:50,044 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:41:50,044 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:41:50,044 - DEBUG - send_request_headers.complete
2024-10-15 10:41:50,044 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:41:50,044 - DEBUG - send_request_body.complete
2024-10-15 10:41:50,044 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:41:51,287 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:41:52 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1089'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9997'), (b'x-ratelimit-remaining-tokens', b'9821'), (b'x-ratelimit-reset-requests', b'25.717s'), (b'x-ratelimit-reset-tokens', b'1.074s'), (b'x-request-id', b'req_14a7fe175890e39ba3899e98146ea4c1'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e2b48edfdc9f1-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:41:51,287 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:41:51,287 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:41:51,288 - DEBUG - receive_response_body.complete
2024-10-15 10:41:51,288 - DEBUG - response_closed.started
2024-10-15 10:41:51,288 - DEBUG - response_closed.complete
2024-10-15 10:41:51,288 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:41:52 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1089', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9997', 'x-ratelimit-remaining-tokens': '9821', 'x-ratelimit-reset-requests': '25.717s', 'x-ratelimit-reset-tokens': '1.074s', 'x-request-id': 'req_14a7fe175890e39ba3899e98146ea4c1', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e2b48edfdc9f1-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:41:51,288 - DEBUG - request_id: req_14a7fe175890e39ba3899e98146ea4c1
2024-10-15 10:41:51,288 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWTfVzLTI5TwYiyAOiYqFzEfh3eA', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_GBKpE0UboBT9AdWE0mH1vBhC', function=Function(arguments='{\n"action": "identify_parties"\n}', name='AgentAction'), type='function')]))], created=1728978111, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=10, prompt_tokens=207, total_tokens=217, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:41:51,289 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.ContractParties'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Identify the buyer and seller from the given information:\n\nName: T525M ISPILANTE SENTIMENT BRUSLI, Address: Videle, Jud: Teleorman, Sos. Giurgiului nr.1, 695 TR\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'properties': {'buyer': {'description': 'Name of the buyer', 'title': 'Buyer', 'type': 'string'}, 'seller': {'description': 'Name of the seller', 'title': 'Seller', 'type': 'string'}}, 'required': ['buyer', 'seller'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}}
2024-10-15 10:41:51,289 - DEBUG - max_retries: 1
2024-10-15 10:41:51,291 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Identify the buyer and seller from the given information:\n\nName: T525M ISPILANTE SENTIMENT BRUSLI, Address: Videle, Jud: Teleorman, Sos. Giurgiului nr.1, 695 TR\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}, 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'properties': {'buyer': {'description': 'Name of the buyer', 'title': 'Buyer', 'type': 'string'}, 'seller': {'description': 'Name of the seller', 'title': 'Seller', 'type': 'string'}}, 'required': ['buyer', 'seller'], 'type': 'object'}}}]}}
2024-10-15 10:41:51,291 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:41:51,291 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:41:51,291 - DEBUG - send_request_headers.complete
2024-10-15 10:41:51,291 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:41:51,291 - DEBUG - send_request_body.complete
2024-10-15 10:41:51,292 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:41:53,745 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:41:54 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2300'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9996'), (b'x-ratelimit-remaining-tokens', b'9817'), (b'x-ratelimit-reset-requests', b'33.118s'), (b'x-ratelimit-reset-tokens', b'1.097s'), (b'x-request-id', b'req_53233335a7d719e6ce6d59216650ba5d'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e2b50acb9c9f1-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:41:53,746 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:41:53,746 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:41:53,746 - DEBUG - receive_response_body.complete
2024-10-15 10:41:53,746 - DEBUG - response_closed.started
2024-10-15 10:41:53,746 - DEBUG - response_closed.complete
2024-10-15 10:41:53,746 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:41:54 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '2300', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9996', 'x-ratelimit-remaining-tokens': '9817', 'x-ratelimit-reset-requests': '33.118s', 'x-ratelimit-reset-tokens': '1.097s', 'x-request-id': 'req_53233335a7d719e6ce6d59216650ba5d', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e2b50acb9c9f1-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:41:53,746 - DEBUG - request_id: req_53233335a7d719e6ce6d59216650ba5d
2024-10-15 10:41:53,746 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWTgv6l7hk1h0GbEbLvw06ys7PeG', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_YotK7YcKdDDyacmz5LeTXLwN', function=Function(arguments='{\n"buyer": "T525M ISPILANTE SENTIMENT BRUSLI",\n"seller": "ELENA VASILESCU"\n}', name='ContractParties'), type='function')]))], created=1728978112, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=31, prompt_tokens=238, total_tokens=269, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:41:53,747 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: Yes\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 10:41:53,747 - DEBUG - max_retries: 1
2024-10-15 10:41:53,749 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: Yes\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 10:41:53,749 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:41:53,749 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:41:53,750 - DEBUG - send_request_headers.complete
2024-10-15 10:41:53,750 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:41:53,750 - DEBUG - send_request_body.complete
2024-10-15 10:41:53,750 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:41:54,692 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:41:55 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'793'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9995'), (b'x-ratelimit-remaining-tokens', b'9743'), (b'x-ratelimit-reset-requests', b'39.3s'), (b'x-ratelimit-reset-tokens', b'1.541s'), (b'x-request-id', b'req_5078e766cd14081eeb3ba09665545656'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e2b600ab3c9f1-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:41:54,693 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:41:54,693 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:41:54,693 - DEBUG - receive_response_body.complete
2024-10-15 10:41:54,693 - DEBUG - response_closed.started
2024-10-15 10:41:54,693 - DEBUG - response_closed.complete
2024-10-15 10:41:54,693 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:41:55 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '793', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9995', 'x-ratelimit-remaining-tokens': '9743', 'x-ratelimit-reset-requests': '39.3s', 'x-ratelimit-reset-tokens': '1.541s', 'x-request-id': 'req_5078e766cd14081eeb3ba09665545656', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e2b600ab3c9f1-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:41:54,693 - DEBUG - request_id: req_5078e766cd14081eeb3ba09665545656
2024-10-15 10:41:54,694 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWTiU1lBGJlBtNiJRR4ErEFAMvOx', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_ui028USmKjEauSWoBsVO5mYz', function=Function(arguments='\n{\n  "action": "determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728978114, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=13, prompt_tokens=207, total_tokens=220, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:41:57,854 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.ContractDetails'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Assign roles 'host' and 'guest' to T525M ISPILANTE SENTIMENT BRUSLI and ELENA VASILESCU for an Airbnb contract."}], 'tools': [{'type': 'function', 'function': {'name': 'ContractDetails', 'description': 'Correctly extracted `ContractDetails` with all the required parameters with correct types', 'parameters': {'properties': {'contract_type': {'description': 'Type of contract (e.g., airbnb, buy-sell, it-consulting)', 'title': 'Contract Type', 'type': 'string'}, 'additional_info': {'additionalProperties': {'type': 'string'}, 'description': 'Additional information specific to the contract type', 'title': 'Additional Info', 'type': 'object'}}, 'required': ['additional_info', 'contract_type'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'ContractDetails'}}}
2024-10-15 10:41:57,854 - DEBUG - max_retries: 1
2024-10-15 10:41:57,856 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Assign roles 'host' and 'guest' to T525M ISPILANTE SENTIMENT BRUSLI and ELENA VASILESCU for an Airbnb contract."}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'ContractDetails'}}, 'tools': [{'type': 'function', 'function': {'name': 'ContractDetails', 'description': 'Correctly extracted `ContractDetails` with all the required parameters with correct types', 'parameters': {'properties': {'contract_type': {'description': 'Type of contract (e.g., airbnb, buy-sell, it-consulting)', 'title': 'Contract Type', 'type': 'string'}, 'additional_info': {'additionalProperties': {'type': 'string'}, 'description': 'Additional information specific to the contract type', 'title': 'Additional Info', 'type': 'object'}}, 'required': ['additional_info', 'contract_type'], 'type': 'object'}}}]}}
2024-10-15 10:41:57,857 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:41:57,857 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:41:57,857 - DEBUG - send_request_headers.complete
2024-10-15 10:41:57,857 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:41:57,857 - DEBUG - send_request_body.complete
2024-10-15 10:41:57,858 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:41:59,325 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:42:00 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1320'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9994'), (b'x-ratelimit-remaining-tokens', b'9865'), (b'x-ratelimit-reset-requests', b'43.835s'), (b'x-ratelimit-reset-tokens', b'810ms'), (b'x-request-id', b'req_ab8dc1b24849c48bf5e752ce6fd02bc2'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e2b79bdd1c9f1-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:41:59,325 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:41:59,325 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:41:59,325 - DEBUG - receive_response_body.complete
2024-10-15 10:41:59,325 - DEBUG - response_closed.started
2024-10-15 10:41:59,325 - DEBUG - response_closed.complete
2024-10-15 10:41:59,325 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:42:00 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1320', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9994', 'x-ratelimit-remaining-tokens': '9865', 'x-ratelimit-reset-requests': '43.835s', 'x-ratelimit-reset-tokens': '810ms', 'x-request-id': 'req_ab8dc1b24849c48bf5e752ce6fd02bc2', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e2b79bdd1c9f1-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:41:59,325 - DEBUG - request_id: req_ab8dc1b24849c48bf5e752ce6fd02bc2
2024-10-15 10:41:59,326 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWTmvtIUBMEtTGrU9f2m0tlvZwwJ', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_UhPqcOVwlCTXAPtB6MgJXIhg', function=Function(arguments='{\n"contract_type": "airbnb"\n}', name='ContractDetails'), type='function')]))], created=1728978118, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=10, prompt_tokens=190, total_tokens=200, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:41:59,326 - DEBUG - Contract type: airbnb
2024-10-15 10:41:59,326 - DEBUG - Additional info: {}
2024-10-15 10:42:13,299 - DEBUG - close.started
2024-10-15 10:42:13,300 - DEBUG - close.complete
2024-10-15 10:42:13,300 - ERROR - Task exception was never retrieved
future: <Task finished name='Task-1' coro=<agent_workflow() done, defined at D:\deve\contract_automation\src\main.py:25> exception=KeyboardInterrupt()>
Traceback (most recent call last):
  File "D:\deve\contract_automation\src\main.py", line 110, in <module>
    asyncio.run(agent_workflow())
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 30, in run
    return loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 92, in run_until_complete
    self._run_once()
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 133, in _run_once
    handle._run()
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 386, in __wakeup
    self.__step()
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 293, in __step
    self.__step_run_and_handle_result(exc)
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 304, in __step_run_and_handle_result
    result = coro.send(None)
             ^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\src\main.py", line 65, in agent_workflow
    confirmation = input("Is this role assignment correct? (yes/no): ").lower()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
2024-10-15 10:42:16,905 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-15 10:42:18,187 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-15 10:42:18,187 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-15 10:42:18,503 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-15 10:42:18,504 - DEBUG - Using proactor: IocpProactor
2024-10-15 10:42:18,521 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:42:18,521 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:42:18,521 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:42:18,521 - DEBUG - Compression method 0
2024-10-15 10:42:18,522 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:42:18,522 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:42:18,522 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 10:42:18,522 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 10:42:18,522 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 10:42:18,522 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 10:42:18,522 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:42:18,522 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:42:18,522 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:42:18,522 - DEBUG - Compression method 0
2024-10-15 10:42:18,522 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:42:18,522 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:42:18,522 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 10:42:18,522 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 10:42:18,522 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 10:42:18,522 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 10:42:18,531 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:42:18,532 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:42:18,532 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 10:42:18,532 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 10:42:18,532 - DEBUG - Error closing: Operation on closed image
2024-10-15 10:42:20,656 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:42:20,656 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:42:20,656 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:42:20,656 - DEBUG - Compression method 0
2024-10-15 10:42:20,656 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:42:20,656 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:42:20,656 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 10:42:20,656 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 10:42:20,656 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 10:42:20,656 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 10:42:20,656 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:42:20,656 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:42:20,656 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:42:20,656 - DEBUG - Compression method 0
2024-10-15 10:42:20,656 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:42:20,656 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:42:20,656 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 10:42:20,656 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 10:42:20,656 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 10:42:20,656 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 10:42:20,674 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:42:20,674 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:42:20,674 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 10:42:20,674 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 10:42:20,675 - DEBUG - Error closing: Operation on closed image
2024-10-15 10:42:23,962 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 0 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 10:42:23,963 - DEBUG - max_retries: 1
2024-10-15 10:42:23,965 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 0 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 10:42:24,000 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:42:24,000 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-15 10:42:24,011 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x0000021029493EF0>
2024-10-15 10:42:24,011 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x00000210292FE7D0> server_hostname='api.openai.com' timeout=5.0
2024-10-15 10:42:24,020 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000002107FD91700>
2024-10-15 10:42:24,020 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:42:24,020 - DEBUG - send_request_headers.complete
2024-10-15 10:42:24,020 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:42:24,020 - DEBUG - send_request_body.complete
2024-10-15 10:42:24,021 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:42:25,398 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:42:26 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1170'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9996'), (b'x-ratelimit-remaining-tokens', b'9821'), (b'x-ratelimit-reset-requests', b'26.306s'), (b'x-ratelimit-reset-tokens', b'1.074s'), (b'x-request-id', b'req_e323e6d5ed687742a118f4339e53c71a'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=yrDcfy6dI8FOOYKUPANHDyMkM0ZOEQ5HfnsOuagR0.A-1728978146-1.0.1.1-rZxwoISGY4eiWO5ccJu0MP9mS_1aYBbDow1T0T5e9i16XlrUpWGbvqsjvMdfmIvYX..brU4SELH7c3cU0xu2GQ; path=/; expires=Tue, 15-Oct-24 08:12:26 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=046twGyzL0I217_srbTS9a5fFUv9bDwdQqqWiKEJorU-1728978146205-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e2c1d38896afa-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:42:25,398 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:42:25,398 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:42:25,399 - DEBUG - receive_response_body.complete
2024-10-15 10:42:25,399 - DEBUG - response_closed.started
2024-10-15 10:42:25,399 - DEBUG - response_closed.complete
2024-10-15 10:42:25,399 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Tue, 15 Oct 2024 07:42:26 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-kzzh9hik9ryjiou4ftvhondh'), ('openai-processing-ms', '1170'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '10000'), ('x-ratelimit-remaining-requests', '9996'), ('x-ratelimit-remaining-tokens', '9821'), ('x-ratelimit-reset-requests', '26.306s'), ('x-ratelimit-reset-tokens', '1.074s'), ('x-request-id', 'req_e323e6d5ed687742a118f4339e53c71a'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=yrDcfy6dI8FOOYKUPANHDyMkM0ZOEQ5HfnsOuagR0.A-1728978146-1.0.1.1-rZxwoISGY4eiWO5ccJu0MP9mS_1aYBbDow1T0T5e9i16XlrUpWGbvqsjvMdfmIvYX..brU4SELH7c3cU0xu2GQ; path=/; expires=Tue, 15-Oct-24 08:12:26 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=046twGyzL0I217_srbTS9a5fFUv9bDwdQqqWiKEJorU-1728978146205-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d2e2c1d38896afa-OTP'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-15 10:42:25,399 - DEBUG - request_id: req_e323e6d5ed687742a118f4339e53c71a
2024-10-15 10:42:25,401 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWUDv4NREpWIFIXmKebiMt4s3DaL', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_d1q7aC9tjnAkeJxdRagN6afc', function=Function(arguments='\n{\n  "action": "extract_pii"\n}', name='AgentAction'), type='function')]))], created=1728978145, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=12, prompt_tokens=207, total_tokens=219, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:42:25,402 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.PIIData'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}}
2024-10-15 10:42:25,402 - DEBUG - max_retries: 1
2024-10-15 10:42:25,403 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}, 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}]}}
2024-10-15 10:42:25,403 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:42:25,404 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:42:25,404 - DEBUG - send_request_headers.complete
2024-10-15 10:42:25,404 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:42:25,404 - DEBUG - send_request_body.complete
2024-10-15 10:42:25,404 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:42:28,114 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:42:28 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2552'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9996'), (b'x-ratelimit-remaining-tokens', b'9721'), (b'x-ratelimit-reset-requests', b'33.564s'), (b'x-ratelimit-reset-tokens', b'1.672s'), (b'x-request-id', b'req_5c529c85933a310766090c9ae9be67de'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e2c25d8f66afa-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:42:28,115 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:42:28,115 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:42:28,115 - DEBUG - receive_response_body.complete
2024-10-15 10:42:28,115 - DEBUG - response_closed.started
2024-10-15 10:42:28,115 - DEBUG - response_closed.complete
2024-10-15 10:42:28,115 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:42:28 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '2552', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9996', 'x-ratelimit-remaining-tokens': '9721', 'x-ratelimit-reset-requests': '33.564s', 'x-ratelimit-reset-tokens': '1.672s', 'x-request-id': 'req_5c529c85933a310766090c9ae9be67de', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e2c25d8f66afa-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:42:28,115 - DEBUG - request_id: req_5c529c85933a310766090c9ae9be67de
2024-10-15 10:42:28,116 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWUE51GZxR8rMn1q9pBhlmm5AxIg', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_hezefP00mOOsVQltgplZQ16I', function=Function(arguments='{\n"name": "ISPILANTE SENTIMENT BRUSLI",\n"address": "Videle Jud: Teleorman Sos. Giurgiului nr.1"\n}', name='PIIData'), type='function')]))], created=1728978146, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=36, prompt_tokens=377, total_tokens=413, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:42:35,831 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.PIIData'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}}
2024-10-15 10:42:35,832 - DEBUG - max_retries: 1
2024-10-15 10:42:35,834 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}, 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}]}}
2024-10-15 10:42:35,834 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:42:35,835 - DEBUG - close.started
2024-10-15 10:42:35,835 - DEBUG - close.complete
2024-10-15 10:42:35,835 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-15 10:42:35,839 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x00000210294CFFB0>
2024-10-15 10:42:35,839 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x00000210292FE7D0> server_hostname='api.openai.com' timeout=5.0
2024-10-15 10:42:35,847 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x00000210294CE1B0>
2024-10-15 10:42:35,847 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:42:35,848 - DEBUG - send_request_headers.complete
2024-10-15 10:42:35,848 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:42:35,848 - DEBUG - send_request_body.complete
2024-10-15 10:42:35,848 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:42:38,076 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:42:38 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2062'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9996'), (b'x-ratelimit-remaining-tokens', b'9742'), (b'x-ratelimit-reset-requests', b'31.758s'), (b'x-ratelimit-reset-tokens', b'1.548s'), (b'x-request-id', b'req_8185306fabd2c3677b94068c6747bbd0'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e2c671a1e053d-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:42:38,076 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:42:38,076 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:42:38,076 - DEBUG - receive_response_body.complete
2024-10-15 10:42:38,077 - DEBUG - response_closed.started
2024-10-15 10:42:38,077 - DEBUG - response_closed.complete
2024-10-15 10:42:38,077 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:42:38 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '2062', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9996', 'x-ratelimit-remaining-tokens': '9742', 'x-ratelimit-reset-requests': '31.758s', 'x-ratelimit-reset-tokens': '1.548s', 'x-request-id': 'req_8185306fabd2c3677b94068c6747bbd0', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e2c671a1e053d-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:42:38,077 - DEBUG - request_id: req_8185306fabd2c3677b94068c6747bbd0
2024-10-15 10:42:38,077 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWUOBWwA0B5zz0yQMYbHrIYXKr3H', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_VP3OKanaEcD5tQmumYgoSbIU', function=Function(arguments='{\n"name": "ELENA VASILESCU",\n"address": "Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B"\n}', name='PIIData'), type='function')]))], created=1728978156, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=42, prompt_tokens=380, total_tokens=422, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:42:39,254 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 10:42:39,254 - DEBUG - max_retries: 1
2024-10-15 10:42:39,256 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 10:42:39,257 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:42:39,257 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:42:39,257 - DEBUG - send_request_headers.complete
2024-10-15 10:42:39,258 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:42:39,258 - DEBUG - send_request_body.complete
2024-10-15 10:42:39,258 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:42:40,309 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:42:41 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'904'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9995'), (b'x-ratelimit-remaining-tokens', b'9821'), (b'x-ratelimit-reset-requests', b'36.999s'), (b'x-ratelimit-reset-tokens', b'1.074s'), (b'x-request-id', b'req_2face05d649f9c1cad110b3038ef314e'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e2c7c6d37053d-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:42:40,309 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:42:40,309 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:42:40,309 - DEBUG - receive_response_body.complete
2024-10-15 10:42:40,309 - DEBUG - response_closed.started
2024-10-15 10:42:40,309 - DEBUG - response_closed.complete
2024-10-15 10:42:40,309 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:42:41 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '904', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9995', 'x-ratelimit-remaining-tokens': '9821', 'x-ratelimit-reset-requests': '36.999s', 'x-ratelimit-reset-tokens': '1.074s', 'x-request-id': 'req_2face05d649f9c1cad110b3038ef314e', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e2c7c6d37053d-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:42:40,309 - DEBUG - request_id: req_2face05d649f9c1cad110b3038ef314e
2024-10-15 10:42:40,310 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWUSUX31UFILgjX9FGupF5AZbm4j', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_YfVboKdoukqkrvz10ecLCxMY', function=Function(arguments='\n{\n"action": "identify_parties"\n}', name='AgentAction'), type='function')]))], created=1728978160, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=11, prompt_tokens=207, total_tokens=218, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:42:40,310 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.ContractParties'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Identify the buyer and seller from the given information:\n\nName: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'properties': {'buyer': {'description': 'Name of the buyer', 'title': 'Buyer', 'type': 'string'}, 'seller': {'description': 'Name of the seller', 'title': 'Seller', 'type': 'string'}}, 'required': ['buyer', 'seller'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}}
2024-10-15 10:42:40,310 - DEBUG - max_retries: 1
2024-10-15 10:42:40,312 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Identify the buyer and seller from the given information:\n\nName: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}, 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'properties': {'buyer': {'description': 'Name of the buyer', 'title': 'Buyer', 'type': 'string'}, 'seller': {'description': 'Name of the seller', 'title': 'Seller', 'type': 'string'}}, 'required': ['buyer', 'seller'], 'type': 'object'}}}]}}
2024-10-15 10:42:40,312 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:42:40,312 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:42:40,312 - DEBUG - send_request_headers.complete
2024-10-15 10:42:40,312 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:42:40,312 - DEBUG - send_request_body.complete
2024-10-15 10:42:40,312 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:42:42,124 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:42:42 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1634'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9994'), (b'x-ratelimit-remaining-tokens', b'9794'), (b'x-ratelimit-reset-requests', b'44.577s'), (b'x-ratelimit-reset-tokens', b'1.23s'), (b'x-request-id', b'req_ce41bd79bdeda4922f1f5236821de0be'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e2c830bc1053d-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:42:42,125 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:42:42,125 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:42:42,126 - DEBUG - receive_response_body.complete
2024-10-15 10:42:42,126 - DEBUG - response_closed.started
2024-10-15 10:42:42,126 - DEBUG - response_closed.complete
2024-10-15 10:42:42,126 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:42:42 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1634', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9994', 'x-ratelimit-remaining-tokens': '9794', 'x-ratelimit-reset-requests': '44.577s', 'x-ratelimit-reset-tokens': '1.23s', 'x-request-id': 'req_ce41bd79bdeda4922f1f5236821de0be', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e2c830bc1053d-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:42:42,126 - DEBUG - request_id: req_ce41bd79bdeda4922f1f5236821de0be
2024-10-15 10:42:42,127 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWUTkiOwCUbEcTkVj18uAULmvDGJ', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_qqhJk8eLMwQzW0A21LrFRsBu', function=Function(arguments='{\n"buyer": "ISPILANTE SENTIMENT BRUSLI",\n"seller": "ELENA VASILESCU"\n}', name='ContractParties'), type='function')]))], created=1728978161, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=28, prompt_tokens=229, total_tokens=257, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:42:42,130 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: Yes\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 10:42:42,130 - DEBUG - max_retries: 1
2024-10-15 10:42:42,131 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: Yes\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 10:42:42,131 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:42:42,131 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:42:42,132 - DEBUG - send_request_headers.complete
2024-10-15 10:42:42,132 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:42:42,132 - DEBUG - send_request_body.complete
2024-10-15 10:42:42,132 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:42:43,219 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:42:44 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'926'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9994'), (b'x-ratelimit-remaining-tokens', b'9754'), (b'x-ratelimit-reset-requests', b'51.406s'), (b'x-ratelimit-reset-tokens', b'1.472s'), (b'x-request-id', b'req_134f0000442f2049ced4330c3905a118'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e2c8e5ec8053d-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:42:43,219 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:42:43,220 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:42:43,220 - DEBUG - receive_response_body.complete
2024-10-15 10:42:43,220 - DEBUG - response_closed.started
2024-10-15 10:42:43,220 - DEBUG - response_closed.complete
2024-10-15 10:42:43,220 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:42:44 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '926', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9994', 'x-ratelimit-remaining-tokens': '9754', 'x-ratelimit-reset-requests': '51.406s', 'x-ratelimit-reset-tokens': '1.472s', 'x-request-id': 'req_134f0000442f2049ced4330c3905a118', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e2c8e5ec8053d-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:42:43,221 - DEBUG - request_id: req_134f0000442f2049ced4330c3905a118
2024-10-15 10:42:43,221 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWUVBXUw5R66N78kkloJZPr6A0AC', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_FloSuDP5tmvMe1drDxvKf2X6', function=Function(arguments='{\n  "action": "determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728978163, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=12, prompt_tokens=207, total_tokens=219, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:42:55,993 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.ContractDetails'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'For a airbnb contract, assign appropriate roles to ISPILANTE SENTIMENT BRUSLI and ELENA VASILESCU. Respond with a JSON object where keys are role names and values are the assigned party names.'}], 'tools': [{'type': 'function', 'function': {'name': 'ContractDetails', 'description': 'Correctly extracted `ContractDetails` with all the required parameters with correct types', 'parameters': {'properties': {'contract_type': {'description': 'Type of contract (e.g., airbnb, buy-sell, it-consulting)', 'title': 'Contract Type', 'type': 'string'}, 'additional_info': {'additionalProperties': {'type': 'string'}, 'description': 'Additional information specific to the contract type', 'title': 'Additional Info', 'type': 'object'}}, 'required': ['additional_info', 'contract_type'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'ContractDetails'}}}
2024-10-15 10:42:55,994 - DEBUG - max_retries: 1
2024-10-15 10:42:55,996 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'For a airbnb contract, assign appropriate roles to ISPILANTE SENTIMENT BRUSLI and ELENA VASILESCU. Respond with a JSON object where keys are role names and values are the assigned party names.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'ContractDetails'}}, 'tools': [{'type': 'function', 'function': {'name': 'ContractDetails', 'description': 'Correctly extracted `ContractDetails` with all the required parameters with correct types', 'parameters': {'properties': {'contract_type': {'description': 'Type of contract (e.g., airbnb, buy-sell, it-consulting)', 'title': 'Contract Type', 'type': 'string'}, 'additional_info': {'additionalProperties': {'type': 'string'}, 'description': 'Additional information specific to the contract type', 'title': 'Additional Info', 'type': 'object'}}, 'required': ['additional_info', 'contract_type'], 'type': 'object'}}}]}}
2024-10-15 10:42:55,996 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:42:55,996 - DEBUG - close.started
2024-10-15 10:42:55,997 - DEBUG - close.complete
2024-10-15 10:42:55,997 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-15 10:42:56,075 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x00000210296F28A0>
2024-10-15 10:42:56,075 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x00000210292FE7D0> server_hostname='api.openai.com' timeout=5.0
2024-10-15 10:42:56,082 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x00000210294CE0F0>
2024-10-15 10:42:56,082 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:42:56,082 - DEBUG - send_request_headers.complete
2024-10-15 10:42:56,083 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:42:56,083 - DEBUG - send_request_body.complete
2024-10-15 10:42:56,083 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:42:56,958 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:42:57 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'731'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9994'), (b'x-ratelimit-remaining-tokens', b'9844'), (b'x-ratelimit-reset-requests', b'46.1s'), (b'x-ratelimit-reset-tokens', b'936ms'), (b'x-request-id', b'req_872e99f4a4bbb2eddff522315d854652'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e2ce58e31c9e1-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:42:56,959 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:42:56,959 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:42:56,959 - DEBUG - receive_response_body.complete
2024-10-15 10:42:56,959 - DEBUG - response_closed.started
2024-10-15 10:42:56,959 - DEBUG - response_closed.complete
2024-10-15 10:42:56,959 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:42:57 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '731', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9994', 'x-ratelimit-remaining-tokens': '9844', 'x-ratelimit-reset-requests': '46.1s', 'x-ratelimit-reset-tokens': '936ms', 'x-request-id': 'req_872e99f4a4bbb2eddff522315d854652', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e2ce58e31c9e1-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:42:56,959 - DEBUG - request_id: req_872e99f4a4bbb2eddff522315d854652
2024-10-15 10:42:56,959 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWUjYKMP4qVEWJ5In9zHbvJ52Gdr', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_kRMmAqKd9ndhrAi4HRSMPJRJ', function=Function(arguments='{\n"contract_type": "airbnb"\n}', name='ContractDetails'), type='function')]))], created=1728978177, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=10, prompt_tokens=201, total_tokens=211, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:42:56,960 - DEBUG - Contract type: airbnb
2024-10-15 10:42:56,960 - DEBUG - Additional info: {}
2024-10-15 10:42:56,960 - ERROR - Error in determine_contract_details: No roles assigned in the API response
2024-10-15 10:42:56,960 - ERROR - Error determining contract details: No roles assigned in the API response
2024-10-15 10:43:26,243 - DEBUG - close.started
2024-10-15 10:43:26,243 - DEBUG - close.complete
2024-10-15 10:43:26,243 - ERROR - Task exception was never retrieved
future: <Task finished name='Task-1' coro=<agent_workflow() done, defined at D:\deve\contract_automation\src\main.py:25> exception=KeyboardInterrupt()>
Traceback (most recent call last):
  File "D:\deve\contract_automation\src\main.py", line 110, in <module>
    asyncio.run(agent_workflow())
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 30, in run
    return loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 92, in run_until_complete
    self._run_once()
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 133, in _run_once
    handle._run()
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 386, in __wakeup
    self.__step()
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 293, in __step
    self.__step_run_and_handle_result(exc)
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 304, in __step_run_and_handle_result
    result = coro.send(None)
             ^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\src\main.py", line 55, in agent_workflow
    contract_type = input("Enter contract type: ").lower().replace(" ", "-")
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
2024-10-15 10:44:13,882 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-15 10:44:15,127 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-15 10:44:15,127 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-15 10:44:15,457 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-15 10:44:15,458 - DEBUG - Using proactor: IocpProactor
2024-10-15 10:44:15,478 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:44:15,478 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:44:15,478 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:44:15,478 - DEBUG - Compression method 0
2024-10-15 10:44:15,478 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:44:15,478 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:44:15,478 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 10:44:15,479 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 10:44:15,479 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 10:44:15,479 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 10:44:15,479 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:44:15,479 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:44:15,479 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:44:15,479 - DEBUG - Compression method 0
2024-10-15 10:44:15,479 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:44:15,479 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:44:15,479 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 10:44:15,479 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 10:44:15,479 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 10:44:15,479 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 10:44:15,490 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:44:15,490 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:44:15,490 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 10:44:15,490 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 10:44:15,491 - DEBUG - Error closing: Operation on closed image
2024-10-15 10:44:17,505 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:44:17,506 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:44:17,506 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:44:17,506 - DEBUG - Compression method 0
2024-10-15 10:44:17,506 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:44:17,506 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:44:17,506 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 10:44:17,506 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 10:44:17,506 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 10:44:17,506 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 10:44:17,506 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:44:17,506 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:44:17,506 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:44:17,506 - DEBUG - Compression method 0
2024-10-15 10:44:17,506 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:44:17,506 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:44:17,506 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 10:44:17,506 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 10:44:17,506 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 10:44:17,506 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 10:44:17,523 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:44:17,523 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:44:17,523 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 10:44:17,523 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 10:44:17,524 - DEBUG - Error closing: Operation on closed image
2024-10-15 10:44:20,081 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 0 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 10:44:20,082 - DEBUG - max_retries: 1
2024-10-15 10:44:20,084 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 0 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 10:44:20,121 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:44:20,122 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-15 10:44:20,156 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001B7FF763FB0>
2024-10-15 10:44:20,156 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x000001B7FF5CE7D0> server_hostname='api.openai.com' timeout=5.0
2024-10-15 10:44:20,166 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001B7FF763B00>
2024-10-15 10:44:20,167 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:44:20,167 - DEBUG - send_request_headers.complete
2024-10-15 10:44:20,167 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:44:20,167 - DEBUG - send_request_body.complete
2024-10-15 10:44:20,167 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:44:21,143 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:44:21 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'816'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'9821'), (b'x-ratelimit-reset-requests', b'8.64s'), (b'x-ratelimit-reset-tokens', b'1.074s'), (b'x-request-id', b'req_8c1b2a3b9feb5e3c06a4a0f3759c2e61'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=Wo1gIeRP9sww5vvIsxHyY3ETPQLi.1YdI_h1m7jAgx8-1728978261-1.0.1.1-5ym9uQhGGIJjlgvojjs0IoKLyKA0l90N7mT2swQoQjO.2GIjVETS8_fX0gba_nFOPWbdJKYksDF0I.fOJO.6pw; path=/; expires=Tue, 15-Oct-24 08:14:21 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=jKsmgNdgka9JuAUVIuDwRRr5KJ.PY1XFtVcODNB9.R4-1728978261924-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e2ef2f9bf0538-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:44:21,145 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:44:21,146 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:44:21,146 - DEBUG - receive_response_body.complete
2024-10-15 10:44:21,146 - DEBUG - response_closed.started
2024-10-15 10:44:21,146 - DEBUG - response_closed.complete
2024-10-15 10:44:21,147 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Tue, 15 Oct 2024 07:44:21 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-kzzh9hik9ryjiou4ftvhondh'), ('openai-processing-ms', '816'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '10000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '9821'), ('x-ratelimit-reset-requests', '8.64s'), ('x-ratelimit-reset-tokens', '1.074s'), ('x-request-id', 'req_8c1b2a3b9feb5e3c06a4a0f3759c2e61'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=Wo1gIeRP9sww5vvIsxHyY3ETPQLi.1YdI_h1m7jAgx8-1728978261-1.0.1.1-5ym9uQhGGIJjlgvojjs0IoKLyKA0l90N7mT2swQoQjO.2GIjVETS8_fX0gba_nFOPWbdJKYksDF0I.fOJO.6pw; path=/; expires=Tue, 15-Oct-24 08:14:21 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=jKsmgNdgka9JuAUVIuDwRRr5KJ.PY1XFtVcODNB9.R4-1728978261924-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d2e2ef2f9bf0538-OTP'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-15 10:44:21,147 - DEBUG - request_id: req_8c1b2a3b9feb5e3c06a4a0f3759c2e61
2024-10-15 10:44:21,150 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWW5v40IeoxvDfzWXB2IGfnrrHiy', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_GwoJQGIYMMuXPtOhu1uWTE6m', function=Function(arguments='{\n"action": "extract_pii"\n}', name='AgentAction'), type='function')]))], created=1728978261, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=10, prompt_tokens=207, total_tokens=217, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:44:21,152 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.PIIData'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}}
2024-10-15 10:44:21,152 - DEBUG - max_retries: 1
2024-10-15 10:44:21,153 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}, 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}]}}
2024-10-15 10:44:21,154 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:44:21,154 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:44:21,154 - DEBUG - send_request_headers.complete
2024-10-15 10:44:21,154 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:44:21,154 - DEBUG - send_request_body.complete
2024-10-15 10:44:21,154 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:44:23,448 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:44:24 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2113'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9998'), (b'x-ratelimit-remaining-tokens', b'9683'), (b'x-ratelimit-reset-requests', b'16.292s'), (b'x-ratelimit-reset-tokens', b'1.898s'), (b'x-request-id', b'req_ebe67e0261eee068a38a734b6316a2f3'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e2ef918230538-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:44:23,449 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:44:23,449 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:44:23,449 - DEBUG - receive_response_body.complete
2024-10-15 10:44:23,450 - DEBUG - response_closed.started
2024-10-15 10:44:23,450 - DEBUG - response_closed.complete
2024-10-15 10:44:23,450 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:44:24 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '2113', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9998', 'x-ratelimit-remaining-tokens': '9683', 'x-ratelimit-reset-requests': '16.292s', 'x-ratelimit-reset-tokens': '1.898s', 'x-request-id': 'req_ebe67e0261eee068a38a734b6316a2f3', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e2ef918230538-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:44:23,450 - DEBUG - request_id: req_ebe67e0261eee068a38a734b6316a2f3
2024-10-15 10:44:23,452 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWW6FmiWHNmUEdf68bSzvY3uSSkI', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_ofKHrRPBDo0wkM5RPxiTwRrW', function=Function(arguments='{\n"name": "ISPILANTE SENTIMENT BRUSLI",\n"address": "Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR"\n}', name='PIIData'), type='function')]))], created=1728978262, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=39, prompt_tokens=377, total_tokens=416, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:44:25,504 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.PIIData'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}}
2024-10-15 10:44:25,504 - DEBUG - max_retries: 1
2024-10-15 10:44:25,506 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}, 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}]}}
2024-10-15 10:44:25,507 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:44:25,507 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:44:25,507 - DEBUG - send_request_headers.complete
2024-10-15 10:44:25,507 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:44:25,507 - DEBUG - send_request_body.complete
2024-10-15 10:44:25,507 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:44:27,548 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:44:28 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1885'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9997'), (b'x-ratelimit-remaining-tokens', b'9742'), (b'x-ratelimit-reset-requests', b'20.579s'), (b'x-ratelimit-reset-tokens', b'1.548s'), (b'x-request-id', b'req_5d9cd95d1ed4c48d33d6b89418409fcf'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e2f145efb0538-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:44:27,548 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:44:27,548 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:44:27,548 - DEBUG - receive_response_body.complete
2024-10-15 10:44:27,548 - DEBUG - response_closed.started
2024-10-15 10:44:27,548 - DEBUG - response_closed.complete
2024-10-15 10:44:27,548 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:44:28 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1885', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9997', 'x-ratelimit-remaining-tokens': '9742', 'x-ratelimit-reset-requests': '20.579s', 'x-ratelimit-reset-tokens': '1.548s', 'x-request-id': 'req_5d9cd95d1ed4c48d33d6b89418409fcf', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e2f145efb0538-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:44:27,548 - DEBUG - request_id: req_5d9cd95d1ed4c48d33d6b89418409fcf
2024-10-15 10:44:27,549 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWWAbFW3zYPJ4GDQX5HXG6wJqnwO', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_TxCH6C3ehDEIcnbacRvUdz3c', function=Function(arguments='{\n"name": "VASILESCU ELENA",\n"address": "Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B"\n}', name='PIIData'), type='function')]))], created=1728978266, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=41, prompt_tokens=380, total_tokens=421, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:44:29,217 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 10:44:29,217 - DEBUG - max_retries: 1
2024-10-15 10:44:29,219 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 10:44:29,219 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:44:29,219 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:44:29,219 - DEBUG - send_request_headers.complete
2024-10-15 10:44:29,219 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:44:29,219 - DEBUG - send_request_body.complete
2024-10-15 10:44:29,219 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:44:30,116 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:44:30 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'738'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9997'), (b'x-ratelimit-remaining-tokens', b'9821'), (b'x-ratelimit-reset-requests', b'25.501s'), (b'x-ratelimit-reset-tokens', b'1.074s'), (b'x-request-id', b'req_237d9e68517f6091cd2c12b4a57e92fb'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e2f2b89590538-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:44:30,117 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:44:30,117 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:44:30,118 - DEBUG - receive_response_body.complete
2024-10-15 10:44:30,118 - DEBUG - response_closed.started
2024-10-15 10:44:30,118 - DEBUG - response_closed.complete
2024-10-15 10:44:30,118 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:44:30 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '738', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9997', 'x-ratelimit-remaining-tokens': '9821', 'x-ratelimit-reset-requests': '25.501s', 'x-ratelimit-reset-tokens': '1.074s', 'x-request-id': 'req_237d9e68517f6091cd2c12b4a57e92fb', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e2f2b89590538-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:44:30,119 - DEBUG - request_id: req_237d9e68517f6091cd2c12b4a57e92fb
2024-10-15 10:44:30,120 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWWE6jglZQnzZVHGHUOEOJTI6yJB', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_a1ovOY6lWDtRDvnuPYmDaOyH', function=Function(arguments='\n{\n"action": "identify_parties"\n}', name='AgentAction'), type='function')]))], created=1728978270, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=11, prompt_tokens=207, total_tokens=218, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:44:30,122 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.ContractParties'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Identify the buyer and seller from the given information:\n\nName: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: VASILESCU ELENA, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'properties': {'buyer': {'description': 'Name of the buyer', 'title': 'Buyer', 'type': 'string'}, 'seller': {'description': 'Name of the seller', 'title': 'Seller', 'type': 'string'}}, 'required': ['buyer', 'seller'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}}
2024-10-15 10:44:30,122 - DEBUG - max_retries: 1
2024-10-15 10:44:30,125 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Identify the buyer and seller from the given information:\n\nName: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: VASILESCU ELENA, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}, 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'properties': {'buyer': {'description': 'Name of the buyer', 'title': 'Buyer', 'type': 'string'}, 'seller': {'description': 'Name of the seller', 'title': 'Seller', 'type': 'string'}}, 'required': ['buyer', 'seller'], 'type': 'object'}}}]}}
2024-10-15 10:44:30,126 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:44:30,126 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:44:30,126 - DEBUG - send_request_headers.complete
2024-10-15 10:44:30,126 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:44:30,126 - DEBUG - send_request_body.complete
2024-10-15 10:44:30,126 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:44:32,046 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:44:32 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1755'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9996'), (b'x-ratelimit-remaining-tokens', b'9766'), (b'x-ratelimit-reset-requests', b'33.24s'), (b'x-ratelimit-reset-tokens', b'1.403s'), (b'x-request-id', b'req_c034760af578cf4b6c351063be19a313'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e2f312f4f0538-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:44:32,046 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:44:32,046 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:44:32,047 - DEBUG - receive_response_body.complete
2024-10-15 10:44:32,047 - DEBUG - response_closed.started
2024-10-15 10:44:32,047 - DEBUG - response_closed.complete
2024-10-15 10:44:32,047 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:44:32 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1755', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9996', 'x-ratelimit-remaining-tokens': '9766', 'x-ratelimit-reset-requests': '33.24s', 'x-ratelimit-reset-tokens': '1.403s', 'x-request-id': 'req_c034760af578cf4b6c351063be19a313', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e2f312f4f0538-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:44:32,047 - DEBUG - request_id: req_c034760af578cf4b6c351063be19a313
2024-10-15 10:44:32,048 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWWFc3W8O79mkPEb4MXiRZQof3Vj', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_V3RATxieMkpiU9ht2UWtGrlo', function=Function(arguments='{\n  "buyer": "ISPILANTE SENTIMENT BRUSLI",\n  "seller": "VASILESCU ELENA"\n}', name='ContractParties'), type='function')]))], created=1728978271, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=29, prompt_tokens=232, total_tokens=261, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:44:32,049 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: Yes\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 10:44:32,049 - DEBUG - max_retries: 1
2024-10-15 10:44:32,051 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: Yes\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 10:44:32,051 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:44:32,051 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:44:32,052 - DEBUG - send_request_headers.complete
2024-10-15 10:44:32,052 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:44:32,052 - DEBUG - send_request_body.complete
2024-10-15 10:44:32,052 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:44:33,043 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:44:33 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'834'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9995'), (b'x-ratelimit-remaining-tokens', b'9751'), (b'x-ratelimit-reset-requests', b'39.952s'), (b'x-ratelimit-reset-tokens', b'1.49s'), (b'x-request-id', b'req_2bf3a2a91351a2d78efeb8b339193938'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e2f3d3c4c0538-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:44:33,043 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:44:33,043 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:44:33,043 - DEBUG - receive_response_body.complete
2024-10-15 10:44:33,044 - DEBUG - response_closed.started
2024-10-15 10:44:33,044 - DEBUG - response_closed.complete
2024-10-15 10:44:33,044 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:44:33 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '834', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9995', 'x-ratelimit-remaining-tokens': '9751', 'x-ratelimit-reset-requests': '39.952s', 'x-ratelimit-reset-tokens': '1.49s', 'x-request-id': 'req_2bf3a2a91351a2d78efeb8b339193938', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e2f3d3c4c0538-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:44:33,044 - DEBUG - request_id: req_2bf3a2a91351a2d78efeb8b339193938
2024-10-15 10:44:33,044 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWWHoEnnjGVbOjclKPhLqTs5EadL', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_4LcQdZ5ZhDvml6tXwPQCWxac', function=Function(arguments='\n{\n  "action": "determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728978273, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=13, prompt_tokens=207, total_tokens=220, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:44:35,808 - DEBUG - close.started
2024-10-15 10:44:35,809 - DEBUG - close.complete
2024-10-15 10:44:35,809 - ERROR - Task exception was never retrieved
future: <Task finished name='Task-1' coro=<agent_workflow() done, defined at D:\deve\contract_automation\src\main.py:25> exception=KeyboardInterrupt()>
Traceback (most recent call last):
  File "D:\deve\contract_automation\src\main.py", line 110, in <module>
    asyncio.run(agent_workflow())
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 30, in run
    return loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 92, in run_until_complete
    self._run_once()
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 133, in _run_once
    handle._run()
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 386, in __wakeup
    self.__step()
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 293, in __step
    self.__step_run_and_handle_result(exc)
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 304, in __step_run_and_handle_result
    result = coro.send(None)
             ^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\src\main.py", line 55, in agent_workflow
    contract_type = input("Enter contract type: ").lower().replace(" ", "-")
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
2024-10-15 10:44:47,087 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-15 10:44:48,348 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-15 10:44:48,349 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-15 10:44:48,676 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-15 10:44:48,677 - DEBUG - Using proactor: IocpProactor
2024-10-15 10:44:48,707 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:44:48,707 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:44:48,707 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:44:48,707 - DEBUG - Compression method 0
2024-10-15 10:44:48,707 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:44:48,707 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:44:48,707 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 10:44:48,707 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 10:44:48,707 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 10:44:48,707 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 10:44:48,707 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:44:48,707 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:44:48,707 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:44:48,707 - DEBUG - Compression method 0
2024-10-15 10:44:48,707 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:44:48,707 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:44:48,707 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 10:44:48,707 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 10:44:48,707 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 10:44:48,708 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 10:44:48,717 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:44:48,717 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:44:48,717 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 10:44:48,717 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 10:44:48,718 - DEBUG - Error closing: Operation on closed image
2024-10-15 10:44:50,778 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:44:50,778 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:44:50,778 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:44:50,778 - DEBUG - Compression method 0
2024-10-15 10:44:50,778 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:44:50,778 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:44:50,778 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 10:44:50,778 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 10:44:50,778 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 10:44:50,778 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 10:44:50,779 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:44:50,779 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:44:50,779 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:44:50,779 - DEBUG - Compression method 0
2024-10-15 10:44:50,779 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:44:50,779 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:44:50,779 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 10:44:50,779 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 10:44:50,779 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 10:44:50,779 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 10:44:50,796 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:44:50,796 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:44:50,796 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 10:44:50,796 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 10:44:50,797 - DEBUG - Error closing: Operation on closed image
2024-10-15 10:44:53,349 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 0 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 10:44:53,350 - DEBUG - max_retries: 1
2024-10-15 10:44:53,352 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 0 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 10:44:53,388 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:44:53,388 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-15 10:44:53,399 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001C1F29EC0E0>
2024-10-15 10:44:53,399 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x000001C1F281E750> server_hostname='api.openai.com' timeout=5.0
2024-10-15 10:44:53,406 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001C1F29AFFB0>
2024-10-15 10:44:53,406 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:44:53,406 - DEBUG - send_request_headers.complete
2024-10-15 10:44:53,406 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:44:53,406 - DEBUG - send_request_body.complete
2024-10-15 10:44:53,406 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:44:54,469 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:44:55 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'691'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9996'), (b'x-ratelimit-remaining-tokens', b'9821'), (b'x-ratelimit-reset-requests', b'27.046s'), (b'x-ratelimit-reset-tokens', b'1.074s'), (b'x-request-id', b'req_b82940cc45157a9bef97f9ea59e2eb83'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=5p3XQhJSimV0_bebTlSeazvUnZvOL_79DJAZk4fcw0A-1728978295-1.0.1.1-_cEV6GQ5ng2D7OTC1Dyc1f8RdChLZeo6PShXAUEIF0swR4zmhfNXsaXe6N3a.IPdhFw58INO_oHV6qOPSL54Mg; path=/; expires=Tue, 15-Oct-24 08:14:55 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=5W2_s9bXA0R7niMhEuqb8CWhm62h_2mdbHRjIE69TAg-1728978295242-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e2fc2ae8b0531-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:44:54,471 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:44:54,471 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:44:54,472 - DEBUG - receive_response_body.complete
2024-10-15 10:44:54,472 - DEBUG - response_closed.started
2024-10-15 10:44:54,472 - DEBUG - response_closed.complete
2024-10-15 10:44:54,472 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Tue, 15 Oct 2024 07:44:55 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-kzzh9hik9ryjiou4ftvhondh'), ('openai-processing-ms', '691'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '10000'), ('x-ratelimit-remaining-requests', '9996'), ('x-ratelimit-remaining-tokens', '9821'), ('x-ratelimit-reset-requests', '27.046s'), ('x-ratelimit-reset-tokens', '1.074s'), ('x-request-id', 'req_b82940cc45157a9bef97f9ea59e2eb83'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=5p3XQhJSimV0_bebTlSeazvUnZvOL_79DJAZk4fcw0A-1728978295-1.0.1.1-_cEV6GQ5ng2D7OTC1Dyc1f8RdChLZeo6PShXAUEIF0swR4zmhfNXsaXe6N3a.IPdhFw58INO_oHV6qOPSL54Mg; path=/; expires=Tue, 15-Oct-24 08:14:55 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=5W2_s9bXA0R7niMhEuqb8CWhm62h_2mdbHRjIE69TAg-1728978295242-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d2e2fc2ae8b0531-OTP'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-15 10:44:54,473 - DEBUG - request_id: req_b82940cc45157a9bef97f9ea59e2eb83
2024-10-15 10:44:54,476 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWWcWjuJEpMblE28hVnk3sUGQB4z', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_ODALPjoEizrbJ0P3VMRlWrP5', function=Function(arguments='{\n"action": "extract_pii"\n}', name='AgentAction'), type='function')]))], created=1728978294, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=10, prompt_tokens=207, total_tokens=217, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:44:54,477 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.PIIData'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}}
2024-10-15 10:44:54,477 - DEBUG - max_retries: 1
2024-10-15 10:44:54,478 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}, 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}]}}
2024-10-15 10:44:54,479 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:44:54,479 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:44:54,479 - DEBUG - send_request_headers.complete
2024-10-15 10:44:54,479 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:44:54,479 - DEBUG - send_request_body.complete
2024-10-15 10:44:54,479 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:44:56,521 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:44:57 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1873'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9995'), (b'x-ratelimit-remaining-tokens', b'9664'), (b'x-ratelimit-reset-requests', b'34.815s'), (b'x-ratelimit-reset-tokens', b'2.014s'), (b'x-request-id', b'req_5c552a5daa990dc75bb6ecc96d4b68d7'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e2fc95d470531-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:44:56,521 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:44:56,522 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:44:56,522 - DEBUG - receive_response_body.complete
2024-10-15 10:44:56,522 - DEBUG - response_closed.started
2024-10-15 10:44:56,523 - DEBUG - response_closed.complete
2024-10-15 10:44:56,523 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:44:57 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1873', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9995', 'x-ratelimit-remaining-tokens': '9664', 'x-ratelimit-reset-requests': '34.815s', 'x-ratelimit-reset-tokens': '2.014s', 'x-request-id': 'req_5c552a5daa990dc75bb6ecc96d4b68d7', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e2fc95d470531-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:44:56,523 - DEBUG - request_id: req_5c552a5daa990dc75bb6ecc96d4b68d7
2024-10-15 10:44:56,524 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWWdmq3wqgVWFUl6WGenzvgVUiCz', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_P38WjOlHkjbr6FaMyta7Kg3i', function=Function(arguments='{\n  "name": "ISPILANTE SENTIMENT BRUSLI",\n  "address": "Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR"\n}', name='PIIData'), type='function')]))], created=1728978295, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=42, prompt_tokens=377, total_tokens=419, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:44:58,423 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.PIIData'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}}
2024-10-15 10:44:58,423 - DEBUG - max_retries: 1
2024-10-15 10:44:58,425 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}, 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}]}}
2024-10-15 10:44:58,425 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:44:58,426 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:44:58,426 - DEBUG - send_request_headers.complete
2024-10-15 10:44:58,426 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:44:58,426 - DEBUG - send_request_body.complete
2024-10-15 10:44:58,426 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:45:00,433 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:45:01 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1852'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9995'), (b'x-ratelimit-remaining-tokens', b'9742'), (b'x-ratelimit-reset-requests', b'39.512s'), (b'x-ratelimit-reset-tokens', b'1.548s'), (b'x-request-id', b'req_26edb07fe272498b32e0986b0435fd97'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e2fe20e8e0531-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:45:00,434 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:45:00,435 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:45:00,435 - DEBUG - receive_response_body.complete
2024-10-15 10:45:00,435 - DEBUG - response_closed.started
2024-10-15 10:45:00,435 - DEBUG - response_closed.complete
2024-10-15 10:45:00,436 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:45:01 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1852', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9995', 'x-ratelimit-remaining-tokens': '9742', 'x-ratelimit-reset-requests': '39.512s', 'x-ratelimit-reset-tokens': '1.548s', 'x-request-id': 'req_26edb07fe272498b32e0986b0435fd97', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e2fe20e8e0531-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:45:00,436 - DEBUG - request_id: req_26edb07fe272498b32e0986b0435fd97
2024-10-15 10:45:00,437 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWWhRAzUXXvElwPgHP6RvO369Ma4', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_f48kUaqw6vBuQNoWhE1QDuRP', function=Function(arguments='{\n"name": "VASILESCU ELENA",\n"address": "Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3"\n}', name='PIIData'), type='function')]))], created=1728978299, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=38, prompt_tokens=380, total_tokens=418, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:45:01,659 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 10:45:01,659 - DEBUG - max_retries: 1
2024-10-15 10:45:01,661 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 10:45:01,661 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:45:01,661 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:45:01,662 - DEBUG - send_request_headers.complete
2024-10-15 10:45:01,662 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:45:01,662 - DEBUG - send_request_body.complete
2024-10-15 10:45:01,662 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:45:02,828 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:45:03 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1014'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9994'), (b'x-ratelimit-remaining-tokens', b'9821'), (b'x-ratelimit-reset-requests', b'44.914s'), (b'x-ratelimit-reset-tokens', b'1.074s'), (b'x-request-id', b'req_06cd1416d82aa2cb95b0a8d55490a46a'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e2ff639d80531-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:45:02,829 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:45:02,830 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:45:02,830 - DEBUG - receive_response_body.complete
2024-10-15 10:45:02,830 - DEBUG - response_closed.started
2024-10-15 10:45:02,831 - DEBUG - response_closed.complete
2024-10-15 10:45:02,831 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:45:03 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1014', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9994', 'x-ratelimit-remaining-tokens': '9821', 'x-ratelimit-reset-requests': '44.914s', 'x-ratelimit-reset-tokens': '1.074s', 'x-request-id': 'req_06cd1416d82aa2cb95b0a8d55490a46a', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e2ff639d80531-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:45:02,831 - DEBUG - request_id: req_06cd1416d82aa2cb95b0a8d55490a46a
2024-10-15 10:45:02,832 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWWkAmfhtcqekaMEoOA0OW59UYpE', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_ZfwlmMMoDfymhfvDEb1h1Qem', function=Function(arguments='\n{\n  "action": "identify_parties"\n}', name='AgentAction'), type='function')]))], created=1728978302, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=12, prompt_tokens=207, total_tokens=219, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:45:02,835 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.ContractParties'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Identify the buyer and seller from the given information:\n\nName: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: VASILESCU ELENA, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3'}], 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'properties': {'buyer': {'description': 'Name of the buyer', 'title': 'Buyer', 'type': 'string'}, 'seller': {'description': 'Name of the seller', 'title': 'Seller', 'type': 'string'}}, 'required': ['buyer', 'seller'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}}
2024-10-15 10:45:02,835 - DEBUG - max_retries: 1
2024-10-15 10:45:02,836 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Identify the buyer and seller from the given information:\n\nName: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: VASILESCU ELENA, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}, 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'properties': {'buyer': {'description': 'Name of the buyer', 'title': 'Buyer', 'type': 'string'}, 'seller': {'description': 'Name of the seller', 'title': 'Seller', 'type': 'string'}}, 'required': ['buyer', 'seller'], 'type': 'object'}}}]}}
2024-10-15 10:45:02,836 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:45:02,837 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:45:02,837 - DEBUG - send_request_headers.complete
2024-10-15 10:45:02,837 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:45:02,837 - DEBUG - send_request_body.complete
2024-10-15 10:45:02,837 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:45:04,864 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:45:05 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1877'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9993'), (b'x-ratelimit-remaining-tokens', b'9811'), (b'x-ratelimit-reset-requests', b'52.382s'), (b'x-ratelimit-reset-tokens', b'1.132s'), (b'x-request-id', b'req_a49ac7f26714c4556d5d27f5b663fa2e'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e2ffd98940531-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:45:04,864 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:45:04,865 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:45:04,865 - DEBUG - receive_response_body.complete
2024-10-15 10:45:04,865 - DEBUG - response_closed.started
2024-10-15 10:45:04,865 - DEBUG - response_closed.complete
2024-10-15 10:45:04,865 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:45:05 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1877', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9993', 'x-ratelimit-remaining-tokens': '9811', 'x-ratelimit-reset-requests': '52.382s', 'x-ratelimit-reset-tokens': '1.132s', 'x-request-id': 'req_a49ac7f26714c4556d5d27f5b663fa2e', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e2ffd98940531-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:45:04,865 - DEBUG - request_id: req_a49ac7f26714c4556d5d27f5b663fa2e
2024-10-15 10:45:04,865 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWWl61i0pQ114hhAYpmLVOiXHEnp', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_9atRvM4fi25YQiJzvvH3aU8L', function=Function(arguments='{\n"buyer": "VASILESCU ELENA",\n"seller": "ISPILANTE SENTIMENT BRUSLI"\n}', name='ContractParties'), type='function')]))], created=1728978303, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=27, prompt_tokens=229, total_tokens=256, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:45:04,866 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: Yes\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 10:45:04,866 - DEBUG - max_retries: 1
2024-10-15 10:45:04,868 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: Yes\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 10:45:04,868 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:45:04,868 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:45:04,868 - DEBUG - send_request_headers.complete
2024-10-15 10:45:04,868 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:45:04,868 - DEBUG - send_request_body.complete
2024-10-15 10:45:04,868 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:45:05,974 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:45:06 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'932'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9993'), (b'x-ratelimit-remaining-tokens', b'9753'), (b'x-ratelimit-reset-requests', b'58.993s'), (b'x-ratelimit-reset-tokens', b'1.477s'), (b'x-request-id', b'req_57241428446c6bfb9b122ab7b1f69dbf'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e300a4d0c0531-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:45:05,974 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:45:05,975 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:45:05,975 - DEBUG - receive_response_body.complete
2024-10-15 10:45:05,975 - DEBUG - response_closed.started
2024-10-15 10:45:05,976 - DEBUG - response_closed.complete
2024-10-15 10:45:05,976 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:45:06 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '932', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9993', 'x-ratelimit-remaining-tokens': '9753', 'x-ratelimit-reset-requests': '58.993s', 'x-ratelimit-reset-tokens': '1.477s', 'x-request-id': 'req_57241428446c6bfb9b122ab7b1f69dbf', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e300a4d0c0531-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:45:05,976 - DEBUG - request_id: req_57241428446c6bfb9b122ab7b1f69dbf
2024-10-15 10:45:05,977 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWWnNkfXLdc2GYRU9J5kljZRGO3I', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_ATEsiBDMtLcalL0eliPmGjHI', function=Function(arguments='\n{\n"action": "determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728978305, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=12, prompt_tokens=207, total_tokens=219, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:45:19,159 - DEBUG - close.started
2024-10-15 10:45:19,160 - DEBUG - close.complete
2024-10-15 10:45:19,160 - ERROR - Task exception was never retrieved
future: <Task finished name='Task-1' coro=<agent_workflow() done, defined at D:\deve\contract_automation\src\main.py:25> exception=KeyboardInterrupt()>
Traceback (most recent call last):
  File "D:\deve\contract_automation\src\main.py", line 110, in <module>
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 30, in run
    return loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 92, in run_until_complete
    self._run_once()
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 133, in _run_once
    handle._run()
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 386, in __wakeup
    self.__step()
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 293, in __step
    self.__step_run_and_handle_result(exc)
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 304, in __step_run_and_handle_result
    result = coro.send(None)
             ^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\src\main.py", line 55, in agent_workflow
    contract_type = input("Enter contract type (airbnb, buy-sell, it-consulting): ").lower().replace(" ", "-")
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
2024-10-15 10:45:26,201 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-15 10:45:27,456 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-15 10:45:27,457 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-15 10:45:27,773 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-15 10:45:27,774 - DEBUG - Using proactor: IocpProactor
2024-10-15 10:45:27,793 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:45:27,794 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:45:27,794 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:45:27,794 - DEBUG - Compression method 0
2024-10-15 10:45:27,794 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:45:27,794 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:45:27,794 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 10:45:27,794 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 10:45:27,794 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 10:45:27,794 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 10:45:27,794 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:45:27,794 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:45:27,794 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:45:27,794 - DEBUG - Compression method 0
2024-10-15 10:45:27,794 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:45:27,794 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:45:27,794 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 10:45:27,794 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 10:45:27,794 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 10:45:27,794 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 10:45:27,803 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:45:27,803 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:45:27,803 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 10:45:27,803 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 10:45:27,804 - DEBUG - Error closing: Operation on closed image
2024-10-15 10:45:29,830 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:45:29,830 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:45:29,830 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:45:29,830 - DEBUG - Compression method 0
2024-10-15 10:45:29,830 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:45:29,830 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:45:29,830 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 10:45:29,830 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 10:45:29,830 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 10:45:29,831 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 10:45:29,831 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:45:29,831 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:45:29,831 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:45:29,831 - DEBUG - Compression method 0
2024-10-15 10:45:29,831 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:45:29,831 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:45:29,831 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 10:45:29,831 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 10:45:29,831 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 10:45:29,831 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 10:45:29,848 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:45:29,848 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:45:29,848 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 10:45:29,848 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 10:45:29,849 - DEBUG - Error closing: Operation on closed image
2024-10-15 10:45:32,344 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 0 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 10:45:32,344 - DEBUG - max_retries: 1
2024-10-15 10:45:32,346 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 0 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 10:45:32,384 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:45:32,384 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-15 10:45:32,398 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x0000023FB5D43D40>
2024-10-15 10:45:32,398 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x0000023FB5BAE750> server_hostname='api.openai.com' timeout=5.0
2024-10-15 10:45:32,406 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x0000023FB5CD6480>
2024-10-15 10:45:32,406 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:45:32,407 - DEBUG - send_request_headers.complete
2024-10-15 10:45:32,407 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:45:32,407 - DEBUG - send_request_body.complete
2024-10-15 10:45:32,407 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:45:33,408 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:45:34 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'813'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9995'), (b'x-ratelimit-remaining-tokens', b'9821'), (b'x-ratelimit-reset-requests', b'40.093s'), (b'x-ratelimit-reset-tokens', b'1.074s'), (b'x-request-id', b'req_4555b032bc832ea0cb4320468ff31929'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=Y0jiEBjPHNEUHifB2F8_W6NJZudtNS1XiPHGcHaS7aY-1728978334-1.0.1.1-GmyaNTchtcX1grDKwrBx60cHQsJ79YDAgbW7ZNzO5K8NN3IShv1VZuq3qTSCg_z84jgL5Higi4pZ8quq359ewQ; path=/; expires=Tue, 15-Oct-24 08:15:34 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=trl_jGoF1newYBUtwdxqRw6UzM5fjxFNqocwi.rqJR8-1728978334175-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e30b65f57b6a0-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:45:33,408 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:45:33,409 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:45:33,409 - DEBUG - receive_response_body.complete
2024-10-15 10:45:33,409 - DEBUG - response_closed.started
2024-10-15 10:45:33,409 - DEBUG - response_closed.complete
2024-10-15 10:45:33,409 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Tue, 15 Oct 2024 07:45:34 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-kzzh9hik9ryjiou4ftvhondh'), ('openai-processing-ms', '813'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '10000'), ('x-ratelimit-remaining-requests', '9995'), ('x-ratelimit-remaining-tokens', '9821'), ('x-ratelimit-reset-requests', '40.093s'), ('x-ratelimit-reset-tokens', '1.074s'), ('x-request-id', 'req_4555b032bc832ea0cb4320468ff31929'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=Y0jiEBjPHNEUHifB2F8_W6NJZudtNS1XiPHGcHaS7aY-1728978334-1.0.1.1-GmyaNTchtcX1grDKwrBx60cHQsJ79YDAgbW7ZNzO5K8NN3IShv1VZuq3qTSCg_z84jgL5Higi4pZ8quq359ewQ; path=/; expires=Tue, 15-Oct-24 08:15:34 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=trl_jGoF1newYBUtwdxqRw6UzM5fjxFNqocwi.rqJR8-1728978334175-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d2e30b65f57b6a0-OTP'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-15 10:45:33,409 - DEBUG - request_id: req_4555b032bc832ea0cb4320468ff31929
2024-10-15 10:45:33,411 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWXFguilGmjhcw4IRdT6rWCYcfM4', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_Ns6k8vhgwl2EZxM2ErQFOsP9', function=Function(arguments='\n{\n"action": "extract_pii"\n}', name='AgentAction'), type='function')]))], created=1728978333, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=11, prompt_tokens=207, total_tokens=218, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:45:33,412 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.PIIData'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}}
2024-10-15 10:45:33,412 - DEBUG - max_retries: 1
2024-10-15 10:45:33,413 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}, 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}]}}
2024-10-15 10:45:33,414 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:45:33,414 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:45:33,414 - DEBUG - send_request_headers.complete
2024-10-15 10:45:33,414 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:45:33,414 - DEBUG - send_request_body.complete
2024-10-15 10:45:33,414 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:45:35,977 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:45:36 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2410'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9994'), (b'x-ratelimit-remaining-tokens', b'9684'), (b'x-ratelimit-reset-requests', b'47.732s'), (b'x-ratelimit-reset-tokens', b'1.891s'), (b'x-request-id', b'req_b162b8fa20d29208894085dd2eea7c71'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e30bcadd8b6a0-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:45:35,978 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:45:35,978 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:45:35,978 - DEBUG - receive_response_body.complete
2024-10-15 10:45:35,979 - DEBUG - response_closed.started
2024-10-15 10:45:35,979 - DEBUG - response_closed.complete
2024-10-15 10:45:35,979 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:45:36 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '2410', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9994', 'x-ratelimit-remaining-tokens': '9684', 'x-ratelimit-reset-requests': '47.732s', 'x-ratelimit-reset-tokens': '1.891s', 'x-request-id': 'req_b162b8fa20d29208894085dd2eea7c71', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e30bcadd8b6a0-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:45:35,979 - DEBUG - request_id: req_b162b8fa20d29208894085dd2eea7c71
2024-10-15 10:45:35,981 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWXGGE5g4WHsGMcVTUSXrTLVCcnT', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_q6aELYWlz4a5r7rPIZXbiXBI', function=Function(arguments='{\n"name": "T525M ISPILANTE SENTIMENT BRUSLI",\n"address": "Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR"\n}', name='PIIData'), type='function')]))], created=1728978334, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=42, prompt_tokens=377, total_tokens=419, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:45:38,727 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.PIIData'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}}
2024-10-15 10:45:38,727 - DEBUG - max_retries: 1
2024-10-15 10:45:38,729 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}, 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}]}}
2024-10-15 10:45:38,729 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:45:38,729 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:45:38,729 - DEBUG - send_request_headers.complete
2024-10-15 10:45:38,729 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:45:38,730 - DEBUG - send_request_body.complete
2024-10-15 10:45:38,730 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:45:41,111 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:45:41 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2171'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9994'), (b'x-ratelimit-remaining-tokens', b'9742'), (b'x-ratelimit-reset-requests', b'50.997s'), (b'x-ratelimit-reset-tokens', b'1.548s'), (b'x-request-id', b'req_2861c46e059c946a52cd86c1ba1f9119'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e30ddd86ab6a0-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:45:41,111 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:45:41,111 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:45:41,112 - DEBUG - receive_response_body.complete
2024-10-15 10:45:41,112 - DEBUG - response_closed.started
2024-10-15 10:45:41,112 - DEBUG - response_closed.complete
2024-10-15 10:45:41,112 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:45:41 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '2171', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9994', 'x-ratelimit-remaining-tokens': '9742', 'x-ratelimit-reset-requests': '50.997s', 'x-ratelimit-reset-tokens': '1.548s', 'x-request-id': 'req_2861c46e059c946a52cd86c1ba1f9119', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e30ddd86ab6a0-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:45:41,112 - DEBUG - request_id: req_2861c46e059c946a52cd86c1ba1f9119
2024-10-15 10:45:41,113 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWXL4DutkgWWtJQlZXKVXEatZ5Zs', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_bI6oM6ejxn6ly8BhZSD5qvGQ', function=Function(arguments='{\n"name": "ELENA VASILESCU",\n"address": "Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B"\n}', name='PIIData'), type='function')]))], created=1728978339, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=42, prompt_tokens=380, total_tokens=422, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:45:42,794 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 10:45:42,794 - DEBUG - max_retries: 1
2024-10-15 10:45:42,796 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 10:45:42,797 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:45:42,797 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:45:42,797 - DEBUG - send_request_headers.complete
2024-10-15 10:45:42,797 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:45:42,797 - DEBUG - send_request_body.complete
2024-10-15 10:45:42,797 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:45:44,107 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:45:44 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1150'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9993'), (b'x-ratelimit-remaining-tokens', b'9821'), (b'x-ratelimit-reset-requests', b'55.631s'), (b'x-ratelimit-reset-tokens', b'1.074s'), (b'x-request-id', b'req_97f352725dfdb2d714e1dedd983a20b7'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e30f74cb4b6a0-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:45:44,108 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:45:44,108 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:45:44,109 - DEBUG - receive_response_body.complete
2024-10-15 10:45:44,109 - DEBUG - response_closed.started
2024-10-15 10:45:44,109 - DEBUG - response_closed.complete
2024-10-15 10:45:44,109 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:45:44 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1150', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9993', 'x-ratelimit-remaining-tokens': '9821', 'x-ratelimit-reset-requests': '55.631s', 'x-ratelimit-reset-tokens': '1.074s', 'x-request-id': 'req_97f352725dfdb2d714e1dedd983a20b7', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e30f74cb4b6a0-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:45:44,110 - DEBUG - request_id: req_97f352725dfdb2d714e1dedd983a20b7
2024-10-15 10:45:44,111 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWXPJB6mgOK92joLEfw5SZDawXmo', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_CUJ57VH7KV3hxsxKpN1IBkQ1', function=Function(arguments='{\n"action": "identify_parties"\n}', name='AgentAction'), type='function')]))], created=1728978343, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=10, prompt_tokens=207, total_tokens=217, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:45:44,113 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.ContractParties'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Identify the buyer and seller from the given information:\n\nName: T525M ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'properties': {'buyer': {'description': 'Name of the buyer', 'title': 'Buyer', 'type': 'string'}, 'seller': {'description': 'Name of the seller', 'title': 'Seller', 'type': 'string'}}, 'required': ['buyer', 'seller'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}}
2024-10-15 10:45:44,113 - DEBUG - max_retries: 1
2024-10-15 10:45:44,117 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Identify the buyer and seller from the given information:\n\nName: T525M ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}, 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'properties': {'buyer': {'description': 'Name of the buyer', 'title': 'Buyer', 'type': 'string'}, 'seller': {'description': 'Name of the seller', 'title': 'Seller', 'type': 'string'}}, 'required': ['buyer', 'seller'], 'type': 'object'}}}]}}
2024-10-15 10:45:44,117 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:45:44,117 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:45:44,118 - DEBUG - send_request_headers.complete
2024-10-15 10:45:44,118 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:45:44,118 - DEBUG - send_request_body.complete
2024-10-15 10:45:44,118 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:45:46,079 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:45:46 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1808'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9992'), (b'x-ratelimit-remaining-tokens', b'9819'), (b'x-ratelimit-reset-requests', b'1m2.949s'), (b'x-ratelimit-reset-tokens', b'1.08s'), (b'x-request-id', b'req_c921a6b0502344ff1990c9b13f6b1cf7'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e30ff8cffb6a0-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:45:46,080 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:45:46,080 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:45:46,081 - DEBUG - receive_response_body.complete
2024-10-15 10:45:46,081 - DEBUG - response_closed.started
2024-10-15 10:45:46,081 - DEBUG - response_closed.complete
2024-10-15 10:45:46,081 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:45:46 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1808', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9992', 'x-ratelimit-remaining-tokens': '9819', 'x-ratelimit-reset-requests': '1m2.949s', 'x-ratelimit-reset-tokens': '1.08s', 'x-request-id': 'req_c921a6b0502344ff1990c9b13f6b1cf7', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e30ff8cffb6a0-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:45:46,082 - DEBUG - request_id: req_c921a6b0502344ff1990c9b13f6b1cf7
2024-10-15 10:45:46,083 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWXRvgWXWnldL0xHW8QXf48BvwrD', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_xMVrsrPmwqUTJHX8ryHonqlq', function=Function(arguments='{\n  "buyer": "ELENA VASILESCU",\n  "seller": "T525M ISPILANTE SENTIMENT BRUSLI"\n}', name='ContractParties'), type='function')]))], created=1728978345, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=33, prompt_tokens=235, total_tokens=268, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:45:46,084 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: Yes\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 10:45:46,084 - DEBUG - max_retries: 1
2024-10-15 10:45:46,086 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: Yes\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 10:45:46,086 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:45:46,087 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:45:46,087 - DEBUG - send_request_headers.complete
2024-10-15 10:45:46,087 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:45:46,087 - DEBUG - send_request_body.complete
2024-10-15 10:45:46,087 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:45:46,979 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:45:47 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'728'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9991'), (b'x-ratelimit-remaining-tokens', b'9744'), (b'x-ratelimit-reset-requests', b'1m9.626s'), (b'x-ratelimit-reset-tokens', b'1.532s'), (b'x-request-id', b'req_7cd4e3892f1ad803f57936232b052c57'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e310bdac6b6a0-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:45:46,980 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:45:46,981 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:45:46,981 - DEBUG - receive_response_body.complete
2024-10-15 10:45:46,981 - DEBUG - response_closed.started
2024-10-15 10:45:46,981 - DEBUG - response_closed.complete
2024-10-15 10:45:46,981 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:45:47 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '728', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9991', 'x-ratelimit-remaining-tokens': '9744', 'x-ratelimit-reset-requests': '1m9.626s', 'x-ratelimit-reset-tokens': '1.532s', 'x-request-id': 'req_7cd4e3892f1ad803f57936232b052c57', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e310bdac6b6a0-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:45:46,982 - DEBUG - request_id: req_7cd4e3892f1ad803f57936232b052c57
2024-10-15 10:45:46,983 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWXTDM3o7qGNYp1gy8caAZWtBVXJ', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_VNk9jTHKRYYN9lzZngqOu3Ry', function=Function(arguments='{\n"action": "determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728978347, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=11, prompt_tokens=207, total_tokens=218, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:45:50,197 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.ContractDetails'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'For a airbnb contract, assign appropriate roles to ELENA VASILESCU and T525M ISPILANTE SENTIMENT BRUSLI. Respond with a JSON object where keys are role names and values are the assigned party names.'}], 'tools': [{'type': 'function', 'function': {'name': 'ContractDetails', 'description': 'Correctly extracted `ContractDetails` with all the required parameters with correct types', 'parameters': {'properties': {'contract_type': {'description': 'Type of contract (e.g., airbnb, buy-sell, it-consulting)', 'title': 'Contract Type', 'type': 'string'}, 'additional_info': {'additionalProperties': {'type': 'string'}, 'description': 'Additional information specific to the contract type', 'title': 'Additional Info', 'type': 'object'}}, 'required': ['additional_info', 'contract_type'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'ContractDetails'}}}
2024-10-15 10:45:50,197 - DEBUG - max_retries: 1
2024-10-15 10:45:50,199 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'For a airbnb contract, assign appropriate roles to ELENA VASILESCU and T525M ISPILANTE SENTIMENT BRUSLI. Respond with a JSON object where keys are role names and values are the assigned party names.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'ContractDetails'}}, 'tools': [{'type': 'function', 'function': {'name': 'ContractDetails', 'description': 'Correctly extracted `ContractDetails` with all the required parameters with correct types', 'parameters': {'properties': {'contract_type': {'description': 'Type of contract (e.g., airbnb, buy-sell, it-consulting)', 'title': 'Contract Type', 'type': 'string'}, 'additional_info': {'additionalProperties': {'type': 'string'}, 'description': 'Additional information specific to the contract type', 'title': 'Additional Info', 'type': 'object'}}, 'required': ['additional_info', 'contract_type'], 'type': 'object'}}}]}}
2024-10-15 10:45:50,200 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:45:50,200 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:45:50,200 - DEBUG - send_request_headers.complete
2024-10-15 10:45:50,200 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:45:50,200 - DEBUG - send_request_body.complete
2024-10-15 10:45:50,200 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:45:51,353 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:45:52 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'976'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9991'), (b'x-ratelimit-remaining-tokens', b'9843'), (b'x-ratelimit-reset-requests', b'1m14.144s'), (b'x-ratelimit-reset-tokens', b'942ms'), (b'x-request-id', b'req_ec5bde25f97a99b75249cadd62ddab44'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e31258d92b6a0-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:45:51,354 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:45:51,355 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:45:51,355 - DEBUG - receive_response_body.complete
2024-10-15 10:45:51,355 - DEBUG - response_closed.started
2024-10-15 10:45:51,355 - DEBUG - response_closed.complete
2024-10-15 10:45:51,356 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:45:52 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '976', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9991', 'x-ratelimit-remaining-tokens': '9843', 'x-ratelimit-reset-requests': '1m14.144s', 'x-ratelimit-reset-tokens': '942ms', 'x-request-id': 'req_ec5bde25f97a99b75249cadd62ddab44', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e31258d92b6a0-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:45:51,356 - DEBUG - request_id: req_ec5bde25f97a99b75249cadd62ddab44
2024-10-15 10:45:51,357 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWXXa4yhiqWJWlArJXuQDHmH6T6M', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_tZVixRt1qIHmCSLi3FFE7q9V', function=Function(arguments='{\n  "contract_type": "airbnb"\n}', name='ContractDetails'), type='function')]))], created=1728978351, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=11, prompt_tokens=204, total_tokens=215, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:45:51,358 - DEBUG - Contract type: airbnb
2024-10-15 10:45:51,358 - DEBUG - Additional info: {}
2024-10-15 10:45:51,358 - ERROR - Error in determine_contract_details: No roles assigned in the API response
2024-10-15 10:45:51,530 - DEBUG - close.started
2024-10-15 10:45:51,531 - DEBUG - close.complete
2024-10-15 10:49:35,147 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-15 10:49:36,407 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-15 10:49:36,407 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-15 10:49:36,729 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-15 10:49:36,730 - DEBUG - Using proactor: IocpProactor
2024-10-15 10:49:36,749 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:49:36,749 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:49:36,749 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:49:36,749 - DEBUG - Compression method 0
2024-10-15 10:49:36,749 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:49:36,749 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:49:36,749 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 10:49:36,749 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 10:49:36,749 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 10:49:36,749 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 10:49:36,749 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:49:36,749 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:49:36,749 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:49:36,749 - DEBUG - Compression method 0
2024-10-15 10:49:36,750 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:49:36,750 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:49:36,750 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 10:49:36,750 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 10:49:36,750 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 10:49:36,750 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 10:49:36,759 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:49:36,759 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:49:36,759 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 10:49:36,759 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 10:49:36,760 - DEBUG - Error closing: Operation on closed image
2024-10-15 10:49:38,777 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:49:38,778 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:49:38,778 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:49:38,778 - DEBUG - Compression method 0
2024-10-15 10:49:38,778 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:49:38,778 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:49:38,778 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 10:49:38,778 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 10:49:38,778 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 10:49:38,778 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 10:49:38,778 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:49:38,778 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:49:38,778 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:49:38,778 - DEBUG - Compression method 0
2024-10-15 10:49:38,778 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:49:38,778 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:49:38,778 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 10:49:38,778 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 10:49:38,778 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 10:49:38,778 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 10:49:38,795 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:49:38,795 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:49:38,795 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 10:49:38,795 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 10:49:38,796 - DEBUG - Error closing: Operation on closed image
2024-10-15 10:49:41,445 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 0 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 10:49:41,446 - DEBUG - max_retries: 1
2024-10-15 10:49:41,448 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 0 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 10:49:41,477 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:49:41,477 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-15 10:49:41,491 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x0000020F87826690>
2024-10-15 10:49:41,492 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x0000020F876FE750> server_hostname='api.openai.com' timeout=5.0
2024-10-15 10:49:41,500 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x0000020F87826630>
2024-10-15 10:49:41,500 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:49:41,500 - DEBUG - send_request_headers.complete
2024-10-15 10:49:41,500 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:49:41,500 - DEBUG - send_request_body.complete
2024-10-15 10:49:41,501 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:49:42,577 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:49:43 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'900'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'9821'), (b'x-ratelimit-reset-requests', b'8.64s'), (b'x-ratelimit-reset-tokens', b'1.074s'), (b'x-request-id', b'req_523cc31db39eab1f27b50bc244a56213'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=78Yc6SFIsxM1kmIAgt0q1v8mYp.3hMqXv_kVUMUD4tU-1728978583-1.0.1.1-.yUxElh0niecLZOn1.X.bsRtiZolbwk4xtDZdRBgrBBliricD8mpc1OAPpK9j1uuPfdUYxY9CT_rEq6Rbowxxg; path=/; expires=Tue, 15-Oct-24 08:19:43 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=Ngk1ume8d94va37RTT_rv5Ff7kcKGx0t_OkDWbdTUy8-1728978583306-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e36cafa530535-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:49:42,579 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:49:42,579 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:49:42,580 - DEBUG - receive_response_body.complete
2024-10-15 10:49:42,581 - DEBUG - response_closed.started
2024-10-15 10:49:42,581 - DEBUG - response_closed.complete
2024-10-15 10:49:42,582 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Tue, 15 Oct 2024 07:49:43 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-kzzh9hik9ryjiou4ftvhondh'), ('openai-processing-ms', '900'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '10000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '9821'), ('x-ratelimit-reset-requests', '8.64s'), ('x-ratelimit-reset-tokens', '1.074s'), ('x-request-id', 'req_523cc31db39eab1f27b50bc244a56213'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=78Yc6SFIsxM1kmIAgt0q1v8mYp.3hMqXv_kVUMUD4tU-1728978583-1.0.1.1-.yUxElh0niecLZOn1.X.bsRtiZolbwk4xtDZdRBgrBBliricD8mpc1OAPpK9j1uuPfdUYxY9CT_rEq6Rbowxxg; path=/; expires=Tue, 15-Oct-24 08:19:43 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=Ngk1ume8d94va37RTT_rv5Ff7kcKGx0t_OkDWbdTUy8-1728978583306-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d2e36cafa530535-OTP'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-15 10:49:42,582 - DEBUG - request_id: req_523cc31db39eab1f27b50bc244a56213
2024-10-15 10:49:42,590 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWbG5qI0N5MfmGbYqj5ubSYQSzNu', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_37Kza4RbPa9YN2yWiCT6SXGf', function=Function(arguments='{\n"action": "extract_pii"\n}', name='AgentAction'), type='function')]))], created=1728978582, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=10, prompt_tokens=207, total_tokens=217, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:49:42,591 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.PIIData'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}}
2024-10-15 10:49:42,591 - DEBUG - max_retries: 1
2024-10-15 10:49:42,592 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}, 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}]}}
2024-10-15 10:49:42,593 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:49:42,593 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:49:42,593 - DEBUG - send_request_headers.complete
2024-10-15 10:49:42,593 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:49:42,593 - DEBUG - send_request_body.complete
2024-10-15 10:49:42,593 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:49:44,997 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:49:45 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2246'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9998'), (b'x-ratelimit-remaining-tokens', b'9699'), (b'x-ratelimit-reset-requests', b'16.194s'), (b'x-ratelimit-reset-tokens', b'1.8s'), (b'x-request-id', b'req_85ceccd85ea65fff6c6605cef9796345'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e36d1c9110535-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:49:44,998 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:49:44,998 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:49:44,998 - DEBUG - receive_response_body.complete
2024-10-15 10:49:44,999 - DEBUG - response_closed.started
2024-10-15 10:49:44,999 - DEBUG - response_closed.complete
2024-10-15 10:49:44,999 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:49:45 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '2246', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9998', 'x-ratelimit-remaining-tokens': '9699', 'x-ratelimit-reset-requests': '16.194s', 'x-ratelimit-reset-tokens': '1.8s', 'x-request-id': 'req_85ceccd85ea65fff6c6605cef9796345', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e36d1c9110535-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:49:44,999 - DEBUG - request_id: req_85ceccd85ea65fff6c6605cef9796345
2024-10-15 10:49:45,000 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWbHgZaoPov6fCOs9PIVOjBC1X50', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_em49yDYg3PRO0eeGM4B2dqVr', function=Function(arguments='{\n  "name": "ISPILANTE SENTIMENT BRUSLI",\n  "address": "Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR"\n}', name='PIIData'), type='function')]))], created=1728978583, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=42, prompt_tokens=377, total_tokens=419, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:49:47,223 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.PIIData'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}}
2024-10-15 10:49:47,223 - DEBUG - max_retries: 1
2024-10-15 10:49:47,225 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}, 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}]}}
2024-10-15 10:49:47,226 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:49:47,226 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:49:47,226 - DEBUG - send_request_headers.complete
2024-10-15 10:49:47,226 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:49:47,226 - DEBUG - send_request_body.complete
2024-10-15 10:49:47,226 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:49:49,914 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:49:50 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2513'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9997'), (b'x-ratelimit-remaining-tokens', b'9742'), (b'x-ratelimit-reset-requests', b'20.199s'), (b'x-ratelimit-reset-tokens', b'1.548s'), (b'x-request-id', b'req_22ae90767748774ef6f6873ab79da0cf'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e36eebd840535-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:49:49,914 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:49:49,914 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:49:49,914 - DEBUG - receive_response_body.complete
2024-10-15 10:49:49,914 - DEBUG - response_closed.started
2024-10-15 10:49:49,914 - DEBUG - response_closed.complete
2024-10-15 10:49:49,914 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:49:50 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '2513', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9997', 'x-ratelimit-remaining-tokens': '9742', 'x-ratelimit-reset-requests': '20.199s', 'x-ratelimit-reset-tokens': '1.548s', 'x-request-id': 'req_22ae90767748774ef6f6873ab79da0cf', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e36eebd840535-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:49:49,914 - DEBUG - request_id: req_22ae90767748774ef6f6873ab79da0cf
2024-10-15 10:49:49,915 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWbM25Aoc0vCGfE9ZHvk8qrpt29V', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_BYcfHjrDxvt1NJGbejJJrgox', function=Function(arguments='{\n"name": "ELENA VASILESCU",\n"address": "Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3"\n}', name='PIIData'), type='function')]))], created=1728978588, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=39, prompt_tokens=380, total_tokens=419, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:49:51,159 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 10:49:51,159 - DEBUG - max_retries: 1
2024-10-15 10:49:51,162 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 10:49:51,162 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:49:51,162 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:49:51,162 - DEBUG - send_request_headers.complete
2024-10-15 10:49:51,162 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:49:51,162 - DEBUG - send_request_body.complete
2024-10-15 10:49:51,162 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:49:52,122 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:49:52 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'800'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9997'), (b'x-ratelimit-remaining-tokens', b'9821'), (b'x-ratelimit-reset-requests', b'24.898s'), (b'x-ratelimit-reset-tokens', b'1.074s'), (b'x-request-id', b'req_ee79d8ed2f8f987cc2dcfcacd4bc3f68'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e37075e0e0535-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:49:52,123 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:49:52,123 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:49:52,123 - DEBUG - receive_response_body.complete
2024-10-15 10:49:52,123 - DEBUG - response_closed.started
2024-10-15 10:49:52,123 - DEBUG - response_closed.complete
2024-10-15 10:49:52,124 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:49:52 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '800', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9997', 'x-ratelimit-remaining-tokens': '9821', 'x-ratelimit-reset-requests': '24.898s', 'x-ratelimit-reset-tokens': '1.074s', 'x-request-id': 'req_ee79d8ed2f8f987cc2dcfcacd4bc3f68', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e37075e0e0535-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:49:52,124 - DEBUG - request_id: req_ee79d8ed2f8f987cc2dcfcacd4bc3f68
2024-10-15 10:49:52,124 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWbQeQ9VvIz4idfIUGPtQ3TS48Mx', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_Ljzg8ZvjC0LwGHtTXjr98tzT', function=Function(arguments='\n{\n  "action": "identify_parties"\n}', name='AgentAction'), type='function')]))], created=1728978592, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=12, prompt_tokens=207, total_tokens=219, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:49:52,126 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.ContractParties'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Identify the buyer and seller from the given information:\n\nName: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3'}], 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'properties': {'buyer': {'description': 'Name of the buyer', 'title': 'Buyer', 'type': 'string'}, 'seller': {'description': 'Name of the seller', 'title': 'Seller', 'type': 'string'}}, 'required': ['buyer', 'seller'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}}
2024-10-15 10:49:52,126 - DEBUG - max_retries: 1
2024-10-15 10:49:52,127 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Identify the buyer and seller from the given information:\n\nName: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}, 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'properties': {'buyer': {'description': 'Name of the buyer', 'title': 'Buyer', 'type': 'string'}, 'seller': {'description': 'Name of the seller', 'title': 'Seller', 'type': 'string'}}, 'required': ['buyer', 'seller'], 'type': 'object'}}}]}}
2024-10-15 10:49:52,128 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:49:52,128 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:49:52,128 - DEBUG - send_request_headers.complete
2024-10-15 10:49:52,128 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:49:52,128 - DEBUG - send_request_body.complete
2024-10-15 10:49:52,128 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:49:53,867 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:49:54 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1571'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9996'), (b'x-ratelimit-remaining-tokens', b'9775'), (b'x-ratelimit-reset-requests', b'32.581s'), (b'x-ratelimit-reset-tokens', b'1.347s'), (b'x-request-id', b'req_961a8bd4a1e69cf26393984ee81ba233'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e370d5bea0535-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:49:53,868 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:49:53,868 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:49:53,868 - DEBUG - receive_response_body.complete
2024-10-15 10:49:53,869 - DEBUG - response_closed.started
2024-10-15 10:49:53,869 - DEBUG - response_closed.complete
2024-10-15 10:49:53,869 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:49:54 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1571', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9996', 'x-ratelimit-remaining-tokens': '9775', 'x-ratelimit-reset-requests': '32.581s', 'x-ratelimit-reset-tokens': '1.347s', 'x-request-id': 'req_961a8bd4a1e69cf26393984ee81ba233', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e370d5bea0535-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:49:53,869 - DEBUG - request_id: req_961a8bd4a1e69cf26393984ee81ba233
2024-10-15 10:49:53,870 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWbRdgSnUDCSQZo3AmFa98B8Ax6o', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_1OgsOJ9mPUESBjUQ6Eazqxal', function=Function(arguments='{\n"buyer": "ISPILANTE SENTIMENT BRUSLI",\n"seller": "ELENA VASILESCU"\n}', name='ContractParties'), type='function')]))], created=1728978593, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=28, prompt_tokens=229, total_tokens=257, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:49:53,874 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: Yes\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 10:49:53,874 - DEBUG - max_retries: 1
2024-10-15 10:49:53,880 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: Yes\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 10:49:53,881 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:49:53,881 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:49:53,881 - DEBUG - send_request_headers.complete
2024-10-15 10:49:53,881 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:49:53,881 - DEBUG - send_request_body.complete
2024-10-15 10:49:53,881 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:49:54,919 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:49:55 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'887'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9995'), (b'x-ratelimit-remaining-tokens', b'9754'), (b'x-ratelimit-reset-requests', b'39.47s'), (b'x-ratelimit-reset-tokens', b'1.472s'), (b'x-request-id', b'req_eb289be00216df39171f1ff67010fb3d'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e37185f200535-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:49:54,919 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:49:54,920 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:49:54,920 - DEBUG - receive_response_body.complete
2024-10-15 10:49:54,920 - DEBUG - response_closed.started
2024-10-15 10:49:54,920 - DEBUG - response_closed.complete
2024-10-15 10:49:54,920 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:49:55 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '887', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9995', 'x-ratelimit-remaining-tokens': '9754', 'x-ratelimit-reset-requests': '39.47s', 'x-ratelimit-reset-tokens': '1.472s', 'x-request-id': 'req_eb289be00216df39171f1ff67010fb3d', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e37185f200535-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:49:54,920 - DEBUG - request_id: req_eb289be00216df39171f1ff67010fb3d
2024-10-15 10:49:54,920 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWbSKmfaGAFX6uEYJFhaK0V2wUzG', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_tk8Ql7vSv4u9PcEteJfid2Tt', function=Function(arguments='{\n"action": "determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728978594, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=11, prompt_tokens=207, total_tokens=218, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:49:57,732 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.ContractDetails'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Assign roles: 'host' and 'guest'. Participants: ISPILANTE SENTIMENT BRUSLI (buyer) and ELENA VASILESCU (seller)."}], 'tools': [{'type': 'function', 'function': {'name': 'ContractDetails', 'description': 'Correctly extracted `ContractDetails` with all the required parameters with correct types', 'parameters': {'properties': {'contract_type': {'description': 'Type of contract (e.g., airbnb, buy-sell, it-consulting)', 'title': 'Contract Type', 'type': 'string'}, 'additional_info': {'additionalProperties': {'type': 'string'}, 'description': 'Additional information specific to the contract type', 'title': 'Additional Info', 'type': 'object'}}, 'required': ['additional_info', 'contract_type'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'ContractDetails'}}}
2024-10-15 10:49:57,732 - DEBUG - max_retries: 1
2024-10-15 10:49:57,734 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Assign roles: 'host' and 'guest'. Participants: ISPILANTE SENTIMENT BRUSLI (buyer) and ELENA VASILESCU (seller)."}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'ContractDetails'}}, 'tools': [{'type': 'function', 'function': {'name': 'ContractDetails', 'description': 'Correctly extracted `ContractDetails` with all the required parameters with correct types', 'parameters': {'properties': {'contract_type': {'description': 'Type of contract (e.g., airbnb, buy-sell, it-consulting)', 'title': 'Contract Type', 'type': 'string'}, 'additional_info': {'additionalProperties': {'type': 'string'}, 'description': 'Additional information specific to the contract type', 'title': 'Additional Info', 'type': 'object'}}, 'required': ['additional_info', 'contract_type'], 'type': 'object'}}}]}}
2024-10-15 10:49:57,734 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:49:57,735 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:49:57,735 - DEBUG - send_request_headers.complete
2024-10-15 10:49:57,735 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:49:57,735 - DEBUG - send_request_body.complete
2024-10-15 10:49:57,735 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:49:58,762 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:49:59 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'875'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9994'), (b'x-ratelimit-remaining-tokens', b'9864'), (b'x-ratelimit-reset-requests', b'44.253s'), (b'x-ratelimit-reset-tokens', b'816ms'), (b'x-request-id', b'req_59cbd722412aba76abcf38d284de9c2c'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e37306ffb0535-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:49:58,763 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:49:58,763 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:49:58,763 - DEBUG - receive_response_body.complete
2024-10-15 10:49:58,764 - DEBUG - response_closed.started
2024-10-15 10:49:58,764 - DEBUG - response_closed.complete
2024-10-15 10:49:58,764 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:49:59 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '875', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9994', 'x-ratelimit-remaining-tokens': '9864', 'x-ratelimit-reset-requests': '44.253s', 'x-ratelimit-reset-tokens': '816ms', 'x-request-id': 'req_59cbd722412aba76abcf38d284de9c2c', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e37306ffb0535-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:49:58,764 - DEBUG - request_id: req_59cbd722412aba76abcf38d284de9c2c
2024-10-15 10:49:58,765 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWbWBChghKCROIqdQzUTfwy4Vju3', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_YX5G6Dg3mtKiIcxlhjWK4jzf', function=Function(arguments='{\n"contract_type": "buy-sell"\n}', name='ContractDetails'), type='function')]))], created=1728978598, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=11, prompt_tokens=190, total_tokens=201, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:49:58,765 - ERROR - Error in determine_contract_details: No roles assigned in the API response
2024-10-15 10:49:58,928 - DEBUG - close.started
2024-10-15 10:49:58,929 - DEBUG - close.complete
2024-10-15 10:51:31,078 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-15 10:51:32,323 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-15 10:51:32,324 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-15 10:51:32,647 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-15 10:51:32,648 - DEBUG - Using proactor: IocpProactor
2024-10-15 10:51:32,666 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:51:32,666 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:51:32,666 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:51:32,666 - DEBUG - Compression method 0
2024-10-15 10:51:32,666 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:51:32,667 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:51:32,667 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 10:51:32,667 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 10:51:32,667 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 10:51:32,667 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 10:51:32,667 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:51:32,667 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:51:32,667 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:51:32,667 - DEBUG - Compression method 0
2024-10-15 10:51:32,667 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:51:32,667 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:51:32,667 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 10:51:32,667 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 10:51:32,667 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 10:51:32,667 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 10:51:32,676 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:51:32,676 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:51:32,676 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 10:51:32,676 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 10:51:32,677 - DEBUG - Error closing: Operation on closed image
2024-10-15 10:51:34,708 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:51:34,708 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:51:34,708 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:51:34,708 - DEBUG - Compression method 0
2024-10-15 10:51:34,708 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:51:34,708 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:51:34,708 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 10:51:34,708 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 10:51:34,708 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 10:51:34,708 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 10:51:34,708 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:51:34,708 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:51:34,708 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:51:34,708 - DEBUG - Compression method 0
2024-10-15 10:51:34,708 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:51:34,708 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:51:34,709 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 10:51:34,709 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 10:51:34,709 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 10:51:34,709 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 10:51:34,725 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:51:34,726 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:51:34,726 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 10:51:34,726 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 10:51:34,726 - DEBUG - Error closing: Operation on closed image
2024-10-15 10:51:37,230 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 0 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 10:51:37,231 - DEBUG - max_retries: 1
2024-10-15 10:51:37,233 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 0 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 10:51:37,265 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:51:37,266 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-15 10:51:37,295 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000002A879A93DD0>
2024-10-15 10:51:37,295 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x000002A8798FE750> server_hostname='api.openai.com' timeout=5.0
2024-10-15 10:51:37,303 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000002A879A93B30>
2024-10-15 10:51:37,303 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:51:37,303 - DEBUG - send_request_headers.complete
2024-10-15 10:51:37,303 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:51:37,303 - DEBUG - send_request_body.complete
2024-10-15 10:51:37,303 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:51:38,210 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:51:38 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'754'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'9821'), (b'x-ratelimit-reset-requests', b'8.64s'), (b'x-ratelimit-reset-tokens', b'1.074s'), (b'x-request-id', b'req_dcdad77dbe80cee695aedfbb91bc6adb'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=0zCL8FNLhfPxja3LYGUoX1sUW_eVRjymkqvsn_GiD3c-1728978698-1.0.1.1-r2MpBiJICgNxtX2COJbhsbHJwZcXHD6MzdB3aTkXKdDbHFcWrp_PT2EkdaxOSMYo9g9aTZN1_HqoaRmaaekJfQ; path=/; expires=Tue, 15-Oct-24 08:21:38 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=d.8LDCgft3Kx7zltzkDS0aUElU4OyMceRuZUdWdSRbw-1728978698923-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e399ea987b9d1-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:51:38,211 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:51:38,211 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:51:38,212 - DEBUG - receive_response_body.complete
2024-10-15 10:51:38,212 - DEBUG - response_closed.started
2024-10-15 10:51:38,212 - DEBUG - response_closed.complete
2024-10-15 10:51:38,212 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Tue, 15 Oct 2024 07:51:38 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-kzzh9hik9ryjiou4ftvhondh'), ('openai-processing-ms', '754'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '10000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '9821'), ('x-ratelimit-reset-requests', '8.64s'), ('x-ratelimit-reset-tokens', '1.074s'), ('x-request-id', 'req_dcdad77dbe80cee695aedfbb91bc6adb'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=0zCL8FNLhfPxja3LYGUoX1sUW_eVRjymkqvsn_GiD3c-1728978698-1.0.1.1-r2MpBiJICgNxtX2COJbhsbHJwZcXHD6MzdB3aTkXKdDbHFcWrp_PT2EkdaxOSMYo9g9aTZN1_HqoaRmaaekJfQ; path=/; expires=Tue, 15-Oct-24 08:21:38 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=d.8LDCgft3Kx7zltzkDS0aUElU4OyMceRuZUdWdSRbw-1728978698923-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d2e399ea987b9d1-OTP'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-15 10:51:38,212 - DEBUG - request_id: req_dcdad77dbe80cee695aedfbb91bc6adb
2024-10-15 10:51:38,215 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWd8U98ZE7EdYWrojLcpT8cOumhz', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_7XzaqGeYiHniQ4Cf2LLuGSBo', function=Function(arguments='\n{\n"action": "extract_pii"\n}', name='AgentAction'), type='function')]))], created=1728978698, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=11, prompt_tokens=207, total_tokens=218, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:51:38,216 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.PIIData'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}}
2024-10-15 10:51:38,216 - DEBUG - max_retries: 1
2024-10-15 10:51:38,217 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}, 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}]}}
2024-10-15 10:51:38,217 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:51:38,217 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:51:38,218 - DEBUG - send_request_headers.complete
2024-10-15 10:51:38,218 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:51:38,218 - DEBUG - send_request_body.complete
2024-10-15 10:51:38,218 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:51:40,294 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:51:41 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1928'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9998'), (b'x-ratelimit-remaining-tokens', b'9670'), (b'x-ratelimit-reset-requests', b'16.366s'), (b'x-ratelimit-reset-tokens', b'1.978s'), (b'x-request-id', b'req_c0b54254b065cb0d79ab17887962bfd0'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e39a45fc6b9d1-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:51:40,294 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:51:40,294 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:51:40,294 - DEBUG - receive_response_body.complete
2024-10-15 10:51:40,295 - DEBUG - response_closed.started
2024-10-15 10:51:40,295 - DEBUG - response_closed.complete
2024-10-15 10:51:40,295 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:51:41 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1928', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9998', 'x-ratelimit-remaining-tokens': '9670', 'x-ratelimit-reset-requests': '16.366s', 'x-ratelimit-reset-tokens': '1.978s', 'x-request-id': 'req_c0b54254b065cb0d79ab17887962bfd0', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e39a45fc6b9d1-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:51:40,295 - DEBUG - request_id: req_c0b54254b065cb0d79ab17887962bfd0
2024-10-15 10:51:40,295 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWd9GWEvd4XIQxotBcYgnWGzZ84V', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_4PwJhmfWmqAmLROrKUIvtMxc', function=Function(arguments='{\n"name": "ISPILANTE SENTIMENT BRUSLI",\n"address": "Videle Jud: Teleorman Sos. Giurgiului nr.1"\n}', name='PIIData'), type='function')]))], created=1728978699, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=36, prompt_tokens=377, total_tokens=413, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:51:43,661 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.PIIData'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}}
2024-10-15 10:51:43,661 - DEBUG - max_retries: 1
2024-10-15 10:51:43,664 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}, 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}]}}
2024-10-15 10:51:43,664 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:51:43,664 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:51:43,665 - DEBUG - send_request_headers.complete
2024-10-15 10:51:43,665 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:51:43,665 - DEBUG - send_request_body.complete
2024-10-15 10:51:43,665 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:51:46,308 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:51:47 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2485'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9997'), (b'x-ratelimit-remaining-tokens', b'9742'), (b'x-ratelimit-reset-requests', b'19.563s'), (b'x-ratelimit-reset-tokens', b'1.548s'), (b'x-request-id', b'req_176fc86b0e05e32afbee26adc766d69f'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e39c66be4b9d1-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:51:46,308 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:51:46,309 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:51:46,309 - DEBUG - receive_response_body.complete
2024-10-15 10:51:46,309 - DEBUG - response_closed.started
2024-10-15 10:51:46,309 - DEBUG - response_closed.complete
2024-10-15 10:51:46,309 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:51:47 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '2485', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9997', 'x-ratelimit-remaining-tokens': '9742', 'x-ratelimit-reset-requests': '19.563s', 'x-ratelimit-reset-tokens': '1.548s', 'x-request-id': 'req_176fc86b0e05e32afbee26adc766d69f', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e39c66be4b9d1-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:51:46,309 - DEBUG - request_id: req_176fc86b0e05e32afbee26adc766d69f
2024-10-15 10:51:46,310 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWdE0f10zrSAumkoCWx6x16Ueri7', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_jMAixBi64NbV8CKfdqQJzjBL', function=Function(arguments='{\n"name": "ELENA VASILESCU",\n"address": "Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B"\n}', name='PIIData'), type='function')]))], created=1728978704, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=42, prompt_tokens=380, total_tokens=422, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:51:47,977 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 10:51:47,977 - DEBUG - max_retries: 1
2024-10-15 10:51:47,979 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 10:51:47,980 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:51:47,980 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:51:47,980 - DEBUG - send_request_headers.complete
2024-10-15 10:51:47,980 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:51:47,981 - DEBUG - send_request_body.complete
2024-10-15 10:51:47,981 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:51:49,039 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:51:49 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'903'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9997'), (b'x-ratelimit-remaining-tokens', b'9821'), (b'x-ratelimit-reset-requests', b'23.881s'), (b'x-ratelimit-reset-tokens', b'1.074s'), (b'x-request-id', b'req_2a28c469a57972f8fecf0fde5d14fa31'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e39e1586fb9d1-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:51:49,040 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:51:49,040 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:51:49,040 - DEBUG - receive_response_body.complete
2024-10-15 10:51:49,040 - DEBUG - response_closed.started
2024-10-15 10:51:49,040 - DEBUG - response_closed.complete
2024-10-15 10:51:49,040 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:51:49 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '903', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9997', 'x-ratelimit-remaining-tokens': '9821', 'x-ratelimit-reset-requests': '23.881s', 'x-ratelimit-reset-tokens': '1.074s', 'x-request-id': 'req_2a28c469a57972f8fecf0fde5d14fa31', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e39e1586fb9d1-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:51:49,040 - DEBUG - request_id: req_2a28c469a57972f8fecf0fde5d14fa31
2024-10-15 10:51:49,040 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWdI6rhwsJruJ06xSHpZFCtAhbF7', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_CTCwraJvWOnaPB21yIK4QdwN', function=Function(arguments='\n{\n  "action": "identify_parties"\n}', name='AgentAction'), type='function')]))], created=1728978708, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=12, prompt_tokens=207, total_tokens=219, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:51:49,041 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.ContractParties'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Identify the buyer and seller from the given information:\n\nName: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'properties': {'buyer': {'description': 'Name of the buyer', 'title': 'Buyer', 'type': 'string'}, 'seller': {'description': 'Name of the seller', 'title': 'Seller', 'type': 'string'}}, 'required': ['buyer', 'seller'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}}
2024-10-15 10:51:49,041 - DEBUG - max_retries: 1
2024-10-15 10:51:49,042 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Identify the buyer and seller from the given information:\n\nName: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}, 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'properties': {'buyer': {'description': 'Name of the buyer', 'title': 'Buyer', 'type': 'string'}, 'seller': {'description': 'Name of the seller', 'title': 'Seller', 'type': 'string'}}, 'required': ['buyer', 'seller'], 'type': 'object'}}}]}}
2024-10-15 10:51:49,043 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:51:49,043 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:51:49,043 - DEBUG - send_request_headers.complete
2024-10-15 10:51:49,043 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:51:49,043 - DEBUG - send_request_body.complete
2024-10-15 10:51:49,043 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:51:51,154 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:51:51 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1907'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9996'), (b'x-ratelimit-remaining-tokens', b'9794'), (b'x-ratelimit-reset-requests', b'31.454s'), (b'x-ratelimit-reset-tokens', b'1.231s'), (b'x-request-id', b'req_bf76e06290071d556be3627cdd613307'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e39e7ff83b9d1-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:51:51,155 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:51:51,155 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:51:51,155 - DEBUG - receive_response_body.complete
2024-10-15 10:51:51,156 - DEBUG - response_closed.started
2024-10-15 10:51:51,156 - DEBUG - response_closed.complete
2024-10-15 10:51:51,156 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:51:51 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1907', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9996', 'x-ratelimit-remaining-tokens': '9794', 'x-ratelimit-reset-requests': '31.454s', 'x-ratelimit-reset-tokens': '1.231s', 'x-request-id': 'req_bf76e06290071d556be3627cdd613307', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e39e7ff83b9d1-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:51:51,156 - DEBUG - request_id: req_bf76e06290071d556be3627cdd613307
2024-10-15 10:51:51,157 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWdJkFAWn8svvWwda26raKfrddde', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_3scFQY9fdl1o3uDq2UKAFREf', function=Function(arguments='{\n"buyer": "ISPILANTE SENTIMENT BRUSLI",\n"seller": "ELENA VASILESCU"\n}', name='ContractParties'), type='function')]))], created=1728978709, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=28, prompt_tokens=229, total_tokens=257, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:51:51,160 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: Yes\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 10:51:51,160 - DEBUG - max_retries: 1
2024-10-15 10:51:51,163 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: Yes\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 10:51:51,164 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:51:51,164 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:51:51,164 - DEBUG - send_request_headers.complete
2024-10-15 10:51:51,164 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:51:51,165 - DEBUG - send_request_body.complete
2024-10-15 10:51:51,165 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:51:52,430 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:51:53 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1109'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9995'), (b'x-ratelimit-remaining-tokens', b'9760'), (b'x-ratelimit-reset-requests', b'37.978s'), (b'x-ratelimit-reset-tokens', b'1.436s'), (b'x-request-id', b'req_b95cfcda4114083415c01b90c49c1f49'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e39f53e89b9d1-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:51:52,430 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:51:52,430 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:51:52,430 - DEBUG - receive_response_body.complete
2024-10-15 10:51:52,430 - DEBUG - response_closed.started
2024-10-15 10:51:52,430 - DEBUG - response_closed.complete
2024-10-15 10:51:52,431 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:51:53 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1109', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9995', 'x-ratelimit-remaining-tokens': '9760', 'x-ratelimit-reset-requests': '37.978s', 'x-ratelimit-reset-tokens': '1.436s', 'x-request-id': 'req_b95cfcda4114083415c01b90c49c1f49', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e39f53e89b9d1-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:51:52,431 - DEBUG - request_id: req_b95cfcda4114083415c01b90c49c1f49
2024-10-15 10:51:52,431 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWdMXQc2r9qVk5d7C1hs00OUQiQF', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_6FqIcILUjrBOy8tSs4nbvfAp', function=Function(arguments='\n{\n"action": "determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728978712, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=12, prompt_tokens=207, total_tokens=219, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:51:55,363 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.ContractDetails'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Assign roles: 'host' and 'guest'. Participants: ISPILANTE SENTIMENT BRUSLI (buyer) and ELENA VASILESCU (seller)."}], 'tools': [{'type': 'function', 'function': {'name': 'ContractDetails', 'description': 'Correctly extracted `ContractDetails` with all the required parameters with correct types', 'parameters': {'properties': {'contract_type': {'description': 'Type of contract (e.g., airbnb, buy-sell, it-consulting)', 'title': 'Contract Type', 'type': 'string'}, 'additional_info': {'additionalProperties': {'type': 'string'}, 'description': 'Additional information specific to the contract type', 'title': 'Additional Info', 'type': 'object'}}, 'required': ['additional_info', 'contract_type'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'ContractDetails'}}}
2024-10-15 10:51:55,363 - DEBUG - max_retries: 1
2024-10-15 10:51:55,365 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Assign roles: 'host' and 'guest'. Participants: ISPILANTE SENTIMENT BRUSLI (buyer) and ELENA VASILESCU (seller)."}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'ContractDetails'}}, 'tools': [{'type': 'function', 'function': {'name': 'ContractDetails', 'description': 'Correctly extracted `ContractDetails` with all the required parameters with correct types', 'parameters': {'properties': {'contract_type': {'description': 'Type of contract (e.g., airbnb, buy-sell, it-consulting)', 'title': 'Contract Type', 'type': 'string'}, 'additional_info': {'additionalProperties': {'type': 'string'}, 'description': 'Additional information specific to the contract type', 'title': 'Additional Info', 'type': 'object'}}, 'required': ['additional_info', 'contract_type'], 'type': 'object'}}}]}}
2024-10-15 10:51:55,366 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:51:55,366 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:51:55,366 - DEBUG - send_request_headers.complete
2024-10-15 10:51:55,366 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:51:55,367 - DEBUG - send_request_body.complete
2024-10-15 10:51:55,367 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:51:56,413 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:51:57 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'882'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9995'), (b'x-ratelimit-remaining-tokens', b'9864'), (b'x-ratelimit-reset-requests', b'42.428s'), (b'x-ratelimit-reset-tokens', b'816ms'), (b'x-request-id', b'req_c78016c4d4e8c647194a5b7bf08aa836'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e3a0f8d7cb9d1-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:51:56,413 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:51:56,413 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:51:56,413 - DEBUG - receive_response_body.complete
2024-10-15 10:51:56,413 - DEBUG - response_closed.started
2024-10-15 10:51:56,413 - DEBUG - response_closed.complete
2024-10-15 10:51:56,413 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:51:57 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '882', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9995', 'x-ratelimit-remaining-tokens': '9864', 'x-ratelimit-reset-requests': '42.428s', 'x-ratelimit-reset-tokens': '816ms', 'x-request-id': 'req_c78016c4d4e8c647194a5b7bf08aa836', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e3a0f8d7cb9d1-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:51:56,413 - DEBUG - request_id: req_c78016c4d4e8c647194a5b7bf08aa836
2024-10-15 10:51:56,414 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWdQYF0e6Oj7ul9ZbB4xeaWYNhaY', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_8LriBKQJxZjiYCDyV8QBdLv0', function=Function(arguments='{\n"contract_type": "buy-sell"\n}', name='ContractDetails'), type='function')]))], created=1728978716, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=11, prompt_tokens=190, total_tokens=201, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:51:56,414 - ERROR - Error in determine_contract_details: No roles assigned in the API response
2024-10-15 10:51:56,564 - DEBUG - close.started
2024-10-15 10:51:56,564 - DEBUG - close.complete
2024-10-15 10:52:43,775 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-15 10:52:45,013 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-15 10:52:45,013 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-15 10:52:45,330 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-15 10:52:45,331 - DEBUG - Using proactor: IocpProactor
2024-10-15 10:52:45,350 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:52:45,350 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:52:45,350 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:52:45,350 - DEBUG - Compression method 0
2024-10-15 10:52:45,350 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:52:45,350 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:52:45,350 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 10:52:45,350 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 10:52:45,350 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 10:52:45,350 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 10:52:45,350 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:52:45,350 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:52:45,350 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:52:45,350 - DEBUG - Compression method 0
2024-10-15 10:52:45,350 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:52:45,350 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:52:45,350 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 10:52:45,350 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 10:52:45,350 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 10:52:45,350 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 10:52:45,360 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:52:45,360 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:52:45,360 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 10:52:45,360 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 10:52:45,361 - DEBUG - Error closing: Operation on closed image
2024-10-15 10:52:47,379 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:52:47,379 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:52:47,379 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:52:47,379 - DEBUG - Compression method 0
2024-10-15 10:52:47,379 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:52:47,379 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:52:47,379 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 10:52:47,379 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 10:52:47,379 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 10:52:47,380 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 10:52:47,380 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:52:47,380 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:52:47,380 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:52:47,380 - DEBUG - Compression method 0
2024-10-15 10:52:47,380 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:52:47,380 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:52:47,380 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 10:52:47,380 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 10:52:47,380 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 10:52:47,380 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 10:52:47,397 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:52:47,397 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:52:47,397 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 10:52:47,397 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 10:52:47,398 - DEBUG - Error closing: Operation on closed image
2024-10-15 10:52:49,923 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 0 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 10:52:49,923 - DEBUG - max_retries: 1
2024-10-15 10:52:49,925 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 0 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 10:52:49,962 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:52:49,962 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-15 10:52:49,973 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000002BF40A66690>
2024-10-15 10:52:49,973 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x000002BF4093E750> server_hostname='api.openai.com' timeout=5.0
2024-10-15 10:52:49,983 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000002BF40AD3AA0>
2024-10-15 10:52:49,983 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:52:49,983 - DEBUG - send_request_headers.complete
2024-10-15 10:52:49,983 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:52:49,983 - DEBUG - send_request_body.complete
2024-10-15 10:52:49,983 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:52:51,613 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:52:52 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1476'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'9821'), (b'x-ratelimit-reset-requests', b'8.64s'), (b'x-ratelimit-reset-tokens', b'1.074s'), (b'x-request-id', b'req_259507c030d23aa4d440c250d01e86b2'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=sxTyaL7rh_wfuW0knhZR4YNuTBmMSlL6dQ36t9bMJxc-1728978772-1.0.1.1-141cFOTNfLshT_yuqEqnzWFlFalyiSWtAo2ahas9vL4Zs4v46.2RGiG.FMeP3JsVz0r.ywGJiqt2ytkuLkPf2w; path=/; expires=Tue, 15-Oct-24 08:22:52 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=w3SrbeZnyC2TI5AhaXDJMrLegaeWPX0OHnQDVo9kHP4-1728978772314-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e3b64ccae6244-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:52:51,615 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:52:51,616 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:52:51,616 - DEBUG - receive_response_body.complete
2024-10-15 10:52:51,617 - DEBUG - response_closed.started
2024-10-15 10:52:51,617 - DEBUG - response_closed.complete
2024-10-15 10:52:51,617 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Tue, 15 Oct 2024 07:52:52 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-kzzh9hik9ryjiou4ftvhondh'), ('openai-processing-ms', '1476'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '10000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '9821'), ('x-ratelimit-reset-requests', '8.64s'), ('x-ratelimit-reset-tokens', '1.074s'), ('x-request-id', 'req_259507c030d23aa4d440c250d01e86b2'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=sxTyaL7rh_wfuW0knhZR4YNuTBmMSlL6dQ36t9bMJxc-1728978772-1.0.1.1-141cFOTNfLshT_yuqEqnzWFlFalyiSWtAo2ahas9vL4Zs4v46.2RGiG.FMeP3JsVz0r.ywGJiqt2ytkuLkPf2w; path=/; expires=Tue, 15-Oct-24 08:22:52 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=w3SrbeZnyC2TI5AhaXDJMrLegaeWPX0OHnQDVo9kHP4-1728978772314-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d2e3b64ccae6244-OTP'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-15 10:52:51,617 - DEBUG - request_id: req_259507c030d23aa4d440c250d01e86b2
2024-10-15 10:52:51,620 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWeISOd2Hj9FzPaBeD345g3kQvG9', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_Xq48ANDS5VEQdfJ89yGzPOcI', function=Function(arguments='\n{\n  "action": "extract_pii"\n}', name='AgentAction'), type='function')]))], created=1728978770, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=12, prompt_tokens=207, total_tokens=219, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:52:51,621 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.PIIData'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}}
2024-10-15 10:52:51,621 - DEBUG - max_retries: 1
2024-10-15 10:52:51,623 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}, 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}]}}
2024-10-15 10:52:51,623 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:52:51,623 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:52:51,623 - DEBUG - send_request_headers.complete
2024-10-15 10:52:51,623 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:52:51,623 - DEBUG - send_request_body.complete
2024-10-15 10:52:51,623 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:52:54,254 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:52:54 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2478'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9998'), (b'x-ratelimit-remaining-tokens', b'9721'), (b'x-ratelimit-reset-requests', b'15.642s'), (b'x-ratelimit-reset-tokens', b'1.673s'), (b'x-request-id', b'req_28f9742388863cf2e77609fe83690585'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e3b6f0b826244-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:52:54,255 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:52:54,255 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:52:54,255 - DEBUG - receive_response_body.complete
2024-10-15 10:52:54,255 - DEBUG - response_closed.started
2024-10-15 10:52:54,255 - DEBUG - response_closed.complete
2024-10-15 10:52:54,256 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:52:54 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '2478', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9998', 'x-ratelimit-remaining-tokens': '9721', 'x-ratelimit-reset-requests': '15.642s', 'x-ratelimit-reset-tokens': '1.673s', 'x-request-id': 'req_28f9742388863cf2e77609fe83690585', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e3b6f0b826244-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:52:54,256 - DEBUG - request_id: req_28f9742388863cf2e77609fe83690585
2024-10-15 10:52:54,256 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWeKfOHrq6VcdrBb2EILUEbwsv3H', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_thcZjSoeKOzP8iBzmCF6mBj0', function=Function(arguments='{\n"name": "ISPILANTE SENTIMENT BRUSLI",\n"address": "Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR"\n}', name='PIIData'), type='function')]))], created=1728978772, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=39, prompt_tokens=377, total_tokens=416, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:53:15,408 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.PIIData'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}}
2024-10-15 10:53:15,409 - DEBUG - max_retries: 1
2024-10-15 10:53:15,412 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}, 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}]}}
2024-10-15 10:53:15,413 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:53:15,413 - DEBUG - close.started
2024-10-15 10:53:15,413 - DEBUG - close.complete
2024-10-15 10:53:15,413 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-15 10:53:15,418 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000002BF40B0FE30>
2024-10-15 10:53:15,418 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x000002BF4093E750> server_hostname='api.openai.com' timeout=5.0
2024-10-15 10:53:15,424 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000002BF40B0E0C0>
2024-10-15 10:53:15,424 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:53:15,425 - DEBUG - send_request_headers.complete
2024-10-15 10:53:15,425 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:53:15,425 - DEBUG - send_request_body.complete
2024-10-15 10:53:15,425 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:53:18,004 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:53:18 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2422'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'9742'), (b'x-ratelimit-reset-requests', b'8.64s'), (b'x-ratelimit-reset-tokens', b'1.548s'), (b'x-request-id', b'req_1167b206bf08321571e70895ad6a69d3'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e3c03c927c9c8-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:53:18,004 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:53:18,004 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:53:18,004 - DEBUG - receive_response_body.complete
2024-10-15 10:53:18,004 - DEBUG - response_closed.started
2024-10-15 10:53:18,004 - DEBUG - response_closed.complete
2024-10-15 10:53:18,004 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:53:18 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '2422', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9999', 'x-ratelimit-remaining-tokens': '9742', 'x-ratelimit-reset-requests': '8.64s', 'x-ratelimit-reset-tokens': '1.548s', 'x-request-id': 'req_1167b206bf08321571e70895ad6a69d3', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e3c03c927c9c8-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:53:18,005 - DEBUG - request_id: req_1167b206bf08321571e70895ad6a69d3
2024-10-15 10:53:18,005 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWeiRkG5LNUEZWnJc4cp07NyhKcv', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_WCLibUh0Bq08K1ZhqVgoiLbV', function=Function(arguments='{\n"name": "ELENA VASILESCU",\n"address": "Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B"\n}', name='PIIData'), type='function')]))], created=1728978796, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=42, prompt_tokens=380, total_tokens=422, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:53:19,005 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 10:53:19,005 - DEBUG - max_retries: 1
2024-10-15 10:53:19,006 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 10:53:19,007 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:53:19,007 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:53:19,007 - DEBUG - send_request_headers.complete
2024-10-15 10:53:19,007 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:53:19,007 - DEBUG - send_request_body.complete
2024-10-15 10:53:19,007 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:53:20,487 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:53:21 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1319'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9998'), (b'x-ratelimit-remaining-tokens', b'9821'), (b'x-ratelimit-reset-requests', b'13.703s'), (b'x-ratelimit-reset-tokens', b'1.074s'), (b'x-request-id', b'req_3b1808ed972f469ddbf9058933cc2012'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e3c1a2827c9c8-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:53:20,488 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:53:20,488 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:53:20,488 - DEBUG - receive_response_body.complete
2024-10-15 10:53:20,488 - DEBUG - response_closed.started
2024-10-15 10:53:20,488 - DEBUG - response_closed.complete
2024-10-15 10:53:20,489 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:53:21 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1319', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9998', 'x-ratelimit-remaining-tokens': '9821', 'x-ratelimit-reset-requests': '13.703s', 'x-ratelimit-reset-tokens': '1.074s', 'x-request-id': 'req_3b1808ed972f469ddbf9058933cc2012', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e3c1a2827c9c8-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:53:20,489 - DEBUG - request_id: req_3b1808ed972f469ddbf9058933cc2012
2024-10-15 10:53:20,489 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWelgWY2bXThQC9KR5Vb1kGXDdme', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_t23Om7pq57pFlRyDSyOvg1uq', function=Function(arguments='\n{\n  "action": "identify_parties"\n}', name='AgentAction'), type='function')]))], created=1728978799, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=12, prompt_tokens=207, total_tokens=219, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:53:20,491 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.ContractParties'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Identify the buyer and seller from the given information:\n\nName: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'properties': {'buyer': {'description': 'Name of the buyer', 'title': 'Buyer', 'type': 'string'}, 'seller': {'description': 'Name of the seller', 'title': 'Seller', 'type': 'string'}}, 'required': ['buyer', 'seller'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}}
2024-10-15 10:53:20,491 - DEBUG - max_retries: 1
2024-10-15 10:53:20,493 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Identify the buyer and seller from the given information:\n\nName: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}, 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'properties': {'buyer': {'description': 'Name of the buyer', 'title': 'Buyer', 'type': 'string'}, 'seller': {'description': 'Name of the seller', 'title': 'Seller', 'type': 'string'}}, 'required': ['buyer', 'seller'], 'type': 'object'}}}]}}
2024-10-15 10:53:20,494 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:53:20,494 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:53:20,495 - DEBUG - send_request_headers.complete
2024-10-15 10:53:20,495 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:53:20,495 - DEBUG - send_request_body.complete
2024-10-15 10:53:20,495 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:53:22,579 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:53:23 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1935'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9997'), (b'x-ratelimit-remaining-tokens', b'9818'), (b'x-ratelimit-reset-requests', b'20.855s'), (b'x-ratelimit-reset-tokens', b'1.09s'), (b'x-request-id', b'req_fe7f379ad109a89f24d0ef5c687fb397'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e3c237996c9c8-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:53:22,580 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:53:22,580 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:53:22,580 - DEBUG - receive_response_body.complete
2024-10-15 10:53:22,581 - DEBUG - response_closed.started
2024-10-15 10:53:22,581 - DEBUG - response_closed.complete
2024-10-15 10:53:22,581 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:53:23 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1935', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9997', 'x-ratelimit-remaining-tokens': '9818', 'x-ratelimit-reset-requests': '20.855s', 'x-ratelimit-reset-tokens': '1.09s', 'x-request-id': 'req_fe7f379ad109a89f24d0ef5c687fb397', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e3c237996c9c8-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:53:22,581 - DEBUG - request_id: req_fe7f379ad109a89f24d0ef5c687fb397
2024-10-15 10:53:22,582 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWen49WWNzxFIL0aj5QhxNin5lIG', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_cJTDt1jUQQSVTZlX1n03XNZU', function=Function(arguments='{\n"buyer": "ISPILANTE SENTIMENT BRUSLI",\n"seller": "ELENA VASILESCU"\n}', name='ContractParties'), type='function')]))], created=1728978801, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=28, prompt_tokens=232, total_tokens=260, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:53:22,585 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: Yes\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 10:53:22,585 - DEBUG - max_retries: 1
2024-10-15 10:53:22,587 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: Yes\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 10:53:22,588 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:53:22,588 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:53:22,588 - DEBUG - send_request_headers.complete
2024-10-15 10:53:22,589 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:53:22,589 - DEBUG - send_request_body.complete
2024-10-15 10:53:22,589 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:53:23,732 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:53:24 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'978'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9996'), (b'x-ratelimit-remaining-tokens', b'9751'), (b'x-ratelimit-reset-requests', b'27.405s'), (b'x-ratelimit-reset-tokens', b'1.493s'), (b'x-request-id', b'req_14ad8e05fd4e71ba4886c35ba888ba03'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e3c308ccec9c8-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:53:23,733 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:53:23,734 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:53:23,734 - DEBUG - receive_response_body.complete
2024-10-15 10:53:23,734 - DEBUG - response_closed.started
2024-10-15 10:53:23,734 - DEBUG - response_closed.complete
2024-10-15 10:53:23,735 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:53:24 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '978', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9996', 'x-ratelimit-remaining-tokens': '9751', 'x-ratelimit-reset-requests': '27.405s', 'x-ratelimit-reset-tokens': '1.493s', 'x-request-id': 'req_14ad8e05fd4e71ba4886c35ba888ba03', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e3c308ccec9c8-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:53:23,735 - DEBUG - request_id: req_14ad8e05fd4e71ba4886c35ba888ba03
2024-10-15 10:53:23,736 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWepZX69vDR7s2f3szz00F3i25TT', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_5MnlrkCDFEdWwKG8HjhhqRN0', function=Function(arguments='\n{\n  "action": "determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728978803, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=13, prompt_tokens=207, total_tokens=220, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:54:29,487 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.ContractDetails'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Assign roles: 'host' and 'guest'. Participants: ISPILANTE SENTIMENT BRUSLI (buyer) and ELENA VASILESCU (seller)."}], 'tools': [{'type': 'function', 'function': {'name': 'ContractDetails', 'description': 'Correctly extracted `ContractDetails` with all the required parameters with correct types', 'parameters': {'properties': {'contract_type': {'description': 'Type of contract (e.g., airbnb, buy-sell, it-consulting)', 'title': 'Contract Type', 'type': 'string'}, 'additional_info': {'additionalProperties': {'type': 'string'}, 'description': 'Additional information specific to the contract type', 'title': 'Additional Info', 'type': 'object'}}, 'required': ['additional_info', 'contract_type'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'ContractDetails'}}}
2024-10-15 10:54:29,488 - DEBUG - max_retries: 1
2024-10-15 10:54:29,490 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Assign roles: 'host' and 'guest'. Participants: ISPILANTE SENTIMENT BRUSLI (buyer) and ELENA VASILESCU (seller)."}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'ContractDetails'}}, 'tools': [{'type': 'function', 'function': {'name': 'ContractDetails', 'description': 'Correctly extracted `ContractDetails` with all the required parameters with correct types', 'parameters': {'properties': {'contract_type': {'description': 'Type of contract (e.g., airbnb, buy-sell, it-consulting)', 'title': 'Contract Type', 'type': 'string'}, 'additional_info': {'additionalProperties': {'type': 'string'}, 'description': 'Additional information specific to the contract type', 'title': 'Additional Info', 'type': 'object'}}, 'required': ['additional_info', 'contract_type'], 'type': 'object'}}}]}}
2024-10-15 10:54:29,490 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:54:29,491 - DEBUG - close.started
2024-10-15 10:54:29,491 - DEBUG - close.complete
2024-10-15 10:54:29,491 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-15 10:54:29,557 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000002BF40B0E390>
2024-10-15 10:54:29,557 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x000002BF4093E750> server_hostname='api.openai.com' timeout=5.0
2024-10-15 10:54:29,572 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000002BF40B0E120>
2024-10-15 10:54:29,572 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:54:29,573 - DEBUG - send_request_headers.complete
2024-10-15 10:54:29,573 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:54:29,573 - DEBUG - send_request_body.complete
2024-10-15 10:54:29,573 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:54:30,752 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:54:31 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1024'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'9864'), (b'x-ratelimit-reset-requests', b'8.64s'), (b'x-ratelimit-reset-tokens', b'816ms'), (b'x-request-id', b'req_d7653d03d0493a4d254248334b31ee5a'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e3dd32ec7053b-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:54:30,753 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:54:30,753 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:54:30,753 - DEBUG - receive_response_body.complete
2024-10-15 10:54:30,754 - DEBUG - response_closed.started
2024-10-15 10:54:30,754 - DEBUG - response_closed.complete
2024-10-15 10:54:30,754 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:54:31 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1024', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9999', 'x-ratelimit-remaining-tokens': '9864', 'x-ratelimit-reset-requests': '8.64s', 'x-ratelimit-reset-tokens': '816ms', 'x-request-id': 'req_d7653d03d0493a4d254248334b31ee5a', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e3dd32ec7053b-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:54:30,754 - DEBUG - request_id: req_d7653d03d0493a4d254248334b31ee5a
2024-10-15 10:54:30,755 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWfuTsTnjzoZ2TFDgMhtVpIzf1yU', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_cdjt4GzNdQ44eIuL9zYJuq5s', function=Function(arguments='{\n"contract_type": "buy-sell"\n}', name='ContractDetails'), type='function')]))], created=1728978870, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=11, prompt_tokens=190, total_tokens=201, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:54:30,757 - ERROR - Error in determine_contract_details: No roles assigned in the API response
2024-10-15 10:54:30,917 - DEBUG - close.started
2024-10-15 10:54:30,918 - DEBUG - close.complete
2024-10-15 10:54:51,573 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-15 10:54:52,826 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-15 10:54:52,827 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-15 10:54:53,145 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-15 10:54:53,146 - DEBUG - Using proactor: IocpProactor
2024-10-15 10:54:53,164 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:54:53,164 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:54:53,164 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:54:53,164 - DEBUG - Compression method 0
2024-10-15 10:54:53,164 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:54:53,164 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:54:53,164 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 10:54:53,164 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 10:54:53,164 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 10:54:53,165 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 10:54:53,165 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:54:53,165 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:54:53,165 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:54:53,165 - DEBUG - Compression method 0
2024-10-15 10:54:53,165 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:54:53,165 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:54:53,165 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 10:54:53,165 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 10:54:53,165 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 10:54:53,165 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 10:54:53,174 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:54:53,174 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:54:53,174 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 10:54:53,174 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 10:54:53,175 - DEBUG - Error closing: Operation on closed image
2024-10-15 10:54:55,253 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:54:55,253 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:54:55,253 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:54:55,253 - DEBUG - Compression method 0
2024-10-15 10:54:55,253 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:54:55,253 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:54:55,253 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 10:54:55,253 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 10:54:55,253 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 10:54:55,253 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 10:54:55,253 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:54:55,253 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:54:55,253 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:54:55,253 - DEBUG - Compression method 0
2024-10-15 10:54:55,253 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:54:55,253 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:54:55,253 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 10:54:55,253 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 10:54:55,253 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 10:54:55,253 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 10:54:55,270 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:54:55,271 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:54:55,271 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 10:54:55,271 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 10:54:55,271 - DEBUG - Error closing: Operation on closed image
2024-10-15 10:54:57,866 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 0 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 10:54:57,867 - DEBUG - max_retries: 1
2024-10-15 10:54:57,868 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 0 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 10:54:57,897 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:54:57,897 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-15 10:54:57,908 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000002377FCCFE60>
2024-10-15 10:54:57,908 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x000002377FB3E750> server_hostname='api.openai.com' timeout=5.0
2024-10-15 10:54:57,915 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000002377FC64710>
2024-10-15 10:54:57,915 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:54:57,915 - DEBUG - send_request_headers.complete
2024-10-15 10:54:57,915 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:54:57,915 - DEBUG - send_request_body.complete
2024-10-15 10:54:57,915 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:54:58,809 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:54:59 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'732'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'9821'), (b'x-ratelimit-reset-requests', b'8.64s'), (b'x-ratelimit-reset-tokens', b'1.074s'), (b'x-request-id', b'req_8635c8c68bdc0489b2d858d0a6c861a2'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=UIrjyl4l.6dQ6dd3m8k1olB7sbsitzlyvZQV03af7Pw-1728978899-1.0.1.1-jNekgFr3bsiKPayosE0zFGSRtIKPRGbyZFFdhSWRk8bqXIGqDmSYUCL6akmG0aiJCEQf34gkQ16OnWiU2_Am5Q; path=/; expires=Tue, 15-Oct-24 08:24:59 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=iL2oZ.dcCA5y1AxAOG6SJEFarJ0_cjD_6BgC9pBQleo-1728978899492-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e3e844b4cb6bb-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:54:58,811 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:54:58,811 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:54:58,811 - DEBUG - receive_response_body.complete
2024-10-15 10:54:58,811 - DEBUG - response_closed.started
2024-10-15 10:54:58,811 - DEBUG - response_closed.complete
2024-10-15 10:54:58,811 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Tue, 15 Oct 2024 07:54:59 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-kzzh9hik9ryjiou4ftvhondh'), ('openai-processing-ms', '732'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '10000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '9821'), ('x-ratelimit-reset-requests', '8.64s'), ('x-ratelimit-reset-tokens', '1.074s'), ('x-request-id', 'req_8635c8c68bdc0489b2d858d0a6c861a2'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=UIrjyl4l.6dQ6dd3m8k1olB7sbsitzlyvZQV03af7Pw-1728978899-1.0.1.1-jNekgFr3bsiKPayosE0zFGSRtIKPRGbyZFFdhSWRk8bqXIGqDmSYUCL6akmG0aiJCEQf34gkQ16OnWiU2_Am5Q; path=/; expires=Tue, 15-Oct-24 08:24:59 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=iL2oZ.dcCA5y1AxAOG6SJEFarJ0_cjD_6BgC9pBQleo-1728978899492-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d2e3e844b4cb6bb-OTP'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-15 10:54:58,811 - DEBUG - request_id: req_8635c8c68bdc0489b2d858d0a6c861a2
2024-10-15 10:54:58,814 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWgMLqTPdbFtYORFpNu7S1nx69Nk', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_4D9sVdB56ypiir151FbwMb4l', function=Function(arguments='\n{\n"action": "extract_pii"\n}', name='AgentAction'), type='function')]))], created=1728978898, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=11, prompt_tokens=207, total_tokens=218, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:54:58,815 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.PIIData'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}}
2024-10-15 10:54:58,815 - DEBUG - max_retries: 1
2024-10-15 10:54:58,817 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}, 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}]}}
2024-10-15 10:54:58,817 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:54:58,817 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:54:58,818 - DEBUG - send_request_headers.complete
2024-10-15 10:54:58,818 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:54:58,818 - DEBUG - send_request_body.complete
2024-10-15 10:54:58,818 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:55:01,090 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:55:01 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2113'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9998'), (b'x-ratelimit-remaining-tokens', b'9667'), (b'x-ratelimit-reset-requests', b'16.381s'), (b'x-ratelimit-reset-tokens', b'1.993s'), (b'x-request-id', b'req_e0d170edb1fcb8d17b952fb4c55d8185'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e3e89e91ab6bb-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:55:01,091 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:55:01,092 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:55:01,092 - DEBUG - receive_response_body.complete
2024-10-15 10:55:01,092 - DEBUG - response_closed.started
2024-10-15 10:55:01,092 - DEBUG - response_closed.complete
2024-10-15 10:55:01,093 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:55:01 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '2113', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9998', 'x-ratelimit-remaining-tokens': '9667', 'x-ratelimit-reset-requests': '16.381s', 'x-ratelimit-reset-tokens': '1.993s', 'x-request-id': 'req_e0d170edb1fcb8d17b952fb4c55d8185', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e3e89e91ab6bb-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:55:01,093 - DEBUG - request_id: req_e0d170edb1fcb8d17b952fb4c55d8185
2024-10-15 10:55:01,094 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWgN0nm2j1Z7NWfP6nGA83sT5VNM', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_gku8rrelBiOjI1P7D9VHEcLM', function=Function(arguments='{\n"name": "ISPILANTE SENTIMENT BRUSLI",\n"address": "Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR"\n}', name='PIIData'), type='function')]))], created=1728978899, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=39, prompt_tokens=377, total_tokens=416, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:55:03,054 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.PIIData'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}}
2024-10-15 10:55:03,054 - DEBUG - max_retries: 1
2024-10-15 10:55:03,056 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}, 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}]}}
2024-10-15 10:55:03,056 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:55:03,057 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:55:03,057 - DEBUG - send_request_headers.complete
2024-10-15 10:55:03,057 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:55:03,057 - DEBUG - send_request_body.complete
2024-10-15 10:55:03,057 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:55:05,461 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:55:06 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2250'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9997'), (b'x-ratelimit-remaining-tokens', b'9742'), (b'x-ratelimit-reset-requests', b'20.778s'), (b'x-ratelimit-reset-tokens', b'1.548s'), (b'x-request-id', b'req_cba751393d3a861a97c032f51e3cc1c6'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e3ea46d85b6bb-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:55:05,461 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:55:05,461 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:55:05,461 - DEBUG - receive_response_body.complete
2024-10-15 10:55:05,462 - DEBUG - response_closed.started
2024-10-15 10:55:05,462 - DEBUG - response_closed.complete
2024-10-15 10:55:05,462 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:55:06 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '2250', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9997', 'x-ratelimit-remaining-tokens': '9742', 'x-ratelimit-reset-requests': '20.778s', 'x-ratelimit-reset-tokens': '1.548s', 'x-request-id': 'req_cba751393d3a861a97c032f51e3cc1c6', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e3ea46d85b6bb-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:55:05,462 - DEBUG - request_id: req_cba751393d3a861a97c032f51e3cc1c6
2024-10-15 10:55:05,462 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWgS39ooRxkWIDTZK7r5aHHpu63o', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_xbjeSeNyUCfPasbbDWVDiH4e', function=Function(arguments='{\n"name": "ELENA VASILESCU",\n"address": "Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3"\n}', name='PIIData'), type='function')]))], created=1728978904, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=39, prompt_tokens=380, total_tokens=419, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:55:06,480 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 10:55:06,480 - DEBUG - max_retries: 1
2024-10-15 10:55:06,481 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 10:55:06,482 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:55:06,482 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:55:06,482 - DEBUG - send_request_headers.complete
2024-10-15 10:55:06,482 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:55:06,482 - DEBUG - send_request_body.complete
2024-10-15 10:55:06,482 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:55:07,682 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:55:08 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1030'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9996'), (b'x-ratelimit-remaining-tokens', b'9821'), (b'x-ratelimit-reset-requests', b'25.995s'), (b'x-ratelimit-reset-tokens', b'1.074s'), (b'x-request-id', b'req_3310b9c8e119e2c15d1920aafd5b4ddf'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e3eb9cb73b6bb-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:55:07,683 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:55:07,683 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:55:07,683 - DEBUG - receive_response_body.complete
2024-10-15 10:55:07,683 - DEBUG - response_closed.started
2024-10-15 10:55:07,683 - DEBUG - response_closed.complete
2024-10-15 10:55:07,683 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:55:08 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1030', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9996', 'x-ratelimit-remaining-tokens': '9821', 'x-ratelimit-reset-requests': '25.995s', 'x-ratelimit-reset-tokens': '1.074s', 'x-request-id': 'req_3310b9c8e119e2c15d1920aafd5b4ddf', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e3eb9cb73b6bb-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:55:07,683 - DEBUG - request_id: req_3310b9c8e119e2c15d1920aafd5b4ddf
2024-10-15 10:55:07,684 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWgV4mLZsPayV7WFLCjJsCOfXUIf', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_g3Gdfdo4ngx56v1JdyDRWsir', function=Function(arguments='{\n"action": "identify_parties"\n}', name='AgentAction'), type='function')]))], created=1728978907, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=10, prompt_tokens=207, total_tokens=217, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:55:07,684 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.ContractParties'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Identify the buyer and seller from the given information:\n\nName: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3'}], 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'properties': {'buyer': {'description': 'Name of the buyer', 'title': 'Buyer', 'type': 'string'}, 'seller': {'description': 'Name of the seller', 'title': 'Seller', 'type': 'string'}}, 'required': ['buyer', 'seller'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}}
2024-10-15 10:55:07,684 - DEBUG - max_retries: 1
2024-10-15 10:55:07,686 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Identify the buyer and seller from the given information:\n\nName: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}, 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'properties': {'buyer': {'description': 'Name of the buyer', 'title': 'Buyer', 'type': 'string'}, 'seller': {'description': 'Name of the seller', 'title': 'Seller', 'type': 'string'}}, 'required': ['buyer', 'seller'], 'type': 'object'}}}]}}
2024-10-15 10:55:07,686 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:55:07,686 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:55:07,687 - DEBUG - send_request_headers.complete
2024-10-15 10:55:07,687 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:55:07,687 - DEBUG - send_request_body.complete
2024-10-15 10:55:07,687 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:55:09,771 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:55:10 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1930'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9996'), (b'x-ratelimit-remaining-tokens', b'9817'), (b'x-ratelimit-reset-requests', b'33.439s'), (b'x-ratelimit-reset-tokens', b'1.095s'), (b'x-request-id', b'req_fddbe87d27b22c16fb12d8488fa4af38'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e3ec15c03b6bb-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:55:09,772 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:55:09,772 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:55:09,772 - DEBUG - receive_response_body.complete
2024-10-15 10:55:09,773 - DEBUG - response_closed.started
2024-10-15 10:55:09,773 - DEBUG - response_closed.complete
2024-10-15 10:55:09,773 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:55:10 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1930', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9996', 'x-ratelimit-remaining-tokens': '9817', 'x-ratelimit-reset-requests': '33.439s', 'x-ratelimit-reset-tokens': '1.095s', 'x-request-id': 'req_fddbe87d27b22c16fb12d8488fa4af38', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e3ec15c03b6bb-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:55:09,773 - DEBUG - request_id: req_fddbe87d27b22c16fb12d8488fa4af38
2024-10-15 10:55:09,774 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWgWLvFSbW8THiNcTstaWNPxcY8K', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_QWQVP5hOBaCYH4csjFWVqRhg', function=Function(arguments='{\n"buyer": "ISPILANTE SENTIMENT BRUSLI",\n"seller": "ELENA VASILESCU"\n}', name='ContractParties'), type='function')]))], created=1728978908, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=28, prompt_tokens=229, total_tokens=257, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:55:09,777 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: Yes\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 10:55:09,777 - DEBUG - max_retries: 1
2024-10-15 10:55:09,779 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: Yes\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 10:55:09,780 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:55:09,780 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:55:09,781 - DEBUG - send_request_headers.complete
2024-10-15 10:55:09,781 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:55:09,781 - DEBUG - send_request_body.complete
2024-10-15 10:55:09,781 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:55:10,656 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:55:11 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'713'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9995'), (b'x-ratelimit-remaining-tokens', b'9755'), (b'x-ratelimit-reset-requests', b'39.977s'), (b'x-ratelimit-reset-tokens', b'1.468s'), (b'x-request-id', b'req_414218caf08aca47eb927504b0edd30c'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e3ece6805b6bb-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:55:10,656 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:55:10,656 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:55:10,657 - DEBUG - receive_response_body.complete
2024-10-15 10:55:10,657 - DEBUG - response_closed.started
2024-10-15 10:55:10,657 - DEBUG - response_closed.complete
2024-10-15 10:55:10,657 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:55:11 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '713', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9995', 'x-ratelimit-remaining-tokens': '9755', 'x-ratelimit-reset-requests': '39.977s', 'x-ratelimit-reset-tokens': '1.468s', 'x-request-id': 'req_414218caf08aca47eb927504b0edd30c', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e3ece6805b6bb-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:55:10,657 - DEBUG - request_id: req_414218caf08aca47eb927504b0edd30c
2024-10-15 10:55:10,657 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWgYWPMYZ9HbvcFg5EPdgK7oLUkm', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_C1QjfVGrwKwolaYVHQ6MxngA', function=Function(arguments='\n{\n"action": "determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728978910, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=12, prompt_tokens=207, total_tokens=219, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:55:14,659 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.ContractDetails'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Assign roles: 'host' and 'guest'. Participants: ISPILANTE SENTIMENT BRUSLI (buyer) and ELENA VASILESCU (seller)."}], 'tools': [{'type': 'function', 'function': {'name': 'ContractDetails', 'description': 'Correctly extracted `ContractDetails` with all the required parameters with correct types', 'parameters': {'properties': {'contract_type': {'description': 'Type of contract (e.g., airbnb, buy-sell, it-consulting)', 'title': 'Contract Type', 'type': 'string'}, 'additional_info': {'additionalProperties': {'type': 'string'}, 'description': 'Additional information specific to the contract type', 'title': 'Additional Info', 'type': 'object'}}, 'required': ['additional_info', 'contract_type'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'ContractDetails'}}}
2024-10-15 10:55:14,659 - DEBUG - max_retries: 1
2024-10-15 10:55:14,661 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Assign roles: 'host' and 'guest'. Participants: ISPILANTE SENTIMENT BRUSLI (buyer) and ELENA VASILESCU (seller)."}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'ContractDetails'}}, 'tools': [{'type': 'function', 'function': {'name': 'ContractDetails', 'description': 'Correctly extracted `ContractDetails` with all the required parameters with correct types', 'parameters': {'properties': {'contract_type': {'description': 'Type of contract (e.g., airbnb, buy-sell, it-consulting)', 'title': 'Contract Type', 'type': 'string'}, 'additional_info': {'additionalProperties': {'type': 'string'}, 'description': 'Additional information specific to the contract type', 'title': 'Additional Info', 'type': 'object'}}, 'required': ['additional_info', 'contract_type'], 'type': 'object'}}}]}}
2024-10-15 10:55:14,662 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:55:14,662 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:55:14,662 - DEBUG - send_request_headers.complete
2024-10-15 10:55:14,662 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:55:14,662 - DEBUG - send_request_body.complete
2024-10-15 10:55:14,662 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:55:16,102 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:55:16 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1287'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9994'), (b'x-ratelimit-remaining-tokens', b'9864'), (b'x-ratelimit-reset-requests', b'43.749s'), (b'x-ratelimit-reset-tokens', b'816ms'), (b'x-request-id', b'req_8ffbeb606b8360dbb45d9ad21e4b417f'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e3eeceeadb6bb-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:55:16,103 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:55:16,103 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:55:16,104 - DEBUG - receive_response_body.complete
2024-10-15 10:55:16,104 - DEBUG - response_closed.started
2024-10-15 10:55:16,104 - DEBUG - response_closed.complete
2024-10-15 10:55:16,104 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:55:16 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1287', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9994', 'x-ratelimit-remaining-tokens': '9864', 'x-ratelimit-reset-requests': '43.749s', 'x-ratelimit-reset-tokens': '816ms', 'x-request-id': 'req_8ffbeb606b8360dbb45d9ad21e4b417f', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e3eeceeadb6bb-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:55:16,105 - DEBUG - request_id: req_8ffbeb606b8360dbb45d9ad21e4b417f
2024-10-15 10:55:16,106 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWgdjjqhWZxTJOIPt16B4EN8NBu2', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_rbvzrWVIGDlIHemggzI8j9Et', function=Function(arguments='{\n  "contract_type": "buy-sell"\n}', name='ContractDetails'), type='function')]))], created=1728978915, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=12, prompt_tokens=190, total_tokens=202, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:55:16,107 - ERROR - Error in determine_contract_details: No roles assigned in the API response
2024-10-15 10:55:16,256 - DEBUG - close.started
2024-10-15 10:55:16,257 - DEBUG - close.complete
2024-10-15 10:55:56,428 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-15 10:55:57,664 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-15 10:55:57,664 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-15 10:55:57,987 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-15 10:55:57,988 - DEBUG - Using proactor: IocpProactor
2024-10-15 10:55:58,006 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:55:58,006 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:55:58,006 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:55:58,006 - DEBUG - Compression method 0
2024-10-15 10:55:58,006 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:55:58,006 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:55:58,006 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 10:55:58,006 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 10:55:58,006 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 10:55:58,006 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 10:55:58,006 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:55:58,006 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:55:58,006 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:55:58,006 - DEBUG - Compression method 0
2024-10-15 10:55:58,006 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:55:58,006 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:55:58,006 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 10:55:58,006 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 10:55:58,006 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 10:55:58,006 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 10:55:58,016 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:55:58,016 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:55:58,016 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 10:55:58,016 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 10:55:58,017 - DEBUG - Error closing: Operation on closed image
2024-10-15 10:56:00,102 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:56:00,102 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:56:00,102 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:56:00,102 - DEBUG - Compression method 0
2024-10-15 10:56:00,102 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:56:00,102 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:56:00,102 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 10:56:00,102 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 10:56:00,102 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 10:56:00,102 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 10:56:00,102 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:56:00,102 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:56:00,102 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:56:00,102 - DEBUG - Compression method 0
2024-10-15 10:56:00,102 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:56:00,102 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:56:00,102 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 10:56:00,102 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 10:56:00,102 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 10:56:00,102 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 10:56:00,119 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:56:00,119 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:56:00,119 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 10:56:00,119 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 10:56:00,120 - DEBUG - Error closing: Operation on closed image
2024-10-15 10:56:02,590 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 0 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 10:56:02,591 - DEBUG - max_retries: 1
2024-10-15 10:56:02,593 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 0 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 10:56:02,629 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:56:02,630 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-15 10:56:02,717 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000002B23D0D3DA0>
2024-10-15 10:56:02,718 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x000002B23CF3E750> server_hostname='api.openai.com' timeout=5.0
2024-10-15 10:56:02,738 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000002B23D0D3CB0>
2024-10-15 10:56:02,738 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:56:02,738 - DEBUG - send_request_headers.complete
2024-10-15 10:56:02,738 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:56:02,738 - DEBUG - send_request_body.complete
2024-10-15 10:56:02,739 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:56:03,824 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:56:04 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'932'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'9821'), (b'x-ratelimit-reset-requests', b'8.64s'), (b'x-ratelimit-reset-tokens', b'1.074s'), (b'x-request-id', b'req_568a5bdd914016bddef12a120168051c'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=MZ8MWKBuVqJ9ox8LsJt2QiSfYugwwYvBHAmyZZnWQ9g-1728978964-1.0.1.1-bS9W0Q0sf_GPSZ5_msKkX0wAUbBr5gSXiR._mgQ8Vperam0pdpkp4WJbsFBbP2ofXfiLj_4T1PJIKvkfwHPgDA; path=/; expires=Tue, 15-Oct-24 08:26:04 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=Urvt_96HvtkdYGK8IiuwZMvqGP8tnpSp_bK3ZKDovXw-1728978964496-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e40195ce2b6ac-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:56:03,826 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:56:03,826 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:56:03,827 - DEBUG - receive_response_body.complete
2024-10-15 10:56:03,827 - DEBUG - response_closed.started
2024-10-15 10:56:03,827 - DEBUG - response_closed.complete
2024-10-15 10:56:03,827 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Tue, 15 Oct 2024 07:56:04 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-kzzh9hik9ryjiou4ftvhondh'), ('openai-processing-ms', '932'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '10000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '9821'), ('x-ratelimit-reset-requests', '8.64s'), ('x-ratelimit-reset-tokens', '1.074s'), ('x-request-id', 'req_568a5bdd914016bddef12a120168051c'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=MZ8MWKBuVqJ9ox8LsJt2QiSfYugwwYvBHAmyZZnWQ9g-1728978964-1.0.1.1-bS9W0Q0sf_GPSZ5_msKkX0wAUbBr5gSXiR._mgQ8Vperam0pdpkp4WJbsFBbP2ofXfiLj_4T1PJIKvkfwHPgDA; path=/; expires=Tue, 15-Oct-24 08:26:04 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=Urvt_96HvtkdYGK8IiuwZMvqGP8tnpSp_bK3ZKDovXw-1728978964496-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d2e40195ce2b6ac-OTP'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-15 10:56:03,828 - DEBUG - request_id: req_568a5bdd914016bddef12a120168051c
2024-10-15 10:56:03,832 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWhPtlI2tKMqeIOEImdYt1oedxE7', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_3nOMNDhu4WqCHqP7ygCwZG1K', function=Function(arguments='\n{\n  "action": "extract_pii"\n}', name='AgentAction'), type='function')]))], created=1728978963, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=12, prompt_tokens=207, total_tokens=219, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:56:03,833 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.PIIData'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}}
2024-10-15 10:56:03,834 - DEBUG - max_retries: 1
2024-10-15 10:56:03,835 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}, 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}]}}
2024-10-15 10:56:03,836 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:56:03,836 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:56:03,836 - DEBUG - send_request_headers.complete
2024-10-15 10:56:03,836 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:56:03,836 - DEBUG - send_request_body.complete
2024-10-15 10:56:03,836 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:56:06,398 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:56:07 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1850'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9998'), (b'x-ratelimit-remaining-tokens', b'9702'), (b'x-ratelimit-reset-requests', b'16.169s'), (b'x-ratelimit-reset-tokens', b'1.787s'), (b'x-request-id', b'req_7608461b11d41818b9a1ffe93b3268fa'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e40203c88b6ac-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:56:06,399 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:56:06,399 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:56:06,399 - DEBUG - receive_response_body.complete
2024-10-15 10:56:06,399 - DEBUG - response_closed.started
2024-10-15 10:56:06,399 - DEBUG - response_closed.complete
2024-10-15 10:56:06,399 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:56:07 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1850', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9998', 'x-ratelimit-remaining-tokens': '9702', 'x-ratelimit-reset-requests': '16.169s', 'x-ratelimit-reset-tokens': '1.787s', 'x-request-id': 'req_7608461b11d41818b9a1ffe93b3268fa', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e40203c88b6ac-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:56:06,399 - DEBUG - request_id: req_7608461b11d41818b9a1ffe93b3268fa
2024-10-15 10:56:06,400 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWhQWjQqLJqO2Tv6gscbvIgl3YYg', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_368lL5mcnMadZXu1n35TuHAb', function=Function(arguments='{\n"name": "ISPILANTE SENTIMENT BRUSLI",\n"address": "Videle Jud: Teleorman Sos. Giurgiului nr.1"\n}', name='PIIData'), type='function')]))], created=1728978964, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=36, prompt_tokens=377, total_tokens=413, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:56:07,795 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.PIIData'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}}
2024-10-15 10:56:07,795 - DEBUG - max_retries: 1
2024-10-15 10:56:07,797 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}, 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}]}}
2024-10-15 10:56:07,798 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:56:07,798 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:56:07,798 - DEBUG - send_request_headers.complete
2024-10-15 10:56:07,799 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:56:07,799 - DEBUG - send_request_body.complete
2024-10-15 10:56:07,799 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:56:10,085 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:56:10 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2133'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9997'), (b'x-ratelimit-remaining-tokens', b'9742'), (b'x-ratelimit-reset-requests', b'20.861s'), (b'x-ratelimit-reset-tokens', b'1.548s'), (b'x-request-id', b'req_14a4a4135cb512ef3004978848118f22'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e4038f878b6ac-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:56:10,086 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:56:10,086 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:56:10,087 - DEBUG - receive_response_body.complete
2024-10-15 10:56:10,087 - DEBUG - response_closed.started
2024-10-15 10:56:10,087 - DEBUG - response_closed.complete
2024-10-15 10:56:10,087 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:56:10 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '2133', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9997', 'x-ratelimit-remaining-tokens': '9742', 'x-ratelimit-reset-requests': '20.861s', 'x-ratelimit-reset-tokens': '1.548s', 'x-request-id': 'req_14a4a4135cb512ef3004978848118f22', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e4038f878b6ac-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:56:10,087 - DEBUG - request_id: req_14a4a4135cb512ef3004978848118f22
2024-10-15 10:56:10,089 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWhUUauwsxu8aQJdwbdrbmcNBDFA', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_faVEUqAs4QjKUBX9ssaXti2q', function=Function(arguments='{\n"name": "ELENA VASILESCU",\n"address": "Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B"\n}', name='PIIData'), type='function')]))], created=1728978968, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=42, prompt_tokens=380, total_tokens=422, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:56:11,072 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 10:56:11,072 - DEBUG - max_retries: 1
2024-10-15 10:56:11,074 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 10:56:11,075 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:56:11,075 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:56:11,075 - DEBUG - send_request_headers.complete
2024-10-15 10:56:11,075 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:56:11,075 - DEBUG - send_request_body.complete
2024-10-15 10:56:11,075 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:56:11,997 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:56:12 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'758'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9996'), (b'x-ratelimit-remaining-tokens', b'9821'), (b'x-ratelimit-reset-requests', b'26.223s'), (b'x-ratelimit-reset-tokens', b'1.074s'), (b'x-request-id', b'req_27e398863046e707c46e82640193fb70'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e404d7f90b6ac-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:56:11,998 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:56:11,998 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:56:11,998 - DEBUG - receive_response_body.complete
2024-10-15 10:56:11,998 - DEBUG - response_closed.started
2024-10-15 10:56:11,998 - DEBUG - response_closed.complete
2024-10-15 10:56:11,998 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:56:12 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '758', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9996', 'x-ratelimit-remaining-tokens': '9821', 'x-ratelimit-reset-requests': '26.223s', 'x-ratelimit-reset-tokens': '1.074s', 'x-request-id': 'req_27e398863046e707c46e82640193fb70', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e404d7f90b6ac-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:56:11,998 - DEBUG - request_id: req_27e398863046e707c46e82640193fb70
2024-10-15 10:56:11,998 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWhXElJhNBJ4LhxXOCHZC3WogaXl', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_0yC4XYzVXoY7latERZYFy3DT', function=Function(arguments='{\n  "action": "identify_parties"\n}', name='AgentAction'), type='function')]))], created=1728978971, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=11, prompt_tokens=207, total_tokens=218, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:56:11,999 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.ContractParties'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Identify the buyer and seller from the given information:\n\nName: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'properties': {'buyer': {'description': 'Name of the buyer', 'title': 'Buyer', 'type': 'string'}, 'seller': {'description': 'Name of the seller', 'title': 'Seller', 'type': 'string'}}, 'required': ['buyer', 'seller'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}}
2024-10-15 10:56:11,999 - DEBUG - max_retries: 1
2024-10-15 10:56:12,001 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Identify the buyer and seller from the given information:\n\nName: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}, 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'properties': {'buyer': {'description': 'Name of the buyer', 'title': 'Buyer', 'type': 'string'}, 'seller': {'description': 'Name of the seller', 'title': 'Seller', 'type': 'string'}}, 'required': ['buyer', 'seller'], 'type': 'object'}}}]}}
2024-10-15 10:56:12,002 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:56:12,002 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:56:12,002 - DEBUG - send_request_headers.complete
2024-10-15 10:56:12,002 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:56:12,002 - DEBUG - send_request_body.complete
2024-10-15 10:56:12,002 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:56:17,326 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:56:17 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'5153'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9996'), (b'x-ratelimit-remaining-tokens', b'9771'), (b'x-ratelimit-reset-requests', b'33.941s'), (b'x-ratelimit-reset-tokens', b'1.369s'), (b'x-request-id', b'req_f4e7bcb94fead13790231ac7a256fb4f'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e40533de5b6ac-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:56:17,326 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:56:17,326 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:56:17,326 - DEBUG - receive_response_body.complete
2024-10-15 10:56:17,327 - DEBUG - response_closed.started
2024-10-15 10:56:17,327 - DEBUG - response_closed.complete
2024-10-15 10:56:17,327 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:56:17 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '5153', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9996', 'x-ratelimit-remaining-tokens': '9771', 'x-ratelimit-reset-requests': '33.941s', 'x-ratelimit-reset-tokens': '1.369s', 'x-request-id': 'req_f4e7bcb94fead13790231ac7a256fb4f', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e40533de5b6ac-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:56:17,327 - DEBUG - request_id: req_f4e7bcb94fead13790231ac7a256fb4f
2024-10-15 10:56:17,327 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWhZxh8oDOorHR2zfb3PLIp3HUfg', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_Xx3W3GOeQiljx7xhF4B4fIK4', function=Function(arguments='{\n"buyer": "ISPILANTE SENTIMENT BRUSLI",\n"seller": "ELENA VASILESCU"\n}', name='ContractParties'), type='function')]))], created=1728978973, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=28, prompt_tokens=229, total_tokens=257, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:56:17,328 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: Yes\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 10:56:17,328 - DEBUG - max_retries: 1
2024-10-15 10:56:17,330 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: Yes\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 10:56:17,330 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:56:17,331 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:56:17,331 - DEBUG - send_request_headers.complete
2024-10-15 10:56:17,331 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:56:17,331 - DEBUG - send_request_body.complete
2024-10-15 10:56:17,331 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:56:18,276 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:56:18 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'791'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9995'), (b'x-ratelimit-remaining-tokens', b'9752'), (b'x-ratelimit-reset-requests', b'37.25s'), (b'x-ratelimit-reset-tokens', b'1.486s'), (b'x-request-id', b'req_17706559450b4428e5536c6747d8347c'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e40748cefb6ac-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:56:18,276 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:56:18,276 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:56:18,276 - DEBUG - receive_response_body.complete
2024-10-15 10:56:18,276 - DEBUG - response_closed.started
2024-10-15 10:56:18,276 - DEBUG - response_closed.complete
2024-10-15 10:56:18,276 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:56:18 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '791', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9995', 'x-ratelimit-remaining-tokens': '9752', 'x-ratelimit-reset-requests': '37.25s', 'x-ratelimit-reset-tokens': '1.486s', 'x-request-id': 'req_17706559450b4428e5536c6747d8347c', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e40748cefb6ac-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:56:18,276 - DEBUG - request_id: req_17706559450b4428e5536c6747d8347c
2024-10-15 10:56:18,277 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWheL3CGUHwvnKTxpAlBtrOVpeQS', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_t23Om7pq57pFlRyDSyOvg1uq', function=Function(arguments='{\n"action": "determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728978978, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=11, prompt_tokens=207, total_tokens=218, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:56:44,125 - DEBUG - close.started
2024-10-15 10:56:44,125 - DEBUG - close.complete
2024-10-15 10:56:44,126 - ERROR - Task exception was never retrieved
future: <Task finished name='Task-1' coro=<agent_workflow() done, defined at D:\deve\contract_automation\src\main.py:25> exception=KeyboardInterrupt()>
Traceback (most recent call last):
  File "D:\deve\contract_automation\src\main.py", line 105, in <module>
    asyncio.run(agent_workflow())
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 30, in run
    return loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 92, in run_until_complete
    self._run_once()
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 133, in _run_once
    handle._run()
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 386, in __wakeup
    self.__step()
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 293, in __step
    self.__step_run_and_handle_result(exc)
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 304, in __step_run_and_handle_result
    result = coro.send(None)
             ^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\src\main.py", line 55, in agent_workflow
    contract_type = input("Enter contract type (airbnb, buy-sell, it-consulting): ").lower().replace(" ", "-")
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
2024-10-15 10:58:04,854 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-15 10:58:06,109 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-15 10:58:06,110 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-15 10:58:06,433 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-15 10:58:06,433 - DEBUG - Using proactor: IocpProactor
2024-10-15 10:58:06,452 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:58:06,452 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:58:06,452 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:58:06,452 - DEBUG - Compression method 0
2024-10-15 10:58:06,452 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:58:06,452 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:58:06,452 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 10:58:06,452 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 10:58:06,452 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 10:58:06,452 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 10:58:06,452 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:58:06,452 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:58:06,453 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:58:06,453 - DEBUG - Compression method 0
2024-10-15 10:58:06,453 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:58:06,453 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:58:06,453 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 10:58:06,453 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 10:58:06,453 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 10:58:06,453 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 10:58:06,462 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:58:06,462 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:58:06,462 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 10:58:06,462 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 10:58:06,463 - DEBUG - Error closing: Operation on closed image
2024-10-15 10:58:08,517 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:58:08,517 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:58:08,518 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:58:08,518 - DEBUG - Compression method 0
2024-10-15 10:58:08,518 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:58:08,518 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:58:08,518 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 10:58:08,518 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 10:58:08,518 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 10:58:08,518 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 10:58:08,518 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 10:58:08,518 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 10:58:08,518 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 10:58:08,518 - DEBUG - Compression method 0
2024-10-15 10:58:08,518 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 10:58:08,518 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 10:58:08,518 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 10:58:08,518 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 10:58:08,518 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 10:58:08,518 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 10:58:08,535 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:58:08,535 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 10:58:08,535 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 10:58:08,535 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 10:58:08,536 - DEBUG - Error closing: Operation on closed image
2024-10-15 10:58:11,084 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 0 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 10:58:11,085 - DEBUG - max_retries: 1
2024-10-15 10:58:11,087 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 0 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 10:58:11,125 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:58:11,125 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-15 10:58:11,158 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x0000021D6B02FE90>
2024-10-15 10:58:11,158 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x0000021D6AE9E750> server_hostname='api.openai.com' timeout=5.0
2024-10-15 10:58:11,168 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x0000021D6B02FBF0>
2024-10-15 10:58:11,168 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:58:11,168 - DEBUG - send_request_headers.complete
2024-10-15 10:58:11,168 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:58:11,168 - DEBUG - send_request_body.complete
2024-10-15 10:58:11,168 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:58:12,355 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:58:13 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1019'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'9821'), (b'x-ratelimit-reset-requests', b'8.64s'), (b'x-ratelimit-reset-tokens', b'1.074s'), (b'x-request-id', b'req_d54667eb3ae140417a94bde9a44b6677'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=s1TiYZ79XYNUKMQijplLoaIeqrRo3cZSryg8gTdo97A-1728979093-1.0.1.1-AZ01pcBBr0D6iaiE2HHvSfz2Msismp9Vvq7XFTZikqAAoyIp8otUmjO5JNZq.Ei.A3Xl2b4RJAD1u8DT1EshlQ; path=/; expires=Tue, 15-Oct-24 08:28:13 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=F_kVqLQapNX3UrsD_jISlMojLOULWXRwE22VkAUTt1Y-1728979093008-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e433be9f06247-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:58:12,357 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:58:12,358 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:58:12,359 - DEBUG - receive_response_body.complete
2024-10-15 10:58:12,359 - DEBUG - response_closed.started
2024-10-15 10:58:12,359 - DEBUG - response_closed.complete
2024-10-15 10:58:12,359 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Tue, 15 Oct 2024 07:58:13 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-kzzh9hik9ryjiou4ftvhondh'), ('openai-processing-ms', '1019'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '10000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '9821'), ('x-ratelimit-reset-requests', '8.64s'), ('x-ratelimit-reset-tokens', '1.074s'), ('x-request-id', 'req_d54667eb3ae140417a94bde9a44b6677'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=s1TiYZ79XYNUKMQijplLoaIeqrRo3cZSryg8gTdo97A-1728979093-1.0.1.1-AZ01pcBBr0D6iaiE2HHvSfz2Msismp9Vvq7XFTZikqAAoyIp8otUmjO5JNZq.Ei.A3Xl2b4RJAD1u8DT1EshlQ; path=/; expires=Tue, 15-Oct-24 08:28:13 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=F_kVqLQapNX3UrsD_jISlMojLOULWXRwE22VkAUTt1Y-1728979093008-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d2e433be9f06247-OTP'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-15 10:58:12,360 - DEBUG - request_id: req_d54667eb3ae140417a94bde9a44b6677
2024-10-15 10:58:12,364 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWjUEKI3r6Q18mLHy4LYBJPrr5yy', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_qDAN1jJuSM3AgBpECX2X9XW2', function=Function(arguments='\n{\n  "action": "extract_pii"\n}', name='AgentAction'), type='function')]))], created=1728979092, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=12, prompt_tokens=207, total_tokens=219, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:58:12,365 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.PIIData'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}}
2024-10-15 10:58:12,365 - DEBUG - max_retries: 1
2024-10-15 10:58:12,367 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}, 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}]}}
2024-10-15 10:58:12,367 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:58:12,367 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:58:12,367 - DEBUG - send_request_headers.complete
2024-10-15 10:58:12,367 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:58:12,367 - DEBUG - send_request_body.complete
2024-10-15 10:58:12,367 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:58:14,432 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:58:15 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1913'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9998'), (b'x-ratelimit-remaining-tokens', b'9716'), (b'x-ratelimit-reset-requests', b'16.085s'), (b'x-ratelimit-reset-tokens', b'1.703s'), (b'x-request-id', b'req_68fbe8167a250e2d53daefd47637b65c'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e43436f7a6247-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:58:14,433 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:58:14,433 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:58:14,433 - DEBUG - receive_response_body.complete
2024-10-15 10:58:14,433 - DEBUG - response_closed.started
2024-10-15 10:58:14,433 - DEBUG - response_closed.complete
2024-10-15 10:58:14,433 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:58:15 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1913', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9998', 'x-ratelimit-remaining-tokens': '9716', 'x-ratelimit-reset-requests': '16.085s', 'x-ratelimit-reset-tokens': '1.703s', 'x-request-id': 'req_68fbe8167a250e2d53daefd47637b65c', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e43436f7a6247-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:58:14,433 - DEBUG - request_id: req_68fbe8167a250e2d53daefd47637b65c
2024-10-15 10:58:14,434 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWjVGThxOGPy738S8omJyY2d2TcY', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_qB1eOXvGnC29QDKcWIwyRS9K', function=Function(arguments='{\n"name": "ISPILANTE SENTIMENT BRUSLI",\n"address": "Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR"\n}', name='PIIData'), type='function')]))], created=1728979093, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=39, prompt_tokens=377, total_tokens=416, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:58:19,684 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.PIIData'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}}
2024-10-15 10:58:19,684 - DEBUG - max_retries: 1
2024-10-15 10:58:19,685 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}, 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}]}}
2024-10-15 10:58:19,686 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:58:19,686 - DEBUG - close.started
2024-10-15 10:58:19,686 - DEBUG - close.complete
2024-10-15 10:58:19,686 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-15 10:58:19,702 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x0000021D6B06FFE0>
2024-10-15 10:58:19,702 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x0000021D6AE9E750> server_hostname='api.openai.com' timeout=5.0
2024-10-15 10:58:19,708 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x0000021D6B06E210>
2024-10-15 10:58:19,708 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:58:19,708 - DEBUG - send_request_headers.complete
2024-10-15 10:58:19,708 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:58:19,708 - DEBUG - send_request_body.complete
2024-10-15 10:58:19,708 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:58:22,549 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:58:23 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2687'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9997'), (b'x-ratelimit-remaining-tokens', b'9742'), (b'x-ratelimit-reset-requests', b'17.384s'), (b'x-ratelimit-reset-tokens', b'1.548s'), (b'x-request-id', b'req_f9d9287b1b6ca0d315223493d036f385'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e43714b36ca20-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:58:22,549 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:58:22,549 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:58:22,549 - DEBUG - receive_response_body.complete
2024-10-15 10:58:22,549 - DEBUG - response_closed.started
2024-10-15 10:58:22,549 - DEBUG - response_closed.complete
2024-10-15 10:58:22,549 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:58:23 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '2687', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9997', 'x-ratelimit-remaining-tokens': '9742', 'x-ratelimit-reset-requests': '17.384s', 'x-ratelimit-reset-tokens': '1.548s', 'x-request-id': 'req_f9d9287b1b6ca0d315223493d036f385', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e43714b36ca20-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:58:22,549 - DEBUG - request_id: req_f9d9287b1b6ca0d315223493d036f385
2024-10-15 10:58:22,550 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWjco86fa59bPAGmRBWv3FX0wLsg', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_FLc5k7O3Wv9UQWjsrX1l7lMr', function=Function(arguments='{\n"name": "ELENA VASILESCU",\n"address": "Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B"\n}', name='PIIData'), type='function')]))], created=1728979100, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=42, prompt_tokens=380, total_tokens=422, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:58:24,323 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 10:58:24,323 - DEBUG - max_retries: 1
2024-10-15 10:58:24,325 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 10:58:24,325 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:58:24,326 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:58:24,326 - DEBUG - send_request_headers.complete
2024-10-15 10:58:24,326 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:58:24,326 - DEBUG - send_request_body.complete
2024-10-15 10:58:24,326 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:58:25,384 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:58:26 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'874'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9997'), (b'x-ratelimit-remaining-tokens', b'9821'), (b'x-ratelimit-reset-requests', b'21.374s'), (b'x-ratelimit-reset-tokens', b'1.074s'), (b'x-request-id', b'req_40c3129154cd37beb074f60dc3e2b0a1'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e438e292aca20-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:58:25,384 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:58:25,384 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:58:25,384 - DEBUG - receive_response_body.complete
2024-10-15 10:58:25,384 - DEBUG - response_closed.started
2024-10-15 10:58:25,384 - DEBUG - response_closed.complete
2024-10-15 10:58:25,384 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:58:26 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '874', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9997', 'x-ratelimit-remaining-tokens': '9821', 'x-ratelimit-reset-requests': '21.374s', 'x-ratelimit-reset-tokens': '1.074s', 'x-request-id': 'req_40c3129154cd37beb074f60dc3e2b0a1', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e438e292aca20-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:58:25,384 - DEBUG - request_id: req_40c3129154cd37beb074f60dc3e2b0a1
2024-10-15 10:58:25,385 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWjh1dUlJbufcwSXLAgDyvy3ZJtN', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_QWQVP5hOBaCYH4csjFWVqRhg', function=Function(arguments='{\n"action": "identify_parties"\n}', name='AgentAction'), type='function')]))], created=1728979105, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=10, prompt_tokens=207, total_tokens=217, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:58:25,385 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.ContractParties'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Identify the buyer and seller from the given information:\n\nName: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'properties': {'buyer': {'description': 'Name of the buyer', 'title': 'Buyer', 'type': 'string'}, 'seller': {'description': 'Name of the seller', 'title': 'Seller', 'type': 'string'}}, 'required': ['buyer', 'seller'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}}
2024-10-15 10:58:25,385 - DEBUG - max_retries: 1
2024-10-15 10:58:25,387 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Identify the buyer and seller from the given information:\n\nName: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}, 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'properties': {'buyer': {'description': 'Name of the buyer', 'title': 'Buyer', 'type': 'string'}, 'seller': {'description': 'Name of the seller', 'title': 'Seller', 'type': 'string'}}, 'required': ['buyer', 'seller'], 'type': 'object'}}}]}}
2024-10-15 10:58:25,387 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:58:25,387 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:58:25,387 - DEBUG - send_request_headers.complete
2024-10-15 10:58:25,387 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:58:25,387 - DEBUG - send_request_body.complete
2024-10-15 10:58:25,387 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:58:27,408 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:58:28 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1866'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9996'), (b'x-ratelimit-remaining-tokens', b'9788'), (b'x-ratelimit-reset-requests', b'28.985s'), (b'x-ratelimit-reset-tokens', b'1.269s'), (b'x-request-id', b'req_b92f2c9effbb7a19e719722edb48b195'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e4394cc2bca20-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:58:27,408 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:58:27,408 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:58:27,409 - DEBUG - receive_response_body.complete
2024-10-15 10:58:27,409 - DEBUG - response_closed.started
2024-10-15 10:58:27,409 - DEBUG - response_closed.complete
2024-10-15 10:58:27,409 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:58:28 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1866', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9996', 'x-ratelimit-remaining-tokens': '9788', 'x-ratelimit-reset-requests': '28.985s', 'x-ratelimit-reset-tokens': '1.269s', 'x-request-id': 'req_b92f2c9effbb7a19e719722edb48b195', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e4394cc2bca20-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:58:27,409 - DEBUG - request_id: req_b92f2c9effbb7a19e719722edb48b195
2024-10-15 10:58:27,410 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWjiLPWFt8FunJTcw9BodgCY8BwQ', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_dXdCbTDxCUmrN99Y4Wr8ViK1', function=Function(arguments='{\n  "buyer": "ISPILANTE SENTIMENT BRUSLI",\n  "seller": "ELENA VASILESCU"\n}', name='ContractParties'), type='function')]))], created=1728979106, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=30, prompt_tokens=232, total_tokens=262, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:58:27,411 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: Yes\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 10:58:27,411 - DEBUG - max_retries: 1
2024-10-15 10:58:27,414 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: Yes\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 10:58:27,415 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:58:27,415 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:58:27,415 - DEBUG - send_request_headers.complete
2024-10-15 10:58:27,415 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:58:27,416 - DEBUG - send_request_body.complete
2024-10-15 10:58:27,416 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:58:28,303 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:58:28 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'739'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9995'), (b'x-ratelimit-remaining-tokens', b'9748'), (b'x-ratelimit-reset-requests', b'35.602s'), (b'x-ratelimit-reset-tokens', b'1.507s'), (b'x-request-id', b'req_3cf64a90d1b45ad77e9d925cfcc8c011'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e43a17d9fca20-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:58:28,304 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:58:28,304 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:58:28,304 - DEBUG - receive_response_body.complete
2024-10-15 10:58:28,304 - DEBUG - response_closed.started
2024-10-15 10:58:28,305 - DEBUG - response_closed.complete
2024-10-15 10:58:28,305 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:58:28 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '739', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9995', 'x-ratelimit-remaining-tokens': '9748', 'x-ratelimit-reset-requests': '35.602s', 'x-ratelimit-reset-tokens': '1.507s', 'x-request-id': 'req_3cf64a90d1b45ad77e9d925cfcc8c011', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e43a17d9fca20-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:58:28,305 - DEBUG - request_id: req_3cf64a90d1b45ad77e9d925cfcc8c011
2024-10-15 10:58:28,306 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWjk6JBW9ZC00Z681xjUQw4hTeg9', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_0fP1EesgUjFO2Zn1AbC4YrLb', function=Function(arguments='{\n"action": "determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728979108, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=11, prompt_tokens=207, total_tokens=218, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:58:32,884 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.ContractDetails'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Assign roles: 'buyer' and 'seller'. Participants: ISPILANTE SENTIMENT BRUSLI and ELENA VASILESCU."}], 'tools': [{'type': 'function', 'function': {'name': 'ContractDetails', 'description': 'Correctly extracted `ContractDetails` with all the required parameters with correct types', 'parameters': {'properties': {'contract_type': {'description': 'Type of contract (e.g., airbnb, buy-sell, it-consulting)', 'title': 'Contract Type', 'type': 'string'}, 'additional_info': {'additionalProperties': {'type': 'string'}, 'description': 'Additional information specific to the contract type', 'title': 'Additional Info', 'type': 'object'}}, 'required': ['additional_info', 'contract_type'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'ContractDetails'}}}
2024-10-15 10:58:32,884 - DEBUG - max_retries: 1
2024-10-15 10:58:32,886 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Assign roles: 'buyer' and 'seller'. Participants: ISPILANTE SENTIMENT BRUSLI and ELENA VASILESCU."}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'ContractDetails'}}, 'tools': [{'type': 'function', 'function': {'name': 'ContractDetails', 'description': 'Correctly extracted `ContractDetails` with all the required parameters with correct types', 'parameters': {'properties': {'contract_type': {'description': 'Type of contract (e.g., airbnb, buy-sell, it-consulting)', 'title': 'Contract Type', 'type': 'string'}, 'additional_info': {'additionalProperties': {'type': 'string'}, 'description': 'Additional information specific to the contract type', 'title': 'Additional Info', 'type': 'object'}}, 'required': ['additional_info', 'contract_type'], 'type': 'object'}}}]}}
2024-10-15 10:58:32,886 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 10:58:32,887 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 10:58:32,887 - DEBUG - send_request_headers.complete
2024-10-15 10:58:32,887 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 10:58:32,887 - DEBUG - send_request_body.complete
2024-10-15 10:58:32,887 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 10:58:34,214 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 07:58:34 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1169'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9995'), (b'x-ratelimit-remaining-tokens', b'9868'), (b'x-ratelimit-reset-requests', b'38.767s'), (b'x-ratelimit-reset-tokens', b'792ms'), (b'x-request-id', b'req_87cd499fc6d751b67e1e234e9aa9186d'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e43c3a964ca20-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 10:58:34,215 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 10:58:34,216 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 10:58:34,216 - DEBUG - receive_response_body.complete
2024-10-15 10:58:34,216 - DEBUG - response_closed.started
2024-10-15 10:58:34,216 - DEBUG - response_closed.complete
2024-10-15 10:58:34,217 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 07:58:34 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1169', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9995', 'x-ratelimit-remaining-tokens': '9868', 'x-ratelimit-reset-requests': '38.767s', 'x-ratelimit-reset-tokens': '792ms', 'x-request-id': 'req_87cd499fc6d751b67e1e234e9aa9186d', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e43c3a964ca20-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 10:58:34,217 - DEBUG - request_id: req_87cd499fc6d751b67e1e234e9aa9186d
2024-10-15 10:58:34,218 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWjp4xoSuQlgHeAF6PCzxKH6cNuC', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_kp0IgKZmBal82NtmJFCjvRbD', function=Function(arguments='{\n  "contract_type": "buy-sell"\n}', name='ContractDetails'), type='function')]))], created=1728979113, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=12, prompt_tokens=185, total_tokens=197, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 10:58:34,220 - ERROR - Error in determine_contract_details: No roles assigned in the API response
2024-10-15 10:58:34,376 - DEBUG - close.started
2024-10-15 10:58:34,377 - DEBUG - close.complete
2024-10-15 11:02:36,565 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-15 11:02:37,817 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-15 11:02:37,817 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-15 11:02:38,139 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-15 11:02:38,140 - DEBUG - Using proactor: IocpProactor
2024-10-15 11:02:38,158 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 11:02:38,158 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 11:02:38,158 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 11:02:38,158 - DEBUG - Compression method 0
2024-10-15 11:02:38,158 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 11:02:38,158 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 11:02:38,158 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 11:02:38,158 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 11:02:38,158 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 11:02:38,158 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 11:02:38,158 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 11:02:38,158 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 11:02:38,158 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 11:02:38,158 - DEBUG - Compression method 0
2024-10-15 11:02:38,158 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 11:02:38,158 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 11:02:38,159 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 11:02:38,159 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 11:02:38,159 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 11:02:38,159 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 11:02:38,168 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 11:02:38,168 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 11:02:38,168 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 11:02:38,168 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 11:02:38,169 - DEBUG - Error closing: Operation on closed image
2024-10-15 11:02:40,182 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 11:02:40,182 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 11:02:40,182 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 11:02:40,182 - DEBUG - Compression method 0
2024-10-15 11:02:40,182 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 11:02:40,182 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 11:02:40,182 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 11:02:40,182 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 11:02:40,182 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 11:02:40,182 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 11:02:40,182 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 11:02:40,183 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 11:02:40,183 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 11:02:40,183 - DEBUG - Compression method 0
2024-10-15 11:02:40,183 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 11:02:40,183 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 11:02:40,183 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 11:02:40,183 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 11:02:40,183 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 11:02:40,183 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 11:02:40,200 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 11:02:40,200 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 11:02:40,200 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 11:02:40,200 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 11:02:40,200 - DEBUG - Error closing: Operation on closed image
2024-10-15 11:02:42,671 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 0 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 11:02:42,672 - DEBUG - max_retries: 1
2024-10-15 11:02:42,673 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 0 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 11:02:42,736 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 11:02:42,737 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-15 11:02:42,759 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001602948FEC0>
2024-10-15 11:02:42,759 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x00000160292FE750> server_hostname='api.openai.com' timeout=5.0
2024-10-15 11:02:42,766 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001602948FC80>
2024-10-15 11:02:42,766 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 11:02:42,766 - DEBUG - send_request_headers.complete
2024-10-15 11:02:42,766 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 11:02:42,766 - DEBUG - send_request_body.complete
2024-10-15 11:02:42,766 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 11:02:44,414 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 08:02:45 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1492'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'9821'), (b'x-ratelimit-reset-requests', b'8.64s'), (b'x-ratelimit-reset-tokens', b'1.074s'), (b'x-request-id', b'req_0aaeb90d3defe0c4a2bd4f4a4bc4bff1'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=68ebjSJJeJ8RskADSDmFGFZEN2aA9UXDVIhU7rvXFFc-1728979365-1.0.1.1-zOVYGfOS4vdf5kZTAnJItzsBu05QQh2kdNx0W.mCZv3z3_gir3TftUBb1vYZ3NEQ6NjvlyW121GVzCmi3m.15w; path=/; expires=Tue, 15-Oct-24 08:32:45 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=CuKZF80upTuB7NAvl2mciFOzP0KdPw41UOcfO_WF5B4-1728979365029-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e49dd2a406241-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 11:02:44,414 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 11:02:44,415 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 11:02:44,415 - DEBUG - receive_response_body.complete
2024-10-15 11:02:44,415 - DEBUG - response_closed.started
2024-10-15 11:02:44,415 - DEBUG - response_closed.complete
2024-10-15 11:02:44,415 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Tue, 15 Oct 2024 08:02:45 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-kzzh9hik9ryjiou4ftvhondh'), ('openai-processing-ms', '1492'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '10000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '9821'), ('x-ratelimit-reset-requests', '8.64s'), ('x-ratelimit-reset-tokens', '1.074s'), ('x-request-id', 'req_0aaeb90d3defe0c4a2bd4f4a4bc4bff1'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=68ebjSJJeJ8RskADSDmFGFZEN2aA9UXDVIhU7rvXFFc-1728979365-1.0.1.1-zOVYGfOS4vdf5kZTAnJItzsBu05QQh2kdNx0W.mCZv3z3_gir3TftUBb1vYZ3NEQ6NjvlyW121GVzCmi3m.15w; path=/; expires=Tue, 15-Oct-24 08:32:45 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=CuKZF80upTuB7NAvl2mciFOzP0KdPw41UOcfO_WF5B4-1728979365029-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d2e49dd2a406241-OTP'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-15 11:02:44,415 - DEBUG - request_id: req_0aaeb90d3defe0c4a2bd4f4a4bc4bff1
2024-10-15 11:02:44,417 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWnrnsRskU9T5plMwYjdVsQpJj1y', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_NTDWfC2Luv8G42Pu4B2QOIc7', function=Function(arguments='\n{\n  "action": "extract_pii"\n}', name='AgentAction'), type='function')]))], created=1728979363, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=12, prompt_tokens=207, total_tokens=219, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 11:02:44,418 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.PIIData'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}}
2024-10-15 11:02:44,418 - DEBUG - max_retries: 1
2024-10-15 11:02:44,419 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}, 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}]}}
2024-10-15 11:02:44,420 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 11:02:44,420 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 11:02:44,420 - DEBUG - send_request_headers.complete
2024-10-15 11:02:44,420 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 11:02:44,420 - DEBUG - send_request_body.complete
2024-10-15 11:02:44,420 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 11:02:47,230 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 08:02:47 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2658'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9998'), (b'x-ratelimit-remaining-tokens', b'9719'), (b'x-ratelimit-reset-requests', b'15.629s'), (b'x-ratelimit-reset-tokens', b'1.681s'), (b'x-request-id', b'req_e53e20c537bfb33c25c37b033d672066'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e49e778e66241-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 11:02:47,230 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 11:02:47,231 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 11:02:47,231 - DEBUG - receive_response_body.complete
2024-10-15 11:02:47,231 - DEBUG - response_closed.started
2024-10-15 11:02:47,231 - DEBUG - response_closed.complete
2024-10-15 11:02:47,231 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 08:02:47 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '2658', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9998', 'x-ratelimit-remaining-tokens': '9719', 'x-ratelimit-reset-requests': '15.629s', 'x-ratelimit-reset-tokens': '1.681s', 'x-request-id': 'req_e53e20c537bfb33c25c37b033d672066', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e49e778e66241-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 11:02:47,231 - DEBUG - request_id: req_e53e20c537bfb33c25c37b033d672066
2024-10-15 11:02:47,231 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWntVR9ZXo9HeeYOPNvjCDhqJLrh', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_13507FSIsly0RSqwclORj8Uh', function=Function(arguments='{\n"name": "ISPILANTE SENTIMENT BRUSLI",\n"address": "Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR"\n}', name='PIIData'), type='function')]))], created=1728979365, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=39, prompt_tokens=377, total_tokens=416, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 11:02:49,644 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.PIIData'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}}
2024-10-15 11:02:49,644 - DEBUG - max_retries: 1
2024-10-15 11:02:49,646 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}, 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}]}}
2024-10-15 11:02:49,647 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 11:02:49,647 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 11:02:49,647 - DEBUG - send_request_headers.complete
2024-10-15 11:02:49,647 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 11:02:49,647 - DEBUG - send_request_body.complete
2024-10-15 11:02:49,647 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 11:02:52,405 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 08:02:53 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2597'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9997'), (b'x-ratelimit-remaining-tokens', b'9742'), (b'x-ratelimit-reset-requests', b'19.033s'), (b'x-ratelimit-reset-tokens', b'1.548s'), (b'x-request-id', b'req_0c43750906cbaa2f24101b0d89efca4a'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e4a082aec6241-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 11:02:52,405 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 11:02:52,406 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 11:02:52,406 - DEBUG - receive_response_body.complete
2024-10-15 11:02:52,406 - DEBUG - response_closed.started
2024-10-15 11:02:52,406 - DEBUG - response_closed.complete
2024-10-15 11:02:52,406 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 08:02:53 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '2597', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9997', 'x-ratelimit-remaining-tokens': '9742', 'x-ratelimit-reset-requests': '19.033s', 'x-ratelimit-reset-tokens': '1.548s', 'x-request-id': 'req_0c43750906cbaa2f24101b0d89efca4a', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e4a082aec6241-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 11:02:52,406 - DEBUG - request_id: req_0c43750906cbaa2f24101b0d89efca4a
2024-10-15 11:02:52,407 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWnyTq2Yemfdi7DUQPseUtssrlTl', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_oyLutgPDiknFE3fgQFmjf3U8', function=Function(arguments='{\n"name": "ELENA VASILESCU",\n"address": "Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B"\n}', name='PIIData'), type='function')]))], created=1728979370, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=42, prompt_tokens=380, total_tokens=422, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 11:02:54,142 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 11:02:54,142 - DEBUG - max_retries: 1
2024-10-15 11:02:54,144 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 11:02:54,145 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 11:02:54,145 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 11:02:54,145 - DEBUG - send_request_headers.complete
2024-10-15 11:02:54,145 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 11:02:54,145 - DEBUG - send_request_body.complete
2024-10-15 11:02:54,145 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 11:02:55,244 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 08:02:55 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'938'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9997'), (b'x-ratelimit-remaining-tokens', b'9821'), (b'x-ratelimit-reset-requests', b'23.171s'), (b'x-ratelimit-reset-tokens', b'1.074s'), (b'x-request-id', b'req_d95c5b2882793c5b85fab266f5a81fee'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e4a244f996241-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 11:02:55,245 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 11:02:55,246 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 11:02:55,246 - DEBUG - receive_response_body.complete
2024-10-15 11:02:55,246 - DEBUG - response_closed.started
2024-10-15 11:02:55,247 - DEBUG - response_closed.complete
2024-10-15 11:02:55,247 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 08:02:55 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '938', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9997', 'x-ratelimit-remaining-tokens': '9821', 'x-ratelimit-reset-requests': '23.171s', 'x-ratelimit-reset-tokens': '1.074s', 'x-request-id': 'req_d95c5b2882793c5b85fab266f5a81fee', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e4a244f996241-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 11:02:55,247 - DEBUG - request_id: req_d95c5b2882793c5b85fab266f5a81fee
2024-10-15 11:02:55,248 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWo3Nf7XbCpGhPUPqs8tMyadc76o', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_hhbLpe5pgMCKWYxf4MSKx6rk', function=Function(arguments='\n{\n"action": "identify_parties"\n}', name='AgentAction'), type='function')]))], created=1728979375, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=11, prompt_tokens=207, total_tokens=218, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 11:02:55,251 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.ContractParties'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Identify the buyer and seller from the given information:\n\nName: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'properties': {'buyer': {'description': 'Name of the buyer', 'title': 'Buyer', 'type': 'string'}, 'seller': {'description': 'Name of the seller', 'title': 'Seller', 'type': 'string'}}, 'required': ['buyer', 'seller'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}}
2024-10-15 11:02:55,251 - DEBUG - max_retries: 1
2024-10-15 11:02:55,252 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Identify the buyer and seller from the given information:\n\nName: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}, 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'properties': {'buyer': {'description': 'Name of the buyer', 'title': 'Buyer', 'type': 'string'}, 'seller': {'description': 'Name of the seller', 'title': 'Seller', 'type': 'string'}}, 'required': ['buyer', 'seller'], 'type': 'object'}}}]}}
2024-10-15 11:02:55,253 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 11:02:55,253 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 11:02:55,253 - DEBUG - send_request_headers.complete
2024-10-15 11:02:55,253 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 11:02:55,253 - DEBUG - send_request_body.complete
2024-10-15 11:02:55,253 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 11:02:57,731 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 08:02:58 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2318'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9996'), (b'x-ratelimit-remaining-tokens', b'9799'), (b'x-ratelimit-reset-requests', b'30.711s'), (b'x-ratelimit-reset-tokens', b'1.204s'), (b'x-request-id', b'req_e42643e54d9a76baa9399eda3565a596'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e4a2b3cf66241-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 11:02:57,732 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 11:02:57,732 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 11:02:57,733 - DEBUG - receive_response_body.complete
2024-10-15 11:02:57,733 - DEBUG - response_closed.started
2024-10-15 11:02:57,733 - DEBUG - response_closed.complete
2024-10-15 11:02:57,733 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 08:02:58 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '2318', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9996', 'x-ratelimit-remaining-tokens': '9799', 'x-ratelimit-reset-requests': '30.711s', 'x-ratelimit-reset-tokens': '1.204s', 'x-request-id': 'req_e42643e54d9a76baa9399eda3565a596', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e4a2b3cf66241-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 11:02:57,734 - DEBUG - request_id: req_e42643e54d9a76baa9399eda3565a596
2024-10-15 11:02:57,735 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWo4me72UsL01D9YVndOdFvKLPq7', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_d7enpfVZVgjBvOOw8ffemtZy', function=Function(arguments='{\n"buyer": "ISPILANTE SENTIMENT BRUSLI",\n"seller": "ELENA VASILESCU"\n}', name='ContractParties'), type='function')]))], created=1728979376, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=28, prompt_tokens=232, total_tokens=260, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 11:02:57,738 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: Yes\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 11:02:57,738 - DEBUG - max_retries: 1
2024-10-15 11:02:57,740 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: Yes\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 11:02:57,740 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 11:02:57,741 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 11:02:57,741 - DEBUG - send_request_headers.complete
2024-10-15 11:02:57,741 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 11:02:57,741 - DEBUG - send_request_body.complete
2024-10-15 11:02:57,741 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 11:02:58,852 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 08:02:59 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'954'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9995'), (b'x-ratelimit-remaining-tokens', b'9753'), (b'x-ratelimit-reset-requests', b'36.859s'), (b'x-ratelimit-reset-tokens', b'1.477s'), (b'x-request-id', b'req_861c048486af60281d822617ac7ec779'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e4a3ab9796241-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 11:02:58,852 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 11:02:58,852 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 11:02:58,852 - DEBUG - receive_response_body.complete
2024-10-15 11:02:58,852 - DEBUG - response_closed.started
2024-10-15 11:02:58,852 - DEBUG - response_closed.complete
2024-10-15 11:02:58,852 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 08:02:59 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '954', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9995', 'x-ratelimit-remaining-tokens': '9753', 'x-ratelimit-reset-requests': '36.859s', 'x-ratelimit-reset-tokens': '1.477s', 'x-request-id': 'req_861c048486af60281d822617ac7ec779', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e4a3ab9796241-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 11:02:58,853 - DEBUG - request_id: req_861c048486af60281d822617ac7ec779
2024-10-15 11:02:58,853 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWo6g5eTBKBSZQTG57CtpjNYmIbn', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_4USG5VNT8eGEN3QAXfa6QuXe', function=Function(arguments='{\n    "action": "determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728979378, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=12, prompt_tokens=207, total_tokens=219, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 11:03:01,933 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.ContractDetails'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Assign roles: 'host' and 'guest'. Participants: ISPILANTE SENTIMENT BRUSLI (buyer) and ELENA VASILESCU (seller)."}], 'tools': [{'type': 'function', 'function': {'name': 'ContractDetails', 'description': 'Correctly extracted `ContractDetails` with all the required parameters with correct types', 'parameters': {'properties': {'contract_type': {'description': 'Type of contract (e.g., airbnb, buy-sell, it-consulting)', 'title': 'Contract Type', 'type': 'string'}, 'additional_info': {'additionalProperties': {'type': 'string'}, 'description': 'Additional information specific to the contract type', 'title': 'Additional Info', 'type': 'object'}}, 'required': ['additional_info', 'contract_type'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'ContractDetails'}}}
2024-10-15 11:03:01,933 - DEBUG - max_retries: 1
2024-10-15 11:03:01,935 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Assign roles: 'host' and 'guest'. Participants: ISPILANTE SENTIMENT BRUSLI (buyer) and ELENA VASILESCU (seller)."}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'ContractDetails'}}, 'tools': [{'type': 'function', 'function': {'name': 'ContractDetails', 'description': 'Correctly extracted `ContractDetails` with all the required parameters with correct types', 'parameters': {'properties': {'contract_type': {'description': 'Type of contract (e.g., airbnb, buy-sell, it-consulting)', 'title': 'Contract Type', 'type': 'string'}, 'additional_info': {'additionalProperties': {'type': 'string'}, 'description': 'Additional information specific to the contract type', 'title': 'Additional Info', 'type': 'object'}}, 'required': ['additional_info', 'contract_type'], 'type': 'object'}}}]}}
2024-10-15 11:03:01,935 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 11:03:01,936 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 11:03:01,936 - DEBUG - send_request_headers.complete
2024-10-15 11:03:01,936 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 11:03:01,936 - DEBUG - send_request_body.complete
2024-10-15 11:03:01,936 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 11:03:03,353 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 08:03:03 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1260'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9995'), (b'x-ratelimit-remaining-tokens', b'9864'), (b'x-ratelimit-reset-requests', b'41.314s'), (b'x-ratelimit-reset-tokens', b'816ms'), (b'x-request-id', b'req_232b532e5fd08eb805fb390af04065ae'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e4a54ff716241-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 11:03:03,354 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 11:03:03,355 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 11:03:03,355 - DEBUG - receive_response_body.complete
2024-10-15 11:03:03,355 - DEBUG - response_closed.started
2024-10-15 11:03:03,355 - DEBUG - response_closed.complete
2024-10-15 11:03:03,355 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 08:03:03 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1260', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9995', 'x-ratelimit-remaining-tokens': '9864', 'x-ratelimit-reset-requests': '41.314s', 'x-ratelimit-reset-tokens': '816ms', 'x-request-id': 'req_232b532e5fd08eb805fb390af04065ae', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e4a54ff716241-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 11:03:03,356 - DEBUG - request_id: req_232b532e5fd08eb805fb390af04065ae
2024-10-15 11:03:03,356 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWoAszEEECKRROCYBsK9M3S4ZCYs', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_hQD5Ug6cKu7nI4u8S1WpHb8D', function=Function(arguments='{\n"contract_type": "buy-sell"\n}', name='ContractDetails'), type='function')]))], created=1728979382, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=11, prompt_tokens=190, total_tokens=201, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 11:03:03,357 - ERROR - Error in determine_contract_details: No roles assigned in the API response
2024-10-15 11:03:03,520 - DEBUG - close.started
2024-10-15 11:03:03,521 - DEBUG - close.complete
2024-10-15 11:04:43,339 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-15 11:04:44,582 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-15 11:04:44,583 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-15 11:04:44,902 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-15 11:04:44,902 - DEBUG - Using proactor: IocpProactor
2024-10-15 11:04:44,921 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 11:04:44,921 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 11:04:44,921 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 11:04:44,921 - DEBUG - Compression method 0
2024-10-15 11:04:44,921 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 11:04:44,921 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 11:04:44,921 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 11:04:44,922 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 11:04:44,922 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 11:04:44,922 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 11:04:44,922 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 11:04:44,922 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 11:04:44,922 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 11:04:44,922 - DEBUG - Compression method 0
2024-10-15 11:04:44,922 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 11:04:44,922 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 11:04:44,922 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 11:04:44,922 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 11:04:44,922 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 11:04:44,922 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 11:04:44,931 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 11:04:44,931 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 11:04:44,931 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 11:04:44,931 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 11:04:44,932 - DEBUG - Error closing: Operation on closed image
2024-10-15 11:04:46,937 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 11:04:46,937 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 11:04:46,937 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 11:04:46,937 - DEBUG - Compression method 0
2024-10-15 11:04:46,937 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 11:04:46,937 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 11:04:46,937 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 11:04:46,937 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 11:04:46,937 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 11:04:46,937 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 11:04:46,937 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 11:04:46,937 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 11:04:46,937 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 11:04:46,937 - DEBUG - Compression method 0
2024-10-15 11:04:46,937 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 11:04:46,937 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 11:04:46,937 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 11:04:46,937 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 11:04:46,937 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 11:04:46,937 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 11:04:46,954 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 11:04:46,955 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 11:04:46,955 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 11:04:46,955 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 11:04:46,955 - DEBUG - Error closing: Operation on closed image
2024-10-15 11:04:49,456 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 0 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 11:04:49,457 - DEBUG - max_retries: 1
2024-10-15 11:04:49,459 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 0 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 11:04:49,501 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 11:04:49,501 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-15 11:04:49,574 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001BF386CFE30>
2024-10-15 11:04:49,574 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x000001BF3853E750> server_hostname='api.openai.com' timeout=5.0
2024-10-15 11:04:49,580 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001BF3844B380>
2024-10-15 11:04:49,581 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 11:04:49,581 - DEBUG - send_request_headers.complete
2024-10-15 11:04:49,581 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 11:04:49,581 - DEBUG - send_request_body.complete
2024-10-15 11:04:49,581 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 11:04:51,224 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 08:04:51 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1478'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'9821'), (b'x-ratelimit-reset-requests', b'8.64s'), (b'x-ratelimit-reset-tokens', b'1.074s'), (b'x-request-id', b'req_ba0003ca5ad68f5665d321227dfa6d0b'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=CnJ5TARas7GjMtBKI5bwFdzCO.0VfGH6wKN1b.uLmMc-1728979491-1.0.1.1-NUzPcfVbAp9A7QgN8FJ..Bpfi8ZLUdAFsyiM3qcB2CvMLV_x6TMLJmovhb9BcJto8nDQ21C.wfcm.kOA97F29g; path=/; expires=Tue, 15-Oct-24 08:34:51 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=v5AvXfarBVgO27tHR9IvQ9jYfT8O0wPVxXLOFCWXAOA-1728979491825-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e4cf5acb7c9d4-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 11:04:51,226 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 11:04:51,227 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 11:04:51,228 - DEBUG - receive_response_body.complete
2024-10-15 11:04:51,228 - DEBUG - response_closed.started
2024-10-15 11:04:51,228 - DEBUG - response_closed.complete
2024-10-15 11:04:51,228 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Tue, 15 Oct 2024 08:04:51 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-kzzh9hik9ryjiou4ftvhondh'), ('openai-processing-ms', '1478'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '10000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '9821'), ('x-ratelimit-reset-requests', '8.64s'), ('x-ratelimit-reset-tokens', '1.074s'), ('x-request-id', 'req_ba0003ca5ad68f5665d321227dfa6d0b'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=CnJ5TARas7GjMtBKI5bwFdzCO.0VfGH6wKN1b.uLmMc-1728979491-1.0.1.1-NUzPcfVbAp9A7QgN8FJ..Bpfi8ZLUdAFsyiM3qcB2CvMLV_x6TMLJmovhb9BcJto8nDQ21C.wfcm.kOA97F29g; path=/; expires=Tue, 15-Oct-24 08:34:51 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=v5AvXfarBVgO27tHR9IvQ9jYfT8O0wPVxXLOFCWXAOA-1728979491825-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d2e4cf5acb7c9d4-OTP'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-15 11:04:51,229 - DEBUG - request_id: req_ba0003ca5ad68f5665d321227dfa6d0b
2024-10-15 11:04:51,233 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWpuF86WMpxCZpThvKpigDxPORuY', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_2W1ZCONYuO95PQIF6kAsoMJ8', function=Function(arguments='{\n"action": "extract_pii"\n}', name='AgentAction'), type='function')]))], created=1728979490, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=10, prompt_tokens=207, total_tokens=217, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 11:04:51,234 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.PIIData'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}}
2024-10-15 11:04:51,234 - DEBUG - max_retries: 1
2024-10-15 11:04:51,236 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}, 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}]}}
2024-10-15 11:04:51,236 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 11:04:51,236 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 11:04:51,237 - DEBUG - send_request_headers.complete
2024-10-15 11:04:51,237 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 11:04:51,237 - DEBUG - send_request_body.complete
2024-10-15 11:04:51,237 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 11:04:54,700 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 08:04:55 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'3299'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9998'), (b'x-ratelimit-remaining-tokens', b'9724'), (b'x-ratelimit-reset-requests', b'15.621s'), (b'x-ratelimit-reset-tokens', b'1.655s'), (b'x-request-id', b'req_453671effcdd6d605a7954c34f9013fd'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e4d000f92c9d4-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 11:04:54,701 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 11:04:54,701 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 11:04:54,702 - DEBUG - receive_response_body.complete
2024-10-15 11:04:54,702 - DEBUG - response_closed.started
2024-10-15 11:04:54,702 - DEBUG - response_closed.complete
2024-10-15 11:04:54,703 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 08:04:55 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '3299', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9998', 'x-ratelimit-remaining-tokens': '9724', 'x-ratelimit-reset-requests': '15.621s', 'x-ratelimit-reset-tokens': '1.655s', 'x-request-id': 'req_453671effcdd6d605a7954c34f9013fd', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e4d000f92c9d4-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 11:04:54,703 - DEBUG - request_id: req_453671effcdd6d605a7954c34f9013fd
2024-10-15 11:04:54,704 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWpwRhg504ZazNKyRMJx3sI0kTfZ', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_S101h1I32W4AJMHm7ZLCQ1OM', function=Function(arguments='{\n"name": "ISPILANTE SENTIMENT BRUSLI",\n"address": "Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR"\n}', name='PIIData'), type='function')]))], created=1728979492, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=39, prompt_tokens=377, total_tokens=416, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 11:04:57,502 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.PIIData'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}}
2024-10-15 11:04:57,502 - DEBUG - max_retries: 1
2024-10-15 11:04:57,504 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract the name and address from the given text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'PIIData'}}, 'tools': [{'type': 'function', 'function': {'name': 'PIIData', 'description': 'Correctly extracted `PIIData` with all the required parameters with correct types', 'parameters': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['address', 'name'], 'type': 'object'}}}]}}
2024-10-15 11:04:57,504 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 11:04:57,505 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 11:04:57,505 - DEBUG - send_request_headers.complete
2024-10-15 11:04:57,505 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 11:04:57,505 - DEBUG - send_request_body.complete
2024-10-15 11:04:57,505 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 11:05:00,289 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 08:05:00 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2635'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9997'), (b'x-ratelimit-remaining-tokens', b'9742'), (b'x-ratelimit-reset-requests', b'18.003s'), (b'x-ratelimit-reset-tokens', b'1.548s'), (b'x-request-id', b'req_f0122afee924773bedda62de04961d51'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e4d273b16c9d4-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 11:05:00,290 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 11:05:00,290 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 11:05:00,290 - DEBUG - receive_response_body.complete
2024-10-15 11:05:00,291 - DEBUG - response_closed.started
2024-10-15 11:05:00,291 - DEBUG - response_closed.complete
2024-10-15 11:05:00,291 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 08:05:00 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '2635', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9997', 'x-ratelimit-remaining-tokens': '9742', 'x-ratelimit-reset-requests': '18.003s', 'x-ratelimit-reset-tokens': '1.548s', 'x-request-id': 'req_f0122afee924773bedda62de04961d51', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e4d273b16c9d4-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 11:05:00,291 - DEBUG - request_id: req_f0122afee924773bedda62de04961d51
2024-10-15 11:05:00,292 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWq20mjrffAYnW56SyxXF8thyNMI', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_xoTQct1KVChokj5udGod0RMy', function=Function(arguments='{\n  "name": "ELENA VASILESCU",\n  "address": "Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B"\n}', name='PIIData'), type='function')]))], created=1728979498, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=45, prompt_tokens=380, total_tokens=425, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 11:05:01,506 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 11:05:01,506 - DEBUG - max_retries: 1
2024-10-15 11:05:01,508 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 11:05:01,508 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 11:05:01,508 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 11:05:01,509 - DEBUG - send_request_headers.complete
2024-10-15 11:05:01,509 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 11:05:01,509 - DEBUG - send_request_body.complete
2024-10-15 11:05:01,509 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 11:05:02,706 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 08:05:03 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'793'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9997'), (b'x-ratelimit-remaining-tokens', b'9821'), (b'x-ratelimit-reset-requests', b'22.38s'), (b'x-ratelimit-reset-tokens', b'1.074s'), (b'x-request-id', b'req_5141c98c80b55932ec07a6394decf07c'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e4d403edec9d4-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 11:05:02,706 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 11:05:02,707 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 11:05:02,707 - DEBUG - receive_response_body.complete
2024-10-15 11:05:02,707 - DEBUG - response_closed.started
2024-10-15 11:05:02,707 - DEBUG - response_closed.complete
2024-10-15 11:05:02,707 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 08:05:03 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '793', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9997', 'x-ratelimit-remaining-tokens': '9821', 'x-ratelimit-reset-requests': '22.38s', 'x-ratelimit-reset-tokens': '1.074s', 'x-request-id': 'req_5141c98c80b55932ec07a6394decf07c', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e4d403edec9d4-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 11:05:02,707 - DEBUG - request_id: req_5141c98c80b55932ec07a6394decf07c
2024-10-15 11:05:02,708 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWq6TsWQN5LIrwgiXJKKUSYAzLOH', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_3TB6OUf8By0cATU5rNseu6b4', function=Function(arguments='{\n"action": "identify_parties"\n}', name='AgentAction'), type='function')]))], created=1728979502, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=10, prompt_tokens=207, total_tokens=217, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 11:05:02,709 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.ContractParties'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Identify the buyer and seller from the given information:\n\nName: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'properties': {'buyer': {'description': 'Name of the buyer', 'title': 'Buyer', 'type': 'string'}, 'seller': {'description': 'Name of the seller', 'title': 'Seller', 'type': 'string'}}, 'required': ['buyer', 'seller'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}}
2024-10-15 11:05:02,709 - DEBUG - max_retries: 1
2024-10-15 11:05:02,711 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': 'Identify the buyer and seller from the given information:\n\nName: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}, 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'properties': {'buyer': {'description': 'Name of the buyer', 'title': 'Buyer', 'type': 'string'}, 'seller': {'description': 'Name of the seller', 'title': 'Seller', 'type': 'string'}}, 'required': ['buyer', 'seller'], 'type': 'object'}}}]}}
2024-10-15 11:05:02,711 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 11:05:02,711 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 11:05:02,711 - DEBUG - send_request_headers.complete
2024-10-15 11:05:02,711 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 11:05:02,712 - DEBUG - send_request_body.complete
2024-10-15 11:05:02,712 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 11:05:05,090 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 08:05:05 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2218'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9996'), (b'x-ratelimit-remaining-tokens', b'9776'), (b'x-ratelimit-reset-requests', b'30.065s'), (b'x-ratelimit-reset-tokens', b'1.342s'), (b'x-request-id', b'req_68b12238bffe5fd7042510fed05db819'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e4d47ba38c9d4-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 11:05:05,090 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 11:05:05,090 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 11:05:05,090 - DEBUG - receive_response_body.complete
2024-10-15 11:05:05,090 - DEBUG - response_closed.started
2024-10-15 11:05:05,090 - DEBUG - response_closed.complete
2024-10-15 11:05:05,090 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 08:05:05 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '2218', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9996', 'x-ratelimit-remaining-tokens': '9776', 'x-ratelimit-reset-requests': '30.065s', 'x-ratelimit-reset-tokens': '1.342s', 'x-request-id': 'req_68b12238bffe5fd7042510fed05db819', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e4d47ba38c9d4-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 11:05:05,090 - DEBUG - request_id: req_68b12238bffe5fd7042510fed05db819
2024-10-15 11:05:05,091 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWq7aK0YvXhWliA6S3GWqaaPqsHI', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_PZOg53mltHszhelsE93x8jsS', function=Function(arguments='{\n"buyer": "ISPILANTE SENTIMENT BRUSLI",\n"seller": "ELENA VASILESCU"\n}', name='ContractParties'), type='function')]))], created=1728979503, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=28, prompt_tokens=232, total_tokens=260, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 11:05:05,092 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: Yes\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 11:05:05,092 - DEBUG - max_retries: 1
2024-10-15 11:05:05,093 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: Yes\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 11:05:05,094 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 11:05:05,094 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 11:05:05,094 - DEBUG - send_request_headers.complete
2024-10-15 11:05:05,094 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 11:05:05,094 - DEBUG - send_request_body.complete
2024-10-15 11:05:05,094 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 11:05:06,593 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 08:05:07 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1317'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9995'), (b'x-ratelimit-remaining-tokens', b'9750'), (b'x-ratelimit-reset-requests', b'36.33s'), (b'x-ratelimit-reset-tokens', b'1.494s'), (b'x-request-id', b'req_832166485d7d7b0c3e4f16882b635399'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e4d569d5ac9d4-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 11:05:06,594 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 11:05:06,594 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 11:05:06,595 - DEBUG - receive_response_body.complete
2024-10-15 11:05:06,595 - DEBUG - response_closed.started
2024-10-15 11:05:06,595 - DEBUG - response_closed.complete
2024-10-15 11:05:06,595 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 08:05:07 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1317', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9995', 'x-ratelimit-remaining-tokens': '9750', 'x-ratelimit-reset-requests': '36.33s', 'x-ratelimit-reset-tokens': '1.494s', 'x-request-id': 'req_832166485d7d7b0c3e4f16882b635399', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e4d569d5ac9d4-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 11:05:06,596 - DEBUG - request_id: req_832166485d7d7b0c3e4f16882b635399
2024-10-15 11:05:06,597 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWqAgttjhxBRFGmAtAET3QoFrdlw', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_RRnYunaWb0kGTb5JmgXdbZlg', function=Function(arguments='\n{\n"action": "determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728979506, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=12, prompt_tokens=207, total_tokens=219, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 11:05:09,139 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.ContractDetails'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Assign roles: 'host' and 'guest'. Participants: ISPILANTE SENTIMENT BRUSLI (buyer) and ELENA VASILESCU (seller)."}], 'tools': [{'type': 'function', 'function': {'name': 'ContractDetails', 'description': 'Correctly extracted `ContractDetails` with all the required parameters with correct types', 'parameters': {'properties': {'contract_type': {'description': 'Type of contract (e.g., airbnb, buy-sell, it-consulting)', 'title': 'Contract Type', 'type': 'string'}, 'additional_info': {'additionalProperties': {'type': 'string'}, 'description': 'Additional information specific to the contract type', 'title': 'Additional Info', 'type': 'object'}}, 'required': ['additional_info', 'contract_type'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'ContractDetails'}}}
2024-10-15 11:05:09,140 - DEBUG - max_retries: 1
2024-10-15 11:05:09,142 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Assign roles: 'host' and 'guest'. Participants: ISPILANTE SENTIMENT BRUSLI (buyer) and ELENA VASILESCU (seller)."}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'ContractDetails'}}, 'tools': [{'type': 'function', 'function': {'name': 'ContractDetails', 'description': 'Correctly extracted `ContractDetails` with all the required parameters with correct types', 'parameters': {'properties': {'contract_type': {'description': 'Type of contract (e.g., airbnb, buy-sell, it-consulting)', 'title': 'Contract Type', 'type': 'string'}, 'additional_info': {'additionalProperties': {'type': 'string'}, 'description': 'Additional information specific to the contract type', 'title': 'Additional Info', 'type': 'object'}}, 'required': ['additional_info', 'contract_type'], 'type': 'object'}}}]}}
2024-10-15 11:05:09,142 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 11:05:09,142 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 11:05:09,143 - DEBUG - send_request_headers.complete
2024-10-15 11:05:09,143 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 11:05:09,143 - DEBUG - send_request_body.complete
2024-10-15 11:05:09,143 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 11:05:10,310 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 08:05:10 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1007'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9995'), (b'x-ratelimit-remaining-tokens', b'9864'), (b'x-ratelimit-reset-requests', b'40.911s'), (b'x-ratelimit-reset-tokens', b'816ms'), (b'x-request-id', b'req_44824d31993e34df7d00844a4ca51740'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e4d6fea85c9d4-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 11:05:10,311 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 11:05:10,311 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 11:05:10,312 - DEBUG - receive_response_body.complete
2024-10-15 11:05:10,312 - DEBUG - response_closed.started
2024-10-15 11:05:10,312 - DEBUG - response_closed.complete
2024-10-15 11:05:10,312 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 08:05:10 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1007', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9995', 'x-ratelimit-remaining-tokens': '9864', 'x-ratelimit-reset-requests': '40.911s', 'x-ratelimit-reset-tokens': '816ms', 'x-request-id': 'req_44824d31993e34df7d00844a4ca51740', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e4d6fea85c9d4-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 11:05:10,313 - DEBUG - request_id: req_44824d31993e34df7d00844a4ca51740
2024-10-15 11:05:10,314 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWqDRT22fIe0HkUFPHVYCEJ8V7yC', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_paw4v4GX8G8ozO4gWFCJQeSi', function=Function(arguments='{\n  "contract_type": "buy-sell"\n}', name='ContractDetails'), type='function')]))], created=1728979509, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=12, prompt_tokens=190, total_tokens=202, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 11:05:10,315 - ERROR - Error in determine_contract_details: No roles assigned in the API response
2024-10-15 11:05:10,472 - DEBUG - close.started
2024-10-15 11:05:10,472 - DEBUG - close.complete
2024-10-15 11:05:33,849 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-15 11:05:35,122 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-15 11:05:35,122 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-15 11:05:35,444 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-15 11:05:35,445 - DEBUG - Using proactor: IocpProactor
2024-10-15 11:05:35,464 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 11:05:35,464 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 11:05:35,464 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 11:05:35,464 - DEBUG - Compression method 0
2024-10-15 11:05:35,464 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 11:05:35,464 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 11:05:35,464 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 11:05:35,465 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 11:05:35,465 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 11:05:35,465 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 11:05:35,465 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 11:05:35,465 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 11:05:35,465 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 11:05:35,465 - DEBUG - Compression method 0
2024-10-15 11:05:35,465 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 11:05:35,465 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 11:05:35,465 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 11:05:35,465 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 11:05:35,465 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 11:05:35,465 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 11:05:35,474 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 11:05:35,474 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 11:05:35,474 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 11:05:35,474 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 11:05:35,475 - DEBUG - Error closing: Operation on closed image
2024-10-15 11:05:37,522 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 11:05:37,522 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 11:05:37,522 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 11:05:37,522 - DEBUG - Compression method 0
2024-10-15 11:05:37,522 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 11:05:37,522 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 11:05:37,522 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 11:05:37,522 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 11:05:37,522 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 11:05:37,522 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 11:05:37,522 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 11:05:37,522 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 11:05:37,522 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 11:05:37,522 - DEBUG - Compression method 0
2024-10-15 11:05:37,522 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 11:05:37,522 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 11:05:37,522 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 11:05:37,522 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 11:05:37,523 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 11:05:37,523 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 11:05:37,540 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 11:05:37,540 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 11:05:37,540 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 11:05:37,540 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 11:05:37,540 - DEBUG - Error closing: Operation on closed image
2024-10-15 11:05:40,028 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 0 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 11:05:40,029 - DEBUG - max_retries: 1
2024-10-15 11:05:40,031 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 0 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 11:05:40,070 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 11:05:40,070 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-15 11:05:40,100 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x00000274B995FF20>
2024-10-15 11:05:40,100 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x00000274B97CE7D0> server_hostname='api.openai.com' timeout=5.0
2024-10-15 11:05:40,109 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x00000274B995FE60>
2024-10-15 11:05:40,110 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 11:05:40,110 - DEBUG - send_request_headers.complete
2024-10-15 11:05:40,110 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 11:05:40,110 - DEBUG - send_request_body.complete
2024-10-15 11:05:40,110 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 11:05:41,701 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 08:05:42 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1432'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9997'), (b'x-ratelimit-remaining-tokens', b'9821'), (b'x-ratelimit-reset-requests', b'18.59s'), (b'x-ratelimit-reset-tokens', b'1.074s'), (b'x-request-id', b'req_53d9fecaf27bba25a9c321d96c4e25a6'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=gh3N2yGLWIldxNX3hA8uYbOLlTCNFEhhezIRir38dqM-1728979542-1.0.1.1-iHISvCjRSgIPwyKvVRB6vjkbAfcugw_3kNWi_n4iFxjdEo1NOlCpJLO4YrJUiExqyJ6YJzhnzFWIoa5_Gx9I7A; path=/; expires=Tue, 15-Oct-24 08:35:42 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=03uqfgA5lhMYJTDgntq1.EkrwXoAj5DOLWhi0QUv9j0-1728979542299-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e4e317af4623b-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 11:05:41,703 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 11:05:41,704 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 11:05:41,704 - DEBUG - receive_response_body.complete
2024-10-15 11:05:41,705 - DEBUG - response_closed.started
2024-10-15 11:05:41,705 - DEBUG - response_closed.complete
2024-10-15 11:05:41,705 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Tue, 15 Oct 2024 08:05:42 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-kzzh9hik9ryjiou4ftvhondh'), ('openai-processing-ms', '1432'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '10000'), ('x-ratelimit-remaining-requests', '9997'), ('x-ratelimit-remaining-tokens', '9821'), ('x-ratelimit-reset-requests', '18.59s'), ('x-ratelimit-reset-tokens', '1.074s'), ('x-request-id', 'req_53d9fecaf27bba25a9c321d96c4e25a6'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=gh3N2yGLWIldxNX3hA8uYbOLlTCNFEhhezIRir38dqM-1728979542-1.0.1.1-iHISvCjRSgIPwyKvVRB6vjkbAfcugw_3kNWi_n4iFxjdEo1NOlCpJLO4YrJUiExqyJ6YJzhnzFWIoa5_Gx9I7A; path=/; expires=Tue, 15-Oct-24 08:35:42 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=03uqfgA5lhMYJTDgntq1.EkrwXoAj5DOLWhi0QUv9j0-1728979542299-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d2e4e317af4623b-OTP'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-15 11:05:41,705 - DEBUG - request_id: req_53d9fecaf27bba25a9c321d96c4e25a6
2024-10-15 11:05:41,708 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWqjymtqhF5RV3ee6vRUNyU6w0Xk', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_QyT9HT1HSw7FK8FJdivft7Dh', function=Function(arguments='{\n"action": "extract_pii"\n}', name='AgentAction'), type='function')]))], created=1728979541, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=10, prompt_tokens=207, total_tokens=217, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 11:05:41,710 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'instructor.dsl.simple_type.Response'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}}
2024-10-15 11:05:41,710 - DEBUG - max_retries: 1
2024-10-15 11:05:41,712 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}, 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}]}}
2024-10-15 11:05:41,712 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 11:05:41,712 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 11:05:41,712 - DEBUG - send_request_headers.complete
2024-10-15 11:05:41,713 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 11:05:41,713 - DEBUG - send_request_body.complete
2024-10-15 11:05:41,713 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 11:05:45,849 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 08:05:46 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'3972'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9997'), (b'x-ratelimit-remaining-tokens', b'9719'), (b'x-ratelimit-reset-requests', b'25.628s'), (b'x-ratelimit-reset-tokens', b'1.683s'), (b'x-request-id', b'req_a96d8e55351a0df1942daad9a800abe0'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e4e3b7a62623b-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 11:05:45,850 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 11:05:45,850 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 11:05:45,850 - DEBUG - receive_response_body.complete
2024-10-15 11:05:45,850 - DEBUG - response_closed.started
2024-10-15 11:05:45,850 - DEBUG - response_closed.complete
2024-10-15 11:05:45,850 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 08:05:46 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '3972', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9997', 'x-ratelimit-remaining-tokens': '9719', 'x-ratelimit-reset-requests': '25.628s', 'x-ratelimit-reset-tokens': '1.683s', 'x-request-id': 'req_a96d8e55351a0df1942daad9a800abe0', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e4e3b7a62623b-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 11:05:45,850 - DEBUG - request_id: req_a96d8e55351a0df1942daad9a800abe0
2024-10-15 11:05:45,851 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWqkWMc5fMPbMFCKKaLaq51VxuMS', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_OES9RScUbtVIvrrWDnGVajBb', function=Function(arguments='{\n  "content": [\n    {\n      "name": "T525M ISPILANTE SENTIMENT BRUSLI",\n      "address": "Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR"\n    }\n  ]\n}', name='Response'), type='function')]))], created=1728979542, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=56, prompt_tokens=360, total_tokens=416, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 11:05:45,851 - DEBUG - Returning model from AdapterBase
2024-10-15 11:05:45,998 - DEBUG - close.started
2024-10-15 11:05:45,999 - DEBUG - close.complete
2024-10-15 11:06:51,539 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-15 11:06:52,793 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-15 11:06:52,794 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-15 11:06:53,121 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-15 11:06:53,122 - DEBUG - Using proactor: IocpProactor
2024-10-15 11:06:53,142 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 11:06:53,142 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 11:06:53,142 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 11:06:53,142 - DEBUG - Compression method 0
2024-10-15 11:06:53,142 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 11:06:53,142 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 11:06:53,142 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 11:06:53,142 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 11:06:53,142 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 11:06:53,142 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 11:06:53,142 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 11:06:53,142 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 11:06:53,142 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 11:06:53,142 - DEBUG - Compression method 0
2024-10-15 11:06:53,142 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 11:06:53,142 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 11:06:53,142 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 11:06:53,142 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 11:06:53,142 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 11:06:53,142 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 11:06:53,152 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 11:06:53,152 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 11:06:53,152 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 11:06:53,152 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 11:06:53,152 - DEBUG - Error closing: Operation on closed image
2024-10-15 11:06:55,192 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 11:06:55,192 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 11:06:55,192 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 11:06:55,192 - DEBUG - Compression method 0
2024-10-15 11:06:55,192 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 11:06:55,192 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 11:06:55,192 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 11:06:55,192 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 11:06:55,192 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 11:06:55,192 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 11:06:55,192 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 11:06:55,192 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 11:06:55,192 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 11:06:55,192 - DEBUG - Compression method 0
2024-10-15 11:06:55,192 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 11:06:55,192 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 11:06:55,192 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 11:06:55,192 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 11:06:55,192 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 11:06:55,192 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 11:06:55,210 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 11:06:55,210 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 11:06:55,210 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 11:06:55,210 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 11:06:55,211 - DEBUG - Error closing: Operation on closed image
2024-10-15 11:06:57,853 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 0 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 11:06:57,854 - DEBUG - max_retries: 1
2024-10-15 11:06:57,855 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 0 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 11:06:57,903 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 11:06:57,904 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-15 11:06:57,916 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001CE21970110>
2024-10-15 11:06:57,916 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x000001CE215FE7D0> server_hostname='api.openai.com' timeout=5.0
2024-10-15 11:06:57,927 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001CE2178FFE0>
2024-10-15 11:06:57,927 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 11:06:57,927 - DEBUG - send_request_headers.complete
2024-10-15 11:06:57,927 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 11:06:57,927 - DEBUG - send_request_body.complete
2024-10-15 11:06:57,927 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 11:06:58,976 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 08:06:59 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'873'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'9821'), (b'x-ratelimit-reset-requests', b'8.64s'), (b'x-ratelimit-reset-tokens', b'1.074s'), (b'x-request-id', b'req_7550b0c213177d88d44226be7002f6dc'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=RAV01M1igC6vVRdKdWqIv1eZlPW6Z31KoezvqGJl6Xs-1728979619-1.0.1.1-VBT0XJspyHnEKTUtIzkZUtpBFkrekNNUE3tTb1oFfUfRez0TyQ5faYI13EITDiz80u3AGdo67IFFfOw5Q_adqA; path=/; expires=Tue, 15-Oct-24 08:36:59 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=nVVKAY0f3XSkpIwE0pWsaI43pnm4cf9YTK6udnFRkaA-1728979619566-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e5017cb070530-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 11:06:58,976 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 11:06:58,976 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 11:06:58,977 - DEBUG - receive_response_body.complete
2024-10-15 11:06:58,977 - DEBUG - response_closed.started
2024-10-15 11:06:58,977 - DEBUG - response_closed.complete
2024-10-15 11:06:58,977 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Tue, 15 Oct 2024 08:06:59 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-kzzh9hik9ryjiou4ftvhondh'), ('openai-processing-ms', '873'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '10000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '9821'), ('x-ratelimit-reset-requests', '8.64s'), ('x-ratelimit-reset-tokens', '1.074s'), ('x-request-id', 'req_7550b0c213177d88d44226be7002f6dc'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=RAV01M1igC6vVRdKdWqIv1eZlPW6Z31KoezvqGJl6Xs-1728979619-1.0.1.1-VBT0XJspyHnEKTUtIzkZUtpBFkrekNNUE3tTb1oFfUfRez0TyQ5faYI13EITDiz80u3AGdo67IFFfOw5Q_adqA; path=/; expires=Tue, 15-Oct-24 08:36:59 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=nVVKAY0f3XSkpIwE0pWsaI43pnm4cf9YTK6udnFRkaA-1728979619566-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d2e5017cb070530-OTP'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-15 11:06:58,977 - DEBUG - request_id: req_7550b0c213177d88d44226be7002f6dc
2024-10-15 11:06:58,979 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWryh5JcFZNq4bV5zSa2pXxcIINC', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_AyM99qr90PU3ThK4YsBg5FXG', function=Function(arguments='{\n"action": "extract_pii"\n}', name='AgentAction'), type='function')]))], created=1728979618, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=10, prompt_tokens=207, total_tokens=217, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 11:06:58,981 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'instructor.dsl.simple_type.Response'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}}
2024-10-15 11:06:58,981 - DEBUG - max_retries: 1
2024-10-15 11:06:58,983 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. \n\nYour role is:\n 1. Guide the process of extracting information from documents..\n 2. Verifying the extracted information with human input.\n 3. Identifying parties. \n 4. Constructing a contract. \n\n\nFollow the workflow precisely and ask for human input when needed.\n\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}, 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}]}}
2024-10-15 11:06:58,983 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 11:06:58,983 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 11:06:58,984 - DEBUG - send_request_headers.complete
2024-10-15 11:06:58,984 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 11:06:58,984 - DEBUG - send_request_body.complete
2024-10-15 11:06:58,984 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 11:07:02,214 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 08:07:02 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'3041'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9998'), (b'x-ratelimit-remaining-tokens', b'9692'), (b'x-ratelimit-reset-requests', b'16.212s'), (b'x-ratelimit-reset-tokens', b'1.842s'), (b'x-request-id', b'req_42717ef7bf7c13ea28c670bd76977c93'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e501e5a370530-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 11:07:02,215 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 11:07:02,215 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 11:07:02,215 - DEBUG - receive_response_body.complete
2024-10-15 11:07:02,215 - DEBUG - response_closed.started
2024-10-15 11:07:02,215 - DEBUG - response_closed.complete
2024-10-15 11:07:02,215 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 08:07:02 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '3041', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9998', 'x-ratelimit-remaining-tokens': '9692', 'x-ratelimit-reset-requests': '16.212s', 'x-ratelimit-reset-tokens': '1.842s', 'x-request-id': 'req_42717ef7bf7c13ea28c670bd76977c93', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e501e5a370530-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 11:07:02,215 - DEBUG - request_id: req_42717ef7bf7c13ea28c670bd76977c93
2024-10-15 11:07:02,215 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWrzrUT8oYRLcK3Kyn0XIzev4lUY', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_ypUcvTD80gX7FAWNW9oYS4qz', function=Function(arguments='{\n  "content": [\n    {\n      "name": "ISPILANTE SENTIMENT BRUSLI",\n      "address": "Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR"\n    }\n  ]\n}', name='Response'), type='function')]))], created=1728979619, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=53, prompt_tokens=360, total_tokens=413, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 11:07:02,216 - DEBUG - Returning model from AdapterBase
2024-10-15 11:07:02,366 - DEBUG - close.started
2024-10-15 11:07:02,367 - DEBUG - close.complete
2024-10-15 11:08:24,199 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-15 11:08:25,453 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-15 11:08:25,453 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-15 11:08:25,776 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-15 11:08:25,780 - DEBUG - Using proactor: IocpProactor
2024-10-15 11:08:25,797 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 11:08:25,798 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 11:08:25,798 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 11:08:25,798 - DEBUG - Compression method 0
2024-10-15 11:08:25,798 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 11:08:25,798 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 11:08:25,798 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 11:08:25,798 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 11:08:25,798 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 11:08:25,798 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 11:08:25,798 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 11:08:25,798 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 11:08:25,798 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 11:08:25,798 - DEBUG - Compression method 0
2024-10-15 11:08:25,798 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 11:08:25,798 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 11:08:25,798 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 11:08:25,798 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 11:08:25,798 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 11:08:25,798 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 11:08:25,807 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 11:08:25,808 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 11:08:25,808 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 11:08:25,808 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 11:08:25,808 - DEBUG - Error closing: Operation on closed image
2024-10-15 11:08:27,802 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 11:08:27,802 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 11:08:27,802 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 11:08:27,802 - DEBUG - Compression method 0
2024-10-15 11:08:27,802 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 11:08:27,802 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 11:08:27,802 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 11:08:27,802 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 11:08:27,802 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 11:08:27,802 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 11:08:27,802 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 11:08:27,803 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 11:08:27,803 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 11:08:27,803 - DEBUG - Compression method 0
2024-10-15 11:08:27,803 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 11:08:27,803 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 11:08:27,803 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 11:08:27,803 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 11:08:27,803 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 11:08:27,803 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 11:08:27,820 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 11:08:27,820 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 11:08:27,820 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 11:08:27,820 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 11:08:27,821 - DEBUG - Error closing: Operation on closed image
2024-10-15 11:08:30,314 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of:\n1. Extracting personal identifiable information (PII) from documents.\n2. Identifying parties and their roles in the contract.\n3. Determining contract details based on the type of contract.\n4. Constructing a contract using the provided information and templates.\n\nFor each task, provide a structured response that can be easily parsed into the appropriate data model. Always include all necessary information in your response, and format it as a valid JSON object.\n\nWhen extracting PII, identify the name and address of each person mentioned.\nWhen identifying parties, assign roles based on the contract type (e.g., buyer/seller, host/guest, consultant/client).\nWhen determining contract details, specify the contract type and any additional information relevant to that type of contract.\nWhen constructing a contract, use the provided template and fill in all necessary details.\n\nFollow the workflow precisely and indicate when human input or verification is needed.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 0 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 11:08:30,315 - DEBUG - max_retries: 1
2024-10-15 11:08:30,317 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of:\n1. Extracting personal identifiable information (PII) from documents.\n2. Identifying parties and their roles in the contract.\n3. Determining contract details based on the type of contract.\n4. Constructing a contract using the provided information and templates.\n\nFor each task, provide a structured response that can be easily parsed into the appropriate data model. Always include all necessary information in your response, and format it as a valid JSON object.\n\nWhen extracting PII, identify the name and address of each person mentioned.\nWhen identifying parties, assign roles based on the contract type (e.g., buyer/seller, host/guest, consultant/client).\nWhen determining contract details, specify the contract type and any additional information relevant to that type of contract.\nWhen constructing a contract, use the provided template and fill in all necessary details.\n\nFollow the workflow precisely and indicate when human input or verification is needed.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 0 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 11:08:30,354 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 11:08:30,354 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-15 11:08:30,382 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x0000022FD9BE0500>
2024-10-15 11:08:30,382 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x0000022FD979ECD0> server_hostname='api.openai.com' timeout=5.0
2024-10-15 11:08:30,391 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x0000022FD9BE0140>
2024-10-15 11:08:30,392 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 11:08:30,392 - DEBUG - send_request_headers.complete
2024-10-15 11:08:30,392 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 11:08:30,392 - DEBUG - send_request_body.complete
2024-10-15 11:08:30,392 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 11:08:32,507 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 08:08:33 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1939'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'9636'), (b'x-ratelimit-reset-requests', b'8.64s'), (b'x-ratelimit-reset-tokens', b'2.184s'), (b'x-request-id', b'req_05cd438d0dac842498e749a005721865'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=DbVZ8VenQT5uw513LJvBx_wc0jOPnr18zwhZrUt0mZ8-1728979713-1.0.1.1-hWdiZVdo5gtAce.0MgkFmAT7AJkHCyty8KA2k7m36v0t7ObgXq_WaYSd4t42dykRddvRbM_IZtkSjj4fmN7lag; path=/; expires=Tue, 15-Oct-24 08:38:33 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=2q6SCyiY1qPaXiN5JymP9ghun8ohAsAgK61BXTJhf3M-1728979713088-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e52599cefe0c5-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 11:08:32,509 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 11:08:32,510 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 11:08:32,510 - DEBUG - receive_response_body.complete
2024-10-15 11:08:32,511 - DEBUG - response_closed.started
2024-10-15 11:08:32,511 - DEBUG - response_closed.complete
2024-10-15 11:08:32,511 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Tue, 15 Oct 2024 08:08:33 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-kzzh9hik9ryjiou4ftvhondh'), ('openai-processing-ms', '1939'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '10000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '9636'), ('x-ratelimit-reset-requests', '8.64s'), ('x-ratelimit-reset-tokens', '2.184s'), ('x-request-id', 'req_05cd438d0dac842498e749a005721865'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=DbVZ8VenQT5uw513LJvBx_wc0jOPnr18zwhZrUt0mZ8-1728979713-1.0.1.1-hWdiZVdo5gtAce.0MgkFmAT7AJkHCyty8KA2k7m36v0t7ObgXq_WaYSd4t42dykRddvRbM_IZtkSjj4fmN7lag; path=/; expires=Tue, 15-Oct-24 08:38:33 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=2q6SCyiY1qPaXiN5JymP9ghun8ohAsAgK61BXTJhf3M-1728979713088-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d2e52599cefe0c5-OTP'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-15 11:08:32,511 - DEBUG - request_id: req_05cd438d0dac842498e749a005721865
2024-10-15 11:08:32,515 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWtTMmiHSVXfvXolaeifvL8HzCDm', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_hEVHdADGJ6Zca0n8Xd7tjofK', function=Function(arguments='\n{\n  "action": "extract_pii"\n}', name='AgentAction'), type='function')]))], created=1728979711, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=12, prompt_tokens=338, total_tokens=350, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 11:08:32,517 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'instructor.dsl.simple_type.Response'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of:\n1. Extracting personal identifiable information (PII) from documents.\n2. Identifying parties and their roles in the contract.\n3. Determining contract details based on the type of contract.\n4. Constructing a contract using the provided information and templates.\n\nFor each task, provide a structured response that can be easily parsed into the appropriate data model. Always include all necessary information in your response, and format it as a valid JSON object.\n\nWhen extracting PII, identify the name and address of each person mentioned.\nWhen identifying parties, assign roles based on the contract type (e.g., buyer/seller, host/guest, consultant/client).\nWhen determining contract details, specify the contract type and any additional information relevant to that type of contract.\nWhen constructing a contract, use the provided template and fill in all necessary details.\n\nFollow the workflow precisely and indicate when human input or verification is needed.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}}
2024-10-15 11:08:32,517 - DEBUG - max_retries: 1
2024-10-15 11:08:32,518 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of:\n1. Extracting personal identifiable information (PII) from documents.\n2. Identifying parties and their roles in the contract.\n3. Determining contract details based on the type of contract.\n4. Constructing a contract using the provided information and templates.\n\nFor each task, provide a structured response that can be easily parsed into the appropriate data model. Always include all necessary information in your response, and format it as a valid JSON object.\n\nWhen extracting PII, identify the name and address of each person mentioned.\nWhen identifying parties, assign roles based on the contract type (e.g., buyer/seller, host/guest, consultant/client).\nWhen determining contract details, specify the contract type and any additional information relevant to that type of contract.\nWhen constructing a contract, use the provided template and fill in all necessary details.\n\nFollow the workflow precisely and indicate when human input or verification is needed.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}, 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}]}}
2024-10-15 11:08:32,519 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 11:08:32,519 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 11:08:32,519 - DEBUG - send_request_headers.complete
2024-10-15 11:08:32,519 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 11:08:32,519 - DEBUG - send_request_body.complete
2024-10-15 11:08:32,519 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 11:08:36,543 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 08:08:37 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'3872'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9998'), (b'x-ratelimit-remaining-tokens', b'9547'), (b'x-ratelimit-reset-requests', b'15.179s'), (b'x-ratelimit-reset-tokens', b'2.718s'), (b'x-request-id', b'req_c27a8bfae6b62d1934d156a8faa463ca'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e5266eb76e0c5-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 11:08:36,544 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 11:08:36,544 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 11:08:36,544 - DEBUG - receive_response_body.complete
2024-10-15 11:08:36,544 - DEBUG - response_closed.started
2024-10-15 11:08:36,544 - DEBUG - response_closed.complete
2024-10-15 11:08:36,544 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 08:08:37 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '3872', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9998', 'x-ratelimit-remaining-tokens': '9547', 'x-ratelimit-reset-requests': '15.179s', 'x-ratelimit-reset-tokens': '2.718s', 'x-request-id': 'req_c27a8bfae6b62d1934d156a8faa463ca', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e5266eb76e0c5-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 11:08:36,544 - DEBUG - request_id: req_c27a8bfae6b62d1934d156a8faa463ca
2024-10-15 11:08:36,545 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWtVe4i1TQ4n7iseYy4OUOy65Hpi', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_3FW1thymIwxj6H4UKBPLYZ9Y', function=Function(arguments='{\n  "content": [{\n    "name": "ISPILANTE SENTIMENT BRUSLI",\n    "address": "Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR"\n  }]\n}', name='Response'), type='function')]))], created=1728979713, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=49, prompt_tokens=491, total_tokens=540, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 11:08:36,546 - DEBUG - Returning model from AdapterBase
2024-10-15 11:08:39,188 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'instructor.dsl.simple_type.Response'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of:\n1. Extracting personal identifiable information (PII) from documents.\n2. Identifying parties and their roles in the contract.\n3. Determining contract details based on the type of contract.\n4. Constructing a contract using the provided information and templates.\n\nFor each task, provide a structured response that can be easily parsed into the appropriate data model. Always include all necessary information in your response, and format it as a valid JSON object.\n\nWhen extracting PII, identify the name and address of each person mentioned.\nWhen identifying parties, assign roles based on the contract type (e.g., buyer/seller, host/guest, consultant/client).\nWhen determining contract details, specify the contract type and any additional information relevant to that type of contract.\nWhen constructing a contract, use the provided template and fill in all necessary details.\n\nFollow the workflow precisely and indicate when human input or verification is needed.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}}
2024-10-15 11:08:39,188 - DEBUG - max_retries: 1
2024-10-15 11:08:39,191 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of:\n1. Extracting personal identifiable information (PII) from documents.\n2. Identifying parties and their roles in the contract.\n3. Determining contract details based on the type of contract.\n4. Constructing a contract using the provided information and templates.\n\nFor each task, provide a structured response that can be easily parsed into the appropriate data model. Always include all necessary information in your response, and format it as a valid JSON object.\n\nWhen extracting PII, identify the name and address of each person mentioned.\nWhen identifying parties, assign roles based on the contract type (e.g., buyer/seller, host/guest, consultant/client).\nWhen determining contract details, specify the contract type and any additional information relevant to that type of contract.\nWhen constructing a contract, use the provided template and fill in all necessary details.\n\nFollow the workflow precisely and indicate when human input or verification is needed.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}, 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}]}}
2024-10-15 11:08:39,192 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 11:08:39,192 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 11:08:39,193 - DEBUG - send_request_headers.complete
2024-10-15 11:08:39,193 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 11:08:39,193 - DEBUG - send_request_body.complete
2024-10-15 11:08:39,193 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 11:08:43,409 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 08:08:43 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'4046'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9998'), (b'x-ratelimit-remaining-tokens', b'9553'), (b'x-ratelimit-reset-requests', b'17.137s'), (b'x-ratelimit-reset-tokens', b'2.682s'), (b'x-request-id', b'req_9cc40a77a2b37c1fefebb766d7cfd80e'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e52909a44e0c5-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 11:08:43,410 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 11:08:43,410 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 11:08:43,411 - DEBUG - receive_response_body.complete
2024-10-15 11:08:43,411 - DEBUG - response_closed.started
2024-10-15 11:08:43,411 - DEBUG - response_closed.complete
2024-10-15 11:08:43,411 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 08:08:43 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '4046', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9998', 'x-ratelimit-remaining-tokens': '9553', 'x-ratelimit-reset-requests': '17.137s', 'x-ratelimit-reset-tokens': '2.682s', 'x-request-id': 'req_9cc40a77a2b37c1fefebb766d7cfd80e', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e52909a44e0c5-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 11:08:43,411 - DEBUG - request_id: req_9cc40a77a2b37c1fefebb766d7cfd80e
2024-10-15 11:08:43,413 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWtbJAo5hS6pJ6F3UE20pfla8d6i', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_EveD3mCEhCT4CS6HzGAIhKkh', function=Function(arguments='{\n  "content": [\n    {\n      "name": "ELENA VASILESCU",\n      "address": "Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3"\n    }\n  ]\n}', name='Response'), type='function')]))], created=1728979719, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=53, prompt_tokens=494, total_tokens=547, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 11:08:43,414 - DEBUG - Returning model from AdapterBase
2024-10-15 11:08:44,937 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of:\n1. Extracting personal identifiable information (PII) from documents.\n2. Identifying parties and their roles in the contract.\n3. Determining contract details based on the type of contract.\n4. Constructing a contract using the provided information and templates.\n\nFor each task, provide a structured response that can be easily parsed into the appropriate data model. Always include all necessary information in your response, and format it as a valid JSON object.\n\nWhen extracting PII, identify the name and address of each person mentioned.\nWhen identifying parties, assign roles based on the contract type (e.g., buyer/seller, host/guest, consultant/client).\nWhen determining contract details, specify the contract type and any additional information relevant to that type of contract.\nWhen constructing a contract, use the provided template and fill in all necessary details.\n\nFollow the workflow precisely and indicate when human input or verification is needed.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 11:08:44,938 - DEBUG - max_retries: 1
2024-10-15 11:08:44,940 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of:\n1. Extracting personal identifiable information (PII) from documents.\n2. Identifying parties and their roles in the contract.\n3. Determining contract details based on the type of contract.\n4. Constructing a contract using the provided information and templates.\n\nFor each task, provide a structured response that can be easily parsed into the appropriate data model. Always include all necessary information in your response, and format it as a valid JSON object.\n\nWhen extracting PII, identify the name and address of each person mentioned.\nWhen identifying parties, assign roles based on the contract type (e.g., buyer/seller, host/guest, consultant/client).\nWhen determining contract details, specify the contract type and any additional information relevant to that type of contract.\nWhen constructing a contract, use the provided template and fill in all necessary details.\n\nFollow the workflow precisely and indicate when human input or verification is needed.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, identify_parties, determine_contract_type, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 11:08:44,940 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 11:08:44,940 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 11:08:44,941 - DEBUG - send_request_headers.complete
2024-10-15 11:08:44,941 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 11:08:44,941 - DEBUG - send_request_body.complete
2024-10-15 11:08:44,941 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 11:08:46,488 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 08:08:47 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1397'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9997'), (b'x-ratelimit-remaining-tokens', b'9636'), (b'x-ratelimit-reset-requests', b'20.038s'), (b'x-ratelimit-reset-tokens', b'2.184s'), (b'x-request-id', b'req_ee271c0f73b6f69564eff6868b941707'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e52b48836e0c5-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 11:08:46,489 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 11:08:46,490 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 11:08:46,490 - DEBUG - receive_response_body.complete
2024-10-15 11:08:46,490 - DEBUG - response_closed.started
2024-10-15 11:08:46,491 - DEBUG - response_closed.complete
2024-10-15 11:08:46,491 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 08:08:47 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1397', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9997', 'x-ratelimit-remaining-tokens': '9636', 'x-ratelimit-reset-requests': '20.038s', 'x-ratelimit-reset-tokens': '2.184s', 'x-request-id': 'req_ee271c0f73b6f69564eff6868b941707', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e52b48836e0c5-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 11:08:46,491 - DEBUG - request_id: req_ee271c0f73b6f69564eff6868b941707
2024-10-15 11:08:46,492 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWth7eYkVm7gMgtNwoZSVQsX27AL', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_fNPlXmwKjXd1w9dcbBioJXWX', function=Function(arguments='{\n"action": "identify_parties"\n}', name='AgentAction'), type='function')]))], created=1728979725, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=10, prompt_tokens=338, total_tokens=348, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 11:08:46,656 - DEBUG - close.started
2024-10-15 11:08:46,657 - DEBUG - close.complete
2024-10-15 11:09:38,669 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-15 11:09:39,953 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-15 11:09:39,953 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-15 11:09:40,279 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-15 11:09:40,280 - DEBUG - Using proactor: IocpProactor
2024-10-15 11:09:40,298 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 11:09:40,298 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 11:09:40,298 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 11:09:40,299 - DEBUG - Compression method 0
2024-10-15 11:09:40,299 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 11:09:40,299 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 11:09:40,299 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 11:09:40,299 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 11:09:40,299 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 11:09:40,299 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 11:09:40,299 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 11:09:40,299 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 11:09:40,299 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 11:09:40,299 - DEBUG - Compression method 0
2024-10-15 11:09:40,299 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 11:09:40,299 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 11:09:40,299 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 11:09:40,299 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 11:09:40,299 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 11:09:40,299 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 11:09:40,309 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 11:09:40,309 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 11:09:40,309 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 11:09:40,309 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 11:09:40,310 - DEBUG - Error closing: Operation on closed image
2024-10-15 11:09:42,435 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 11:09:42,436 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 11:09:42,436 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 11:09:42,436 - DEBUG - Compression method 0
2024-10-15 11:09:42,436 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 11:09:42,436 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 11:09:42,436 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 11:09:42,436 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 11:09:42,436 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 11:09:42,436 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 11:09:42,436 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 11:09:42,436 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 11:09:42,436 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 11:09:42,436 - DEBUG - Compression method 0
2024-10-15 11:09:42,436 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 11:09:42,437 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 11:09:42,437 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 11:09:42,437 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 11:09:42,437 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 11:09:42,437 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 11:09:42,461 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 11:09:42,461 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 11:09:42,462 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 11:09:42,462 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 11:09:42,463 - DEBUG - Error closing: Operation on closed image
2024-10-15 11:09:47,357 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of:\n1. Extracting personal identifiable information (PII) from documents.\n2. Identifying parties and their roles in the contract.\n3. Determining contract details based on the type of contract.\n4. Constructing a contract using the provided information and templates.\n\nFor each task, provide a structured response that can be easily parsed into the appropriate data model. Always include all necessary information in your response, and format it as a valid JSON object.\n\nWhen extracting PII, identify the name and address of each person mentioned.\nWhen identifying parties, assign roles based on the contract type (e.g., buyer/seller, host/guest, consultant/client).\nWhen determining contract details, specify the contract type and any additional information relevant to that type of contract.\nWhen constructing a contract, use the provided template and fill in all necessary details.\n\nFollow the workflow precisely and indicate when human input or verification is needed.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 0 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, determine_contract_type, identify_parties, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 11:09:47,359 - DEBUG - max_retries: 1
2024-10-15 11:09:47,362 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of:\n1. Extracting personal identifiable information (PII) from documents.\n2. Identifying parties and their roles in the contract.\n3. Determining contract details based on the type of contract.\n4. Constructing a contract using the provided information and templates.\n\nFor each task, provide a structured response that can be easily parsed into the appropriate data model. Always include all necessary information in your response, and format it as a valid JSON object.\n\nWhen extracting PII, identify the name and address of each person mentioned.\nWhen identifying parties, assign roles based on the contract type (e.g., buyer/seller, host/guest, consultant/client).\nWhen determining contract details, specify the contract type and any additional information relevant to that type of contract.\nWhen constructing a contract, use the provided template and fill in all necessary details.\n\nFollow the workflow precisely and indicate when human input or verification is needed.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 0 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, determine_contract_type, identify_parties, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 11:09:47,409 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 11:09:47,410 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-15 11:09:47,436 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001EE95BCC7D0>
2024-10-15 11:09:47,436 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x000001EE959FE7D0> server_hostname='api.openai.com' timeout=5.0
2024-10-15 11:09:47,445 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001EE95B26570>
2024-10-15 11:09:47,445 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 11:09:47,446 - DEBUG - send_request_headers.complete
2024-10-15 11:09:47,446 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 11:09:47,446 - DEBUG - send_request_body.complete
2024-10-15 11:09:47,446 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 11:09:48,960 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 08:09:49 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1353'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'9636'), (b'x-ratelimit-reset-requests', b'8.64s'), (b'x-ratelimit-reset-tokens', b'2.184s'), (b'x-request-id', b'req_375b47dbbc77b4763c935dad1774891d'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=7Ax4Kh4UvT43uNxRmjq3V.ZHF7VupNxSRawDLypvMOU-1728979789-1.0.1.1-e2xIxSfM3Du1RkRXbSVkILuSx3UEJJ_cm0jJqAUy3fmA4yDKqazEkHEyghECQYccwCAUj5nMzxOUN_mJBe2eCA; path=/; expires=Tue, 15-Oct-24 08:39:49 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=zJU3X5qeyVvsjW.ywTGxKW3XYs1lqjrjQ9H6S3Ah9qw-1728979789534-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e543b2bda70cf-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 11:09:48,960 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 11:09:48,961 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 11:09:48,961 - DEBUG - receive_response_body.complete
2024-10-15 11:09:48,961 - DEBUG - response_closed.started
2024-10-15 11:09:48,961 - DEBUG - response_closed.complete
2024-10-15 11:09:48,961 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Tue, 15 Oct 2024 08:09:49 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-kzzh9hik9ryjiou4ftvhondh'), ('openai-processing-ms', '1353'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '10000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '9636'), ('x-ratelimit-reset-requests', '8.64s'), ('x-ratelimit-reset-tokens', '2.184s'), ('x-request-id', 'req_375b47dbbc77b4763c935dad1774891d'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=7Ax4Kh4UvT43uNxRmjq3V.ZHF7VupNxSRawDLypvMOU-1728979789-1.0.1.1-e2xIxSfM3Du1RkRXbSVkILuSx3UEJJ_cm0jJqAUy3fmA4yDKqazEkHEyghECQYccwCAUj5nMzxOUN_mJBe2eCA; path=/; expires=Tue, 15-Oct-24 08:39:49 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=zJU3X5qeyVvsjW.ywTGxKW3XYs1lqjrjQ9H6S3Ah9qw-1728979789534-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d2e543b2bda70cf-OTP'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-15 11:09:48,961 - DEBUG - request_id: req_375b47dbbc77b4763c935dad1774891d
2024-10-15 11:09:48,965 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWuiFLGigfqlnQ3SrkyWplxK7njC', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_lxJ6Hj2PigvxTAWIJsnR7UQr', function=Function(arguments='\n{\n"action": "extract_pii"\n}', name='AgentAction'), type='function')]))], created=1728979788, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=11, prompt_tokens=338, total_tokens=349, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 11:09:48,968 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'instructor.dsl.simple_type.Response'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of:\n1. Extracting personal identifiable information (PII) from documents.\n2. Identifying parties and their roles in the contract.\n3. Determining contract details based on the type of contract.\n4. Constructing a contract using the provided information and templates.\n\nFor each task, provide a structured response that can be easily parsed into the appropriate data model. Always include all necessary information in your response, and format it as a valid JSON object.\n\nWhen extracting PII, identify the name and address of each person mentioned.\nWhen identifying parties, assign roles based on the contract type (e.g., buyer/seller, host/guest, consultant/client).\nWhen determining contract details, specify the contract type and any additional information relevant to that type of contract.\nWhen constructing a contract, use the provided template and fill in all necessary details.\n\nFollow the workflow precisely and indicate when human input or verification is needed.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}}
2024-10-15 11:09:48,968 - DEBUG - max_retries: 1
2024-10-15 11:09:48,971 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of:\n1. Extracting personal identifiable information (PII) from documents.\n2. Identifying parties and their roles in the contract.\n3. Determining contract details based on the type of contract.\n4. Constructing a contract using the provided information and templates.\n\nFor each task, provide a structured response that can be easily parsed into the appropriate data model. Always include all necessary information in your response, and format it as a valid JSON object.\n\nWhen extracting PII, identify the name and address of each person mentioned.\nWhen identifying parties, assign roles based on the contract type (e.g., buyer/seller, host/guest, consultant/client).\nWhen determining contract details, specify the contract type and any additional information relevant to that type of contract.\nWhen constructing a contract, use the provided template and fill in all necessary details.\n\nFollow the workflow precisely and indicate when human input or verification is needed.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}, 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}]}}
2024-10-15 11:09:48,972 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 11:09:48,973 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 11:09:48,973 - DEBUG - send_request_headers.complete
2024-10-15 11:09:48,973 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 11:09:48,973 - DEBUG - send_request_body.complete
2024-10-15 11:09:48,973 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 11:09:52,843 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 08:09:53 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'3684'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9998'), (b'x-ratelimit-remaining-tokens', b'9453'), (b'x-ratelimit-reset-requests', b'15.745s'), (b'x-ratelimit-reset-tokens', b'3.277s'), (b'x-request-id', b'req_1592307286859da56beb289a531e3884'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e5444be8670cf-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 11:09:52,844 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 11:09:52,844 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 11:09:52,844 - DEBUG - receive_response_body.complete
2024-10-15 11:09:52,844 - DEBUG - response_closed.started
2024-10-15 11:09:52,844 - DEBUG - response_closed.complete
2024-10-15 11:09:52,845 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 08:09:53 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '3684', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9998', 'x-ratelimit-remaining-tokens': '9453', 'x-ratelimit-reset-requests': '15.745s', 'x-ratelimit-reset-tokens': '3.277s', 'x-request-id': 'req_1592307286859da56beb289a531e3884', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e5444be8670cf-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 11:09:52,845 - DEBUG - request_id: req_1592307286859da56beb289a531e3884
2024-10-15 11:09:52,845 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWujrghj6tJ9D5EScj1IuWUm5zRy', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_k8tvOWBHGSZoeFvUXUpLOHHj', function=Function(arguments='{\n  "content": [\n    {\n      "name": "ISPILANTE SENTIMENT BRUSLI",\n      "address": "Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR"\n    }\n  ]\n}', name='Response'), type='function')]))], created=1728979789, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=53, prompt_tokens=491, total_tokens=544, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 11:09:52,846 - DEBUG - Returning model from AdapterBase
2024-10-15 11:09:55,052 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'instructor.dsl.simple_type.Response'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of:\n1. Extracting personal identifiable information (PII) from documents.\n2. Identifying parties and their roles in the contract.\n3. Determining contract details based on the type of contract.\n4. Constructing a contract using the provided information and templates.\n\nFor each task, provide a structured response that can be easily parsed into the appropriate data model. Always include all necessary information in your response, and format it as a valid JSON object.\n\nWhen extracting PII, identify the name and address of each person mentioned.\nWhen identifying parties, assign roles based on the contract type (e.g., buyer/seller, host/guest, consultant/client).\nWhen determining contract details, specify the contract type and any additional information relevant to that type of contract.\nWhen constructing a contract, use the provided template and fill in all necessary details.\n\nFollow the workflow precisely and indicate when human input or verification is needed.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}}
2024-10-15 11:09:55,052 - DEBUG - max_retries: 1
2024-10-15 11:09:55,054 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of:\n1. Extracting personal identifiable information (PII) from documents.\n2. Identifying parties and their roles in the contract.\n3. Determining contract details based on the type of contract.\n4. Constructing a contract using the provided information and templates.\n\nFor each task, provide a structured response that can be easily parsed into the appropriate data model. Always include all necessary information in your response, and format it as a valid JSON object.\n\nWhen extracting PII, identify the name and address of each person mentioned.\nWhen identifying parties, assign roles based on the contract type (e.g., buyer/seller, host/guest, consultant/client).\nWhen determining contract details, specify the contract type and any additional information relevant to that type of contract.\nWhen constructing a contract, use the provided template and fill in all necessary details.\n\nFollow the workflow precisely and indicate when human input or verification is needed.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}, 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}]}}
2024-10-15 11:09:55,054 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 11:09:55,055 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 11:09:55,055 - DEBUG - send_request_headers.complete
2024-10-15 11:09:55,055 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 11:09:55,055 - DEBUG - send_request_body.complete
2024-10-15 11:09:55,055 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 11:09:59,233 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 08:09:59 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'3873'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9997'), (b'x-ratelimit-remaining-tokens', b'9553'), (b'x-ratelimit-reset-requests', b'18.173s'), (b'x-ratelimit-reset-tokens', b'2.682s'), (b'x-request-id', b'req_6cb5d791266a52994fc267902e9b9db2'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e546abf3270cf-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 11:09:59,234 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 11:09:59,235 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 11:09:59,235 - DEBUG - receive_response_body.complete
2024-10-15 11:09:59,235 - DEBUG - response_closed.started
2024-10-15 11:09:59,235 - DEBUG - response_closed.complete
2024-10-15 11:09:59,236 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 08:09:59 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '3873', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9997', 'x-ratelimit-remaining-tokens': '9553', 'x-ratelimit-reset-requests': '18.173s', 'x-ratelimit-reset-tokens': '2.682s', 'x-request-id': 'req_6cb5d791266a52994fc267902e9b9db2', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e546abf3270cf-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 11:09:59,236 - DEBUG - request_id: req_6cb5d791266a52994fc267902e9b9db2
2024-10-15 11:09:59,237 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWuqATWMXgmyKUHYNrIyyuBCbOAJ', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_c7kpngUmwYy3ljj13s6MfghY', function=Function(arguments='{\n  "content": [\n    {\n      "name": "ELENA VASILESCU",\n      "address": "Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3"\n    }\n  ]\n}', name='Response'), type='function')]))], created=1728979796, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=53, prompt_tokens=494, total_tokens=547, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 11:09:59,239 - DEBUG - Returning model from AdapterBase
2024-10-15 11:10:00,591 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of:\n1. Extracting personal identifiable information (PII) from documents.\n2. Identifying parties and their roles in the contract.\n3. Determining contract details based on the type of contract.\n4. Constructing a contract using the provided information and templates.\n\nFor each task, provide a structured response that can be easily parsed into the appropriate data model. Always include all necessary information in your response, and format it as a valid JSON object.\n\nWhen extracting PII, identify the name and address of each person mentioned.\nWhen identifying parties, assign roles based on the contract type (e.g., buyer/seller, host/guest, consultant/client).\nWhen determining contract details, specify the contract type and any additional information relevant to that type of contract.\nWhen constructing a contract, use the provided template and fill in all necessary details.\n\nFollow the workflow precisely and indicate when human input or verification is needed.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, determine_contract_type, identify_parties, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 11:10:00,592 - DEBUG - max_retries: 1
2024-10-15 11:10:00,594 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of:\n1. Extracting personal identifiable information (PII) from documents.\n2. Identifying parties and their roles in the contract.\n3. Determining contract details based on the type of contract.\n4. Constructing a contract using the provided information and templates.\n\nFor each task, provide a structured response that can be easily parsed into the appropriate data model. Always include all necessary information in your response, and format it as a valid JSON object.\n\nWhen extracting PII, identify the name and address of each person mentioned.\nWhen identifying parties, assign roles based on the contract type (e.g., buyer/seller, host/guest, consultant/client).\nWhen determining contract details, specify the contract type and any additional information relevant to that type of contract.\nWhen constructing a contract, use the provided template and fill in all necessary details.\n\nFollow the workflow precisely and indicate when human input or verification is needed.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, determine_contract_type, identify_parties, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 11:10:00,594 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 11:10:00,594 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 11:10:00,594 - DEBUG - send_request_headers.complete
2024-10-15 11:10:00,594 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 11:10:00,594 - DEBUG - send_request_body.complete
2024-10-15 11:10:00,595 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 11:10:02,363 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 08:10:02 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1536'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9997'), (b'x-ratelimit-remaining-tokens', b'9636'), (b'x-ratelimit-reset-requests', b'21.416s'), (b'x-ratelimit-reset-tokens', b'2.184s'), (b'x-request-id', b'req_2e58f3c41cd01cd94323374429138e70'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e548d590e70cf-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 11:10:02,364 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 11:10:02,364 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 11:10:02,365 - DEBUG - receive_response_body.complete
2024-10-15 11:10:02,365 - DEBUG - response_closed.started
2024-10-15 11:10:02,365 - DEBUG - response_closed.complete
2024-10-15 11:10:02,365 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 08:10:02 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1536', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9997', 'x-ratelimit-remaining-tokens': '9636', 'x-ratelimit-reset-requests': '21.416s', 'x-ratelimit-reset-tokens': '2.184s', 'x-request-id': 'req_2e58f3c41cd01cd94323374429138e70', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e548d590e70cf-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 11:10:02,366 - DEBUG - request_id: req_2e58f3c41cd01cd94323374429138e70
2024-10-15 11:10:02,367 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWuvCOwfRfto61lOqOMWqVGHWORW', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_bhshjbyVPxBWB3fkJ6vFsyAa', function=Function(arguments='\n{\n  "action": "identify_parties"\n}', name='AgentAction'), type='function')]))], created=1728979801, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=12, prompt_tokens=338, total_tokens=350, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 11:10:02,370 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of:\n1. Extracting personal identifiable information (PII) from documents.\n2. Identifying parties and their roles in the contract.\n3. Determining contract details based on the type of contract.\n4. Constructing a contract using the provided information and templates.\n\nFor each task, provide a structured response that can be easily parsed into the appropriate data model. Always include all necessary information in your response, and format it as a valid JSON object.\n\nWhen extracting PII, identify the name and address of each person mentioned.\nWhen identifying parties, assign roles based on the contract type (e.g., buyer/seller, host/guest, consultant/client).\nWhen determining contract details, specify the contract type and any additional information relevant to that type of contract.\nWhen constructing a contract, use the provided template and fill in all necessary details.\n\nFollow the workflow precisely and indicate when human input or verification is needed.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, determine_contract_type, identify_parties, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 11:10:02,370 - DEBUG - max_retries: 1
2024-10-15 11:10:02,373 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of:\n1. Extracting personal identifiable information (PII) from documents.\n2. Identifying parties and their roles in the contract.\n3. Determining contract details based on the type of contract.\n4. Constructing a contract using the provided information and templates.\n\nFor each task, provide a structured response that can be easily parsed into the appropriate data model. Always include all necessary information in your response, and format it as a valid JSON object.\n\nWhen extracting PII, identify the name and address of each person mentioned.\nWhen identifying parties, assign roles based on the contract type (e.g., buyer/seller, host/guest, consultant/client).\nWhen determining contract details, specify the contract type and any additional information relevant to that type of contract.\nWhen constructing a contract, use the provided template and fill in all necessary details.\n\nFollow the workflow precisely and indicate when human input or verification is needed.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, determine_contract_type, identify_parties, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 11:10:02,374 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 11:10:02,375 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 11:10:02,375 - DEBUG - send_request_headers.complete
2024-10-15 11:10:02,375 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 11:10:02,375 - DEBUG - send_request_body.complete
2024-10-15 11:10:02,376 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 11:10:03,601 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 08:10:04 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1067'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9996'), (b'x-ratelimit-remaining-tokens', b'9582'), (b'x-ratelimit-reset-requests', b'28.277s'), (b'x-ratelimit-reset-tokens', b'2.505s'), (b'x-request-id', b'req_1f14a21f360c2e1f4eaae15daf533f87'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e54987d8b70cf-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 11:10:03,601 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 11:10:03,601 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 11:10:03,602 - DEBUG - receive_response_body.complete
2024-10-15 11:10:03,602 - DEBUG - response_closed.started
2024-10-15 11:10:03,602 - DEBUG - response_closed.complete
2024-10-15 11:10:03,602 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 08:10:04 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1067', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9996', 'x-ratelimit-remaining-tokens': '9582', 'x-ratelimit-reset-requests': '28.277s', 'x-ratelimit-reset-tokens': '2.505s', 'x-request-id': 'req_1f14a21f360c2e1f4eaae15daf533f87', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e54987d8b70cf-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 11:10:03,602 - DEBUG - request_id: req_1f14a21f360c2e1f4eaae15daf533f87
2024-10-15 11:10:03,602 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWuxEp7c0Ay74z4RBjWIxZTaU2BQ', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_hlrb1JfDYqNN5BvLaq1vXshH', function=Function(arguments='\n{\n"action": "identify_parties"\n}', name='AgentAction'), type='function')]))], created=1728979803, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=11, prompt_tokens=338, total_tokens=349, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 11:10:03,604 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of:\n1. Extracting personal identifiable information (PII) from documents.\n2. Identifying parties and their roles in the contract.\n3. Determining contract details based on the type of contract.\n4. Constructing a contract using the provided information and templates.\n\nFor each task, provide a structured response that can be easily parsed into the appropriate data model. Always include all necessary information in your response, and format it as a valid JSON object.\n\nWhen extracting PII, identify the name and address of each person mentioned.\nWhen identifying parties, assign roles based on the contract type (e.g., buyer/seller, host/guest, consultant/client).\nWhen determining contract details, specify the contract type and any additional information relevant to that type of contract.\nWhen constructing a contract, use the provided template and fill in all necessary details.\n\nFollow the workflow precisely and indicate when human input or verification is needed.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, determine_contract_type, identify_parties, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 11:10:03,604 - DEBUG - max_retries: 1
2024-10-15 11:10:03,605 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of:\n1. Extracting personal identifiable information (PII) from documents.\n2. Identifying parties and their roles in the contract.\n3. Determining contract details based on the type of contract.\n4. Constructing a contract using the provided information and templates.\n\nFor each task, provide a structured response that can be easily parsed into the appropriate data model. Always include all necessary information in your response, and format it as a valid JSON object.\n\nWhen extracting PII, identify the name and address of each person mentioned.\nWhen identifying parties, assign roles based on the contract type (e.g., buyer/seller, host/guest, consultant/client).\nWhen determining contract details, specify the contract type and any additional information relevant to that type of contract.\nWhen constructing a contract, use the provided template and fill in all necessary details.\n\nFollow the workflow precisely and indicate when human input or verification is needed.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, determine_contract_type, identify_parties, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 11:10:03,606 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 11:10:03,606 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 11:10:03,606 - DEBUG - send_request_headers.complete
2024-10-15 11:10:03,606 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 11:10:03,606 - DEBUG - send_request_body.complete
2024-10-15 11:10:03,606 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 11:10:04,620 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 08:10:05 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'858'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9995'), (b'x-ratelimit-remaining-tokens', b'9438'), (b'x-ratelimit-reset-requests', b'35.688s'), (b'x-ratelimit-reset-tokens', b'3.37s'), (b'x-request-id', b'req_a0ebd3b855b0a411cee9e0ba785625f4'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e54a02edf70cf-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 11:10:04,621 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 11:10:04,621 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 11:10:04,621 - DEBUG - receive_response_body.complete
2024-10-15 11:10:04,621 - DEBUG - response_closed.started
2024-10-15 11:10:04,621 - DEBUG - response_closed.complete
2024-10-15 11:10:04,621 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 08:10:05 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '858', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9995', 'x-ratelimit-remaining-tokens': '9438', 'x-ratelimit-reset-requests': '35.688s', 'x-ratelimit-reset-tokens': '3.37s', 'x-request-id': 'req_a0ebd3b855b0a411cee9e0ba785625f4', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e54a02edf70cf-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 11:10:04,621 - DEBUG - request_id: req_a0ebd3b855b0a411cee9e0ba785625f4
2024-10-15 11:10:04,621 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWuywNZpv665OpJrRg0mV7OBTbNu', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_coR2mkPr3AqaqeCuXF3HQ4en', function=Function(arguments='{\n  "action": "identify_parties"\n}', name='AgentAction'), type='function')]))], created=1728979804, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=11, prompt_tokens=338, total_tokens=349, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 11:10:04,622 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of:\n1. Extracting personal identifiable information (PII) from documents.\n2. Identifying parties and their roles in the contract.\n3. Determining contract details based on the type of contract.\n4. Constructing a contract using the provided information and templates.\n\nFor each task, provide a structured response that can be easily parsed into the appropriate data model. Always include all necessary information in your response, and format it as a valid JSON object.\n\nWhen extracting PII, identify the name and address of each person mentioned.\nWhen identifying parties, assign roles based on the contract type (e.g., buyer/seller, host/guest, consultant/client).\nWhen determining contract details, specify the contract type and any additional information relevant to that type of contract.\nWhen constructing a contract, use the provided template and fill in all necessary details.\n\nFollow the workflow precisely and indicate when human input or verification is needed.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, determine_contract_type, identify_parties, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 11:10:04,622 - DEBUG - max_retries: 1
2024-10-15 11:10:04,624 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of:\n1. Extracting personal identifiable information (PII) from documents.\n2. Identifying parties and their roles in the contract.\n3. Determining contract details based on the type of contract.\n4. Constructing a contract using the provided information and templates.\n\nFor each task, provide a structured response that can be easily parsed into the appropriate data model. Always include all necessary information in your response, and format it as a valid JSON object.\n\nWhen extracting PII, identify the name and address of each person mentioned.\nWhen identifying parties, assign roles based on the contract type (e.g., buyer/seller, host/guest, consultant/client).\nWhen determining contract details, specify the contract type and any additional information relevant to that type of contract.\nWhen constructing a contract, use the provided template and fill in all necessary details.\n\nFollow the workflow precisely and indicate when human input or verification is needed.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, determine_contract_type, identify_parties, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 11:10:04,624 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 11:10:04,624 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 11:10:04,624 - DEBUG - send_request_headers.complete
2024-10-15 11:10:04,624 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 11:10:04,625 - DEBUG - send_request_body.complete
2024-10-15 11:10:04,625 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 11:10:06,065 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 08:10:06 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1291'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9994'), (b'x-ratelimit-remaining-tokens', b'9257'), (b'x-ratelimit-reset-requests', b'43.318s'), (b'x-ratelimit-reset-tokens', b'4.453s'), (b'x-request-id', b'req_3cf426200dcb20a770a670709d48e38f'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e54a68f2d70cf-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 11:10:06,065 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 11:10:06,065 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 11:10:06,066 - DEBUG - receive_response_body.complete
2024-10-15 11:10:06,066 - DEBUG - response_closed.started
2024-10-15 11:10:06,066 - DEBUG - response_closed.complete
2024-10-15 11:10:06,066 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 08:10:06 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1291', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9994', 'x-ratelimit-remaining-tokens': '9257', 'x-ratelimit-reset-requests': '43.318s', 'x-ratelimit-reset-tokens': '4.453s', 'x-request-id': 'req_3cf426200dcb20a770a670709d48e38f', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e54a68f2d70cf-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 11:10:06,066 - DEBUG - request_id: req_3cf426200dcb20a770a670709d48e38f
2024-10-15 11:10:06,066 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWuzsEq8ivxCwjiVetQeD8YijKYT', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_hhMzOXzMWC9KiYREVPKm5Wqd', function=Function(arguments='\n{\n  "action": "identify_parties"\n}', name='AgentAction'), type='function')]))], created=1728979805, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=12, prompt_tokens=338, total_tokens=350, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 11:10:06,067 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of:\n1. Extracting personal identifiable information (PII) from documents.\n2. Identifying parties and their roles in the contract.\n3. Determining contract details based on the type of contract.\n4. Constructing a contract using the provided information and templates.\n\nFor each task, provide a structured response that can be easily parsed into the appropriate data model. Always include all necessary information in your response, and format it as a valid JSON object.\n\nWhen extracting PII, identify the name and address of each person mentioned.\nWhen identifying parties, assign roles based on the contract type (e.g., buyer/seller, host/guest, consultant/client).\nWhen determining contract details, specify the contract type and any additional information relevant to that type of contract.\nWhen constructing a contract, use the provided template and fill in all necessary details.\n\nFollow the workflow precisely and indicate when human input or verification is needed.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, determine_contract_type, identify_parties, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 11:10:06,067 - DEBUG - max_retries: 1
2024-10-15 11:10:06,068 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of:\n1. Extracting personal identifiable information (PII) from documents.\n2. Identifying parties and their roles in the contract.\n3. Determining contract details based on the type of contract.\n4. Constructing a contract using the provided information and templates.\n\nFor each task, provide a structured response that can be easily parsed into the appropriate data model. Always include all necessary information in your response, and format it as a valid JSON object.\n\nWhen extracting PII, identify the name and address of each person mentioned.\nWhen identifying parties, assign roles based on the contract type (e.g., buyer/seller, host/guest, consultant/client).\nWhen determining contract details, specify the contract type and any additional information relevant to that type of contract.\nWhen constructing a contract, use the provided template and fill in all necessary details.\n\nFollow the workflow precisely and indicate when human input or verification is needed.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, determine_contract_type, identify_parties, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 11:10:06,069 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 11:10:06,069 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 11:10:06,069 - DEBUG - send_request_headers.complete
2024-10-15 11:10:06,069 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 11:10:06,069 - DEBUG - send_request_body.complete
2024-10-15 11:10:06,069 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 11:10:07,219 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 08:10:07 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'992'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9994'), (b'x-ratelimit-remaining-tokens', b'9150'), (b'x-ratelimit-reset-requests', b'50.503s'), (b'x-ratelimit-reset-tokens', b'5.099s'), (b'x-request-id', b'req_8c3d25834f41a9514f75089537d895d9'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e54af8abd70cf-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 11:10:07,219 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 11:10:07,219 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 11:10:07,220 - DEBUG - receive_response_body.complete
2024-10-15 11:10:07,220 - DEBUG - response_closed.started
2024-10-15 11:10:07,220 - DEBUG - response_closed.complete
2024-10-15 11:10:07,220 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 08:10:07 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '992', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9994', 'x-ratelimit-remaining-tokens': '9150', 'x-ratelimit-reset-requests': '50.503s', 'x-ratelimit-reset-tokens': '5.099s', 'x-request-id': 'req_8c3d25834f41a9514f75089537d895d9', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e54af8abd70cf-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 11:10:07,220 - DEBUG - request_id: req_8c3d25834f41a9514f75089537d895d9
2024-10-15 11:10:07,220 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWv0CWlm7oru031srDZtv8MZv0vg', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_QPcnW5Bm4BlZrsQrriUwdJmA', function=Function(arguments='{\n"action": "identify_parties"\n}', name='AgentAction'), type='function')]))], created=1728979806, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=10, prompt_tokens=338, total_tokens=348, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 11:10:07,221 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of:\n1. Extracting personal identifiable information (PII) from documents.\n2. Identifying parties and their roles in the contract.\n3. Determining contract details based on the type of contract.\n4. Constructing a contract using the provided information and templates.\n\nFor each task, provide a structured response that can be easily parsed into the appropriate data model. Always include all necessary information in your response, and format it as a valid JSON object.\n\nWhen extracting PII, identify the name and address of each person mentioned.\nWhen identifying parties, assign roles based on the contract type (e.g., buyer/seller, host/guest, consultant/client).\nWhen determining contract details, specify the contract type and any additional information relevant to that type of contract.\nWhen constructing a contract, use the provided template and fill in all necessary details.\n\nFollow the workflow precisely and indicate when human input or verification is needed.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, determine_contract_type, identify_parties, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 11:10:07,221 - DEBUG - max_retries: 1
2024-10-15 11:10:07,223 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of:\n1. Extracting personal identifiable information (PII) from documents.\n2. Identifying parties and their roles in the contract.\n3. Determining contract details based on the type of contract.\n4. Constructing a contract using the provided information and templates.\n\nFor each task, provide a structured response that can be easily parsed into the appropriate data model. Always include all necessary information in your response, and format it as a valid JSON object.\n\nWhen extracting PII, identify the name and address of each person mentioned.\nWhen identifying parties, assign roles based on the contract type (e.g., buyer/seller, host/guest, consultant/client).\nWhen determining contract details, specify the contract type and any additional information relevant to that type of contract.\nWhen constructing a contract, use the provided template and fill in all necessary details.\n\nFollow the workflow precisely and indicate when human input or verification is needed.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, determine_contract_type, identify_parties, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 11:10:07,223 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 11:10:07,224 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 11:10:07,224 - DEBUG - send_request_headers.complete
2024-10-15 11:10:07,224 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 11:10:07,224 - DEBUG - send_request_body.complete
2024-10-15 11:10:07,224 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 11:10:08,374 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 08:10:08 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'990'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9993'), (b'x-ratelimit-remaining-tokens', b'8995'), (b'x-ratelimit-reset-requests', b'57.984s'), (b'x-ratelimit-reset-tokens', b'6.027s'), (b'x-request-id', b'req_792004a08fb31a548c21f8278d8a2ca6'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e54b6cc0c70cf-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 11:10:08,375 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 11:10:08,375 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 11:10:08,375 - DEBUG - receive_response_body.complete
2024-10-15 11:10:08,375 - DEBUG - response_closed.started
2024-10-15 11:10:08,375 - DEBUG - response_closed.complete
2024-10-15 11:10:08,375 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 08:10:08 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '990', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9993', 'x-ratelimit-remaining-tokens': '8995', 'x-ratelimit-reset-requests': '57.984s', 'x-ratelimit-reset-tokens': '6.027s', 'x-request-id': 'req_792004a08fb31a548c21f8278d8a2ca6', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e54b6cc0c70cf-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 11:10:08,375 - DEBUG - request_id: req_792004a08fb31a548c21f8278d8a2ca6
2024-10-15 11:10:08,375 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWv2TquJ6GRhugr2FiUZnGG89IDh', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_2Y2n5tliOYyqdPKgDjKH6UjL', function=Function(arguments='\n{\n  "action": "identify_parties"\n}', name='AgentAction'), type='function')]))], created=1728979808, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=12, prompt_tokens=338, total_tokens=350, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 11:10:08,377 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of:\n1. Extracting personal identifiable information (PII) from documents.\n2. Identifying parties and their roles in the contract.\n3. Determining contract details based on the type of contract.\n4. Constructing a contract using the provided information and templates.\n\nFor each task, provide a structured response that can be easily parsed into the appropriate data model. Always include all necessary information in your response, and format it as a valid JSON object.\n\nWhen extracting PII, identify the name and address of each person mentioned.\nWhen identifying parties, assign roles based on the contract type (e.g., buyer/seller, host/guest, consultant/client).\nWhen determining contract details, specify the contract type and any additional information relevant to that type of contract.\nWhen constructing a contract, use the provided template and fill in all necessary details.\n\nFollow the workflow precisely and indicate when human input or verification is needed.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, determine_contract_type, identify_parties, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 11:10:08,377 - DEBUG - max_retries: 1
2024-10-15 11:10:08,378 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of:\n1. Extracting personal identifiable information (PII) from documents.\n2. Identifying parties and their roles in the contract.\n3. Determining contract details based on the type of contract.\n4. Constructing a contract using the provided information and templates.\n\nFor each task, provide a structured response that can be easily parsed into the appropriate data model. Always include all necessary information in your response, and format it as a valid JSON object.\n\nWhen extracting PII, identify the name and address of each person mentioned.\nWhen identifying parties, assign roles based on the contract type (e.g., buyer/seller, host/guest, consultant/client).\nWhen determining contract details, specify the contract type and any additional information relevant to that type of contract.\nWhen constructing a contract, use the provided template and fill in all necessary details.\n\nFollow the workflow precisely and indicate when human input or verification is needed.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, determine_contract_type, identify_parties, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 11:10:08,379 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 11:10:08,379 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 11:10:08,379 - DEBUG - send_request_headers.complete
2024-10-15 11:10:08,379 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 11:10:08,379 - DEBUG - send_request_body.complete
2024-10-15 11:10:08,379 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 11:10:10,165 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 08:10:10 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1632'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9992'), (b'x-ratelimit-remaining-tokens', b'8836'), (b'x-ratelimit-reset-requests', b'1m5.477s'), (b'x-ratelimit-reset-tokens', b'6.98s'), (b'x-request-id', b'req_a9bd20ebf38284ab6f4c596425446800'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e54bdfc1e70cf-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 11:10:10,166 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 11:10:10,166 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 11:10:10,167 - DEBUG - receive_response_body.complete
2024-10-15 11:10:10,167 - DEBUG - response_closed.started
2024-10-15 11:10:10,167 - DEBUG - response_closed.complete
2024-10-15 11:10:10,167 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 08:10:10 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1632', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9992', 'x-ratelimit-remaining-tokens': '8836', 'x-ratelimit-reset-requests': '1m5.477s', 'x-ratelimit-reset-tokens': '6.98s', 'x-request-id': 'req_a9bd20ebf38284ab6f4c596425446800', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e54bdfc1e70cf-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 11:10:10,167 - DEBUG - request_id: req_a9bd20ebf38284ab6f4c596425446800
2024-10-15 11:10:10,168 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWv3Zb8ghYlt18rYhU3K4l5BldRK', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_qpsXoTXTlh8WoqsxmnP8ghA5', function=Function(arguments='\n{\n  "action": "identify_parties"\n}', name='AgentAction'), type='function')]))], created=1728979809, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=12, prompt_tokens=338, total_tokens=350, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 11:10:10,171 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of:\n1. Extracting personal identifiable information (PII) from documents.\n2. Identifying parties and their roles in the contract.\n3. Determining contract details based on the type of contract.\n4. Constructing a contract using the provided information and templates.\n\nFor each task, provide a structured response that can be easily parsed into the appropriate data model. Always include all necessary information in your response, and format it as a valid JSON object.\n\nWhen extracting PII, identify the name and address of each person mentioned.\nWhen identifying parties, assign roles based on the contract type (e.g., buyer/seller, host/guest, consultant/client).\nWhen determining contract details, specify the contract type and any additional information relevant to that type of contract.\nWhen constructing a contract, use the provided template and fill in all necessary details.\n\nFollow the workflow precisely and indicate when human input or verification is needed.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, determine_contract_type, identify_parties, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 11:10:10,171 - DEBUG - max_retries: 1
2024-10-15 11:10:10,174 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of:\n1. Extracting personal identifiable information (PII) from documents.\n2. Identifying parties and their roles in the contract.\n3. Determining contract details based on the type of contract.\n4. Constructing a contract using the provided information and templates.\n\nFor each task, provide a structured response that can be easily parsed into the appropriate data model. Always include all necessary information in your response, and format it as a valid JSON object.\n\nWhen extracting PII, identify the name and address of each person mentioned.\nWhen identifying parties, assign roles based on the contract type (e.g., buyer/seller, host/guest, consultant/client).\nWhen determining contract details, specify the contract type and any additional information relevant to that type of contract.\nWhen constructing a contract, use the provided template and fill in all necessary details.\n\nFollow the workflow precisely and indicate when human input or verification is needed.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, determine_contract_type, identify_parties, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 11:10:10,175 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 11:10:10,175 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 11:10:10,176 - DEBUG - send_request_headers.complete
2024-10-15 11:10:10,176 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 11:10:10,176 - DEBUG - send_request_body.complete
2024-10-15 11:10:10,176 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 11:10:11,623 - DEBUG - receive_response_headers.failed exception=KeyboardInterrupt()
2024-10-15 11:10:11,623 - DEBUG - response_closed.started
2024-10-15 11:10:11,624 - DEBUG - response_closed.complete
2024-10-15 11:10:11,810 - ERROR - Task exception was never retrieved
future: <Task finished name='Task-1' coro=<agent_workflow() done, defined at D:\deve\contract_automation\src\main.py:26> exception=KeyboardInterrupt()>
Traceback (most recent call last):
  File "D:\deve\contract_automation\src\main.py", line 111, in <module>
    asyncio.run(agent_workflow())
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 30, in run
    return loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 92, in run_until_complete
    self._run_once()
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 133, in _run_once
    handle._run()
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 386, in __wakeup
    self.__step()
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 293, in __step
    self.__step_run_and_handle_result(exc)
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 304, in __step_run_and_handle_result
    result = coro.send(None)
             ^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\src\main.py", line 34, in agent_workflow
    action = agent_action(state)
             ^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\src\ai_functions.py", line 172, in agent_action
    response = client.chat.completions.create(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\instructor\patch.py", line 291, in new_create_sync
    response = retry_sync(
               ^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\instructor\retry.py", line 189, in retry_sync
    for attempt in max_retries:
  File "D:\deve\contract_automation\.venv\Lib\site-packages\tenacity\__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\tenacity\__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\tenacity\__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\deve\contract_automation\.venv\Lib\site-packages\instructor\retry.py", line 192, in retry_sync
    response = func(*args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\openai\_utils\_utils.py", line 274, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\openai\resources\chat\completions.py", line 742, in create
    return self._post(
           ^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\openai\_base_client.py", line 1270, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\openai\_base_client.py", line 947, in request
    return self._request(
           ^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\openai\_base_client.py", line 983, in _request
    response = self._client.send(
               ^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpx\_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpx\_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpx\_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpx\_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpx\_transports\default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpcore\_sync\connection_pool.py", line 216, in handle_request
    raise exc from None
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpcore\_sync\connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpcore\_sync\connection.py", line 101, in handle_request
    return self._connection.handle_request(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpcore\_sync\http11.py", line 143, in handle_request
    raise exc
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpcore\_sync\http11.py", line 113, in handle_request
    ) = self._receive_response_headers(**kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpcore\_sync\http11.py", line 186, in _receive_response_headers
    event = self._receive_event(timeout=timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpcore\_sync\http11.py", line 224, in _receive_event
    data = self._network_stream.read(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpcore\_backends\sync.py", line 126, in read
    return self._sock.recv(max_bytes)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\ssl.py", line 1234, in recv
    return self.read(buflen)
           ^^^^^^^^^^^^^^^^^
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\ssl.py", line 1107, in read
    return self._sslobj.read(len)
           ^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
2024-10-15 11:12:01,559 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-15 11:12:02,805 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-15 11:12:02,805 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-15 11:12:03,116 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-15 11:12:03,117 - DEBUG - Using proactor: IocpProactor
2024-10-15 11:12:03,135 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 11:12:03,135 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 11:12:03,135 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 11:12:03,135 - DEBUG - Compression method 0
2024-10-15 11:12:03,135 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 11:12:03,135 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 11:12:03,135 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 11:12:03,135 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 11:12:03,135 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 11:12:03,135 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 11:12:03,136 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 11:12:03,136 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 11:12:03,136 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 11:12:03,136 - DEBUG - Compression method 0
2024-10-15 11:12:03,136 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 11:12:03,136 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 11:12:03,136 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 11:12:03,136 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 11:12:03,136 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 11:12:03,136 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 11:12:03,145 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 11:12:03,145 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 11:12:03,145 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 11:12:03,145 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 11:12:03,146 - DEBUG - Error closing: Operation on closed image
2024-10-15 11:12:05,147 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 11:12:05,147 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 11:12:05,147 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 11:12:05,147 - DEBUG - Compression method 0
2024-10-15 11:12:05,147 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 11:12:05,147 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 11:12:05,147 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 11:12:05,147 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 11:12:05,147 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 11:12:05,147 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 11:12:05,148 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 11:12:05,148 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 11:12:05,148 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 11:12:05,148 - DEBUG - Compression method 0
2024-10-15 11:12:05,148 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 11:12:05,148 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 11:12:05,148 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 11:12:05,148 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 11:12:05,148 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 11:12:05,148 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 11:12:05,165 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 11:12:05,165 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 11:12:05,165 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 11:12:05,165 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 11:12:05,166 - DEBUG - Error closing: Operation on closed image
2024-10-15 11:12:07,716 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of:\n1. Extracting personal identifiable information (PII) from documents.\n2. Identifying parties and their roles in the contract.\n3. Determining contract details based on the type of contract.\n4. Constructing a contract using the provided information and templates.\n\nFor each task, provide a structured response that can be easily parsed into the appropriate data model. Always include all necessary information in your response, and format it as a valid JSON object.\n\nWhen extracting PII, identify the name and address of each person mentioned.\nWhen identifying parties, assign roles based on the contract type (e.g., buyer/seller, host/guest, consultant/client).\nWhen determining contract details, specify the contract type and any additional information relevant to that type of contract.\nWhen constructing a contract, use the provided template and fill in all necessary details.\n\nFollow the workflow precisely and indicate when human input or verification is needed.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 0 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, determine_contract_type, identify_parties, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 11:12:07,717 - DEBUG - max_retries: 1
2024-10-15 11:12:07,719 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of:\n1. Extracting personal identifiable information (PII) from documents.\n2. Identifying parties and their roles in the contract.\n3. Determining contract details based on the type of contract.\n4. Constructing a contract using the provided information and templates.\n\nFor each task, provide a structured response that can be easily parsed into the appropriate data model. Always include all necessary information in your response, and format it as a valid JSON object.\n\nWhen extracting PII, identify the name and address of each person mentioned.\nWhen identifying parties, assign roles based on the contract type (e.g., buyer/seller, host/guest, consultant/client).\nWhen determining contract details, specify the contract type and any additional information relevant to that type of contract.\nWhen constructing a contract, use the provided template and fill in all necessary details.\n\nFollow the workflow precisely and indicate when human input or verification is needed.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 0 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, determine_contract_type, identify_parties, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 11:12:07,757 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 11:12:07,757 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-15 11:12:07,797 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x00000174B20607A0>
2024-10-15 11:12:07,797 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x00000174B1C8E7D0> server_hostname='api.openai.com' timeout=5.0
2024-10-15 11:12:07,804 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x00000174B20606B0>
2024-10-15 11:12:07,804 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 11:12:07,805 - DEBUG - send_request_headers.complete
2024-10-15 11:12:07,805 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 11:12:07,805 - DEBUG - send_request_body.complete
2024-10-15 11:12:07,805 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 11:12:09,622 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 08:12:10 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1654'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'9636'), (b'x-ratelimit-reset-requests', b'8.64s'), (b'x-ratelimit-reset-tokens', b'2.184s'), (b'x-request-id', b'req_b2cb33c1947aac54f829fb7ba01cf849'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=hp4kwEG97UZwb1yWGKf6S.kbnvxdEtUUUYoEBB_E_e0-1728979930-1.0.1.1-7FpWSsEUJWUEgpN86kQOXCXhZDgGKGYZxs.hwYbERhVBHB6HkZG0TElSJmSB_iruKttze88Pq0cEIUYVi9tw_A; path=/; expires=Tue, 15-Oct-24 08:42:10 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=2ODz4dOpnm9nqxtrEtNWFahtuZ3687ZN_O8JpXelVUI-1728979930183-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e57a84ceeb6af-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 11:12:09,622 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 11:12:09,623 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 11:12:09,623 - DEBUG - receive_response_body.complete
2024-10-15 11:12:09,623 - DEBUG - response_closed.started
2024-10-15 11:12:09,623 - DEBUG - response_closed.complete
2024-10-15 11:12:09,623 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Tue, 15 Oct 2024 08:12:10 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-kzzh9hik9ryjiou4ftvhondh'), ('openai-processing-ms', '1654'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '10000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '9636'), ('x-ratelimit-reset-requests', '8.64s'), ('x-ratelimit-reset-tokens', '2.184s'), ('x-request-id', 'req_b2cb33c1947aac54f829fb7ba01cf849'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=hp4kwEG97UZwb1yWGKf6S.kbnvxdEtUUUYoEBB_E_e0-1728979930-1.0.1.1-7FpWSsEUJWUEgpN86kQOXCXhZDgGKGYZxs.hwYbERhVBHB6HkZG0TElSJmSB_iruKttze88Pq0cEIUYVi9tw_A; path=/; expires=Tue, 15-Oct-24 08:42:10 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=2ODz4dOpnm9nqxtrEtNWFahtuZ3687ZN_O8JpXelVUI-1728979930183-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d2e57a84ceeb6af-OTP'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-15 11:12:09,623 - DEBUG - request_id: req_b2cb33c1947aac54f829fb7ba01cf849
2024-10-15 11:12:09,625 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWwyNvpeZFmHoKpwyVrFui8bcSuZ', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_ozFGwgBpIo1B0D97iYvniNkA', function=Function(arguments='\n{\n  "action": "extract_pii"\n}', name='AgentAction'), type='function')]))], created=1728979928, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=12, prompt_tokens=338, total_tokens=350, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 11:12:09,627 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'instructor.dsl.simple_type.Response'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of:\n1. Extracting personal identifiable information (PII) from documents.\n2. Identifying parties and their roles in the contract.\n3. Determining contract details based on the type of contract.\n4. Constructing a contract using the provided information and templates.\n\nFor each task, provide a structured response that can be easily parsed into the appropriate data model. Always include all necessary information in your response, and format it as a valid JSON object.\n\nWhen extracting PII, identify the name and address of each person mentioned.\nWhen identifying parties, assign roles based on the contract type (e.g., buyer/seller, host/guest, consultant/client).\nWhen determining contract details, specify the contract type and any additional information relevant to that type of contract.\nWhen constructing a contract, use the provided template and fill in all necessary details.\n\nFollow the workflow precisely and indicate when human input or verification is needed.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}}
2024-10-15 11:12:09,627 - DEBUG - max_retries: 1
2024-10-15 11:12:09,628 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of:\n1. Extracting personal identifiable information (PII) from documents.\n2. Identifying parties and their roles in the contract.\n3. Determining contract details based on the type of contract.\n4. Constructing a contract using the provided information and templates.\n\nFor each task, provide a structured response that can be easily parsed into the appropriate data model. Always include all necessary information in your response, and format it as a valid JSON object.\n\nWhen extracting PII, identify the name and address of each person mentioned.\nWhen identifying parties, assign roles based on the contract type (e.g., buyer/seller, host/guest, consultant/client).\nWhen determining contract details, specify the contract type and any additional information relevant to that type of contract.\nWhen constructing a contract, use the provided template and fill in all necessary details.\n\nFollow the workflow precisely and indicate when human input or verification is needed.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}, 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}]}}
2024-10-15 11:12:09,629 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 11:12:09,629 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 11:12:09,629 - DEBUG - send_request_headers.complete
2024-10-15 11:12:09,629 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 11:12:09,629 - DEBUG - send_request_body.complete
2024-10-15 11:12:09,629 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 11:12:13,498 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 08:12:14 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'3715'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9998'), (b'x-ratelimit-remaining-tokens', b'9499'), (b'x-ratelimit-reset-requests', b'15.467s'), (b'x-ratelimit-reset-tokens', b'3.005s'), (b'x-request-id', b'req_b2d33e0c79d4be0fd2810ba96df419f0'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e57b3b879b6af-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 11:12:13,499 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 11:12:13,499 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 11:12:13,500 - DEBUG - receive_response_body.complete
2024-10-15 11:12:13,500 - DEBUG - response_closed.started
2024-10-15 11:12:13,500 - DEBUG - response_closed.complete
2024-10-15 11:12:13,501 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 08:12:14 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '3715', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9998', 'x-ratelimit-remaining-tokens': '9499', 'x-ratelimit-reset-requests': '15.467s', 'x-ratelimit-reset-tokens': '3.005s', 'x-request-id': 'req_b2d33e0c79d4be0fd2810ba96df419f0', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e57b3b879b6af-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 11:12:13,501 - DEBUG - request_id: req_b2d33e0c79d4be0fd2810ba96df419f0
2024-10-15 11:12:13,502 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWx0kZ2sQ8vD1GCvkp4GYUqLPGqy', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_w1CB7ivteHey6D8ARm02LZAT', function=Function(arguments='{\n  "content": [\n    {\n      "name": "T525M ISPILANTE SENTIMENT BRUSLI",\n      "address": "Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR"\n    }\n  ]\n}', name='Response'), type='function')]))], created=1728979930, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=56, prompt_tokens=491, total_tokens=547, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 11:12:13,504 - DEBUG - Returning model from AdapterBase
2024-10-15 11:12:16,097 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'instructor.dsl.simple_type.Response'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of:\n1. Extracting personal identifiable information (PII) from documents.\n2. Identifying parties and their roles in the contract.\n3. Determining contract details based on the type of contract.\n4. Constructing a contract using the provided information and templates.\n\nFor each task, provide a structured response that can be easily parsed into the appropriate data model. Always include all necessary information in your response, and format it as a valid JSON object.\n\nWhen extracting PII, identify the name and address of each person mentioned.\nWhen identifying parties, assign roles based on the contract type (e.g., buyer/seller, host/guest, consultant/client).\nWhen determining contract details, specify the contract type and any additional information relevant to that type of contract.\nWhen constructing a contract, use the provided template and fill in all necessary details.\n\nFollow the workflow precisely and indicate when human input or verification is needed.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}}
2024-10-15 11:12:16,097 - DEBUG - max_retries: 1
2024-10-15 11:12:16,099 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of:\n1. Extracting personal identifiable information (PII) from documents.\n2. Identifying parties and their roles in the contract.\n3. Determining contract details based on the type of contract.\n4. Constructing a contract using the provided information and templates.\n\nFor each task, provide a structured response that can be easily parsed into the appropriate data model. Always include all necessary information in your response, and format it as a valid JSON object.\n\nWhen extracting PII, identify the name and address of each person mentioned.\nWhen identifying parties, assign roles based on the contract type (e.g., buyer/seller, host/guest, consultant/client).\nWhen determining contract details, specify the contract type and any additional information relevant to that type of contract.\nWhen constructing a contract, use the provided template and fill in all necessary details.\n\nFollow the workflow precisely and indicate when human input or verification is needed.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}, 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}]}}
2024-10-15 11:12:16,100 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 11:12:16,100 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 11:12:16,100 - DEBUG - send_request_headers.complete
2024-10-15 11:12:16,100 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 11:12:16,100 - DEBUG - send_request_body.complete
2024-10-15 11:12:16,100 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 11:12:18,892 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 08:12:19 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2640'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9997'), (b'x-ratelimit-remaining-tokens', b'9553'), (b'x-ratelimit-reset-requests', b'17.636s'), (b'x-ratelimit-reset-tokens', b'2.682s'), (b'x-request-id', b'req_0e44fed2b66a9303c69b45732f6565ac'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e57dc2a59b6af-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 11:12:18,892 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 11:12:18,892 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 11:12:18,892 - DEBUG - receive_response_body.complete
2024-10-15 11:12:18,892 - DEBUG - response_closed.started
2024-10-15 11:12:18,892 - DEBUG - response_closed.complete
2024-10-15 11:12:18,893 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 08:12:19 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '2640', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9997', 'x-ratelimit-remaining-tokens': '9553', 'x-ratelimit-reset-requests': '17.636s', 'x-ratelimit-reset-tokens': '2.682s', 'x-request-id': 'req_0e44fed2b66a9303c69b45732f6565ac', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e57dc2a59b6af-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 11:12:18,893 - DEBUG - request_id: req_0e44fed2b66a9303c69b45732f6565ac
2024-10-15 11:12:18,893 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWx6g3f8xPi1pc8JkYZKmQEwK0Ye', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_0lkiHMNISNVGUsIR7g01Y3kx', function=Function(arguments='{\n  "content": [\n    {\n      "name": "VASILESCU ELENA",\n      "address": "Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B"\n    }\n  ]\n}', name='Response'), type='function')]))], created=1728979936, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=55, prompt_tokens=494, total_tokens=549, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 11:12:18,893 - DEBUG - Returning model from AdapterBase
2024-10-15 11:12:20,419 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of:\n1. Extracting personal identifiable information (PII) from documents.\n2. Identifying parties and their roles in the contract.\n3. Determining contract details based on the type of contract.\n4. Constructing a contract using the provided information and templates.\n\nFor each task, provide a structured response that can be easily parsed into the appropriate data model. Always include all necessary information in your response, and format it as a valid JSON object.\n\nWhen extracting PII, identify the name and address of each person mentioned.\nWhen identifying parties, assign roles based on the contract type (e.g., buyer/seller, host/guest, consultant/client).\nWhen determining contract details, specify the contract type and any additional information relevant to that type of contract.\nWhen constructing a contract, use the provided template and fill in all necessary details.\n\nFollow the workflow precisely and indicate when human input or verification is needed.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, determine_contract_type, identify_parties, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 11:12:20,419 - DEBUG - max_retries: 1
2024-10-15 11:12:20,421 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of:\n1. Extracting personal identifiable information (PII) from documents.\n2. Identifying parties and their roles in the contract.\n3. Determining contract details based on the type of contract.\n4. Constructing a contract using the provided information and templates.\n\nFor each task, provide a structured response that can be easily parsed into the appropriate data model. Always include all necessary information in your response, and format it as a valid JSON object.\n\nWhen extracting PII, identify the name and address of each person mentioned.\nWhen identifying parties, assign roles based on the contract type (e.g., buyer/seller, host/guest, consultant/client).\nWhen determining contract details, specify the contract type and any additional information relevant to that type of contract.\nWhen constructing a contract, use the provided template and fill in all necessary details.\n\nFollow the workflow precisely and indicate when human input or verification is needed.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, determine_contract_type, identify_parties, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 11:12:20,421 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 11:12:20,421 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 11:12:20,421 - DEBUG - send_request_headers.complete
2024-10-15 11:12:20,422 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 11:12:20,422 - DEBUG - send_request_body.complete
2024-10-15 11:12:20,422 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 11:12:21,599 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 08:12:22 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1013'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9997'), (b'x-ratelimit-remaining-tokens', b'9636'), (b'x-ratelimit-reset-requests', b'21.948s'), (b'x-ratelimit-reset-tokens', b'2.184s'), (b'x-request-id', b'req_8cf758f8fddbcdf44c801abe898e3039'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e57f72b16b6af-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 11:12:21,600 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 11:12:21,601 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 11:12:21,601 - DEBUG - receive_response_body.complete
2024-10-15 11:12:21,601 - DEBUG - response_closed.started
2024-10-15 11:12:21,601 - DEBUG - response_closed.complete
2024-10-15 11:12:21,602 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 08:12:22 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1013', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9997', 'x-ratelimit-remaining-tokens': '9636', 'x-ratelimit-reset-requests': '21.948s', 'x-ratelimit-reset-tokens': '2.184s', 'x-request-id': 'req_8cf758f8fddbcdf44c801abe898e3039', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e57f72b16b6af-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 11:12:21,602 - DEBUG - request_id: req_8cf758f8fddbcdf44c801abe898e3039
2024-10-15 11:12:21,603 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWxBkE9UQuqBW108zEXtGt52h3x6', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_AyM99qr90PU3ThK4YsBg5FXG', function=Function(arguments='\n{\n  "action": "identify_parties"\n}', name='AgentAction'), type='function')]))], created=1728979941, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=12, prompt_tokens=338, total_tokens=350, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 11:12:21,605 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of:\n1. Extracting personal identifiable information (PII) from documents.\n2. Identifying parties and their roles in the contract.\n3. Determining contract details based on the type of contract.\n4. Constructing a contract using the provided information and templates.\n\nFor each task, provide a structured response that can be easily parsed into the appropriate data model. Always include all necessary information in your response, and format it as a valid JSON object.\n\nWhen extracting PII, identify the name and address of each person mentioned.\nWhen identifying parties, assign roles based on the contract type (e.g., buyer/seller, host/guest, consultant/client).\nWhen determining contract details, specify the contract type and any additional information relevant to that type of contract.\nWhen constructing a contract, use the provided template and fill in all necessary details.\n\nFollow the workflow precisely and indicate when human input or verification is needed.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, determine_contract_type, identify_parties, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 11:12:21,605 - DEBUG - max_retries: 1
2024-10-15 11:12:21,608 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of:\n1. Extracting personal identifiable information (PII) from documents.\n2. Identifying parties and their roles in the contract.\n3. Determining contract details based on the type of contract.\n4. Constructing a contract using the provided information and templates.\n\nFor each task, provide a structured response that can be easily parsed into the appropriate data model. Always include all necessary information in your response, and format it as a valid JSON object.\n\nWhen extracting PII, identify the name and address of each person mentioned.\nWhen identifying parties, assign roles based on the contract type (e.g., buyer/seller, host/guest, consultant/client).\nWhen determining contract details, specify the contract type and any additional information relevant to that type of contract.\nWhen constructing a contract, use the provided template and fill in all necessary details.\n\nFollow the workflow precisely and indicate when human input or verification is needed.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, determine_contract_type, identify_parties, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 11:12:21,609 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 11:12:21,609 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 11:12:21,610 - DEBUG - send_request_headers.complete
2024-10-15 11:12:21,610 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 11:12:21,610 - DEBUG - send_request_body.complete
2024-10-15 11:12:21,610 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 11:12:22,600 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 08:12:23 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'830'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9996'), (b'x-ratelimit-remaining-tokens', b'9483'), (b'x-ratelimit-reset-requests', b'29.402s'), (b'x-ratelimit-reset-tokens', b'3.097s'), (b'x-request-id', b'req_0901fcc62aaaff84d8a0a8a7dd2768c7'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e57fe9c95b6af-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 11:12:22,600 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 11:12:22,600 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 11:12:22,600 - DEBUG - receive_response_body.complete
2024-10-15 11:12:22,600 - DEBUG - response_closed.started
2024-10-15 11:12:22,600 - DEBUG - response_closed.complete
2024-10-15 11:12:22,600 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 08:12:23 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '830', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9996', 'x-ratelimit-remaining-tokens': '9483', 'x-ratelimit-reset-requests': '29.402s', 'x-ratelimit-reset-tokens': '3.097s', 'x-request-id': 'req_0901fcc62aaaff84d8a0a8a7dd2768c7', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e57fe9c95b6af-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 11:12:22,600 - DEBUG - request_id: req_0901fcc62aaaff84d8a0a8a7dd2768c7
2024-10-15 11:12:22,601 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWxCowW1d0Iz0Qdj33FQJHbxoumF', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_772PTnhzKXK3xL9u4K82td3w', function=Function(arguments='{\n"action": "identify_parties"\n}', name='AgentAction'), type='function')]))], created=1728979942, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=10, prompt_tokens=338, total_tokens=348, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 11:12:22,602 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of:\n1. Extracting personal identifiable information (PII) from documents.\n2. Identifying parties and their roles in the contract.\n3. Determining contract details based on the type of contract.\n4. Constructing a contract using the provided information and templates.\n\nFor each task, provide a structured response that can be easily parsed into the appropriate data model. Always include all necessary information in your response, and format it as a valid JSON object.\n\nWhen extracting PII, identify the name and address of each person mentioned.\nWhen identifying parties, assign roles based on the contract type (e.g., buyer/seller, host/guest, consultant/client).\nWhen determining contract details, specify the contract type and any additional information relevant to that type of contract.\nWhen constructing a contract, use the provided template and fill in all necessary details.\n\nFollow the workflow precisely and indicate when human input or verification is needed.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, determine_contract_type, identify_parties, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 11:12:22,602 - DEBUG - max_retries: 1
2024-10-15 11:12:22,605 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of:\n1. Extracting personal identifiable information (PII) from documents.\n2. Identifying parties and their roles in the contract.\n3. Determining contract details based on the type of contract.\n4. Constructing a contract using the provided information and templates.\n\nFor each task, provide a structured response that can be easily parsed into the appropriate data model. Always include all necessary information in your response, and format it as a valid JSON object.\n\nWhen extracting PII, identify the name and address of each person mentioned.\nWhen identifying parties, assign roles based on the contract type (e.g., buyer/seller, host/guest, consultant/client).\nWhen determining contract details, specify the contract type and any additional information relevant to that type of contract.\nWhen constructing a contract, use the provided template and fill in all necessary details.\n\nFollow the workflow precisely and indicate when human input or verification is needed.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, determine_contract_type, identify_parties, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 11:12:22,605 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 11:12:22,605 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 11:12:22,606 - DEBUG - send_request_headers.complete
2024-10-15 11:12:22,606 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 11:12:22,606 - DEBUG - send_request_body.complete
2024-10-15 11:12:22,606 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 11:12:23,507 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 08:12:24 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'724'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9995'), (b'x-ratelimit-remaining-tokens', b'9301'), (b'x-ratelimit-reset-requests', b'37.047s'), (b'x-ratelimit-reset-tokens', b'4.19s'), (b'x-request-id', b'req_bfcad94ab37ab590a1b233bc9eca311c'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e5804cb2cb6af-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 11:12:23,508 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 11:12:23,508 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 11:12:23,508 - DEBUG - receive_response_body.complete
2024-10-15 11:12:23,508 - DEBUG - response_closed.started
2024-10-15 11:12:23,508 - DEBUG - response_closed.complete
2024-10-15 11:12:23,508 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 08:12:24 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '724', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9995', 'x-ratelimit-remaining-tokens': '9301', 'x-ratelimit-reset-requests': '37.047s', 'x-ratelimit-reset-tokens': '4.19s', 'x-request-id': 'req_bfcad94ab37ab590a1b233bc9eca311c', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e5804cb2cb6af-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 11:12:23,508 - DEBUG - request_id: req_bfcad94ab37ab590a1b233bc9eca311c
2024-10-15 11:12:23,508 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWxDzsvgrtZcb3BsHgTA8vYoikjv', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_PbtT2OSim3DOFN0JcZEuRD8j', function=Function(arguments='\n{\n  "action": "identify_parties"\n}', name='AgentAction'), type='function')]))], created=1728979943, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=12, prompt_tokens=338, total_tokens=350, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 11:12:23,509 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of:\n1. Extracting personal identifiable information (PII) from documents.\n2. Identifying parties and their roles in the contract.\n3. Determining contract details based on the type of contract.\n4. Constructing a contract using the provided information and templates.\n\nFor each task, provide a structured response that can be easily parsed into the appropriate data model. Always include all necessary information in your response, and format it as a valid JSON object.\n\nWhen extracting PII, identify the name and address of each person mentioned.\nWhen identifying parties, assign roles based on the contract type (e.g., buyer/seller, host/guest, consultant/client).\nWhen determining contract details, specify the contract type and any additional information relevant to that type of contract.\nWhen constructing a contract, use the provided template and fill in all necessary details.\n\nFollow the workflow precisely and indicate when human input or verification is needed.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, determine_contract_type, identify_parties, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 11:12:23,510 - DEBUG - max_retries: 1
2024-10-15 11:12:23,512 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of:\n1. Extracting personal identifiable information (PII) from documents.\n2. Identifying parties and their roles in the contract.\n3. Determining contract details based on the type of contract.\n4. Constructing a contract using the provided information and templates.\n\nFor each task, provide a structured response that can be easily parsed into the appropriate data model. Always include all necessary information in your response, and format it as a valid JSON object.\n\nWhen extracting PII, identify the name and address of each person mentioned.\nWhen identifying parties, assign roles based on the contract type (e.g., buyer/seller, host/guest, consultant/client).\nWhen determining contract details, specify the contract type and any additional information relevant to that type of contract.\nWhen constructing a contract, use the provided template and fill in all necessary details.\n\nFollow the workflow precisely and indicate when human input or verification is needed.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, determine_contract_type, identify_parties, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 11:12:23,513 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 11:12:23,513 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 11:12:23,513 - DEBUG - send_request_headers.complete
2024-10-15 11:12:23,513 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 11:12:23,514 - DEBUG - send_request_body.complete
2024-10-15 11:12:23,514 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 11:12:24,863 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 08:12:25 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1188'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9994'), (b'x-ratelimit-remaining-tokens', b'9103'), (b'x-ratelimit-reset-requests', b'44.775s'), (b'x-ratelimit-reset-tokens', b'5.379s'), (b'x-request-id', b'req_d7c391eca2677a36a8a6a0a32feb95bb'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e580a7a61b6af-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 11:12:24,863 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 11:12:24,863 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 11:12:24,864 - DEBUG - receive_response_body.complete
2024-10-15 11:12:24,864 - DEBUG - response_closed.started
2024-10-15 11:12:24,864 - DEBUG - response_closed.complete
2024-10-15 11:12:24,864 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 08:12:25 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1188', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9994', 'x-ratelimit-remaining-tokens': '9103', 'x-ratelimit-reset-requests': '44.775s', 'x-ratelimit-reset-tokens': '5.379s', 'x-request-id': 'req_d7c391eca2677a36a8a6a0a32feb95bb', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e580a7a61b6af-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 11:12:24,864 - DEBUG - request_id: req_d7c391eca2677a36a8a6a0a32feb95bb
2024-10-15 11:12:24,864 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWxEgzNFIjLY8DPGFjCHZPFjWcWb', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_Vfc628vAvToEjkdc88C8PqCK', function=Function(arguments='\n{\n  "action": "identify_parties"\n}', name='AgentAction'), type='function')]))], created=1728979944, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=12, prompt_tokens=338, total_tokens=350, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 11:12:24,865 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of:\n1. Extracting personal identifiable information (PII) from documents.\n2. Identifying parties and their roles in the contract.\n3. Determining contract details based on the type of contract.\n4. Constructing a contract using the provided information and templates.\n\nFor each task, provide a structured response that can be easily parsed into the appropriate data model. Always include all necessary information in your response, and format it as a valid JSON object.\n\nWhen extracting PII, identify the name and address of each person mentioned.\nWhen identifying parties, assign roles based on the contract type (e.g., buyer/seller, host/guest, consultant/client).\nWhen determining contract details, specify the contract type and any additional information relevant to that type of contract.\nWhen constructing a contract, use the provided template and fill in all necessary details.\n\nFollow the workflow precisely and indicate when human input or verification is needed.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, determine_contract_type, identify_parties, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 11:12:24,865 - DEBUG - max_retries: 1
2024-10-15 11:12:24,866 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of:\n1. Extracting personal identifiable information (PII) from documents.\n2. Identifying parties and their roles in the contract.\n3. Determining contract details based on the type of contract.\n4. Constructing a contract using the provided information and templates.\n\nFor each task, provide a structured response that can be easily parsed into the appropriate data model. Always include all necessary information in your response, and format it as a valid JSON object.\n\nWhen extracting PII, identify the name and address of each person mentioned.\nWhen identifying parties, assign roles based on the contract type (e.g., buyer/seller, host/guest, consultant/client).\nWhen determining contract details, specify the contract type and any additional information relevant to that type of contract.\nWhen constructing a contract, use the provided template and fill in all necessary details.\n\nFollow the workflow precisely and indicate when human input or verification is needed.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, determine_contract_type, identify_parties, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 11:12:24,867 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 11:12:24,867 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 11:12:24,867 - DEBUG - send_request_headers.complete
2024-10-15 11:12:24,867 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 11:12:24,867 - DEBUG - send_request_body.complete
2024-10-15 11:12:24,867 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 11:12:26,036 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 08:12:26 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1003'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9993'), (b'x-ratelimit-remaining-tokens', b'8979'), (b'x-ratelimit-reset-requests', b'52.062s'), (b'x-ratelimit-reset-tokens', b'6.125s'), (b'x-request-id', b'req_6b61531079780e439f1f98849b77490e'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e5812fbe7b6af-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 11:12:26,037 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 11:12:26,037 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 11:12:26,037 - DEBUG - receive_response_body.complete
2024-10-15 11:12:26,037 - DEBUG - response_closed.started
2024-10-15 11:12:26,037 - DEBUG - response_closed.complete
2024-10-15 11:12:26,037 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 08:12:26 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1003', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9993', 'x-ratelimit-remaining-tokens': '8979', 'x-ratelimit-reset-requests': '52.062s', 'x-ratelimit-reset-tokens': '6.125s', 'x-request-id': 'req_6b61531079780e439f1f98849b77490e', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e5812fbe7b6af-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 11:12:26,037 - DEBUG - request_id: req_6b61531079780e439f1f98849b77490e
2024-10-15 11:12:26,038 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWxFnwXFWy8uNQOTl1DsOq1hXzXg', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_tOxYB0wOeFKrPWG948oNg3j9', function=Function(arguments='{\n"action": "identify_parties"\n}', name='AgentAction'), type='function')]))], created=1728979945, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=10, prompt_tokens=338, total_tokens=348, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 11:12:26,039 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of:\n1. Extracting personal identifiable information (PII) from documents.\n2. Identifying parties and their roles in the contract.\n3. Determining contract details based on the type of contract.\n4. Constructing a contract using the provided information and templates.\n\nFor each task, provide a structured response that can be easily parsed into the appropriate data model. Always include all necessary information in your response, and format it as a valid JSON object.\n\nWhen extracting PII, identify the name and address of each person mentioned.\nWhen identifying parties, assign roles based on the contract type (e.g., buyer/seller, host/guest, consultant/client).\nWhen determining contract details, specify the contract type and any additional information relevant to that type of contract.\nWhen constructing a contract, use the provided template and fill in all necessary details.\n\nFollow the workflow precisely and indicate when human input or verification is needed.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, determine_contract_type, identify_parties, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 11:12:26,039 - DEBUG - max_retries: 1
2024-10-15 11:12:26,040 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of:\n1. Extracting personal identifiable information (PII) from documents.\n2. Identifying parties and their roles in the contract.\n3. Determining contract details based on the type of contract.\n4. Constructing a contract using the provided information and templates.\n\nFor each task, provide a structured response that can be easily parsed into the appropriate data model. Always include all necessary information in your response, and format it as a valid JSON object.\n\nWhen extracting PII, identify the name and address of each person mentioned.\nWhen identifying parties, assign roles based on the contract type (e.g., buyer/seller, host/guest, consultant/client).\nWhen determining contract details, specify the contract type and any additional information relevant to that type of contract.\nWhen constructing a contract, use the provided template and fill in all necessary details.\n\nFollow the workflow precisely and indicate when human input or verification is needed.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, determine_contract_type, identify_parties, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 11:12:26,040 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 11:12:26,041 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 11:12:26,041 - DEBUG - send_request_headers.complete
2024-10-15 11:12:26,041 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 11:12:26,041 - DEBUG - send_request_body.complete
2024-10-15 11:12:26,041 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 11:12:27,387 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 08:12:27 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1173'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9993'), (b'x-ratelimit-remaining-tokens', b'8826'), (b'x-ratelimit-reset-requests', b'59.531s'), (b'x-ratelimit-reset-tokens', b'7.042s'), (b'x-request-id', b'req_ec14cb1076254fad2c2d87124a201896'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e581a4c2eb6af-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 11:12:27,388 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 11:12:27,388 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 11:12:27,388 - DEBUG - receive_response_body.complete
2024-10-15 11:12:27,388 - DEBUG - response_closed.started
2024-10-15 11:12:27,388 - DEBUG - response_closed.complete
2024-10-15 11:12:27,388 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 08:12:27 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1173', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9993', 'x-ratelimit-remaining-tokens': '8826', 'x-ratelimit-reset-requests': '59.531s', 'x-ratelimit-reset-tokens': '7.042s', 'x-request-id': 'req_ec14cb1076254fad2c2d87124a201896', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e581a4c2eb6af-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 11:12:27,388 - DEBUG - request_id: req_ec14cb1076254fad2c2d87124a201896
2024-10-15 11:12:27,389 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWxGNvxrzDCJFU8WFk7Yy4iDbE6r', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_d7enpfVZVgjBvOOw8ffemtZy', function=Function(arguments='{\n"action": "identify_parties"\n}', name='AgentAction'), type='function')]))], created=1728979946, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=10, prompt_tokens=338, total_tokens=348, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 11:12:27,390 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of:\n1. Extracting personal identifiable information (PII) from documents.\n2. Identifying parties and their roles in the contract.\n3. Determining contract details based on the type of contract.\n4. Constructing a contract using the provided information and templates.\n\nFor each task, provide a structured response that can be easily parsed into the appropriate data model. Always include all necessary information in your response, and format it as a valid JSON object.\n\nWhen extracting PII, identify the name and address of each person mentioned.\nWhen identifying parties, assign roles based on the contract type (e.g., buyer/seller, host/guest, consultant/client).\nWhen determining contract details, specify the contract type and any additional information relevant to that type of contract.\nWhen constructing a contract, use the provided template and fill in all necessary details.\n\nFollow the workflow precisely and indicate when human input or verification is needed.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, determine_contract_type, identify_parties, construct_contract, finish'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 11:12:27,390 - DEBUG - max_retries: 1
2024-10-15 11:12:27,391 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of:\n1. Extracting personal identifiable information (PII) from documents.\n2. Identifying parties and their roles in the contract.\n3. Determining contract details based on the type of contract.\n4. Constructing a contract using the provided information and templates.\n\nFor each task, provide a structured response that can be easily parsed into the appropriate data model. Always include all necessary information in your response, and format it as a valid JSON object.\n\nWhen extracting PII, identify the name and address of each person mentioned.\nWhen identifying parties, assign roles based on the contract type (e.g., buyer/seller, host/guest, consultant/client).\nWhen determining contract details, specify the contract type and any additional information relevant to that type of contract.\nWhen constructing a contract, use the provided template and fill in all necessary details.\n\nFollow the workflow precisely and indicate when human input or verification is needed.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Parties identified: No\n    - Contract type determined: No\n    - Contract constructed: No\n    \nWhat action should be taken next? Choose from: extract_pii, determine_contract_type, identify_parties, construct_contract, finish'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 11:12:27,392 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 11:12:27,392 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 11:12:27,392 - DEBUG - send_request_headers.complete
2024-10-15 11:12:27,392 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 11:12:27,392 - DEBUG - send_request_body.complete
2024-10-15 11:12:27,392 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 11:12:28,441 - DEBUG - receive_response_headers.failed exception=KeyboardInterrupt()
2024-10-15 11:12:28,441 - DEBUG - response_closed.started
2024-10-15 11:12:28,441 - DEBUG - response_closed.complete
2024-10-15 11:12:28,631 - ERROR - Task exception was never retrieved
future: <Task finished name='Task-1' coro=<agent_workflow() done, defined at D:\deve\contract_automation\src\main.py:26> exception=KeyboardInterrupt()>
Traceback (most recent call last):
  File "D:\deve\contract_automation\src\main.py", line 111, in <module>
    asyncio.run(agent_workflow())
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 30, in run
    return loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 92, in run_until_complete
    self._run_once()
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 133, in _run_once
    handle._run()
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 386, in __wakeup
    self.__step()
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 293, in __step
    self.__step_run_and_handle_result(exc)
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 304, in __step_run_and_handle_result
    result = coro.send(None)
             ^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\src\main.py", line 34, in agent_workflow
    action = agent_action(state)
             ^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\src\ai_functions.py", line 172, in agent_action
    response = client.chat.completions.create(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\instructor\patch.py", line 291, in new_create_sync
    response = retry_sync(
               ^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\instructor\retry.py", line 189, in retry_sync
    for attempt in max_retries:
  File "D:\deve\contract_automation\.venv\Lib\site-packages\tenacity\__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\tenacity\__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\tenacity\__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\deve\contract_automation\.venv\Lib\site-packages\instructor\retry.py", line 192, in retry_sync
    response = func(*args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\openai\_utils\_utils.py", line 274, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\openai\resources\chat\completions.py", line 742, in create
    return self._post(
           ^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\openai\_base_client.py", line 1270, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\openai\_base_client.py", line 947, in request
    return self._request(
           ^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\openai\_base_client.py", line 983, in _request
    response = self._client.send(
               ^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpx\_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpx\_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpx\_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpx\_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpx\_transports\default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpcore\_sync\connection_pool.py", line 216, in handle_request
    raise exc from None
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpcore\_sync\connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpcore\_sync\connection.py", line 101, in handle_request
    return self._connection.handle_request(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpcore\_sync\http11.py", line 143, in handle_request
    raise exc
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpcore\_sync\http11.py", line 113, in handle_request
    ) = self._receive_response_headers(**kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpcore\_sync\http11.py", line 186, in _receive_response_headers
    event = self._receive_event(timeout=timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpcore\_sync\http11.py", line 224, in _receive_event
    data = self._network_stream.read(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpcore\_backends\sync.py", line 126, in read
    return self._sock.recv(max_bytes)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\ssl.py", line 1234, in recv
    return self.read(buflen)
           ^^^^^^^^^^^^^^^^^
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\ssl.py", line 1107, in read
    return self._sslobj.read(len)
           ^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
2024-10-15 11:14:15,998 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-15 11:14:17,255 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-15 11:14:17,256 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-15 11:14:17,582 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-15 11:14:17,582 - DEBUG - Using proactor: IocpProactor
2024-10-15 11:14:17,601 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 11:14:17,601 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 11:14:17,601 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 11:14:17,601 - DEBUG - Compression method 0
2024-10-15 11:14:17,601 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 11:14:17,601 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 11:14:17,601 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 11:14:17,601 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 11:14:17,601 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 11:14:17,601 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 11:14:17,601 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 11:14:17,601 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 11:14:17,601 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 11:14:17,601 - DEBUG - Compression method 0
2024-10-15 11:14:17,601 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 11:14:17,601 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 11:14:17,601 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 11:14:17,601 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 11:14:17,601 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 11:14:17,601 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 11:14:17,611 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 11:14:17,611 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 11:14:17,611 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 11:14:17,611 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 11:14:17,612 - DEBUG - Error closing: Operation on closed image
2024-10-15 11:14:19,646 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 11:14:19,646 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 11:14:19,646 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 11:14:19,646 - DEBUG - Compression method 0
2024-10-15 11:14:19,646 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 11:14:19,646 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 11:14:19,646 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 11:14:19,646 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 11:14:19,646 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 11:14:19,646 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 11:14:19,646 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 11:14:19,646 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 11:14:19,646 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 11:14:19,646 - DEBUG - Compression method 0
2024-10-15 11:14:19,646 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 11:14:19,647 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 11:14:19,647 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 11:14:19,647 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 11:14:19,647 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 11:14:19,647 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 11:14:19,664 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 11:14:19,664 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 11:14:19,664 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 11:14:19,664 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 11:14:19,665 - DEBUG - Error closing: Operation on closed image
2024-10-15 11:14:22,231 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 0 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 11:14:22,232 - DEBUG - max_retries: 1
2024-10-15 11:14:22,234 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 0 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 11:14:22,273 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 11:14:22,273 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-15 11:14:22,300 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000002AC539F7BF0>
2024-10-15 11:14:22,300 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x000002AC5386E650> server_hostname='api.openai.com' timeout=5.0
2024-10-15 11:14:22,308 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000002AC53C000E0>
2024-10-15 11:14:22,308 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 11:14:22,308 - DEBUG - send_request_headers.complete
2024-10-15 11:14:22,308 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 11:14:22,308 - DEBUG - send_request_body.complete
2024-10-15 11:14:22,308 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 11:14:24,388 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 08:14:24 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1928'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'9608'), (b'x-ratelimit-reset-requests', b'8.64s'), (b'x-ratelimit-reset-tokens', b'2.352s'), (b'x-request-id', b'req_b8af7223862f74764112e05d1bb945fe'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=v6QAdWbg6s0DMcLs2jF.CY9EkgszHDZVfESggqaZDA4-1728980064-1.0.1.1-c68SO2b58L97ejPPnNLJiC1gi3O6WDT5JrvIn.1kHB61BwtbuWNl4On6dtce83EtMtWFPLgRZbNXe76jHIoegQ; path=/; expires=Tue, 15-Oct-24 08:44:24 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=wZ3hZwR8UugKABbqTlPHcdVz3REER7PoNGNC.Zpc2iU-1728980064936-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e5af0dd76c9d3-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 11:14:24,390 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 11:14:24,391 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 11:14:24,391 - DEBUG - receive_response_body.complete
2024-10-15 11:14:24,392 - DEBUG - response_closed.started
2024-10-15 11:14:24,392 - DEBUG - response_closed.complete
2024-10-15 11:14:24,392 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Tue, 15 Oct 2024 08:14:24 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-kzzh9hik9ryjiou4ftvhondh'), ('openai-processing-ms', '1928'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '10000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '9608'), ('x-ratelimit-reset-requests', '8.64s'), ('x-ratelimit-reset-tokens', '2.352s'), ('x-request-id', 'req_b8af7223862f74764112e05d1bb945fe'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=v6QAdWbg6s0DMcLs2jF.CY9EkgszHDZVfESggqaZDA4-1728980064-1.0.1.1-c68SO2b58L97ejPPnNLJiC1gi3O6WDT5JrvIn.1kHB61BwtbuWNl4On6dtce83EtMtWFPLgRZbNXe76jHIoegQ; path=/; expires=Tue, 15-Oct-24 08:44:24 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=wZ3hZwR8UugKABbqTlPHcdVz3REER7PoNGNC.Zpc2iU-1728980064936-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d2e5af0dd76c9d3-OTP'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-15 11:14:24,392 - DEBUG - request_id: req_b8af7223862f74764112e05d1bb945fe
2024-10-15 11:14:24,396 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIWz9KJnOqbEbQd4fV1T3NhJhTUkG', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_SnVx655i05r9ZR9CoTSgzasD', function=Function(arguments='\n{\n  "action": "determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728980063, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=13, prompt_tokens=360, total_tokens=373, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 11:16:07,798 - DEBUG - close.started
2024-10-15 11:16:07,798 - DEBUG - close.complete
2024-10-15 11:16:07,798 - ERROR - Task exception was never retrieved
future: <Task finished name='Task-1' coro=<agent_workflow() done, defined at D:\deve\contract_automation\src\main.py:26> exception=KeyboardInterrupt()>
Traceback (most recent call last):
  File "D:\deve\contract_automation\src\main.py", line 98, in <module>
    asyncio.run(agent_workflow())
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 30, in run
    return loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 92, in run_until_complete
    self._run_once()
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 133, in _run_once
    handle._run()
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 386, in __wakeup
    self.__step()
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 293, in __step
    self.__step_run_and_handle_result(exc)
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 304, in __step_run_and_handle_result
    result = coro.send(None)
             ^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\src\main.py", line 47, in agent_workflow
    contract_type = input("Enter the desired contract type: ").lower().replace(" ", "-")
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
2024-10-15 11:16:11,231 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-15 11:16:12,481 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-15 11:16:12,482 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-15 11:16:12,805 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-15 11:16:12,806 - DEBUG - Using proactor: IocpProactor
2024-10-15 11:16:12,825 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 11:16:12,825 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 11:16:12,825 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 11:16:12,825 - DEBUG - Compression method 0
2024-10-15 11:16:12,825 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 11:16:12,825 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 11:16:12,825 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 11:16:12,825 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 11:16:12,825 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 11:16:12,825 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 11:16:12,825 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 11:16:12,825 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 11:16:12,825 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 11:16:12,825 - DEBUG - Compression method 0
2024-10-15 11:16:12,825 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 11:16:12,825 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 11:16:12,825 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 11:16:12,825 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 11:16:12,825 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 11:16:12,825 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 11:16:12,835 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 11:16:12,835 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 11:16:12,835 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 11:16:12,835 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 11:16:12,836 - DEBUG - Error closing: Operation on closed image
2024-10-15 11:16:14,824 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 11:16:14,824 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 11:16:14,824 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 11:16:14,824 - DEBUG - Compression method 0
2024-10-15 11:16:14,824 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 11:16:14,824 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 11:16:14,824 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 11:16:14,824 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 11:16:14,824 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 11:16:14,824 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 11:16:14,824 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 11:16:14,824 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 11:16:14,824 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 11:16:14,824 - DEBUG - Compression method 0
2024-10-15 11:16:14,824 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 11:16:14,824 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 11:16:14,824 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 11:16:14,824 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 11:16:14,824 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 11:16:14,824 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 11:16:14,841 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 11:16:14,841 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 11:16:14,841 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 11:16:14,842 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 11:16:14,842 - DEBUG - Error closing: Operation on closed image
2024-10-15 11:16:17,343 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 0 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 11:16:17,344 - DEBUG - max_retries: 1
2024-10-15 11:16:17,346 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 0 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 11:16:17,384 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 11:16:17,384 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-15 11:16:17,441 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001A75E053F20>
2024-10-15 11:16:17,441 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x000001A75DEBE650> server_hostname='api.openai.com' timeout=5.0
2024-10-15 11:16:17,450 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001A75DE04FE0>
2024-10-15 11:16:17,450 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 11:16:17,450 - DEBUG - send_request_headers.complete
2024-10-15 11:16:17,450 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 11:16:17,450 - DEBUG - send_request_body.complete
2024-10-15 11:16:17,450 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 11:16:18,487 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 08:16:19 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'830'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'9608'), (b'x-ratelimit-reset-requests', b'8.64s'), (b'x-ratelimit-reset-tokens', b'2.352s'), (b'x-request-id', b'req_d335c4f8ccb03deca653d9157ee22f80'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=VWfAgLam.ZNisHjyv3TYZCFGn.bE1gGryP3V8pvK.cs-1728980179-1.0.1.1-W7nsaGqcKxaEYeQA7uEppqt4ptKfxj2EOCMhMuuA3c6p9hkTQEkzGhbJ4rPETVDyNSU2R38DYbXL0spPOarF9A; path=/; expires=Tue, 15-Oct-24 08:46:19 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=zUTW_GKe1ip5RbDFl76.cTvYRkGcLyIetZeR_JtJRdc-1728980179024-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e5dc07e2c26e0-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 11:16:18,487 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 11:16:18,488 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 11:16:18,488 - DEBUG - receive_response_body.complete
2024-10-15 11:16:18,488 - DEBUG - response_closed.started
2024-10-15 11:16:18,488 - DEBUG - response_closed.complete
2024-10-15 11:16:18,488 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Tue, 15 Oct 2024 08:16:19 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-kzzh9hik9ryjiou4ftvhondh'), ('openai-processing-ms', '830'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '10000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '9608'), ('x-ratelimit-reset-requests', '8.64s'), ('x-ratelimit-reset-tokens', '2.352s'), ('x-request-id', 'req_d335c4f8ccb03deca653d9157ee22f80'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=VWfAgLam.ZNisHjyv3TYZCFGn.bE1gGryP3V8pvK.cs-1728980179-1.0.1.1-W7nsaGqcKxaEYeQA7uEppqt4ptKfxj2EOCMhMuuA3c6p9hkTQEkzGhbJ4rPETVDyNSU2R38DYbXL0spPOarF9A; path=/; expires=Tue, 15-Oct-24 08:46:19 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=zUTW_GKe1ip5RbDFl76.cTvYRkGcLyIetZeR_JtJRdc-1728980179024-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d2e5dc07e2c26e0-OTP'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-15 11:16:18,488 - DEBUG - request_id: req_d335c4f8ccb03deca653d9157ee22f80
2024-10-15 11:16:18,490 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIX10DYDp4KuqsaYWrw4wMAFeWQ5n', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_3V5gKOHLIl1GkPfyfb1fY0bf', function=Function(arguments='{\n  "action": "determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728980178, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=12, prompt_tokens=360, total_tokens=372, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 11:16:29,840 - DEBUG - close.started
2024-10-15 11:16:29,841 - DEBUG - close.complete
2024-10-15 11:16:29,841 - ERROR - Task exception was never retrieved
future: <Task finished name='Task-1' coro=<agent_workflow() done, defined at D:\deve\contract_automation\src\main.py:26> exception=KeyboardInterrupt()>
Traceback (most recent call last):
  File "D:\deve\contract_automation\src\main.py", line 98, in <module>
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 30, in run
    return loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 92, in run_until_complete
    self._run_once()
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 133, in _run_once
    handle._run()
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 386, in __wakeup
    self.__step()
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 293, in __step
    self.__step_run_and_handle_result(exc)
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 304, in __step_run_and_handle_result
    result = coro.send(None)
             ^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\src\main.py", line 47, in agent_workflow
    print(f"- {template.split('.')[0]}")
                    ^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
2024-10-15 11:16:33,611 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-15 11:16:34,861 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-15 11:16:34,862 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-15 11:16:35,176 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-15 11:16:35,180 - DEBUG - Using proactor: IocpProactor
2024-10-15 11:16:35,199 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 11:16:35,199 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 11:16:35,199 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 11:16:35,199 - DEBUG - Compression method 0
2024-10-15 11:16:35,199 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 11:16:35,199 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 11:16:35,199 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 11:16:35,200 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 11:16:35,200 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 11:16:35,200 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 11:16:35,200 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 11:16:35,200 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 11:16:35,200 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 11:16:35,200 - DEBUG - Compression method 0
2024-10-15 11:16:35,200 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 11:16:35,200 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 11:16:35,200 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 11:16:35,200 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 11:16:35,200 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 11:16:35,200 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 11:16:35,210 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 11:16:35,210 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 11:16:35,210 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 11:16:35,210 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 11:16:35,210 - DEBUG - Error closing: Operation on closed image
2024-10-15 11:16:37,192 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 11:16:37,192 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 11:16:37,192 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 11:16:37,192 - DEBUG - Compression method 0
2024-10-15 11:16:37,192 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 11:16:37,192 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 11:16:37,192 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 11:16:37,192 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 11:16:37,192 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 11:16:37,192 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 11:16:37,192 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 11:16:37,192 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 11:16:37,193 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 11:16:37,193 - DEBUG - Compression method 0
2024-10-15 11:16:37,193 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 11:16:37,193 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 11:16:37,193 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 11:16:37,193 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 11:16:37,193 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 11:16:37,193 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 11:16:37,210 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 11:16:37,210 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 11:16:37,210 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 11:16:37,210 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 11:16:37,211 - DEBUG - Error closing: Operation on closed image
2024-10-15 11:16:39,717 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'instructor.dsl.simple_type.Response'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}}
2024-10-15 11:16:39,718 - DEBUG - max_retries: 1
2024-10-15 11:16:39,720 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}, 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}]}}
2024-10-15 11:16:39,757 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 11:16:39,757 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-15 11:16:39,768 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001DAFE7BF9B0>
2024-10-15 11:16:39,768 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x000001DA9A12E6D0> server_hostname='api.openai.com' timeout=5.0
2024-10-15 11:16:39,775 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001DA9A296B70>
2024-10-15 11:16:39,775 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 11:16:39,775 - DEBUG - send_request_headers.complete
2024-10-15 11:16:39,775 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 11:16:39,775 - DEBUG - send_request_body.complete
2024-10-15 11:16:39,775 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 11:16:42,338 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 08:16:42 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2408'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'9569'), (b'x-ratelimit-reset-requests', b'8.64s'), (b'x-ratelimit-reset-tokens', b'2.586s'), (b'x-request-id', b'req_5d545dc30ca0b93c8ffcc487d5bd3944'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=KubQJTPsXca8MAbvZ6fjLe3LV_lSy_UgU0tRcQI2VT4-1728980202-1.0.1.1-2efs_ISh7vPYgS_AMHCYSFTIJNlceKy1MiV02Syt2vYfy1LG0uNvowP5s5hvjl_RUB4OoLo6B9pRcpXI..nr2w; path=/; expires=Tue, 15-Oct-24 08:46:42 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=FuoS88Ft6wvm9hL1DadXhVoK8FB23h.6YFQAA8XeEfE-1728980202873-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e5e4bf922c9dd-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 11:16:42,340 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 11:16:42,341 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 11:16:42,341 - DEBUG - receive_response_body.complete
2024-10-15 11:16:42,342 - DEBUG - response_closed.started
2024-10-15 11:16:42,342 - DEBUG - response_closed.complete
2024-10-15 11:16:42,342 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Tue, 15 Oct 2024 08:16:42 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-kzzh9hik9ryjiou4ftvhondh'), ('openai-processing-ms', '2408'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '10000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '9569'), ('x-ratelimit-reset-requests', '8.64s'), ('x-ratelimit-reset-tokens', '2.586s'), ('x-request-id', 'req_5d545dc30ca0b93c8ffcc487d5bd3944'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=KubQJTPsXca8MAbvZ6fjLe3LV_lSy_UgU0tRcQI2VT4-1728980202-1.0.1.1-2efs_ISh7vPYgS_AMHCYSFTIJNlceKy1MiV02Syt2vYfy1LG0uNvowP5s5hvjl_RUB4OoLo6B9pRcpXI..nr2w; path=/; expires=Tue, 15-Oct-24 08:46:42 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=FuoS88Ft6wvm9hL1DadXhVoK8FB23h.6YFQAA8XeEfE-1728980202873-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d2e5e4bf922c9dd-OTP'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-15 11:16:42,342 - DEBUG - request_id: req_5d545dc30ca0b93c8ffcc487d5bd3944
2024-10-15 11:16:42,345 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIX1MAaPrBCWz4YHsY2R7PmTvbWQa', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_YX5G6Dg3mtKiIcxlhjWK4jzf', function=Function(arguments='{\n  "content": [\n    {\n      "name": "T525M ISPILANTE SENTIMENT BRUSLI",\n      "address": "Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR"\n    }\n  ]\n}', name='Response'), type='function')]))], created=1728980200, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=56, prompt_tokens=472, total_tokens=528, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 11:16:42,345 - DEBUG - Returning model from AdapterBase
2024-10-15 11:16:44,287 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'instructor.dsl.simple_type.Response'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}}
2024-10-15 11:16:44,287 - DEBUG - max_retries: 1
2024-10-15 11:16:44,289 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}, 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}]}}
2024-10-15 11:16:44,290 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 11:16:44,290 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 11:16:44,290 - DEBUG - send_request_headers.complete
2024-10-15 11:16:44,290 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 11:16:44,290 - DEBUG - send_request_body.complete
2024-10-15 11:16:44,291 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 11:16:46,630 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 08:16:47 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2183'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9998'), (b'x-ratelimit-remaining-tokens', b'9576'), (b'x-ratelimit-reset-requests', b'12.764s'), (b'x-ratelimit-reset-tokens', b'2.544s'), (b'x-request-id', b'req_4e813a7d87174bf47bc71126a5a11b1f'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e5e682fe4c9dd-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 11:16:46,631 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 11:16:46,631 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 11:16:46,631 - DEBUG - receive_response_body.complete
2024-10-15 11:16:46,631 - DEBUG - response_closed.started
2024-10-15 11:16:46,632 - DEBUG - response_closed.complete
2024-10-15 11:16:46,632 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 08:16:47 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '2183', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9998', 'x-ratelimit-remaining-tokens': '9576', 'x-ratelimit-reset-requests': '12.764s', 'x-ratelimit-reset-tokens': '2.544s', 'x-request-id': 'req_4e813a7d87174bf47bc71126a5a11b1f', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e5e682fe4c9dd-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 11:16:46,632 - DEBUG - request_id: req_4e813a7d87174bf47bc71126a5a11b1f
2024-10-15 11:16:46,633 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIX1Rt6ZoQ8MwcBRA0XB2UjcoCbDC', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_hJLEBKY6ESsiGXwI1iw1YUB6', function=Function(arguments='{\n  "content": [\n    {\n      "name": "ELENA VASILESCU",\n      "address": "Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B"\n    }\n  ]\n}', name='Response'), type='function')]))], created=1728980205, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=56, prompt_tokens=475, total_tokens=531, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 11:16:46,634 - DEBUG - Returning model from AdapterBase
2024-10-15 11:16:49,883 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 11:16:49,883 - DEBUG - max_retries: 1
2024-10-15 11:16:49,884 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 11:16:49,884 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 11:16:49,885 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 11:16:49,885 - DEBUG - send_request_headers.complete
2024-10-15 11:16:49,885 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 11:16:49,885 - DEBUG - send_request_body.complete
2024-10-15 11:16:49,885 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 11:16:51,291 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 08:16:51 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1246'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9998'), (b'x-ratelimit-remaining-tokens', b'9608'), (b'x-ratelimit-reset-requests', b'15.801s'), (b'x-ratelimit-reset-tokens', b'2.352s'), (b'x-request-id', b'req_b97077ad4d42afc74df9a0c18fb67118'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e5e8b2de8c9dd-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 11:16:51,292 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 11:16:51,292 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 11:16:51,292 - DEBUG - receive_response_body.complete
2024-10-15 11:16:51,292 - DEBUG - response_closed.started
2024-10-15 11:16:51,293 - DEBUG - response_closed.complete
2024-10-15 11:16:51,293 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 08:16:51 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1246', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9998', 'x-ratelimit-remaining-tokens': '9608', 'x-ratelimit-reset-requests': '15.801s', 'x-ratelimit-reset-tokens': '2.352s', 'x-request-id': 'req_b97077ad4d42afc74df9a0c18fb67118', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e5e8b2de8c9dd-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 11:16:51,293 - DEBUG - request_id: req_b97077ad4d42afc74df9a0c18fb67118
2024-10-15 11:16:51,294 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIX1Wk9l0UIofXMjfc2Zb2CGBTVCB', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_a1lOkKT1eSgMeNLhewYVQX5c', function=Function(arguments='\n{\n  "action": "determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728980210, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=13, prompt_tokens=360, total_tokens=373, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 11:16:56,838 - DEBUG - close.started
2024-10-15 11:16:56,838 - DEBUG - close.complete
2024-10-15 11:43:45,346 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-15 11:43:46,592 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-15 11:43:46,593 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-15 11:43:46,912 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-15 11:43:46,913 - DEBUG - Using proactor: IocpProactor
2024-10-15 11:43:46,931 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 11:43:46,931 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 11:43:46,931 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 11:43:46,931 - DEBUG - Compression method 0
2024-10-15 11:43:46,932 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 11:43:46,932 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 11:43:46,932 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 11:43:46,932 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 11:43:46,932 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 11:43:46,932 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 11:43:46,932 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 11:43:46,932 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 11:43:46,932 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 11:43:46,932 - DEBUG - Compression method 0
2024-10-15 11:43:46,932 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 11:43:46,932 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 11:43:46,932 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 11:43:46,932 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 11:43:46,932 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 11:43:46,932 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 11:43:46,942 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 11:43:46,942 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 11:43:46,942 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 11:43:46,942 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 11:43:46,943 - DEBUG - Error closing: Operation on closed image
2024-10-15 11:43:48,878 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 11:43:48,878 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 11:43:48,878 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 11:43:48,878 - DEBUG - Compression method 0
2024-10-15 11:43:48,878 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 11:43:48,878 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 11:43:48,878 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 11:43:48,878 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 11:43:48,878 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 11:43:48,878 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 11:43:48,878 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 11:43:48,878 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 11:43:48,879 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 11:43:48,879 - DEBUG - Compression method 0
2024-10-15 11:43:48,879 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 11:43:48,879 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 11:43:48,879 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 11:43:48,879 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 11:43:48,879 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 11:43:48,879 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 11:43:48,896 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 11:43:48,896 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 11:43:48,896 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 11:43:48,896 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 11:43:48,897 - DEBUG - Error closing: Operation on closed image
2024-10-15 11:43:51,393 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'instructor.dsl.simple_type.Response'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}}
2024-10-15 11:43:51,394 - DEBUG - max_retries: 1
2024-10-15 11:43:51,396 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}, 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}]}}
2024-10-15 11:43:51,430 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 11:43:51,430 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-15 11:43:51,506 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x0000027070497E30>
2024-10-15 11:43:51,506 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x000002707069E6D0> server_hostname='api.openai.com' timeout=5.0
2024-10-15 11:43:51,523 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x0000027070457A40>
2024-10-15 11:43:51,523 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 11:43:51,524 - DEBUG - send_request_headers.complete
2024-10-15 11:43:51,524 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 11:43:51,524 - DEBUG - send_request_body.complete
2024-10-15 11:43:51,524 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 11:43:54,816 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 08:43:55 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'3122'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'9569'), (b'x-ratelimit-reset-requests', b'8.64s'), (b'x-ratelimit-reset-tokens', b'2.586s'), (b'x-request-id', b'req_2311e05f9b81fec2318f75ed9a05d1ee'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=g1AlRerl4yQfawiPTTrHUvQSpgs_OIrgibDAK8FaSok-1728981835-1.0.1.1-5_pekaU1JsXG0uPZLsQdQLrQDr1t.0_CxU0zSUtu.TlE5IPprn7CedqLoJOujb5TvXgrxuDT9TBryy4IQK6x3w; path=/; expires=Tue, 15-Oct-24 09:13:55 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=F1Cz_RWj4Hd8Q.GuOweXdqX8prkwAL8uabpKDNmk.9c-1728981835266-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e8621df5a6247-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 11:43:54,818 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 11:43:54,818 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 11:43:54,819 - DEBUG - receive_response_body.complete
2024-10-15 11:43:54,819 - DEBUG - response_closed.started
2024-10-15 11:43:54,819 - DEBUG - response_closed.complete
2024-10-15 11:43:54,819 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Tue, 15 Oct 2024 08:43:55 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-kzzh9hik9ryjiou4ftvhondh'), ('openai-processing-ms', '3122'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '10000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '9569'), ('x-ratelimit-reset-requests', '8.64s'), ('x-ratelimit-reset-tokens', '2.586s'), ('x-request-id', 'req_2311e05f9b81fec2318f75ed9a05d1ee'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=g1AlRerl4yQfawiPTTrHUvQSpgs_OIrgibDAK8FaSok-1728981835-1.0.1.1-5_pekaU1JsXG0uPZLsQdQLrQDr1t.0_CxU0zSUtu.TlE5IPprn7CedqLoJOujb5TvXgrxuDT9TBryy4IQK6x3w; path=/; expires=Tue, 15-Oct-24 09:13:55 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=F1Cz_RWj4Hd8Q.GuOweXdqX8prkwAL8uabpKDNmk.9c-1728981835266-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d2e8621df5a6247-OTP'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-15 11:43:54,819 - DEBUG - request_id: req_2311e05f9b81fec2318f75ed9a05d1ee
2024-10-15 11:43:54,822 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIXRgiQApiqdPucI0HhPv4OPjILKn', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_9Jxs5lfLaMCxn23xiia83Xcc', function=Function(arguments='{\n  "content": [\n    {\n      "name": "T525M ISPILANTE SENTIMENT BRUSLI",\n      "address": "Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR"\n    }\n  ]\n}', name='Response'), type='function')]))], created=1728981832, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=56, prompt_tokens=472, total_tokens=528, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 11:43:54,823 - DEBUG - Returning model from AdapterBase
2024-10-15 11:44:00,652 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'instructor.dsl.simple_type.Response'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}}
2024-10-15 11:44:00,652 - DEBUG - max_retries: 1
2024-10-15 11:44:00,654 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}, 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}]}}
2024-10-15 11:44:00,655 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 11:44:00,655 - DEBUG - close.started
2024-10-15 11:44:00,655 - DEBUG - close.complete
2024-10-15 11:44:00,656 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-15 11:44:00,661 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x0000027070497CB0>
2024-10-15 11:44:00,661 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x000002707069E6D0> server_hostname='api.openai.com' timeout=5.0
2024-10-15 11:44:00,669 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000002707071A300>
2024-10-15 11:44:00,669 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 11:44:00,670 - DEBUG - send_request_headers.complete
2024-10-15 11:44:00,670 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 11:44:00,670 - DEBUG - send_request_body.complete
2024-10-15 11:44:00,670 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 11:44:04,245 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 08:44:04 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'3423'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'9576'), (b'x-ratelimit-reset-requests', b'8.64s'), (b'x-ratelimit-reset-tokens', b'2.544s'), (b'x-request-id', b'req_c9cfe817e018537f25192872c571d522'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e865b0b41c9d4-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 11:44:04,246 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 11:44:04,246 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 11:44:04,247 - DEBUG - receive_response_body.complete
2024-10-15 11:44:04,247 - DEBUG - response_closed.started
2024-10-15 11:44:04,247 - DEBUG - response_closed.complete
2024-10-15 11:44:04,247 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 08:44:04 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '3423', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9999', 'x-ratelimit-remaining-tokens': '9576', 'x-ratelimit-reset-requests': '8.64s', 'x-ratelimit-reset-tokens': '2.544s', 'x-request-id': 'req_c9cfe817e018537f25192872c571d522', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e865b0b41c9d4-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 11:44:04,248 - DEBUG - request_id: req_c9cfe817e018537f25192872c571d522
2024-10-15 11:44:04,249 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIXRpReXSZZz2IW21u1wwHrbO5mK2', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_L35jwUYZlkurXCred0l24lXH', function=Function(arguments='{\n  "content": [\n    {\n      "name": "Elena Vasilescu",\n      "address": "Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B"\n    }\n  ]\n}', name='Response'), type='function')]))], created=1728981841, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=54, prompt_tokens=475, total_tokens=529, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 11:44:04,250 - DEBUG - Returning model from AdapterBase
2024-10-15 11:44:06,588 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 11:44:06,588 - DEBUG - max_retries: 1
2024-10-15 11:44:06,590 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 11:44:06,591 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 11:44:06,591 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 11:44:06,591 - DEBUG - send_request_headers.complete
2024-10-15 11:44:06,592 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 11:44:06,592 - DEBUG - send_request_body.complete
2024-10-15 11:44:06,592 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 11:44:07,961 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 08:44:08 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1219'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9998'), (b'x-ratelimit-remaining-tokens', b'9608'), (b'x-ratelimit-reset-requests', b'11.365s'), (b'x-ratelimit-reset-tokens', b'2.352s'), (b'x-request-id', b'req_0b879553414f2d9944b7438a2236d1e1'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e868008aac9d4-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 11:44:07,961 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 11:44:07,961 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 11:44:07,961 - DEBUG - receive_response_body.complete
2024-10-15 11:44:07,961 - DEBUG - response_closed.started
2024-10-15 11:44:07,961 - DEBUG - response_closed.complete
2024-10-15 11:44:07,961 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 08:44:08 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1219', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9998', 'x-ratelimit-remaining-tokens': '9608', 'x-ratelimit-reset-requests': '11.365s', 'x-ratelimit-reset-tokens': '2.352s', 'x-request-id': 'req_0b879553414f2d9944b7438a2236d1e1', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e868008aac9d4-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 11:44:07,961 - DEBUG - request_id: req_0b879553414f2d9944b7438a2236d1e1
2024-10-15 11:44:07,962 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIXRvcIaCinQNk8g6Z94WBAAT7iIM', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_wCWHJYOA41rllvextbpEAy33', function=Function(arguments='\n{\n  "action": "determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728981847, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=13, prompt_tokens=360, total_tokens=373, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 11:44:12,170 - DEBUG - close.started
2024-10-15 11:44:12,171 - DEBUG - close.complete
2024-10-15 11:44:38,492 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-15 11:44:39,742 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-15 11:44:39,742 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-15 11:44:40,060 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-15 11:44:40,061 - DEBUG - Using proactor: IocpProactor
2024-10-15 11:44:40,080 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 11:44:40,080 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 11:44:40,080 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 11:44:40,080 - DEBUG - Compression method 0
2024-10-15 11:44:40,080 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 11:44:40,080 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 11:44:40,080 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 11:44:40,080 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 11:44:40,080 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 11:44:40,080 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 11:44:40,080 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 11:44:40,080 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 11:44:40,080 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 11:44:40,080 - DEBUG - Compression method 0
2024-10-15 11:44:40,080 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 11:44:40,080 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 11:44:40,080 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 11:44:40,080 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 11:44:40,080 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 11:44:40,080 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 11:44:40,089 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 11:44:40,089 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 11:44:40,089 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 11:44:40,089 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 11:44:40,090 - DEBUG - Error closing: Operation on closed image
2024-10-15 11:44:42,087 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 11:44:42,087 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 11:44:42,087 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 11:44:42,087 - DEBUG - Compression method 0
2024-10-15 11:44:42,087 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 11:44:42,087 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 11:44:42,087 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 11:44:42,087 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 11:44:42,087 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 11:44:42,087 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 11:44:42,087 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 11:44:42,087 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 11:44:42,087 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 11:44:42,087 - DEBUG - Compression method 0
2024-10-15 11:44:42,088 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 11:44:42,088 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 11:44:42,088 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 11:44:42,088 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 11:44:42,088 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 11:44:42,088 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 11:44:42,105 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 11:44:42,105 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 11:44:42,105 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 11:44:42,105 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 11:44:42,106 - DEBUG - Error closing: Operation on closed image
2024-10-15 11:44:44,601 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'instructor.dsl.simple_type.Response'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}}
2024-10-15 11:44:44,602 - DEBUG - max_retries: 1
2024-10-15 11:44:44,604 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}, 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}]}}
2024-10-15 11:44:44,642 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 11:44:44,642 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-15 11:44:44,671 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x0000029EF208F560>
2024-10-15 11:44:44,671 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x0000029EF228E6D0> server_hostname='api.openai.com' timeout=5.0
2024-10-15 11:44:44,680 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x0000029EF2115640>
2024-10-15 11:44:44,680 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 11:44:44,680 - DEBUG - send_request_headers.complete
2024-10-15 11:44:44,680 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 11:44:44,681 - DEBUG - send_request_body.complete
2024-10-15 11:44:44,681 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 11:44:48,354 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 08:44:48 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'3487'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'9569'), (b'x-ratelimit-reset-requests', b'8.64s'), (b'x-ratelimit-reset-tokens', b'2.586s'), (b'x-request-id', b'req_43d9f1e01c6ea24523764e8abcd1b307'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=aDXEubJm3Hcqz9g1rDWRtGDyCvxxv4h0YGDMy_i1PT8-1728981888-1.0.1.1-5uH4vqlovDg6ce4J0ZXslPZLa964ozlrLfy3ndD0PrZrQK3PvIT5aOlxVSOM5viyAMZN6U6vQ0Ed9waEo1VlPg; path=/; expires=Tue, 15-Oct-24 09:14:48 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=aCDCp60qfMtcRxwU1BvS4hqJw.EvSqsQCQ.mwz95XLk-1728981888801-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e876e183cb688-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 11:44:48,355 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 11:44:48,356 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 11:44:48,356 - DEBUG - receive_response_body.complete
2024-10-15 11:44:48,356 - DEBUG - response_closed.started
2024-10-15 11:44:48,356 - DEBUG - response_closed.complete
2024-10-15 11:44:48,357 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Tue, 15 Oct 2024 08:44:48 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-kzzh9hik9ryjiou4ftvhondh'), ('openai-processing-ms', '3487'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '10000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '9569'), ('x-ratelimit-reset-requests', '8.64s'), ('x-ratelimit-reset-tokens', '2.586s'), ('x-request-id', 'req_43d9f1e01c6ea24523764e8abcd1b307'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=aDXEubJm3Hcqz9g1rDWRtGDyCvxxv4h0YGDMy_i1PT8-1728981888-1.0.1.1-5uH4vqlovDg6ce4J0ZXslPZLa964ozlrLfy3ndD0PrZrQK3PvIT5aOlxVSOM5viyAMZN6U6vQ0Ed9waEo1VlPg; path=/; expires=Tue, 15-Oct-24 09:14:48 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=aCDCp60qfMtcRxwU1BvS4hqJw.EvSqsQCQ.mwz95XLk-1728981888801-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d2e876e183cb688-OTP'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-15 11:44:48,357 - DEBUG - request_id: req_43d9f1e01c6ea24523764e8abcd1b307
2024-10-15 11:44:48,360 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIXSXu1qeKsMEqVHW8gvdKsHZTc4M', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_W8Io8C2xrzdJiwOvbK7grNwo', function=Function(arguments='{\n  "content": [\n    {\n      "name": "ISPILANTE SENTIMENT BRUSLI",\n      "address": "Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR"\n    }\n  ]\n}', name='Response'), type='function')]))], created=1728981885, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=53, prompt_tokens=472, total_tokens=525, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 11:44:48,360 - DEBUG - Returning model from AdapterBase
2024-10-15 11:44:49,917 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'instructor.dsl.simple_type.Response'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}}
2024-10-15 11:44:49,917 - DEBUG - max_retries: 1
2024-10-15 11:44:49,919 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}, 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}]}}
2024-10-15 11:44:49,920 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 11:44:49,920 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 11:44:49,920 - DEBUG - send_request_headers.complete
2024-10-15 11:44:49,920 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 11:44:49,920 - DEBUG - send_request_body.complete
2024-10-15 11:44:49,921 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 11:44:53,000 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 08:44:53 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2868'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9998'), (b'x-ratelimit-remaining-tokens', b'9576'), (b'x-ratelimit-reset-requests', b'12.02s'), (b'x-ratelimit-reset-tokens', b'2.544s'), (b'x-request-id', b'req_227c3354123e03b2374a6add29163a2c'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e878ede52b688-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 11:44:53,000 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 11:44:53,001 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 11:44:53,001 - DEBUG - receive_response_body.complete
2024-10-15 11:44:53,002 - DEBUG - response_closed.started
2024-10-15 11:44:53,002 - DEBUG - response_closed.complete
2024-10-15 11:44:53,002 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 08:44:53 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '2868', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9998', 'x-ratelimit-remaining-tokens': '9576', 'x-ratelimit-reset-requests': '12.02s', 'x-ratelimit-reset-tokens': '2.544s', 'x-request-id': 'req_227c3354123e03b2374a6add29163a2c', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e878ede52b688-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 11:44:53,002 - DEBUG - request_id: req_227c3354123e03b2374a6add29163a2c
2024-10-15 11:44:53,003 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIXScxyL96ncf5n2wflOcdUjRNk85', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_hhbLpe5pgMCKWYxf4MSKx6rk', function=Function(arguments='{\n  "content": [\n    {\n      "name": "VASILESCU ELENA",\n      "address": "Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B"\n    }\n  ]\n}', name='Response'), type='function')]))], created=1728981890, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=55, prompt_tokens=475, total_tokens=530, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 11:44:53,005 - DEBUG - Returning model from AdapterBase
2024-10-15 11:44:54,047 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 11:44:54,048 - DEBUG - max_retries: 1
2024-10-15 11:44:54,050 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 11:44:54,050 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 11:44:54,050 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 11:44:54,051 - DEBUG - send_request_headers.complete
2024-10-15 11:44:54,051 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 11:44:54,051 - DEBUG - send_request_body.complete
2024-10-15 11:44:54,051 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 11:44:55,104 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 08:44:55 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'904'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9998'), (b'x-ratelimit-remaining-tokens', b'9608'), (b'x-ratelimit-reset-requests', b'16.553s'), (b'x-ratelimit-reset-tokens', b'2.352s'), (b'x-request-id', b'req_313a614792cb15012edf6cf60ea3e264'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e87a8aba7b688-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 11:44:55,104 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 11:44:55,104 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 11:44:55,104 - DEBUG - receive_response_body.complete
2024-10-15 11:44:55,104 - DEBUG - response_closed.started
2024-10-15 11:44:55,104 - DEBUG - response_closed.complete
2024-10-15 11:44:55,104 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 08:44:55 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '904', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9998', 'x-ratelimit-remaining-tokens': '9608', 'x-ratelimit-reset-requests': '16.553s', 'x-ratelimit-reset-tokens': '2.352s', 'x-request-id': 'req_313a614792cb15012edf6cf60ea3e264', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e87a8aba7b688-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 11:44:55,104 - DEBUG - request_id: req_313a614792cb15012edf6cf60ea3e264
2024-10-15 11:44:55,105 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIXSgYJaMPK4bq6lfUmUESzGMhS4x', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_Fwtlw9mtg0UU1HYPah6QHsBO', function=Function(arguments='\n{\n  "action": "determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728981894, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=13, prompt_tokens=360, total_tokens=373, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 11:44:58,347 - DEBUG - close.started
2024-10-15 11:44:58,348 - DEBUG - close.complete
2024-10-15 11:45:07,385 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-15 11:45:08,640 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-15 11:45:08,640 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-15 11:45:08,981 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-15 11:45:08,981 - DEBUG - Using proactor: IocpProactor
2024-10-15 11:45:09,001 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 11:45:09,001 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 11:45:09,001 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 11:45:09,001 - DEBUG - Compression method 0
2024-10-15 11:45:09,001 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 11:45:09,001 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 11:45:09,001 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 11:45:09,001 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 11:45:09,001 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 11:45:09,001 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 11:45:09,001 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 11:45:09,002 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 11:45:09,002 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 11:45:09,002 - DEBUG - Compression method 0
2024-10-15 11:45:09,002 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 11:45:09,002 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 11:45:09,002 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 11:45:09,002 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 11:45:09,002 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 11:45:09,002 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 11:45:09,011 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 11:45:09,011 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 11:45:09,011 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 11:45:09,011 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 11:45:09,012 - DEBUG - Error closing: Operation on closed image
2024-10-15 11:45:11,131 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 11:45:11,131 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 11:45:11,131 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 11:45:11,132 - DEBUG - Compression method 0
2024-10-15 11:45:11,132 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 11:45:11,132 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 11:45:11,132 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 11:45:11,132 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 11:45:11,132 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 11:45:11,132 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 11:45:11,132 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 11:45:11,132 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 11:45:11,132 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 11:45:11,132 - DEBUG - Compression method 0
2024-10-15 11:45:11,132 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 11:45:11,132 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 11:45:11,132 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 11:45:11,133 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 11:45:11,133 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 11:45:11,133 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 11:45:11,153 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 11:45:11,153 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 11:45:11,153 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 11:45:11,153 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 11:45:11,154 - DEBUG - Error closing: Operation on closed image
2024-10-15 11:45:14,455 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'instructor.dsl.simple_type.Response'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}}
2024-10-15 11:45:14,456 - DEBUG - max_retries: 1
2024-10-15 11:45:14,458 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}, 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}]}}
2024-10-15 11:45:14,488 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 11:45:14,488 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-15 11:45:14,500 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001F4FE964B00>
2024-10-15 11:45:14,500 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x000001F49212E750> server_hostname='api.openai.com' timeout=5.0
2024-10-15 11:45:14,507 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001F4FE7BFA10>
2024-10-15 11:45:14,507 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 11:45:14,507 - DEBUG - send_request_headers.complete
2024-10-15 11:45:14,507 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 11:45:14,507 - DEBUG - send_request_body.complete
2024-10-15 11:45:14,507 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 11:45:17,921 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 08:45:18 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'3266'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'9569'), (b'x-ratelimit-reset-requests', b'8.64s'), (b'x-ratelimit-reset-tokens', b'2.586s'), (b'x-request-id', b'req_727f892bc4a4f30d211160d13c9dfc8f'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=ud1gwc7.OCuDzaGvlY6eWSvaBH_XkZqjY9.Clta8Xt4-1728981918-1.0.1.1-zficSIpedZ8p3CZvNmoLNz5dFc.qZwBU3D.ScZlxCONhBT4dB.ct5vSAxNT9uOB51a_Npe3_585xpdU8dixWMg; path=/; expires=Tue, 15-Oct-24 09:15:18 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=VDewPwQCVw2BNmh8XdhngqAt_bfx.h5ZFI5r6.l_aeI-1728981918366-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e88287830c9ec-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 11:45:17,923 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 11:45:17,923 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 11:45:17,924 - DEBUG - receive_response_body.complete
2024-10-15 11:45:17,924 - DEBUG - response_closed.started
2024-10-15 11:45:17,924 - DEBUG - response_closed.complete
2024-10-15 11:45:17,924 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Tue, 15 Oct 2024 08:45:18 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-kzzh9hik9ryjiou4ftvhondh'), ('openai-processing-ms', '3266'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '10000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '9569'), ('x-ratelimit-reset-requests', '8.64s'), ('x-ratelimit-reset-tokens', '2.586s'), ('x-request-id', 'req_727f892bc4a4f30d211160d13c9dfc8f'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=ud1gwc7.OCuDzaGvlY6eWSvaBH_XkZqjY9.Clta8Xt4-1728981918-1.0.1.1-zficSIpedZ8p3CZvNmoLNz5dFc.qZwBU3D.ScZlxCONhBT4dB.ct5vSAxNT9uOB51a_Npe3_585xpdU8dixWMg; path=/; expires=Tue, 15-Oct-24 09:15:18 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=VDewPwQCVw2BNmh8XdhngqAt_bfx.h5ZFI5r6.l_aeI-1728981918366-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d2e88287830c9ec-OTP'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-15 11:45:17,925 - DEBUG - request_id: req_727f892bc4a4f30d211160d13c9dfc8f
2024-10-15 11:45:17,927 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIXT1L5o6FIOw0uIEajb7k8ONkdQ1', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_CUJ57VH7KV3hxsxKpN1IBkQ1', function=Function(arguments='{\n  "content": [\n    {\n      "name": "ISPILANTE SENTIMENT BRUSLI",\n      "address": "Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR"\n    }\n  ]\n}', name='Response'), type='function')]))], created=1728981915, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=53, prompt_tokens=472, total_tokens=525, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 11:45:17,927 - DEBUG - Returning model from AdapterBase
2024-10-15 11:45:19,322 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'instructor.dsl.simple_type.Response'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}}
2024-10-15 11:45:19,322 - DEBUG - max_retries: 1
2024-10-15 11:45:19,324 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}, 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}]}}
2024-10-15 11:45:19,325 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 11:45:19,325 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 11:45:19,326 - DEBUG - send_request_headers.complete
2024-10-15 11:45:19,326 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 11:45:19,326 - DEBUG - send_request_body.complete
2024-10-15 11:45:19,326 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 11:45:22,842 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 08:45:23 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'3346'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9998'), (b'x-ratelimit-remaining-tokens', b'9576'), (b'x-ratelimit-reset-requests', b'12.458s'), (b'x-ratelimit-reset-tokens', b'2.544s'), (b'x-request-id', b'req_2f2a629ddfeb4a01d18ee749d9bdbf22'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e88469ad5c9ec-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 11:45:22,843 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 11:45:22,843 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 11:45:22,843 - DEBUG - receive_response_body.complete
2024-10-15 11:45:22,843 - DEBUG - response_closed.started
2024-10-15 11:45:22,844 - DEBUG - response_closed.complete
2024-10-15 11:45:22,844 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 08:45:23 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '3346', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9998', 'x-ratelimit-remaining-tokens': '9576', 'x-ratelimit-reset-requests': '12.458s', 'x-ratelimit-reset-tokens': '2.544s', 'x-request-id': 'req_2f2a629ddfeb4a01d18ee749d9bdbf22', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e88469ad5c9ec-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 11:45:22,844 - DEBUG - request_id: req_2f2a629ddfeb4a01d18ee749d9bdbf22
2024-10-15 11:45:22,845 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIXT6O6g3mjCm7P40JdUhXwKFxwjS', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_k8tvOWBHGSZoeFvUXUpLOHHj', function=Function(arguments='{\n  "content": [\n    {\n      "name": "ELENA VASILESCU",\n      "address": "Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B"\n    }\n  ]\n}', name='Response'), type='function')]))], created=1728981920, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=56, prompt_tokens=475, total_tokens=531, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 11:45:22,846 - DEBUG - Returning model from AdapterBase
2024-10-15 11:45:23,962 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 11:45:23,962 - DEBUG - max_retries: 1
2024-10-15 11:45:23,964 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 11:45:23,965 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 11:45:23,965 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 11:45:23,965 - DEBUG - send_request_headers.complete
2024-10-15 11:45:23,965 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 11:45:23,965 - DEBUG - send_request_body.complete
2024-10-15 11:45:23,965 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 11:45:25,580 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 08:45:26 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1453'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9998'), (b'x-ratelimit-remaining-tokens', b'9608'), (b'x-ratelimit-reset-requests', b'16.454s'), (b'x-ratelimit-reset-tokens', b'2.352s'), (b'x-request-id', b'req_7bba2cbb7c6e7462f2022d27bb7a42a5'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e88639a53c9ec-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 11:45:25,581 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 11:45:25,581 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 11:45:25,582 - DEBUG - receive_response_body.complete
2024-10-15 11:45:25,582 - DEBUG - response_closed.started
2024-10-15 11:45:25,582 - DEBUG - response_closed.complete
2024-10-15 11:45:25,582 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 08:45:26 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1453', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9998', 'x-ratelimit-remaining-tokens': '9608', 'x-ratelimit-reset-requests': '16.454s', 'x-ratelimit-reset-tokens': '2.352s', 'x-request-id': 'req_7bba2cbb7c6e7462f2022d27bb7a42a5', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e88639a53c9ec-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 11:45:25,583 - DEBUG - request_id: req_7bba2cbb7c6e7462f2022d27bb7a42a5
2024-10-15 11:45:25,584 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIXTAX9jWESLy6weQMGhFns5xbQ9V', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_oVSmy0K9q5yEdDgdV8nJMxqM', function=Function(arguments='{\n  "action": "determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728981924, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=12, prompt_tokens=360, total_tokens=372, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 11:45:28,062 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: Yes\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 11:45:28,062 - DEBUG - max_retries: 1
2024-10-15 11:45:28,064 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: Yes\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 11:45:28,065 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 11:45:28,065 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 11:45:28,065 - DEBUG - send_request_headers.complete
2024-10-15 11:45:28,066 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 11:45:28,066 - DEBUG - send_request_body.complete
2024-10-15 11:45:28,066 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 11:45:28,978 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 08:45:29 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'748'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9997'), (b'x-ratelimit-remaining-tokens', b'9608'), (b'x-ratelimit-reset-requests', b'20.99s'), (b'x-ratelimit-reset-tokens', b'2.352s'), (b'x-request-id', b'req_62ff08f65e5eabe464a3f6b9c5bad2a6'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e887d3d6fc9ec-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 11:45:28,979 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 11:45:28,979 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 11:45:28,979 - DEBUG - receive_response_body.complete
2024-10-15 11:45:28,979 - DEBUG - response_closed.started
2024-10-15 11:45:28,979 - DEBUG - response_closed.complete
2024-10-15 11:45:28,979 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 08:45:29 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '748', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9997', 'x-ratelimit-remaining-tokens': '9608', 'x-ratelimit-reset-requests': '20.99s', 'x-ratelimit-reset-tokens': '2.352s', 'x-request-id': 'req_62ff08f65e5eabe464a3f6b9c5bad2a6', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e887d3d6fc9ec-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 11:45:28,980 - DEBUG - request_id: req_62ff08f65e5eabe464a3f6b9c5bad2a6
2024-10-15 11:45:28,980 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIXTEHc6Hn4L2AtSKjBNel0jSZmCO', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_hhMzOXzMWC9KiYREVPKm5Wqd', function=Function(arguments='\n{\n  "action": "identify_parties"\n}', name='AgentAction'), type='function')]))], created=1728981928, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=12, prompt_tokens=360, total_tokens=372, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 11:45:28,982 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.ContractParties'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': 'Identify the parties and their roles for a airbnb contract based on the following information:\n\nName: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'$defs': {'ContractParty': {'properties': {'name': {'description': 'Name of the party', 'title': 'Name', 'type': 'string'}, 'role': {'description': 'Role of the party in the contract', 'title': 'Role', 'type': 'string'}}, 'required': ['name', 'role'], 'title': 'ContractParty', 'type': 'object'}}, 'properties': {'parties': {'description': 'List of parties involved in the contract', 'items': {'$ref': '#/$defs/ContractParty'}, 'title': 'Parties', 'type': 'array'}}, 'required': ['parties'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}}
2024-10-15 11:45:28,982 - DEBUG - max_retries: 1
2024-10-15 11:45:28,985 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': 'Identify the parties and their roles for a airbnb contract based on the following information:\n\nName: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}, 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'$defs': {'ContractParty': {'properties': {'name': {'description': 'Name of the party', 'title': 'Name', 'type': 'string'}, 'role': {'description': 'Role of the party in the contract', 'title': 'Role', 'type': 'string'}}, 'required': ['name', 'role'], 'title': 'ContractParty', 'type': 'object'}}, 'properties': {'parties': {'description': 'List of parties involved in the contract', 'items': {'$ref': '#/$defs/ContractParty'}, 'title': 'Parties', 'type': 'array'}}, 'required': ['parties'], 'type': 'object'}}}]}}
2024-10-15 11:45:28,985 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 11:45:28,985 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 11:45:28,985 - DEBUG - send_request_headers.complete
2024-10-15 11:45:28,985 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 11:45:28,985 - DEBUG - send_request_body.complete
2024-10-15 11:45:28,986 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 11:45:32,593 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 08:45:33 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'3459'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9996'), (b'x-ratelimit-remaining-tokens', b'9441'), (b'x-ratelimit-reset-requests', b'28.72s'), (b'x-ratelimit-reset-tokens', b'3.349s'), (b'x-request-id', b'req_952d322bb44fd3196699d4b8a28002f3'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e8882fdc4c9ec-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 11:45:32,594 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 11:45:32,594 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 11:45:32,594 - DEBUG - receive_response_body.complete
2024-10-15 11:45:32,595 - DEBUG - response_closed.started
2024-10-15 11:45:32,595 - DEBUG - response_closed.complete
2024-10-15 11:45:32,595 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 08:45:33 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '3459', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9996', 'x-ratelimit-remaining-tokens': '9441', 'x-ratelimit-reset-requests': '28.72s', 'x-ratelimit-reset-tokens': '3.349s', 'x-request-id': 'req_952d322bb44fd3196699d4b8a28002f3', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e8882fdc4c9ec-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 11:45:32,595 - DEBUG - request_id: req_952d322bb44fd3196699d4b8a28002f3
2024-10-15 11:45:32,596 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIXTFHGwW09HKTZn9pPeFeDdfERph', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_RjOExs9iBv70X9YayRZKhNCA', function=Function(arguments='{\n  "parties": [\n    {\n      "name": "ISPILANTE SENTIMENT BRUSLI",\n      "role": "property owner"\n    },\n    {\n      "name": "ELENA VASILESCU",\n      "role": "tenant"\n    }\n  ]\n}', name='ContractParties'), type='function')]))], created=1728981929, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=61, prompt_tokens=356, total_tokens=417, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 11:45:32,599 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: Yes\n    - Parties identified: Yes\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 11:45:32,599 - DEBUG - max_retries: 1
2024-10-15 11:45:32,602 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: Yes\n    - Parties identified: Yes\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 11:45:32,602 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 11:45:32,603 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 11:45:32,603 - DEBUG - send_request_headers.complete
2024-10-15 11:45:32,603 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 11:45:32,603 - DEBUG - send_request_body.complete
2024-10-15 11:45:32,603 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 11:45:33,613 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 08:45:34 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'857'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9996'), (b'x-ratelimit-remaining-tokens', b'9552'), (b'x-ratelimit-reset-requests', b'33.742s'), (b'x-ratelimit-reset-tokens', b'2.682s'), (b'x-request-id', b'req_020354e86c358677eb17e763f4a476a3'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e88999eddc9ec-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 11:45:33,613 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 11:45:33,614 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 11:45:33,614 - DEBUG - receive_response_body.complete
2024-10-15 11:45:33,614 - DEBUG - response_closed.started
2024-10-15 11:45:33,614 - DEBUG - response_closed.complete
2024-10-15 11:45:33,614 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 08:45:34 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '857', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9996', 'x-ratelimit-remaining-tokens': '9552', 'x-ratelimit-reset-requests': '33.742s', 'x-ratelimit-reset-tokens': '2.682s', 'x-request-id': 'req_020354e86c358677eb17e763f4a476a3', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e88999eddc9ec-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 11:45:33,614 - DEBUG - request_id: req_020354e86c358677eb17e763f4a476a3
2024-10-15 11:45:33,614 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIXTJiE3h7MDhrFtfzsbyf0cSTmVe', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_p4dryEWTjE6qIYYBTj3pqkTA', function=Function(arguments='{\n  "action": "construct_contract"\n}', name='AgentAction'), type='function')]))], created=1728981933, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=10, prompt_tokens=360, total_tokens=370, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 11:45:33,616 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.Contract'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': 'Construct a airbnb contract using the following template and information:\n\nTemplate:\nAirbnb Rental Agreement Template (Improved Version)\n\nRental Agreement\n\nThis Rental Agreement ("Agreement") is made on [date] between:\n\n1. Parties\n\nHost: [Host\'s Name], residing at [Host\'s Address].\n\nGuest: [Guest\'s Name], residing at [Guest\'s Address].\n\n2. Property\n\nThe Host agrees to rent the property located at [Property Address] to the Guest for the term specified below.\n\nProperty Type: [Apartment/House/Condo/Other]\n\nBedrooms: [Number]\n\nBathrooms: [Number]\n\nOther Features: [Details]\n\n3. Rental Term\n\nThe Guest shall have access to the property for the following period:\n\nFixed Term: From [Start Date] at [Start Time] to [End Date] at [End Time].\n\nMonth-to-Month Lease: Starting on [Start Date], ending upon notice of [X] days from either party.\n\n4. Rental Amount\n\nTotal Rent: [Total Rent in USD]\n\nPayment Method: [e.g., bank transfer, credit card]\n\nPayment Due Date: [Due Date]\n\n5. Security Deposit\n\nAmount: [Security Deposit in USD]\n\nRefundable within [State\'s Requirement] after the lease ends, minus any deductions for damages.\n\n6. House Rules\n\nQuiet Hours: [Yes/No]. If yes, from [Start Time] to [End Time].\n\nSmoking Policy: [Prohibited/Permitted only in specific areas].\n\nPets: [Allowed/Not Allowed]. If allowed, specify any pet fees or restrictions.\n\n7. Utilities and Services\n\nThe Host shall provide all utilities and services, except for: [List of exceptions].\n\n8. Occupants\n\nThe total number of occupants allowed on the property is [Number of Guests].\n\n9. Parking\n\nParking Availability: [Number of Spaces, Fee (if any), and Description of Parking Space].\n\n10. Fees\n\nThe Guest agrees to pay the following fees upon execution of this Agreement:\n\nCleaning Fee: [Amount in USD]\n\nTaxes: [Amount in USD]\n\nOther Fees: [Specify and list amounts]\n\n11. Subletting\n\nSubletting Rights: [Allowed/Not Allowed]. If allowed, subtenants [must/must not] be approved by the Host prior to occupancy.\n\n12. Inspection and Maintenance\n\nMove-in Inspection: A move-in inspection checklist [will/will not] be completed.\n\nRight to Inspect: The Host has the right to inspect the property with reasonable notice as required by law.\n\nMaintenance: The Guest shall maintain the property in good condition. Any damages caused will be deducted from the Security Deposit.\n\n13. Liability\n\nThe Guest shall be responsible for any damages to the property.\n\nThe Host shall not be liable for injuries sustained by the Guest or their guests.\n\n14. Termination\n\nEither party may terminate this Agreement upon [X] days\' notice. All outstanding payments must be settled.\n\n15. Governing Law\n\nThis Agreement shall be governed by the laws of [Jurisdiction].\n\n16. Entire Agreement\n\nThis Agreement constitutes the entire understanding between the Host and the Guest regarding the rental and supersedes all prior agreements, whether written or oral.\n\n17. Signatures\n\nHost Signature: ______________________\n\nDate: ______________________\n\nGuest Signature: ______________________\n\nDate: ______________________\n\nParties: property owner: ISPILANTE SENTIMENT BRUSLI, tenant: ELENA VASILESCU\nAddress: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nAdditional Details: {}'}], 'tools': [{'type': 'function', 'function': {'name': 'Contract', 'description': 'Correctly extracted `Contract` with all the required parameters with correct types', 'parameters': {'$defs': {'ContractParty': {'properties': {'name': {'description': 'Name of the party', 'title': 'Name', 'type': 'string'}, 'role': {'description': 'Role of the party in the contract', 'title': 'Role', 'type': 'string'}}, 'required': ['name', 'role'], 'title': 'ContractParty', 'type': 'object'}}, 'properties': {'parties': {'description': 'List of parties involved in the contract', 'items': {'$ref': '#/$defs/ContractParty'}, 'title': 'Parties', 'type': 'array'}, 'address': {'description': 'Address where the contract is applicable', 'title': 'Address', 'type': 'string'}, 'terms': {'description': 'Terms of the contract', 'title': 'Terms', 'type': 'string'}}, 'required': ['address', 'parties', 'terms'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'Contract'}}}
2024-10-15 11:45:33,616 - DEBUG - max_retries: 1
2024-10-15 11:45:33,618 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': 'Construct a airbnb contract using the following template and information:\n\nTemplate:\nAirbnb Rental Agreement Template (Improved Version)\n\nRental Agreement\n\nThis Rental Agreement ("Agreement") is made on [date] between:\n\n1. Parties\n\nHost: [Host\'s Name], residing at [Host\'s Address].\n\nGuest: [Guest\'s Name], residing at [Guest\'s Address].\n\n2. Property\n\nThe Host agrees to rent the property located at [Property Address] to the Guest for the term specified below.\n\nProperty Type: [Apartment/House/Condo/Other]\n\nBedrooms: [Number]\n\nBathrooms: [Number]\n\nOther Features: [Details]\n\n3. Rental Term\n\nThe Guest shall have access to the property for the following period:\n\nFixed Term: From [Start Date] at [Start Time] to [End Date] at [End Time].\n\nMonth-to-Month Lease: Starting on [Start Date], ending upon notice of [X] days from either party.\n\n4. Rental Amount\n\nTotal Rent: [Total Rent in USD]\n\nPayment Method: [e.g., bank transfer, credit card]\n\nPayment Due Date: [Due Date]\n\n5. Security Deposit\n\nAmount: [Security Deposit in USD]\n\nRefundable within [State\'s Requirement] after the lease ends, minus any deductions for damages.\n\n6. House Rules\n\nQuiet Hours: [Yes/No]. If yes, from [Start Time] to [End Time].\n\nSmoking Policy: [Prohibited/Permitted only in specific areas].\n\nPets: [Allowed/Not Allowed]. If allowed, specify any pet fees or restrictions.\n\n7. Utilities and Services\n\nThe Host shall provide all utilities and services, except for: [List of exceptions].\n\n8. Occupants\n\nThe total number of occupants allowed on the property is [Number of Guests].\n\n9. Parking\n\nParking Availability: [Number of Spaces, Fee (if any), and Description of Parking Space].\n\n10. Fees\n\nThe Guest agrees to pay the following fees upon execution of this Agreement:\n\nCleaning Fee: [Amount in USD]\n\nTaxes: [Amount in USD]\n\nOther Fees: [Specify and list amounts]\n\n11. Subletting\n\nSubletting Rights: [Allowed/Not Allowed]. If allowed, subtenants [must/must not] be approved by the Host prior to occupancy.\n\n12. Inspection and Maintenance\n\nMove-in Inspection: A move-in inspection checklist [will/will not] be completed.\n\nRight to Inspect: The Host has the right to inspect the property with reasonable notice as required by law.\n\nMaintenance: The Guest shall maintain the property in good condition. Any damages caused will be deducted from the Security Deposit.\n\n13. Liability\n\nThe Guest shall be responsible for any damages to the property.\n\nThe Host shall not be liable for injuries sustained by the Guest or their guests.\n\n14. Termination\n\nEither party may terminate this Agreement upon [X] days\' notice. All outstanding payments must be settled.\n\n15. Governing Law\n\nThis Agreement shall be governed by the laws of [Jurisdiction].\n\n16. Entire Agreement\n\nThis Agreement constitutes the entire understanding between the Host and the Guest regarding the rental and supersedes all prior agreements, whether written or oral.\n\n17. Signatures\n\nHost Signature: ______________________\n\nDate: ______________________\n\nGuest Signature: ______________________\n\nDate: ______________________\n\nParties: property owner: ISPILANTE SENTIMENT BRUSLI, tenant: ELENA VASILESCU\nAddress: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nAdditional Details: {}'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'Contract'}}, 'tools': [{'type': 'function', 'function': {'name': 'Contract', 'description': 'Correctly extracted `Contract` with all the required parameters with correct types', 'parameters': {'$defs': {'ContractParty': {'properties': {'name': {'description': 'Name of the party', 'title': 'Name', 'type': 'string'}, 'role': {'description': 'Role of the party in the contract', 'title': 'Role', 'type': 'string'}}, 'required': ['name', 'role'], 'title': 'ContractParty', 'type': 'object'}}, 'properties': {'parties': {'description': 'List of parties involved in the contract', 'items': {'$ref': '#/$defs/ContractParty'}, 'title': 'Parties', 'type': 'array'}, 'address': {'description': 'Address where the contract is applicable', 'title': 'Address', 'type': 'string'}, 'terms': {'description': 'Terms of the contract', 'title': 'Terms', 'type': 'string'}}, 'required': ['address', 'parties', 'terms'], 'type': 'object'}}}]}}
2024-10-15 11:45:33,618 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 11:45:33,619 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 11:45:33,619 - DEBUG - send_request_headers.complete
2024-10-15 11:45:33,619 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 11:45:33,619 - DEBUG - send_request_body.complete
2024-10-15 11:45:33,619 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 11:46:17,197 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 08:46:17 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'43401'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9995'), (b'x-ratelimit-remaining-tokens', b'8670'), (b'x-ratelimit-reset-requests', b'41.37s'), (b'x-ratelimit-reset-tokens', b'7.976s'), (b'x-request-id', b'req_9cdc83e47f75efe0d36ff0edd779e26e'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e889feb17c9ec-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 11:46:17,197 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 11:46:17,198 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 11:46:17,198 - DEBUG - receive_response_body.complete
2024-10-15 11:46:17,198 - DEBUG - response_closed.started
2024-10-15 11:46:17,198 - DEBUG - response_closed.complete
2024-10-15 11:46:17,198 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 08:46:17 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '43401', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9995', 'x-ratelimit-remaining-tokens': '8670', 'x-ratelimit-reset-requests': '41.37s', 'x-ratelimit-reset-tokens': '7.976s', 'x-request-id': 'req_9cdc83e47f75efe0d36ff0edd779e26e', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e889feb17c9ec-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 11:46:17,198 - DEBUG - request_id: req_9cdc83e47f75efe0d36ff0edd779e26e
2024-10-15 11:46:17,199 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIXTKXURCIQ7xouVOCrfIJTkNNeQq', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_19zqipJrtScO7hAdL9GriqH5', function=Function(arguments='{\n"parties": [\n  {\n    "name": "ISPILANTE SENTIMENT BRUSLI",\n    "role": "Host"\n  },\n  {\n    "name": "ELENA VASILESCU",\n    "role": "Guest"\n  }\n],\n"address": "Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR",\n"terms": "Airbnb Rental Agreement Template (Improved Version)\\n\\nRental Agreement\\n\\nThis Rental Agreement (\\"Agreement\\") is made on [date] between:\\n\\n1. Parties\\n\\nHost: [ISPILANTE SENTIMENT BRUSLI], residing at [Host\'s Address].\\n\\nGuest: [ELENA VASILESCU], residing at [Guest\'s Address].\\n\\n2. Property\\n\\nThe Host agrees to rent the property located at [Property Address] to the Guest for the term specified below.\\n\\nProperty Type: [Apartment/House/Condo/Other]\\n\\nBedrooms: [Number]\\n\\nBathrooms: [Number]\\n\\nOther Features: [Details]\\n\\n3. Rental Term\\n\\nThe Guest shall have access to the property for the following period:\\n\\nFixed Term: From [Start Date] at [Start Time] to [End Date] at [End Time].\\n\\nMonth-to-Month Lease: Starting on [Start Date], ending upon notice of [X] days from either party.\\n\\n4. Rental Amount\\n\\nTotal Rent: [Total Rent in USD]\\n\\nPayment Method: [e.g., bank transfer, credit card]\\n\\nPayment Due Date: [Due Date]\\n\\n5. Security Deposit\\n\\nAmount: [Security Deposit in USD]\\n\\nRefundable within [State\'s Requirement] after the lease ends, minus any deductions for damages.\\n\\n6. House Rules\\n\\nQuiet Hours: [Yes/No]. If yes, from [Start Time] to [End Time].\\n\\nSmoking Policy: [Prohibited/Permitted only in specific areas].\\n\\nPets: [Allowed/Not Allowed]. If allowed, specify any pet fees or restrictions.\\n\\n7. Utilities and Services\\n\\nThe Host shall provide all utilities and services, except for: [List of exceptions].\\n\\n8. Occupants\\n\\nThe total number of occupants allowed on the property is [Number of Guests].\\n\\n9. Parking\\n\\nParking Availability: [Number of Spaces, Fee (if any), and Description of Parking Space].\\n\\n10. Fees\\n\\nThe Guest agrees to pay the following fees upon execution of this Agreement:\\n\\nCleaning Fee: [Amount in USD]\\n\\nTaxes: [Amount in USD]\\n\\nOther Fees: [Specify and list amounts]\\n\\n11. Subletting\\n\\nSubletting Rights: [Allowed/Not Allowed]. If allowed, subtenants [must/must not] be approved by the Host prior to occupancy.\\n\\n12. Inspection and Maintenance\\n\\nMove-in Inspection: A move-in inspection checklist [will/will not] be completed.\\n\\nRight to Inspect: The Host has the right to inspect the property with reasonable notice as required by law.\\n\\nMaintenance: The Guest shall maintain the property in good condition. Any damages caused will be deducted from the Security Deposit.\\n\\n13. Liability\\n\\nThe Guest shall be responsible for any damages to the property.\\n\\nThe Host shall not be liable for injuries sustained by the Guest or their guests.\\n\\n14. Termination\\n\\nEither party may terminate this Agreement upon [X] days\' notice. All outstanding payments must be settled.\\n\\n15. Governing Law\\n\\nThis Agreement shall be governed by the laws of [Jurisdiction].\\n\\n16. Entire Agreement\\n\\nThis Agreement constitutes the entire understanding between the Host and the Guest regarding the rental and supersedes all prior agreements, whether written or oral.\\n\\n17. Signatures\\n\\nHost Signature: ______________________\\n\\nDate: ______________________\\n\\nGuest Signature: ______________________\\n\\nDate: ______________________"\n}', name='Contract'), type='function')]))], created=1728981934, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=867, prompt_tokens=1016, total_tokens=1883, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 11:46:17,200 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: Yes\n    - Parties identified: Yes\n    - Contract constructed: Yes\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 11:46:17,200 - DEBUG - max_retries: 1
2024-10-15 11:46:17,202 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: Yes\n    - Parties identified: Yes\n    - Contract constructed: Yes\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 11:46:17,203 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 11:46:17,203 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 11:46:17,203 - DEBUG - send_request_headers.complete
2024-10-15 11:46:17,203 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 11:46:17,203 - DEBUG - send_request_body.complete
2024-10-15 11:46:17,203 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 11:46:18,425 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 08:46:18 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1071'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'8824'), (b'x-ratelimit-reset-requests', b'8.64s'), (b'x-ratelimit-reset-tokens', b'7.055s'), (b'x-request-id', b'req_907629e9dc0e5579eae5ece538492d05'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2e89b05c94c9ec-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 11:46:18,426 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 11:46:18,426 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 11:46:18,426 - DEBUG - receive_response_body.complete
2024-10-15 11:46:18,426 - DEBUG - response_closed.started
2024-10-15 11:46:18,426 - DEBUG - response_closed.complete
2024-10-15 11:46:18,426 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 08:46:18 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1071', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9999', 'x-ratelimit-remaining-tokens': '8824', 'x-ratelimit-reset-requests': '8.64s', 'x-ratelimit-reset-tokens': '7.055s', 'x-request-id': 'req_907629e9dc0e5579eae5ece538492d05', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2e89b05c94c9ec-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 11:46:18,426 - DEBUG - request_id: req_907629e9dc0e5579eae5ece538492d05
2024-10-15 11:46:18,426 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIXU1IUdsfo6ROOWJIyKXu2T49nHF', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_8ZMahJrnwYHgz8iJG6eLOAxM', function=Function(arguments='\n{\n  "action": "finish"\n}', name='AgentAction'), type='function')]))], created=1728981977, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=10, prompt_tokens=360, total_tokens=370, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 11:46:18,590 - DEBUG - close.started
2024-10-15 11:46:18,591 - DEBUG - close.complete
2024-10-15 13:25:38,025 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-15 13:25:39,274 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-15 13:25:39,274 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-15 13:25:39,593 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-15 13:25:39,593 - DEBUG - Using proactor: IocpProactor
2024-10-15 13:25:39,612 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 13:25:39,612 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 13:25:39,612 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 13:25:39,612 - DEBUG - Compression method 0
2024-10-15 13:25:39,613 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 13:25:39,613 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 13:25:39,613 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 13:25:39,613 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 13:25:39,613 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 13:25:39,613 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 13:25:39,613 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 13:25:39,613 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 13:25:39,613 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 13:25:39,613 - DEBUG - Compression method 0
2024-10-15 13:25:39,613 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 13:25:39,613 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 13:25:39,613 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 13:25:39,613 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 13:25:39,613 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 13:25:39,613 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 13:25:39,622 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 13:25:39,623 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 13:25:39,623 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 13:25:39,623 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 13:25:39,623 - DEBUG - Error closing: Operation on closed image
2024-10-15 13:25:41,648 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 13:25:41,648 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 13:25:41,648 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 13:25:41,648 - DEBUG - Compression method 0
2024-10-15 13:25:41,648 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 13:25:41,648 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 13:25:41,648 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 13:25:41,648 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 13:25:41,648 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 13:25:41,648 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 13:25:41,648 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 13:25:41,648 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 13:25:41,648 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 13:25:41,648 - DEBUG - Compression method 0
2024-10-15 13:25:41,648 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 13:25:41,648 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 13:25:41,648 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 13:25:41,648 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 13:25:41,648 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 13:25:41,648 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 13:25:41,665 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 13:25:41,666 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 13:25:41,666 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 13:25:41,666 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 13:25:41,666 - DEBUG - Error closing: Operation on closed image
2024-10-15 13:25:44,193 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'instructor.dsl.simple_type.Response'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}}
2024-10-15 13:25:44,194 - DEBUG - max_retries: 1
2024-10-15 13:25:44,196 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}, 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}]}}
2024-10-15 13:25:44,236 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:25:44,236 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-15 13:25:44,270 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x00000202FF5380E0>
2024-10-15 13:25:44,270 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x00000202FF40E750> server_hostname='api.openai.com' timeout=5.0
2024-10-15 13:25:44,278 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x00000202FF576B10>
2024-10-15 13:25:44,278 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:25:44,278 - DEBUG - send_request_headers.complete
2024-10-15 13:25:44,278 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:25:44,278 - DEBUG - send_request_body.complete
2024-10-15 13:25:44,278 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:25:47,652 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:25:48 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'3217'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'9569'), (b'x-ratelimit-reset-requests', b'8.64s'), (b'x-ratelimit-reset-tokens', b'2.586s'), (b'x-request-id', b'req_6b91be26e03e80be7662c206a87ba5a5'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=3z2eDoyjBFlDKlekvRr8NKyo.DKqnkOtPeSC9Z95eh4-1728987948-1.0.1.1-iiIkm6yW.kqOGVuLpqzYHMRPo1c1ifcKiLJUzI1JKT_gRdqKZOSVgz74oN3uLkIlifiaAhC9fRNHepA9bQ9fng; path=/; expires=Tue, 15-Oct-24 10:55:48 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=Ki8pJGpFllHIcv_L6q7ZbG5PtmkeAkvBoS5wDOKDl7c-1728987948176-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f1b5f0ec2ca21-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:25:47,652 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:25:47,652 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:25:47,652 - DEBUG - receive_response_body.complete
2024-10-15 13:25:47,652 - DEBUG - response_closed.started
2024-10-15 13:25:47,652 - DEBUG - response_closed.complete
2024-10-15 13:25:47,652 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Tue, 15 Oct 2024 10:25:48 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-kzzh9hik9ryjiou4ftvhondh'), ('openai-processing-ms', '3217'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '10000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '9569'), ('x-ratelimit-reset-requests', '8.64s'), ('x-ratelimit-reset-tokens', '2.586s'), ('x-request-id', 'req_6b91be26e03e80be7662c206a87ba5a5'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=3z2eDoyjBFlDKlekvRr8NKyo.DKqnkOtPeSC9Z95eh4-1728987948-1.0.1.1-iiIkm6yW.kqOGVuLpqzYHMRPo1c1ifcKiLJUzI1JKT_gRdqKZOSVgz74oN3uLkIlifiaAhC9fRNHepA9bQ9fng; path=/; expires=Tue, 15-Oct-24 10:55:48 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=Ki8pJGpFllHIcv_L6q7ZbG5PtmkeAkvBoS5wDOKDl7c-1728987948176-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d2f1b5f0ec2ca21-OTP'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-15 13:25:47,653 - DEBUG - request_id: req_6b91be26e03e80be7662c206a87ba5a5
2024-10-15 13:25:47,654 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZ2G9XXWDNf3mRJyCCxTujrbYAbi', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_z6BUQSlg7iX5DwJAWLIXyY4o', function=Function(arguments='{\n  "content": [\n    {\n      "name": "ISPILANTE SENTIMENT BRUSLI",\n      "address": "Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR"\n    }\n  ]\n}', name='Response'), type='function')]))], created=1728987944, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=53, prompt_tokens=472, total_tokens=525, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:25:47,655 - DEBUG - Returning model from AdapterBase
2024-10-15 13:25:49,518 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'instructor.dsl.simple_type.Response'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}}
2024-10-15 13:25:49,518 - DEBUG - max_retries: 1
2024-10-15 13:25:49,520 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}, 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}]}}
2024-10-15 13:25:49,520 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:25:49,520 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:25:49,520 - DEBUG - send_request_headers.complete
2024-10-15 13:25:49,520 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:25:49,520 - DEBUG - send_request_body.complete
2024-10-15 13:25:49,521 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:25:52,587 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:25:53 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2909'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9998'), (b'x-ratelimit-remaining-tokens', b'9576'), (b'x-ratelimit-reset-requests', b'12.04s'), (b'x-ratelimit-reset-tokens', b'2.544s'), (b'x-request-id', b'req_ceaf41e58c5143ce7466b5bc6be6f2bb'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f1b7fcc2dca21-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:25:52,588 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:25:52,588 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:25:52,588 - DEBUG - receive_response_body.complete
2024-10-15 13:25:52,588 - DEBUG - response_closed.started
2024-10-15 13:25:52,588 - DEBUG - response_closed.complete
2024-10-15 13:25:52,588 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 10:25:53 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '2909', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9998', 'x-ratelimit-remaining-tokens': '9576', 'x-ratelimit-reset-requests': '12.04s', 'x-ratelimit-reset-tokens': '2.544s', 'x-request-id': 'req_ceaf41e58c5143ce7466b5bc6be6f2bb', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f1b7fcc2dca21-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 13:25:52,588 - DEBUG - request_id: req_ceaf41e58c5143ce7466b5bc6be6f2bb
2024-10-15 13:25:52,588 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZ2MtuzCfGufJu35R3l89dJnWDZi', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_UyR25Qs8pq4nV9CEZnfhAzAz', function=Function(arguments='{\n  "content": [\n    {\n      "name": "ELENA VASILESCU",\n      "address": "Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B"\n    }\n  ]\n}', name='Response'), type='function')]))], created=1728987950, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=56, prompt_tokens=475, total_tokens=531, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:25:52,589 - DEBUG - Returning model from AdapterBase
2024-10-15 13:25:54,254 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 13:25:54,254 - DEBUG - max_retries: 1
2024-10-15 13:25:54,255 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 13:25:54,256 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:25:54,256 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:25:54,256 - DEBUG - send_request_headers.complete
2024-10-15 13:25:54,256 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:25:54,256 - DEBUG - send_request_body.complete
2024-10-15 13:25:54,256 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:25:55,615 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:25:56 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1212'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9998'), (b'x-ratelimit-remaining-tokens', b'9608'), (b'x-ratelimit-reset-requests', b'15.953s'), (b'x-ratelimit-reset-tokens', b'2.352s'), (b'x-request-id', b'req_ead27be82f5c067f4d4ce8f60af65a1f'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f1b9d6bd1ca21-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:25:55,616 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:25:55,616 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:25:55,616 - DEBUG - receive_response_body.complete
2024-10-15 13:25:55,616 - DEBUG - response_closed.started
2024-10-15 13:25:55,616 - DEBUG - response_closed.complete
2024-10-15 13:25:55,616 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 10:25:56 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1212', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9998', 'x-ratelimit-remaining-tokens': '9608', 'x-ratelimit-reset-requests': '15.953s', 'x-ratelimit-reset-tokens': '2.352s', 'x-request-id': 'req_ead27be82f5c067f4d4ce8f60af65a1f', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f1b9d6bd1ca21-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 13:25:55,616 - DEBUG - request_id: req_ead27be82f5c067f4d4ce8f60af65a1f
2024-10-15 13:25:55,616 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZ2RKuxLHLbJP2E4RCR7qIIXUsJN', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_Q71KA0PRke6Txtnv0kyn6U92', function=Function(arguments='\n{\n  "action": "determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728987955, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=13, prompt_tokens=360, total_tokens=373, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:25:58,613 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: Yes\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 13:25:58,613 - DEBUG - max_retries: 1
2024-10-15 13:25:58,615 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: Yes\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 13:25:58,615 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:25:58,616 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:25:58,616 - DEBUG - send_request_headers.complete
2024-10-15 13:25:58,616 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:25:58,616 - DEBUG - send_request_body.complete
2024-10-15 13:25:58,616 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:25:59,661 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:26:00 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'897'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9997'), (b'x-ratelimit-remaining-tokens', b'9608'), (b'x-ratelimit-reset-requests', b'20.228s'), (b'x-ratelimit-reset-tokens', b'2.352s'), (b'x-request-id', b'req_342394cd3736ca03c73e8067474a3d96'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f1bb8a8c1ca21-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:25:59,661 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:25:59,661 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:25:59,662 - DEBUG - receive_response_body.complete
2024-10-15 13:25:59,662 - DEBUG - response_closed.started
2024-10-15 13:25:59,662 - DEBUG - response_closed.complete
2024-10-15 13:25:59,662 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 10:26:00 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '897', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9997', 'x-ratelimit-remaining-tokens': '9608', 'x-ratelimit-reset-requests': '20.228s', 'x-ratelimit-reset-tokens': '2.352s', 'x-request-id': 'req_342394cd3736ca03c73e8067474a3d96', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f1bb8a8c1ca21-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 13:25:59,662 - DEBUG - request_id: req_342394cd3736ca03c73e8067474a3d96
2024-10-15 13:25:59,663 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZ2Vhm3R5XvLRjaJV2WWTiXvxhZX', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_ZzIXqHosMMJp5aEBzdixNrLC', function=Function(arguments='\n{\n  "action": "identify_parties"\n}', name='AgentAction'), type='function')]))], created=1728987959, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=12, prompt_tokens=360, total_tokens=372, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:25:59,665 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.ContractParties'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': 'Identify the parties and their roles for a it contract based on the following information:\n\nName: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'$defs': {'ContractParty': {'properties': {'name': {'description': 'Name of the party', 'title': 'Name', 'type': 'string'}, 'role': {'description': 'Role of the party in the contract', 'title': 'Role', 'type': 'string'}}, 'required': ['name', 'role'], 'title': 'ContractParty', 'type': 'object'}}, 'properties': {'parties': {'description': 'List of parties involved in the contract', 'items': {'$ref': '#/$defs/ContractParty'}, 'title': 'Parties', 'type': 'array'}}, 'required': ['parties'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}}
2024-10-15 13:25:59,665 - DEBUG - max_retries: 1
2024-10-15 13:25:59,667 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': 'Identify the parties and their roles for a it contract based on the following information:\n\nName: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}, 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'$defs': {'ContractParty': {'properties': {'name': {'description': 'Name of the party', 'title': 'Name', 'type': 'string'}, 'role': {'description': 'Role of the party in the contract', 'title': 'Role', 'type': 'string'}}, 'required': ['name', 'role'], 'title': 'ContractParty', 'type': 'object'}}, 'properties': {'parties': {'description': 'List of parties involved in the contract', 'items': {'$ref': '#/$defs/ContractParty'}, 'title': 'Parties', 'type': 'array'}}, 'required': ['parties'], 'type': 'object'}}}]}}
2024-10-15 13:25:59,668 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:25:59,668 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:25:59,669 - DEBUG - send_request_headers.complete
2024-10-15 13:25:59,669 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:25:59,669 - DEBUG - send_request_body.complete
2024-10-15 13:25:59,669 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:26:03,994 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:26:04 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'4175'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9996'), (b'x-ratelimit-remaining-tokens', b'9466'), (b'x-ratelimit-reset-requests', b'27.814s'), (b'x-ratelimit-reset-tokens', b'3.2s'), (b'x-request-id', b'req_5fed6f526fc61c2991596dd27fdf4984'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f1bbf3c07ca21-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:26:03,994 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:26:03,994 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:26:03,995 - DEBUG - receive_response_body.complete
2024-10-15 13:26:03,995 - DEBUG - response_closed.started
2024-10-15 13:26:03,995 - DEBUG - response_closed.complete
2024-10-15 13:26:03,995 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 10:26:04 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '4175', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9996', 'x-ratelimit-remaining-tokens': '9466', 'x-ratelimit-reset-requests': '27.814s', 'x-ratelimit-reset-tokens': '3.2s', 'x-request-id': 'req_5fed6f526fc61c2991596dd27fdf4984', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f1bbf3c07ca21-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 13:26:03,995 - DEBUG - request_id: req_5fed6f526fc61c2991596dd27fdf4984
2024-10-15 13:26:03,995 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZ2WRqgxm6KsSSbWQRRGPgpfPi06', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_xI3wasysxGhRrTZZeVAStSCn', function=Function(arguments='{\n  "parties": [\n    {\n      "name": "ISPILANTE SENTIMENT BRUSLI",\n      "role": "Service Provider"\n    },\n    {\n      "name": "ELENA VASILESCU",\n      "role": "Client"\n    }\n  ]\n}', name='ContractParties'), type='function')]))], created=1728987960, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=61, prompt_tokens=355, total_tokens=416, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:26:03,999 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: Yes\n    - Parties identified: Yes\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 13:26:03,999 - DEBUG - max_retries: 1
2024-10-15 13:26:04,002 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: Yes\n    - Parties identified: Yes\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 13:26:04,003 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:26:04,003 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:26:04,003 - DEBUG - send_request_headers.complete
2024-10-15 13:26:04,003 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:26:04,004 - DEBUG - send_request_body.complete
2024-10-15 13:26:04,004 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:26:05,445 - DEBUG - receive_response_headers.failed exception=KeyboardInterrupt()
2024-10-15 13:26:05,446 - DEBUG - response_closed.started
2024-10-15 13:26:05,446 - DEBUG - response_closed.complete
2024-10-15 13:26:05,621 - ERROR - Task exception was never retrieved
future: <Task finished name='Task-1' coro=<agent_workflow() done, defined at D:\deve\contract_automation\src\main.py:26> exception=KeyboardInterrupt()>
Traceback (most recent call last):
  File "D:\deve\contract_automation\src\main.py", line 100, in <module>
    asyncio.run(agent_workflow())
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 30, in run
    return loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 92, in run_until_complete
    self._run_once()
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 133, in _run_once
    handle._run()
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 386, in __wakeup
    self.__step()
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 293, in __step
    self.__step_run_and_handle_result(exc)
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 304, in __step_run_and_handle_result
    result = coro.send(None)
             ^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\src\main.py", line 42, in agent_workflow
    action = agent_action(state, templates)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\src\ai_functions.py", line 173, in agent_action
    def construct_contract(parties: ContractParties, address: str, template: str, details: ContractDetails) -> Contract:
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\instructor\patch.py", line 291, in new_create_sync
    response = retry_sync(
               ^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\instructor\retry.py", line 189, in retry_sync
    for attempt in max_retries:
  File "D:\deve\contract_automation\.venv\Lib\site-packages\tenacity\__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\tenacity\__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\tenacity\__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\deve\contract_automation\.venv\Lib\site-packages\instructor\retry.py", line 192, in retry_sync
    response = func(*args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\openai\_utils\_utils.py", line 274, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\openai\resources\chat\completions.py", line 742, in create
    return self._post(
           ^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\openai\_base_client.py", line 1270, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\openai\_base_client.py", line 947, in request
    return self._request(
           ^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\openai\_base_client.py", line 983, in _request
    response = self._client.send(
               ^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpx\_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpx\_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpx\_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpx\_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpx\_transports\default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpcore\_sync\connection_pool.py", line 216, in handle_request
    raise exc from None
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpcore\_sync\connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpcore\_sync\connection.py", line 101, in handle_request
    return self._connection.handle_request(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpcore\_sync\http11.py", line 143, in handle_request
    raise exc
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpcore\_sync\http11.py", line 113, in handle_request
    ) = self._receive_response_headers(**kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpcore\_sync\http11.py", line 186, in _receive_response_headers
    event = self._receive_event(timeout=timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpcore\_sync\http11.py", line 224, in _receive_event
    data = self._network_stream.read(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpcore\_backends\sync.py", line 126, in read
    return self._sock.recv(max_bytes)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\ssl.py", line 1234, in recv
    return self.read(buflen)
           ^^^^^^^^^^^^^^^^^
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\ssl.py", line 1107, in read
    return self._sslobj.read(len)
           ^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
2024-10-15 13:26:09,692 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-15 13:26:10,986 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-15 13:26:10,986 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-15 13:26:11,312 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-15 13:26:11,313 - DEBUG - Using proactor: IocpProactor
2024-10-15 13:26:11,331 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 13:26:11,331 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 13:26:11,331 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 13:26:11,331 - DEBUG - Compression method 0
2024-10-15 13:26:11,331 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 13:26:11,331 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 13:26:11,331 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 13:26:11,331 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 13:26:11,331 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 13:26:11,331 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 13:26:11,331 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 13:26:11,331 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 13:26:11,331 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 13:26:11,331 - DEBUG - Compression method 0
2024-10-15 13:26:11,331 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 13:26:11,331 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 13:26:11,331 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 13:26:11,331 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 13:26:11,331 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 13:26:11,331 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 13:26:11,340 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 13:26:11,340 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 13:26:11,340 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 13:26:11,341 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 13:26:11,341 - DEBUG - Error closing: Operation on closed image
2024-10-15 13:26:13,396 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 13:26:13,396 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 13:26:13,396 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 13:26:13,396 - DEBUG - Compression method 0
2024-10-15 13:26:13,396 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 13:26:13,396 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 13:26:13,396 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 13:26:13,396 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 13:26:13,396 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 13:26:13,396 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 13:26:13,396 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 13:26:13,396 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 13:26:13,397 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 13:26:13,397 - DEBUG - Compression method 0
2024-10-15 13:26:13,397 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 13:26:13,397 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 13:26:13,397 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 13:26:13,397 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 13:26:13,397 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 13:26:13,397 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 13:26:13,414 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 13:26:13,414 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 13:26:13,414 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 13:26:13,414 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 13:26:13,415 - DEBUG - Error closing: Operation on closed image
2024-10-15 13:26:18,178 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'instructor.dsl.simple_type.Response'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}}
2024-10-15 13:26:18,179 - DEBUG - max_retries: 1
2024-10-15 13:26:18,183 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}, 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}]}}
2024-10-15 13:26:18,227 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:26:18,227 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-15 13:26:18,259 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x0000010395066BD0>
2024-10-15 13:26:18,259 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x00000103FFF2E850> server_hostname='api.openai.com' timeout=5.0
2024-10-15 13:26:18,271 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x00000103FFA716D0>
2024-10-15 13:26:18,271 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:26:18,271 - DEBUG - send_request_headers.complete
2024-10-15 13:26:18,271 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:26:18,271 - DEBUG - send_request_body.complete
2024-10-15 13:26:18,271 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:26:21,947 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:26:22 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'3517'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9996'), (b'x-ratelimit-remaining-tokens', b'9569'), (b'x-ratelimit-reset-requests', b'26.48s'), (b'x-ratelimit-reset-tokens', b'2.586s'), (b'x-request-id', b'req_f788f69e2a65b0bd9d876d56cdcbfd24'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=Q.VYBbqXI_AA6JR1sMD7q5wp0jK5sa9JgSGSzg.vBZI-1728987982-1.0.1.1-.aFv3XaJe4BHm24T2RGvJGKMfPnrOMTUz2FySKMkI66oPsk1sM.E6cnFRnwObqAzlk0gZch22HPBMo6b8dRx5w; path=/; expires=Tue, 15-Oct-24 10:56:22 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=NwtFlmwkgrUn8oYoqa.9ZuxnA2BhAKslnX5oLO4gcWI-1728987982474-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f1c338d5b6255-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:26:21,948 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:26:21,948 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:26:21,948 - DEBUG - receive_response_body.complete
2024-10-15 13:26:21,948 - DEBUG - response_closed.started
2024-10-15 13:26:21,948 - DEBUG - response_closed.complete
2024-10-15 13:26:21,948 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Tue, 15 Oct 2024 10:26:22 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-kzzh9hik9ryjiou4ftvhondh'), ('openai-processing-ms', '3517'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '10000'), ('x-ratelimit-remaining-requests', '9996'), ('x-ratelimit-remaining-tokens', '9569'), ('x-ratelimit-reset-requests', '26.48s'), ('x-ratelimit-reset-tokens', '2.586s'), ('x-request-id', 'req_f788f69e2a65b0bd9d876d56cdcbfd24'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=Q.VYBbqXI_AA6JR1sMD7q5wp0jK5sa9JgSGSzg.vBZI-1728987982-1.0.1.1-.aFv3XaJe4BHm24T2RGvJGKMfPnrOMTUz2FySKMkI66oPsk1sM.E6cnFRnwObqAzlk0gZch22HPBMo6b8dRx5w; path=/; expires=Tue, 15-Oct-24 10:56:22 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=NwtFlmwkgrUn8oYoqa.9ZuxnA2BhAKslnX5oLO4gcWI-1728987982474-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d2f1c338d5b6255-OTP'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-15 13:26:21,948 - DEBUG - request_id: req_f788f69e2a65b0bd9d876d56cdcbfd24
2024-10-15 13:26:21,950 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZ2pin7B31iGee5C1ZYcfLK3pwT2', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_SOb5OcDByfTX8YYWJoNznwRL', function=Function(arguments='{\n  "content": [\n    {\n      "name": "ISPILANTE SENTIMENT BRUSLI",\n      "address": "Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR"\n    }\n  ]\n}', name='Response'), type='function')]))], created=1728987979, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=53, prompt_tokens=472, total_tokens=525, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:26:21,950 - DEBUG - Returning model from AdapterBase
2024-10-15 13:26:47,403 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'instructor.dsl.simple_type.Response'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}}
2024-10-15 13:26:47,403 - DEBUG - max_retries: 1
2024-10-15 13:26:47,406 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}, 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}]}}
2024-10-15 13:26:47,407 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:26:47,407 - DEBUG - close.started
2024-10-15 13:26:47,407 - DEBUG - close.complete
2024-10-15 13:26:47,407 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-15 13:26:47,432 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001039508F9E0>
2024-10-15 13:26:47,432 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x00000103FFF2E850> server_hostname='api.openai.com' timeout=5.0
2024-10-15 13:26:47,440 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001039508FA70>
2024-10-15 13:26:47,440 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:26:47,441 - DEBUG - send_request_headers.complete
2024-10-15 13:26:47,441 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:26:47,441 - DEBUG - send_request_body.complete
2024-10-15 13:26:47,441 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:26:51,023 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:26:51 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'3165'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'9576'), (b'x-ratelimit-reset-requests', b'8.64s'), (b'x-ratelimit-reset-tokens', b'2.544s'), (b'x-request-id', b'req_24ab95e17776bde8bd5b46104fd38a1c'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f1ce9decfb6b5-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:26:51,024 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:26:51,025 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:26:51,025 - DEBUG - receive_response_body.complete
2024-10-15 13:26:51,025 - DEBUG - response_closed.started
2024-10-15 13:26:51,026 - DEBUG - response_closed.complete
2024-10-15 13:26:51,026 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 10:26:51 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '3165', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9999', 'x-ratelimit-remaining-tokens': '9576', 'x-ratelimit-reset-requests': '8.64s', 'x-ratelimit-reset-tokens': '2.544s', 'x-request-id': 'req_24ab95e17776bde8bd5b46104fd38a1c', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f1ce9decfb6b5-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 13:26:51,026 - DEBUG - request_id: req_24ab95e17776bde8bd5b46104fd38a1c
2024-10-15 13:26:51,027 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZ3I2ynLxp1d4cjxkftV8bcTCgBR', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_npdm8Grpt3enp6VaVcoUahxe', function=Function(arguments='{\n  "content": [\n    {\n      "name": "VASILESCU ELENA",\n      "address": "Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B"\n    }\n  ]\n}', name='Response'), type='function')]))], created=1728988008, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=55, prompt_tokens=475, total_tokens=530, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:26:51,029 - DEBUG - Returning model from AdapterBase
2024-10-15 13:26:52,208 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 13:26:52,208 - DEBUG - max_retries: 1
2024-10-15 13:26:52,210 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 13:26:52,211 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:26:52,211 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:26:52,211 - DEBUG - send_request_headers.complete
2024-10-15 13:26:52,211 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:26:52,211 - DEBUG - send_request_body.complete
2024-10-15 13:26:52,211 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:26:53,192 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:26:53 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'814'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9998'), (b'x-ratelimit-remaining-tokens', b'9608'), (b'x-ratelimit-reset-requests', b'12.509s'), (b'x-ratelimit-reset-tokens', b'2.352s'), (b'x-request-id', b'req_eb0962ff4cee619fcddd9d024684dbaa'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f1d07a833b6b5-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:26:53,192 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:26:53,192 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:26:53,192 - DEBUG - receive_response_body.complete
2024-10-15 13:26:53,192 - DEBUG - response_closed.started
2024-10-15 13:26:53,192 - DEBUG - response_closed.complete
2024-10-15 13:26:53,192 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 10:26:53 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '814', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9998', 'x-ratelimit-remaining-tokens': '9608', 'x-ratelimit-reset-requests': '12.509s', 'x-ratelimit-reset-tokens': '2.352s', 'x-request-id': 'req_eb0962ff4cee619fcddd9d024684dbaa', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f1d07a833b6b5-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 13:26:53,192 - DEBUG - request_id: req_eb0962ff4cee619fcddd9d024684dbaa
2024-10-15 13:26:53,193 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZ3MipSJlIwDK9mOs7PptAkRhWzX', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_gcWlr9mgi4goUZz2MQxhnfrl', function=Function(arguments='\n{\n  "action": "determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728988012, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=13, prompt_tokens=360, total_tokens=373, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:26:55,766 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: Yes\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 13:26:55,766 - DEBUG - max_retries: 1
2024-10-15 13:26:55,768 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: Yes\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 13:26:55,769 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:26:55,769 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:26:55,769 - DEBUG - send_request_headers.complete
2024-10-15 13:26:55,769 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:26:55,769 - DEBUG - send_request_body.complete
2024-10-15 13:26:55,769 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:26:56,723 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:26:57 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'795'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9997'), (b'x-ratelimit-remaining-tokens', b'9608'), (b'x-ratelimit-reset-requests', b'17.603s'), (b'x-ratelimit-reset-tokens', b'2.352s'), (b'x-request-id', b'req_65de4bfc8b3dbe907d676d2f60ada4a5'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f1d1de91cb6b5-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:26:56,724 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:26:56,724 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:26:56,724 - DEBUG - receive_response_body.complete
2024-10-15 13:26:56,724 - DEBUG - response_closed.started
2024-10-15 13:26:56,724 - DEBUG - response_closed.complete
2024-10-15 13:26:56,724 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 10:26:57 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '795', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9997', 'x-ratelimit-remaining-tokens': '9608', 'x-ratelimit-reset-requests': '17.603s', 'x-ratelimit-reset-tokens': '2.352s', 'x-request-id': 'req_65de4bfc8b3dbe907d676d2f60ada4a5', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f1d1de91cb6b5-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 13:26:56,724 - DEBUG - request_id: req_65de4bfc8b3dbe907d676d2f60ada4a5
2024-10-15 13:26:56,724 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZ3QACBq8YCUPNKZwHtdWzvtqNHL', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_hASOEgNbPokV2lMIu4c3abyr', function=Function(arguments='\n{\n  "action": "identify_parties"\n}', name='AgentAction'), type='function')]))], created=1728988016, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=12, prompt_tokens=360, total_tokens=372, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:26:56,726 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.ContractParties'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    For a it contract, suggest roles for the following parties based on their personal information:\n\n    Name: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: VASILESCU ELENA, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B\n\n    Your task is to suggest appropriate roles for each person in the context of a it contract. \n    The human will then confirm or modify these suggestions.\n    '}], 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'$defs': {'ContractParty': {'properties': {'name': {'description': 'Name of the party', 'title': 'Name', 'type': 'string'}, 'role': {'description': 'Role of the party in the contract', 'title': 'Role', 'type': 'string'}}, 'required': ['name', 'role'], 'title': 'ContractParty', 'type': 'object'}}, 'properties': {'parties': {'description': 'List of parties involved in the contract', 'items': {'$ref': '#/$defs/ContractParty'}, 'title': 'Parties', 'type': 'array'}}, 'required': ['parties'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}}
2024-10-15 13:26:56,726 - DEBUG - max_retries: 1
2024-10-15 13:26:56,727 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    For a it contract, suggest roles for the following parties based on their personal information:\n\n    Name: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: VASILESCU ELENA, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B\n\n    Your task is to suggest appropriate roles for each person in the context of a it contract. \n    The human will then confirm or modify these suggestions.\n    '}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}, 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'$defs': {'ContractParty': {'properties': {'name': {'description': 'Name of the party', 'title': 'Name', 'type': 'string'}, 'role': {'description': 'Role of the party in the contract', 'title': 'Role', 'type': 'string'}}, 'required': ['name', 'role'], 'title': 'ContractParty', 'type': 'object'}}, 'properties': {'parties': {'description': 'List of parties involved in the contract', 'items': {'$ref': '#/$defs/ContractParty'}, 'title': 'Parties', 'type': 'array'}}, 'required': ['parties'], 'type': 'object'}}}]}}
2024-10-15 13:26:56,728 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:26:56,728 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:26:56,728 - DEBUG - send_request_headers.complete
2024-10-15 13:26:56,728 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:26:56,728 - DEBUG - send_request_body.complete
2024-10-15 13:26:56,728 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:27:00,076 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:27:00 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'3191'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9997'), (b'x-ratelimit-remaining-tokens', b'9408'), (b'x-ratelimit-reset-requests', b'25.276s'), (b'x-ratelimit-reset-tokens', b'3.55s'), (b'x-request-id', b'req_de1c838bc08204ac45ea1d49d7ac9dee'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f1d23df8fb6b5-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:27:00,076 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:27:00,076 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:27:00,077 - DEBUG - receive_response_body.complete
2024-10-15 13:27:00,077 - DEBUG - response_closed.started
2024-10-15 13:27:00,077 - DEBUG - response_closed.complete
2024-10-15 13:27:00,077 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 10:27:00 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '3191', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9997', 'x-ratelimit-remaining-tokens': '9408', 'x-ratelimit-reset-requests': '25.276s', 'x-ratelimit-reset-tokens': '3.55s', 'x-request-id': 'req_de1c838bc08204ac45ea1d49d7ac9dee', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f1d23df8fb6b5-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 13:27:00,077 - DEBUG - request_id: req_de1c838bc08204ac45ea1d49d7ac9dee
2024-10-15 13:27:00,077 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZ3RWkjQSsDvgwobrcqDHfDS3uuR', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_HGjlJ1V8yEA1PhJtKZ8jtS7x', function=Function(arguments='\n{\n  "parties": [\n    {\n      "name": "ISPILANTE SENTIMENT BRUSLI",\n      "role": "Service Provider"\n    },\n    {\n      "name": "VASILESCU ELENA",\n      "role": "Client"\n    }\n  ]\n}', name='ContractParties'), type='function')]))], created=1728988017, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=61, prompt_tokens=391, total_tokens=452, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:27:36,948 - DEBUG - close.started
2024-10-15 13:27:36,949 - DEBUG - close.complete
2024-10-15 13:27:36,949 - ERROR - Task exception was never retrieved
future: <Task finished name='Task-1' coro=<agent_workflow() done, defined at D:\deve\contract_automation\src\main.py:26> exception=KeyboardInterrupt()>
Traceback (most recent call last):
  File "D:\deve\contract_automation\src\main.py", line 100, in <module>
    asyncio.run(agent_workflow())
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 30, in run
    return loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 92, in run_until_complete
    self._run_once()
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 133, in _run_once
    handle._run()
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 386, in __wakeup
    self.__step()
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 293, in __step
    self.__step_run_and_handle_result(exc)
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 304, in __step_run_and_handle_result
    result = coro.send(None)
             ^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\src\main.py", line 63, in agent_workflow
    state.parties = identify_parties(state.verified_pii_data, state.contract_details.contract_type)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\src\ai_functions.py", line 152, in identify_parties
    confirmation = input(f"Is this role correct for {party.name}? (yes/no): ").lower()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
2024-10-15 13:33:01,768 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-15 13:33:03,034 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-15 13:33:03,034 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-15 13:33:03,345 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-15 13:33:03,346 - DEBUG - Using proactor: IocpProactor
2024-10-15 13:33:03,365 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 13:33:03,365 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 13:33:03,365 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 13:33:03,365 - DEBUG - Compression method 0
2024-10-15 13:33:03,365 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 13:33:03,365 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 13:33:03,365 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 13:33:03,365 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 13:33:03,365 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 13:33:03,365 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 13:33:03,365 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 13:33:03,365 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 13:33:03,365 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 13:33:03,365 - DEBUG - Compression method 0
2024-10-15 13:33:03,365 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 13:33:03,365 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 13:33:03,365 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 13:33:03,366 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 13:33:03,366 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 13:33:03,366 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 13:33:03,375 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 13:33:03,375 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 13:33:03,375 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 13:33:03,375 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 13:33:03,376 - DEBUG - Error closing: Operation on closed image
2024-10-15 13:33:05,386 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 13:33:05,386 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 13:33:05,386 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 13:33:05,386 - DEBUG - Compression method 0
2024-10-15 13:33:05,386 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 13:33:05,386 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 13:33:05,386 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 13:33:05,386 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 13:33:05,386 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 13:33:05,386 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 13:33:05,386 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 13:33:05,387 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 13:33:05,387 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 13:33:05,387 - DEBUG - Compression method 0
2024-10-15 13:33:05,387 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 13:33:05,387 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 13:33:05,387 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 13:33:05,387 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 13:33:05,387 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 13:33:05,387 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 13:33:05,404 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 13:33:05,404 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 13:33:05,404 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 13:33:05,404 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 13:33:05,405 - DEBUG - Error closing: Operation on closed image
2024-10-15 13:33:07,899 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'instructor.dsl.simple_type.Response'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}}
2024-10-15 13:33:07,900 - DEBUG - max_retries: 1
2024-10-15 13:33:07,902 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}, 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}]}}
2024-10-15 13:33:07,939 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:33:07,940 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-15 13:33:08,018 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001E4531D3680>
2024-10-15 13:33:08,018 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x000001E45322E850> server_hostname='api.openai.com' timeout=5.0
2024-10-15 13:33:08,034 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001E4530B4440>
2024-10-15 13:33:08,034 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:33:08,034 - DEBUG - send_request_headers.complete
2024-10-15 13:33:08,034 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:33:08,034 - DEBUG - send_request_body.complete
2024-10-15 13:33:08,034 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:33:11,187 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:33:11 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'3006'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'9569'), (b'x-ratelimit-reset-requests', b'8.64s'), (b'x-ratelimit-reset-tokens', b'2.586s'), (b'x-request-id', b'req_9850a552466dd008f6d226de643a4722'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=bQsn4Oth8aOZSkhq8O0jW6DIGixoM3np6umgQdKf.Kc-1728988391-1.0.1.1-SrLYQsed7uZodQrQ_tT54XEgl6j0NctV7QEZYkNX8n9fjRhZ6nPRmQLkaaIC503G3iFBlEXko4ezZD5MT7L_ew; path=/; expires=Tue, 15-Oct-24 11:03:11 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=MZ9JfH9XCQBZPtoZbo7nBviLVzsRBlUl7aUuyGhmasU-1728988391729-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f2634acadc9c4-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:33:11,189 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:33:11,189 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:33:11,190 - DEBUG - receive_response_body.complete
2024-10-15 13:33:11,190 - DEBUG - response_closed.started
2024-10-15 13:33:11,191 - DEBUG - response_closed.complete
2024-10-15 13:33:11,191 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Tue, 15 Oct 2024 10:33:11 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-kzzh9hik9ryjiou4ftvhondh'), ('openai-processing-ms', '3006'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '10000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '9569'), ('x-ratelimit-reset-requests', '8.64s'), ('x-ratelimit-reset-tokens', '2.586s'), ('x-request-id', 'req_9850a552466dd008f6d226de643a4722'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=bQsn4Oth8aOZSkhq8O0jW6DIGixoM3np6umgQdKf.Kc-1728988391-1.0.1.1-SrLYQsed7uZodQrQ_tT54XEgl6j0NctV7QEZYkNX8n9fjRhZ6nPRmQLkaaIC503G3iFBlEXko4ezZD5MT7L_ew; path=/; expires=Tue, 15-Oct-24 11:03:11 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=MZ9JfH9XCQBZPtoZbo7nBviLVzsRBlUl7aUuyGhmasU-1728988391729-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d2f2634acadc9c4-OTP'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-15 13:33:11,191 - DEBUG - request_id: req_9850a552466dd008f6d226de643a4722
2024-10-15 13:33:11,194 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZ9Qy2eRIDReqigZP96i64LKR16g', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_i7eehu0VDb7CATHk8sbANi06', function=Function(arguments='{\n  "content": [\n    {\n      "name": "ISPILANTE SENTIMENT BRUSLI",\n      "address": "Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR"\n    }\n  ]\n}', name='Response'), type='function')]))], created=1728988388, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=53, prompt_tokens=472, total_tokens=525, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:33:11,195 - DEBUG - Returning model from AdapterBase
2024-10-15 13:33:12,878 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'instructor.dsl.simple_type.Response'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}}
2024-10-15 13:33:12,879 - DEBUG - max_retries: 1
2024-10-15 13:33:12,881 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}, 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}]}}
2024-10-15 13:33:12,881 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:33:12,881 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:33:12,882 - DEBUG - send_request_headers.complete
2024-10-15 13:33:12,882 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:33:12,882 - DEBUG - send_request_body.complete
2024-10-15 13:33:12,882 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:33:16,129 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:33:16 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'3082'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9998'), (b'x-ratelimit-remaining-tokens', b'9576'), (b'x-ratelimit-reset-requests', b'12.426s'), (b'x-ratelimit-reset-tokens', b'2.544s'), (b'x-request-id', b'req_0ec313c3eda23449bf2327b9f87d8e4f'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f2652eb36c9c4-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:33:16,130 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:33:16,131 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:33:16,131 - DEBUG - receive_response_body.complete
2024-10-15 13:33:16,131 - DEBUG - response_closed.started
2024-10-15 13:33:16,132 - DEBUG - response_closed.complete
2024-10-15 13:33:16,132 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 10:33:16 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '3082', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9998', 'x-ratelimit-remaining-tokens': '9576', 'x-ratelimit-reset-requests': '12.426s', 'x-ratelimit-reset-tokens': '2.544s', 'x-request-id': 'req_0ec313c3eda23449bf2327b9f87d8e4f', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f2652eb36c9c4-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 13:33:16,132 - DEBUG - request_id: req_0ec313c3eda23449bf2327b9f87d8e4f
2024-10-15 13:33:16,133 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZ9VJV9q2BklhxcygV0J9vxUmmtw', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_jXxThNIS14WWrDQTTKRAInS3', function=Function(arguments='{\n  "content": [\n    {\n      "name": "ELENA VASILESCU",\n      "address": "Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B"\n    }\n  ]\n}', name='Response'), type='function')]))], created=1728988393, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=56, prompt_tokens=475, total_tokens=531, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:33:16,135 - DEBUG - Returning model from AdapterBase
2024-10-15 13:33:17,312 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 13:33:17,312 - DEBUG - max_retries: 1
2024-10-15 13:33:17,314 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 13:33:17,315 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:33:17,315 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:33:17,315 - DEBUG - send_request_headers.complete
2024-10-15 13:33:17,315 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:33:17,316 - DEBUG - send_request_body.complete
2024-10-15 13:33:17,316 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:33:18,463 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:33:19 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1002'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9998'), (b'x-ratelimit-remaining-tokens', b'9608'), (b'x-ratelimit-reset-requests', b'16.641s'), (b'x-ratelimit-reset-tokens', b'2.352s'), (b'x-request-id', b'req_60678c0286753767a27331b30a08e060'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f266eab58c9c4-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:33:18,464 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:33:18,465 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:33:18,465 - DEBUG - receive_response_body.complete
2024-10-15 13:33:18,465 - DEBUG - response_closed.started
2024-10-15 13:33:18,465 - DEBUG - response_closed.complete
2024-10-15 13:33:18,465 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 10:33:19 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1002', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9998', 'x-ratelimit-remaining-tokens': '9608', 'x-ratelimit-reset-requests': '16.641s', 'x-ratelimit-reset-tokens': '2.352s', 'x-request-id': 'req_60678c0286753767a27331b30a08e060', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f266eab58c9c4-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 13:33:18,466 - DEBUG - request_id: req_60678c0286753767a27331b30a08e060
2024-10-15 13:33:18,467 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZ9ac1TQ9EHRKt5UNI8cGGD3OP6v', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_MpBvPyAr79QbsfIxydzuI7Lo', function=Function(arguments='\n{\n  "action": "determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728988398, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=13, prompt_tokens=360, total_tokens=373, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:33:21,220 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: Yes\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 13:33:21,220 - DEBUG - max_retries: 1
2024-10-15 13:33:21,221 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: Yes\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 13:33:21,221 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:33:21,221 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:33:21,222 - DEBUG - send_request_headers.complete
2024-10-15 13:33:21,222 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:33:21,222 - DEBUG - send_request_body.complete
2024-10-15 13:33:21,222 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:33:22,415 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:33:22 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1023'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9997'), (b'x-ratelimit-remaining-tokens', b'9608'), (b'x-ratelimit-reset-requests', b'21.364s'), (b'x-ratelimit-reset-tokens', b'2.352s'), (b'x-request-id', b'req_1de6f36cd98785a5bfbed827809e92f3'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f26870e4ec9c4-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:33:22,416 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:33:22,416 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:33:22,416 - DEBUG - receive_response_body.complete
2024-10-15 13:33:22,416 - DEBUG - response_closed.started
2024-10-15 13:33:22,416 - DEBUG - response_closed.complete
2024-10-15 13:33:22,416 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 10:33:22 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1023', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9997', 'x-ratelimit-remaining-tokens': '9608', 'x-ratelimit-reset-requests': '21.364s', 'x-ratelimit-reset-tokens': '2.352s', 'x-request-id': 'req_1de6f36cd98785a5bfbed827809e92f3', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f26870e4ec9c4-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 13:33:22,416 - DEBUG - request_id: req_1de6f36cd98785a5bfbed827809e92f3
2024-10-15 13:33:22,416 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZ9e7hIus0UYtxsTsOEncOJWO8nq', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_JwZqdWAb2HDMrsZfVfFpeDAY', function=Function(arguments='{\n"action": "identify_parties"\n}', name='AgentAction'), type='function')]))], created=1728988402, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=10, prompt_tokens=360, total_tokens=370, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:33:22,418 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.ContractParties'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    For a airbnb contract, show the roles available for the following parties based on their personal information:\n\n    Name: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B\n\n    Your task is to suggest appropriate roles for each person in the context of a airbnb contract. \n    The human will then confirm or modify these suggestions.\n    '}], 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'$defs': {'ContractParty': {'properties': {'name': {'description': 'Name of the party', 'title': 'Name', 'type': 'string'}, 'role': {'description': 'Role of the party in the contract', 'title': 'Role', 'type': 'string'}}, 'required': ['name', 'role'], 'title': 'ContractParty', 'type': 'object'}}, 'properties': {'parties': {'description': 'List of parties involved in the contract', 'items': {'$ref': '#/$defs/ContractParty'}, 'title': 'Parties', 'type': 'array'}}, 'required': ['parties'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}}
2024-10-15 13:33:22,418 - DEBUG - max_retries: 1
2024-10-15 13:33:22,420 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    For a airbnb contract, show the roles available for the following parties based on their personal information:\n\n    Name: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B\n\n    Your task is to suggest appropriate roles for each person in the context of a airbnb contract. \n    The human will then confirm or modify these suggestions.\n    '}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}, 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'$defs': {'ContractParty': {'properties': {'name': {'description': 'Name of the party', 'title': 'Name', 'type': 'string'}, 'role': {'description': 'Role of the party in the contract', 'title': 'Role', 'type': 'string'}}, 'required': ['name', 'role'], 'title': 'ContractParty', 'type': 'object'}}, 'properties': {'parties': {'description': 'List of parties involved in the contract', 'items': {'$ref': '#/$defs/ContractParty'}, 'title': 'Parties', 'type': 'array'}}, 'required': ['parties'], 'type': 'object'}}}]}}
2024-10-15 13:33:22,420 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:33:22,420 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:33:22,421 - DEBUG - send_request_headers.complete
2024-10-15 13:33:22,421 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:33:22,421 - DEBUG - send_request_body.complete
2024-10-15 13:33:22,421 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:33:25,336 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:33:25 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2750'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9996'), (b'x-ratelimit-remaining-tokens', b'9444'), (b'x-ratelimit-reset-requests', b'28.799s'), (b'x-ratelimit-reset-tokens', b'3.331s'), (b'x-request-id', b'req_365f82953ed87949f59bcc1a9bd14378'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f268e8d08c9c4-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:33:25,336 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:33:25,337 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:33:25,337 - DEBUG - receive_response_body.complete
2024-10-15 13:33:25,337 - DEBUG - response_closed.started
2024-10-15 13:33:25,337 - DEBUG - response_closed.complete
2024-10-15 13:33:25,338 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 10:33:25 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '2750', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9996', 'x-ratelimit-remaining-tokens': '9444', 'x-ratelimit-reset-requests': '28.799s', 'x-ratelimit-reset-tokens': '3.331s', 'x-request-id': 'req_365f82953ed87949f59bcc1a9bd14378', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f268e8d08c9c4-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 13:33:25,338 - DEBUG - request_id: req_365f82953ed87949f59bcc1a9bd14378
2024-10-15 13:33:25,339 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZ9fjJxGR07TaG5CAxbHxzgTrVxd', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_P38WjOlHkjbr6FaMyta7Kg3i', function=Function(arguments='\n{\n  "parties": [\n    {\n      "name": "ISPILANTE SENTIMENT BRUSLI",\n      "role": "Landlord"\n    },\n    {\n      "name": "ELENA VASILESCU",\n      "role": "Tenant"\n    }\n  ]\n}', name='ContractParties'), type='function')]))], created=1728988403, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=62, prompt_tokens=395, total_tokens=457, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:33:34,523 - DEBUG - close.started
2024-10-15 13:33:34,524 - DEBUG - close.complete
2024-10-15 13:33:34,524 - ERROR - Task exception was never retrieved
future: <Task finished name='Task-1' coro=<agent_workflow() done, defined at D:\deve\contract_automation\src\main.py:26> exception=KeyboardInterrupt()>
Traceback (most recent call last):
  File "D:\deve\contract_automation\src\main.py", line 100, in <module>
    asyncio.run(agent_workflow())
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 30, in run
    return loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 92, in run_until_complete
    self._run_once()
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 133, in _run_once
    handle._run()
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 386, in __wakeup
    self.__step()
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 293, in __step
    self.__step_run_and_handle_result(exc)
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 304, in __step_run_and_handle_result
    result = coro.send(None)
             ^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\src\main.py", line 63, in agent_workflow
    state.parties = identify_parties(state.verified_pii_data, state.contract_details.contract_type)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\src\ai_functions.py", line 152, in identify_parties
    confirmation = input(f"Is this role correct for {party.name}? (yes/no): ").lower()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
2024-10-15 13:33:38,936 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-15 13:33:40,181 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-15 13:33:40,181 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-15 13:33:40,493 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-15 13:33:40,494 - DEBUG - Using proactor: IocpProactor
2024-10-15 13:33:40,513 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 13:33:40,513 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 13:33:40,513 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 13:33:40,513 - DEBUG - Compression method 0
2024-10-15 13:33:40,513 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 13:33:40,513 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 13:33:40,513 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 13:33:40,513 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 13:33:40,514 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 13:33:40,514 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 13:33:40,514 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 13:33:40,514 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 13:33:40,514 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 13:33:40,514 - DEBUG - Compression method 0
2024-10-15 13:33:40,514 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 13:33:40,514 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 13:33:40,514 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 13:33:40,514 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 13:33:40,514 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 13:33:40,514 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 13:33:40,523 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 13:33:40,523 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 13:33:40,523 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 13:33:40,523 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 13:33:40,524 - DEBUG - Error closing: Operation on closed image
2024-10-15 13:33:42,546 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 13:33:42,546 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 13:33:42,546 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 13:33:42,546 - DEBUG - Compression method 0
2024-10-15 13:33:42,546 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 13:33:42,546 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 13:33:42,546 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 13:33:42,546 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 13:33:42,546 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 13:33:42,546 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 13:33:42,546 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 13:33:42,546 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 13:33:42,546 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 13:33:42,546 - DEBUG - Compression method 0
2024-10-15 13:33:42,546 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 13:33:42,546 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 13:33:42,546 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 13:33:42,546 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 13:33:42,546 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 13:33:42,546 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 13:33:42,564 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 13:33:42,564 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 13:33:42,564 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 13:33:42,564 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 13:33:42,565 - DEBUG - Error closing: Operation on closed image
2024-10-15 13:33:45,022 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'instructor.dsl.simple_type.Response'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}}
2024-10-15 13:33:45,023 - DEBUG - max_retries: 1
2024-10-15 13:33:45,025 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}, 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}]}}
2024-10-15 13:33:45,062 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:33:45,062 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-15 13:33:45,092 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000002367369B560>
2024-10-15 13:33:45,092 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x0000023674A7E850> server_hostname='api.openai.com' timeout=5.0
2024-10-15 13:33:45,099 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x0000023674BACEF0>
2024-10-15 13:33:45,099 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:33:45,099 - DEBUG - send_request_headers.complete
2024-10-15 13:33:45,099 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:33:45,099 - DEBUG - send_request_body.complete
2024-10-15 13:33:45,099 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:33:48,336 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:33:48 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'3075'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9998'), (b'x-ratelimit-remaining-tokens', b'9569'), (b'x-ratelimit-reset-requests', b'14.767s'), (b'x-ratelimit-reset-tokens', b'2.586s'), (b'x-request-id', b'req_172900be05f143b68ecbfcf834d14979'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=cfMUgSTDVsAuImotMLODSUFWwHwpCiBetV_DOCW3zCM-1728988428-1.0.1.1-yeLO0qmS16fz4ReW6DK_jpcPIqNiAeYLLuK0n2ff2YTen1y2.mxQmPTfGhMjmrntCDIH9o.rqwMtpQdGBlBUdQ; path=/; expires=Tue, 15-Oct-24 11:03:48 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=xgDQXwVXWTV.eu7ZAuQiVjBCqt.XSZusIiHIiNaYPwg-1728988428880-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f271c4a32ca29-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:33:48,338 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:33:48,339 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:33:48,339 - DEBUG - receive_response_body.complete
2024-10-15 13:33:48,340 - DEBUG - response_closed.started
2024-10-15 13:33:48,340 - DEBUG - response_closed.complete
2024-10-15 13:33:48,340 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Tue, 15 Oct 2024 10:33:48 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-kzzh9hik9ryjiou4ftvhondh'), ('openai-processing-ms', '3075'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '10000'), ('x-ratelimit-remaining-requests', '9998'), ('x-ratelimit-remaining-tokens', '9569'), ('x-ratelimit-reset-requests', '14.767s'), ('x-ratelimit-reset-tokens', '2.586s'), ('x-request-id', 'req_172900be05f143b68ecbfcf834d14979'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=cfMUgSTDVsAuImotMLODSUFWwHwpCiBetV_DOCW3zCM-1728988428-1.0.1.1-yeLO0qmS16fz4ReW6DK_jpcPIqNiAeYLLuK0n2ff2YTen1y2.mxQmPTfGhMjmrntCDIH9o.rqwMtpQdGBlBUdQ; path=/; expires=Tue, 15-Oct-24 11:03:48 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=xgDQXwVXWTV.eu7ZAuQiVjBCqt.XSZusIiHIiNaYPwg-1728988428880-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d2f271c4a32ca29-OTP'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-15 13:33:48,340 - DEBUG - request_id: req_172900be05f143b68ecbfcf834d14979
2024-10-15 13:33:48,343 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZA1x5sOcO5dJVqHGIt3xy2tCcoy', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_y6g3t3S8mY07j4ULQmozW0L8', function=Function(arguments='{\n"content": [\n  {\n    "name": "ISPILANTE SENTIMENT BRUSLI",\n    "address": "Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR"\n  }\n]\n}', name='Response'), type='function')]))], created=1728988425, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=51, prompt_tokens=472, total_tokens=523, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:33:48,344 - DEBUG - Returning model from AdapterBase
2024-10-15 13:33:49,823 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'instructor.dsl.simple_type.Response'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}}
2024-10-15 13:33:49,823 - DEBUG - max_retries: 1
2024-10-15 13:33:49,825 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}, 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}]}}
2024-10-15 13:33:49,826 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:33:49,826 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:33:49,826 - DEBUG - send_request_headers.complete
2024-10-15 13:33:49,826 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:33:49,827 - DEBUG - send_request_body.complete
2024-10-15 13:33:49,827 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:33:52,648 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:33:53 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2670'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9997'), (b'x-ratelimit-remaining-tokens', b'9576'), (b'x-ratelimit-reset-requests', b'18.683s'), (b'x-ratelimit-reset-tokens', b'2.544s'), (b'x-request-id', b'req_80b977b57cc7d2749ee5003e2bfd397e'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f2739dd31ca29-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:33:52,648 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:33:52,649 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:33:52,650 - DEBUG - receive_response_body.complete
2024-10-15 13:33:52,650 - DEBUG - response_closed.started
2024-10-15 13:33:52,650 - DEBUG - response_closed.complete
2024-10-15 13:33:52,650 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 10:33:53 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '2670', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9997', 'x-ratelimit-remaining-tokens': '9576', 'x-ratelimit-reset-requests': '18.683s', 'x-ratelimit-reset-tokens': '2.544s', 'x-request-id': 'req_80b977b57cc7d2749ee5003e2bfd397e', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f2739dd31ca29-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 13:33:52,651 - DEBUG - request_id: req_80b977b57cc7d2749ee5003e2bfd397e
2024-10-15 13:33:52,652 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZA6isad6ZoVKeePxMkfpEj2bUMx', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_ZcUeaxmV4rwNkkcM5yC4rupG', function=Function(arguments='{\n  "content": [\n    {\n      "name": "VASILESCU ELENA",\n      "address": "Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B"\n    }\n  ]\n}', name='Response'), type='function')]))], created=1728988430, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=55, prompt_tokens=475, total_tokens=530, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:33:52,654 - DEBUG - Returning model from AdapterBase
2024-10-15 13:33:53,825 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 13:33:53,825 - DEBUG - max_retries: 1
2024-10-15 13:33:53,826 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 13:33:53,827 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:33:53,827 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:33:53,827 - DEBUG - send_request_headers.complete
2024-10-15 13:33:53,827 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:33:53,827 - DEBUG - send_request_body.complete
2024-10-15 13:33:53,828 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:33:55,030 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:33:55 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'934'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9997'), (b'x-ratelimit-remaining-tokens', b'9608'), (b'x-ratelimit-reset-requests', b'23.322s'), (b'x-ratelimit-reset-tokens', b'2.352s'), (b'x-request-id', b'req_250961abc337347c8599f17dfa874e0e'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f2752d91eca29-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:33:55,030 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:33:55,030 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:33:55,031 - DEBUG - receive_response_body.complete
2024-10-15 13:33:55,031 - DEBUG - response_closed.started
2024-10-15 13:33:55,031 - DEBUG - response_closed.complete
2024-10-15 13:33:55,031 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 10:33:55 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '934', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9997', 'x-ratelimit-remaining-tokens': '9608', 'x-ratelimit-reset-requests': '23.322s', 'x-ratelimit-reset-tokens': '2.352s', 'x-request-id': 'req_250961abc337347c8599f17dfa874e0e', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f2752d91eca29-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 13:33:55,031 - DEBUG - request_id: req_250961abc337347c8599f17dfa874e0e
2024-10-15 13:33:55,031 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZAAMgKLDOClPJTZqk0fmV5nurGc', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_uIZpBCyztG3rVRrCtgcmiQaK', function=Function(arguments='\n{\n  "action": "determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728988434, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=13, prompt_tokens=360, total_tokens=373, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:33:58,494 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: Yes\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 13:33:58,494 - DEBUG - max_retries: 1
2024-10-15 13:33:58,496 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: Yes\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 13:33:58,496 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:33:58,497 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:33:58,497 - DEBUG - send_request_headers.complete
2024-10-15 13:33:58,497 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:33:58,497 - DEBUG - send_request_body.complete
2024-10-15 13:33:58,497 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:33:59,722 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:34:00 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1075'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9996'), (b'x-ratelimit-remaining-tokens', b'9608'), (b'x-ratelimit-reset-requests', b'27.296s'), (b'x-ratelimit-reset-tokens', b'2.352s'), (b'x-request-id', b'req_167e85185530d8732640b286212b2416'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f27700b34ca29-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:33:59,723 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:33:59,723 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:33:59,724 - DEBUG - receive_response_body.complete
2024-10-15 13:33:59,724 - DEBUG - response_closed.started
2024-10-15 13:33:59,724 - DEBUG - response_closed.complete
2024-10-15 13:33:59,724 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 10:34:00 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1075', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9996', 'x-ratelimit-remaining-tokens': '9608', 'x-ratelimit-reset-requests': '27.296s', 'x-ratelimit-reset-tokens': '2.352s', 'x-request-id': 'req_167e85185530d8732640b286212b2416', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f27700b34ca29-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 13:33:59,725 - DEBUG - request_id: req_167e85185530d8732640b286212b2416
2024-10-15 13:33:59,726 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZAFNExuFLjnqZCFsGPPL5ZN0JQ5', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_m0OoSwLqqLHdzZ2cpSfIdJ6c', function=Function(arguments='\n{\n  "action": "identify_parties"\n}', name='AgentAction'), type='function')]))], created=1728988439, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=12, prompt_tokens=360, total_tokens=372, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:33:59,730 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.ContractParties'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    For a it contract, show the roles available for the following parties based on their personal information:\n\n    Name: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: VASILESCU ELENA, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B\n\n    Your task is to suggest appropriate roles for each person in the context of a it contract. \n    The human will then confirm or modify these suggestions.\n    '}], 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'$defs': {'ContractParty': {'properties': {'name': {'description': 'Name of the party', 'title': 'Name', 'type': 'string'}, 'role': {'description': 'Role of the party in the contract', 'title': 'Role', 'type': 'string'}}, 'required': ['name', 'role'], 'title': 'ContractParty', 'type': 'object'}}, 'properties': {'parties': {'description': 'List of parties involved in the contract', 'items': {'$ref': '#/$defs/ContractParty'}, 'title': 'Parties', 'type': 'array'}}, 'required': ['parties'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}}
2024-10-15 13:33:59,730 - DEBUG - max_retries: 1
2024-10-15 13:33:59,734 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    For a it contract, show the roles available for the following parties based on their personal information:\n\n    Name: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: VASILESCU ELENA, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B\n\n    Your task is to suggest appropriate roles for each person in the context of a it contract. \n    The human will then confirm or modify these suggestions.\n    '}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}, 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'$defs': {'ContractParty': {'properties': {'name': {'description': 'Name of the party', 'title': 'Name', 'type': 'string'}, 'role': {'description': 'Role of the party in the contract', 'title': 'Role', 'type': 'string'}}, 'required': ['name', 'role'], 'title': 'ContractParty', 'type': 'object'}}, 'properties': {'parties': {'description': 'List of parties involved in the contract', 'items': {'$ref': '#/$defs/ContractParty'}, 'title': 'Parties', 'type': 'array'}}, 'required': ['parties'], 'type': 'object'}}}]}}
2024-10-15 13:33:59,735 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:33:59,735 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:33:59,736 - DEBUG - send_request_headers.complete
2024-10-15 13:33:59,736 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:33:59,736 - DEBUG - send_request_body.complete
2024-10-15 13:33:59,736 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:34:02,882 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:34:03 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2998'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9995'), (b'x-ratelimit-remaining-tokens', b'9450'), (b'x-ratelimit-reset-requests', b'34.697s'), (b'x-ratelimit-reset-tokens', b'3.296s'), (b'x-request-id', b'req_fe82b69d0df3b05d885e94a16c8bc75b'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f2777ca1bca29-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:34:02,882 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:34:02,882 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:34:02,883 - DEBUG - receive_response_body.complete
2024-10-15 13:34:02,883 - DEBUG - response_closed.started
2024-10-15 13:34:02,883 - DEBUG - response_closed.complete
2024-10-15 13:34:02,883 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 10:34:03 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '2998', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9995', 'x-ratelimit-remaining-tokens': '9450', 'x-ratelimit-reset-requests': '34.697s', 'x-ratelimit-reset-tokens': '3.296s', 'x-request-id': 'req_fe82b69d0df3b05d885e94a16c8bc75b', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f2777ca1bca29-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 13:34:02,883 - DEBUG - request_id: req_fe82b69d0df3b05d885e94a16c8bc75b
2024-10-15 13:34:02,883 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZAGh72krBCJ7cYHLKWBf9sJn0Zw', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_Z57qYmBWpFc2plhVB9GNyTPx', function=Function(arguments='\n{\n  "parties": [\n    {\n      "name": "ISPILANTE SENTIMENT BRUSLI",\n      "role": "Provider"\n    },\n    {\n      "name": "VASILESCU ELENA",\n      "role": "Client"\n    }\n  ]\n}', name='ContractParties'), type='function')]))], created=1728988440, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=60, prompt_tokens=393, total_tokens=453, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:34:05,051 - DEBUG - close.started
2024-10-15 13:34:05,052 - DEBUG - close.complete
2024-10-15 13:34:05,052 - ERROR - Task exception was never retrieved
future: <Task finished name='Task-1' coro=<agent_workflow() done, defined at D:\deve\contract_automation\src\main.py:26> exception=KeyboardInterrupt()>
Traceback (most recent call last):
  File "D:\deve\contract_automation\src\main.py", line 100, in <module>
    asyncio.run(agent_workflow())
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 30, in run
    return loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 92, in run_until_complete
    self._run_once()
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 133, in _run_once
    handle._run()
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 386, in __wakeup
    self.__step()
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 293, in __step
    self.__step_run_and_handle_result(exc)
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 304, in __step_run_and_handle_result
    result = coro.send(None)
             ^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\src\main.py", line 63, in agent_workflow
    state.parties = identify_parties(state.verified_pii_data, state.contract_details.contract_type)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\src\ai_functions.py", line 152, in identify_parties
    confirmation = input(f"Is this role correct for {party.name}? (yes/no): ").lower()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
2024-10-15 13:35:16,767 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-15 13:35:18,026 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-15 13:35:18,026 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-15 13:35:18,347 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-15 13:35:18,347 - DEBUG - Using proactor: IocpProactor
2024-10-15 13:35:18,374 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 13:35:18,374 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 13:35:18,374 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 13:35:18,374 - DEBUG - Compression method 0
2024-10-15 13:35:18,374 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 13:35:18,374 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 13:35:18,374 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 13:35:18,374 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 13:35:18,374 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 13:35:18,374 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 13:35:18,374 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 13:35:18,374 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 13:35:18,374 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 13:35:18,375 - DEBUG - Compression method 0
2024-10-15 13:35:18,375 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 13:35:18,375 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 13:35:18,375 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 13:35:18,375 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 13:35:18,375 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 13:35:18,375 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 13:35:18,384 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 13:35:18,384 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 13:35:18,384 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 13:35:18,384 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 13:35:18,385 - DEBUG - Error closing: Operation on closed image
2024-10-15 13:35:20,382 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 13:35:20,383 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 13:35:20,383 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 13:35:20,383 - DEBUG - Compression method 0
2024-10-15 13:35:20,383 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 13:35:20,383 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 13:35:20,383 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 13:35:20,383 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 13:35:20,383 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 13:35:20,383 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 13:35:20,383 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 13:35:20,383 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 13:35:20,383 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 13:35:20,383 - DEBUG - Compression method 0
2024-10-15 13:35:20,383 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 13:35:20,383 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 13:35:20,383 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 13:35:20,383 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 13:35:20,383 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 13:35:20,383 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 13:35:20,400 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 13:35:20,400 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 13:35:20,400 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 13:35:20,400 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 13:35:20,401 - DEBUG - Error closing: Operation on closed image
2024-10-15 13:35:22,904 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'instructor.dsl.simple_type.Response'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}}
2024-10-15 13:35:22,905 - DEBUG - max_retries: 1
2024-10-15 13:35:22,907 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}, 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}]}}
2024-10-15 13:35:22,945 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:35:22,945 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-15 13:35:23,051 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x00000241D976D370>
2024-10-15 13:35:23,051 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x00000241D98AE7D0> server_hostname='api.openai.com' timeout=5.0
2024-10-15 13:35:23,060 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x00000241D96EF380>
2024-10-15 13:35:23,060 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:35:23,060 - DEBUG - send_request_headers.complete
2024-10-15 13:35:23,060 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:35:23,060 - DEBUG - send_request_body.complete
2024-10-15 13:35:23,060 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:35:25,761 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:35:26 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2550'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'9569'), (b'x-ratelimit-reset-requests', b'8.64s'), (b'x-ratelimit-reset-tokens', b'2.586s'), (b'x-request-id', b'req_bc5ed58644d2eb96bbd853e318759a20'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=GDBlhQQ7gmfuu39tEaIc3xjn.NRhmjtjw3DT_jgpd9c-1728988526-1.0.1.1-leAxZmjy_ZDvNAEk4B2YFMj89vhbrPcLBLFck8pJcHPFln0eurf6OC7zjQCabepTsc0.BjojXrwZJybItNWxiQ; path=/; expires=Tue, 15-Oct-24 11:05:26 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=ogfCYIine1.oIDQ1NE6h.Pp61amttqH2xtQhwDpx2Ls-1728988526308-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f29809d200530-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:35:25,763 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:35:25,763 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:35:25,764 - DEBUG - receive_response_body.complete
2024-10-15 13:35:25,764 - DEBUG - response_closed.started
2024-10-15 13:35:25,764 - DEBUG - response_closed.complete
2024-10-15 13:35:25,765 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Tue, 15 Oct 2024 10:35:26 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-kzzh9hik9ryjiou4ftvhondh'), ('openai-processing-ms', '2550'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '10000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '9569'), ('x-ratelimit-reset-requests', '8.64s'), ('x-ratelimit-reset-tokens', '2.586s'), ('x-request-id', 'req_bc5ed58644d2eb96bbd853e318759a20'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=GDBlhQQ7gmfuu39tEaIc3xjn.NRhmjtjw3DT_jgpd9c-1728988526-1.0.1.1-leAxZmjy_ZDvNAEk4B2YFMj89vhbrPcLBLFck8pJcHPFln0eurf6OC7zjQCabepTsc0.BjojXrwZJybItNWxiQ; path=/; expires=Tue, 15-Oct-24 11:05:26 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=ogfCYIine1.oIDQ1NE6h.Pp61amttqH2xtQhwDpx2Ls-1728988526308-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d2f29809d200530-OTP'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-15 13:35:25,765 - DEBUG - request_id: req_bc5ed58644d2eb96bbd853e318759a20
2024-10-15 13:35:25,768 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZBbe2F7Ff9qjk6whwEeRoVPBa8d', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_GDTCz5OlLFzCjjzXQE3uHpJv', function=Function(arguments='{\n  "content": [\n    {\n      "name": "ISPILANTE SENTIMENT BRUSLI",\n      "address": "Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR"\n    }\n  ]\n}', name='Response'), type='function')]))], created=1728988523, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=53, prompt_tokens=472, total_tokens=525, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:35:25,769 - DEBUG - Returning model from AdapterBase
2024-10-15 13:35:28,217 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'instructor.dsl.simple_type.Response'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}}
2024-10-15 13:35:28,217 - DEBUG - max_retries: 1
2024-10-15 13:35:28,219 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}, 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}]}}
2024-10-15 13:35:28,220 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:35:28,220 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:35:28,220 - DEBUG - send_request_headers.complete
2024-10-15 13:35:28,220 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:35:28,221 - DEBUG - send_request_body.complete
2024-10-15 13:35:28,221 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:35:31,494 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:35:32 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'3116'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9998'), (b'x-ratelimit-remaining-tokens', b'9576'), (b'x-ratelimit-reset-requests', b'12.117s'), (b'x-ratelimit-reset-tokens', b'2.544s'), (b'x-request-id', b'req_797af30b5cd81554184714e40b50b859'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f29a0d8a50530-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:35:31,494 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:35:31,494 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:35:31,495 - DEBUG - receive_response_body.complete
2024-10-15 13:35:31,495 - DEBUG - response_closed.started
2024-10-15 13:35:31,495 - DEBUG - response_closed.complete
2024-10-15 13:35:31,495 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 10:35:32 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '3116', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9998', 'x-ratelimit-remaining-tokens': '9576', 'x-ratelimit-reset-requests': '12.117s', 'x-ratelimit-reset-tokens': '2.544s', 'x-request-id': 'req_797af30b5cd81554184714e40b50b859', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f29a0d8a50530-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 13:35:31,495 - DEBUG - request_id: req_797af30b5cd81554184714e40b50b859
2024-10-15 13:35:31,495 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZBgShjTlcRx8WPBhNCXzW2JaszX', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_wNYbX10RNT5tgQNNLv0i4bMr', function=Function(arguments='{\n  "content": [\n    {\n      "name": "ELENA VASILESCU",\n      "address": "Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B"\n    }\n  ]\n}', name='Response'), type='function')]))], created=1728988528, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=56, prompt_tokens=475, total_tokens=531, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:35:31,496 - DEBUG - Returning model from AdapterBase
2024-10-15 13:35:34,265 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 13:35:34,265 - DEBUG - max_retries: 1
2024-10-15 13:35:34,267 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 13:35:34,268 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:35:34,268 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:35:34,268 - DEBUG - send_request_headers.complete
2024-10-15 13:35:34,268 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:35:34,268 - DEBUG - send_request_body.complete
2024-10-15 13:35:34,268 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:35:35,325 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:35:35 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'877'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9998'), (b'x-ratelimit-remaining-tokens', b'9608'), (b'x-ratelimit-reset-requests', b'14.684s'), (b'x-ratelimit-reset-tokens', b'2.352s'), (b'x-request-id', b'req_7d6d6b57b9f42c9d4b61966172db6404'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f29c6abb60530-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:35:35,325 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:35:35,325 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:35:35,325 - DEBUG - receive_response_body.complete
2024-10-15 13:35:35,325 - DEBUG - response_closed.started
2024-10-15 13:35:35,325 - DEBUG - response_closed.complete
2024-10-15 13:35:35,325 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 10:35:35 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '877', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9998', 'x-ratelimit-remaining-tokens': '9608', 'x-ratelimit-reset-requests': '14.684s', 'x-ratelimit-reset-tokens': '2.352s', 'x-request-id': 'req_7d6d6b57b9f42c9d4b61966172db6404', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f29c6abb60530-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 13:35:35,325 - DEBUG - request_id: req_7d6d6b57b9f42c9d4b61966172db6404
2024-10-15 13:35:35,326 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZBnIrHbw4rBbZJZeZZ9rPeCIf28', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_bg2lvYwQC5EsA3dTYybCMjPC', function=Function(arguments='\n{\n  "action": "determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728988535, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=13, prompt_tokens=360, total_tokens=373, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:35:37,748 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: Yes\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 13:35:37,748 - DEBUG - max_retries: 1
2024-10-15 13:35:37,750 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: Yes\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 13:35:37,751 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:35:37,751 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:35:37,751 - DEBUG - send_request_headers.complete
2024-10-15 13:35:37,751 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:35:37,751 - DEBUG - send_request_body.complete
2024-10-15 13:35:37,751 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:35:38,964 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:35:39 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'899'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9997'), (b'x-ratelimit-remaining-tokens', b'9608'), (b'x-ratelimit-reset-requests', b'19.712s'), (b'x-ratelimit-reset-tokens', b'2.352s'), (b'x-request-id', b'req_740eab705dbba018263985cd109902e8'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f29dc6b970530-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:35:38,965 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:35:38,965 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:35:38,966 - DEBUG - receive_response_body.complete
2024-10-15 13:35:38,966 - DEBUG - response_closed.started
2024-10-15 13:35:38,966 - DEBUG - response_closed.complete
2024-10-15 13:35:38,966 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 10:35:39 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '899', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9997', 'x-ratelimit-remaining-tokens': '9608', 'x-ratelimit-reset-requests': '19.712s', 'x-ratelimit-reset-tokens': '2.352s', 'x-request-id': 'req_740eab705dbba018263985cd109902e8', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f29dc6b970530-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 13:35:38,966 - DEBUG - request_id: req_740eab705dbba018263985cd109902e8
2024-10-15 13:35:38,967 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZBqeBV4Mt5aDdckbKdTnn7sGNWV', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_Q71KA0PRke6Txtnv0kyn6U92', function=Function(arguments='\n{\n  "action": "identify_parties"\n}', name='AgentAction'), type='function')]))], created=1728988538, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=12, prompt_tokens=360, total_tokens=372, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:35:38,970 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.ContractParties'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    For a it contract, show the roles available for the following parties based on their personal information:\n\n    Name: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B\n\n    Your task is to show the roles available for each person in the context of a it contract. \n    The human will pick one of the roles.\n    '}], 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'$defs': {'ContractParty': {'properties': {'name': {'description': 'Name of the party', 'title': 'Name', 'type': 'string'}, 'role': {'description': 'Role of the party in the contract', 'title': 'Role', 'type': 'string'}}, 'required': ['name', 'role'], 'title': 'ContractParty', 'type': 'object'}}, 'properties': {'parties': {'description': 'List of parties involved in the contract', 'items': {'$ref': '#/$defs/ContractParty'}, 'title': 'Parties', 'type': 'array'}}, 'required': ['parties'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}}
2024-10-15 13:35:38,970 - DEBUG - max_retries: 1
2024-10-15 13:35:38,974 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    For a it contract, show the roles available for the following parties based on their personal information:\n\n    Name: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B\n\n    Your task is to show the roles available for each person in the context of a it contract. \n    The human will pick one of the roles.\n    '}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}, 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'$defs': {'ContractParty': {'properties': {'name': {'description': 'Name of the party', 'title': 'Name', 'type': 'string'}, 'role': {'description': 'Role of the party in the contract', 'title': 'Role', 'type': 'string'}}, 'required': ['name', 'role'], 'title': 'ContractParty', 'type': 'object'}}, 'properties': {'parties': {'description': 'List of parties involved in the contract', 'items': {'$ref': '#/$defs/ContractParty'}, 'title': 'Parties', 'type': 'array'}}, 'required': ['parties'], 'type': 'object'}}}]}}
2024-10-15 13:35:38,974 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:35:38,974 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:35:38,975 - DEBUG - send_request_headers.complete
2024-10-15 13:35:38,975 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:35:38,975 - DEBUG - send_request_body.complete
2024-10-15 13:35:38,975 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:35:43,139 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:35:43 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'4004'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9996'), (b'x-ratelimit-remaining-tokens', b'9428'), (b'x-ratelimit-reset-requests', b'27.278s'), (b'x-ratelimit-reset-tokens', b'3.431s'), (b'x-request-id', b'req_03770b116f652957f4291cb2b6a5a708'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f29e40af30530-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:35:43,139 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:35:43,139 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:35:43,139 - DEBUG - receive_response_body.complete
2024-10-15 13:35:43,139 - DEBUG - response_closed.started
2024-10-15 13:35:43,139 - DEBUG - response_closed.complete
2024-10-15 13:35:43,139 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 10:35:43 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '4004', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9996', 'x-ratelimit-remaining-tokens': '9428', 'x-ratelimit-reset-requests': '27.278s', 'x-ratelimit-reset-tokens': '3.431s', 'x-request-id': 'req_03770b116f652957f4291cb2b6a5a708', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f29e40af30530-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 13:35:43,140 - DEBUG - request_id: req_03770b116f652957f4291cb2b6a5a708
2024-10-15 13:35:43,140 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZBrqbx5iRzhS8AwTJqRMmPLIiKs', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_OK8m4wBUKKUlhmiBvligEYeM', function=Function(arguments='\n{\n"parties": [\n  {\n    "name": "ISPILANTE SENTIMENT BRUSLI",\n    "role": "Client or service provider"\n  },\n  {\n    "name": "ELENA VASILESCU",\n    "role": "Client or service provider"\n  }\n]\n}', name='ContractParties'), type='function')]))], created=1728988539, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=65, prompt_tokens=393, total_tokens=458, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:35:48,151 - DEBUG - close.started
2024-10-15 13:35:48,151 - DEBUG - close.complete
2024-10-15 13:35:48,151 - ERROR - Task exception was never retrieved
future: <Task finished name='Task-1' coro=<agent_workflow() done, defined at D:\deve\contract_automation\src\main.py:26> exception=KeyboardInterrupt()>
Traceback (most recent call last):
  File "D:\deve\contract_automation\src\main.py", line 100, in <module>
    asyncio.run(agent_workflow())
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 30, in run
    return loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 92, in run_until_complete
    self._run_once()
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 133, in _run_once
    handle._run()
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 386, in __wakeup
    self.__step()
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 293, in __step
    self.__step_run_and_handle_result(exc)
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 304, in __step_run_and_handle_result
    result = coro.send(None)
             ^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\src\main.py", line 63, in agent_workflow
    state.parties = identify_parties(state.verified_pii_data, state.contract_details.contract_type)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\src\ai_functions.py", line 152, in identify_parties
    confirmation = input(f"Is this role correct for {party.name}? (yes/no): ").lower()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
2024-10-15 13:38:14,725 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-15 13:38:15,998 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-15 13:38:15,999 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-15 13:38:16,341 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-15 13:38:16,342 - DEBUG - Using proactor: IocpProactor
2024-10-15 13:38:16,369 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 13:38:16,369 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 13:38:16,369 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 13:38:16,369 - DEBUG - Compression method 0
2024-10-15 13:38:16,369 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 13:38:16,369 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 13:38:16,369 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 13:38:16,369 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 13:38:16,369 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 13:38:16,369 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 13:38:16,370 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 13:38:16,370 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 13:38:16,370 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 13:38:16,370 - DEBUG - Compression method 0
2024-10-15 13:38:16,370 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 13:38:16,370 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 13:38:16,370 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 13:38:16,370 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 13:38:16,370 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 13:38:16,370 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 13:38:16,379 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 13:38:16,379 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 13:38:16,379 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 13:38:16,379 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 13:38:16,380 - DEBUG - Error closing: Operation on closed image
2024-10-15 13:38:18,427 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 13:38:18,427 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 13:38:18,427 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 13:38:18,427 - DEBUG - Compression method 0
2024-10-15 13:38:18,427 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 13:38:18,427 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 13:38:18,428 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 13:38:18,428 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 13:38:18,428 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 13:38:18,428 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 13:38:18,428 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 13:38:18,428 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 13:38:18,428 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 13:38:18,428 - DEBUG - Compression method 0
2024-10-15 13:38:18,428 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 13:38:18,428 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 13:38:18,428 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 13:38:18,428 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 13:38:18,428 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 13:38:18,428 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 13:38:18,445 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 13:38:18,445 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 13:38:18,445 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 13:38:18,445 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 13:38:18,446 - DEBUG - Error closing: Operation on closed image
2024-10-15 13:38:20,955 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'instructor.dsl.simple_type.Response'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}}
2024-10-15 13:38:20,956 - DEBUG - max_retries: 1
2024-10-15 13:38:20,958 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}, 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}]}}
2024-10-15 13:38:20,996 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:38:20,996 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-15 13:38:21,010 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x00000208980ED0D0>
2024-10-15 13:38:21,010 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x000002089822E850> server_hostname='api.openai.com' timeout=5.0
2024-10-15 13:38:21,018 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x0000020898396C30>
2024-10-15 13:38:21,018 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:38:21,018 - DEBUG - send_request_headers.complete
2024-10-15 13:38:21,018 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:38:21,018 - DEBUG - send_request_body.complete
2024-10-15 13:38:21,018 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:38:24,850 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:38:25 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'3680'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'9569'), (b'x-ratelimit-reset-requests', b'8.64s'), (b'x-ratelimit-reset-tokens', b'2.586s'), (b'x-request-id', b'req_92aef3fb723e6d9998f0dd6fb5b4b49d'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=VtaBLTTB0yu8Orir7.1VwTbnoBOZO6tDmXm9tR9coOk-1728988705-1.0.1.1-9CClzl8HLTP77Hpc3NY02KIBsFvZN3jeA4itbXE__LDbvGwRjNFrJIaYAhwWHaORpkByZMD.9T1WH_LHTad1UQ; path=/; expires=Tue, 15-Oct-24 11:08:25 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=SrvdF_AL5luRQ.9wh8vVZUhAaFAVGCGM4BP.o2UCXEY-1728988705406-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f2dd8dc3770d0-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:38:24,851 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:38:24,851 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:38:24,851 - DEBUG - receive_response_body.complete
2024-10-15 13:38:24,851 - DEBUG - response_closed.started
2024-10-15 13:38:24,851 - DEBUG - response_closed.complete
2024-10-15 13:38:24,851 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Tue, 15 Oct 2024 10:38:25 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-kzzh9hik9ryjiou4ftvhondh'), ('openai-processing-ms', '3680'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '10000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '9569'), ('x-ratelimit-reset-requests', '8.64s'), ('x-ratelimit-reset-tokens', '2.586s'), ('x-request-id', 'req_92aef3fb723e6d9998f0dd6fb5b4b49d'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=VtaBLTTB0yu8Orir7.1VwTbnoBOZO6tDmXm9tR9coOk-1728988705-1.0.1.1-9CClzl8HLTP77Hpc3NY02KIBsFvZN3jeA4itbXE__LDbvGwRjNFrJIaYAhwWHaORpkByZMD.9T1WH_LHTad1UQ; path=/; expires=Tue, 15-Oct-24 11:08:25 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=SrvdF_AL5luRQ.9wh8vVZUhAaFAVGCGM4BP.o2UCXEY-1728988705406-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d2f2dd8dc3770d0-OTP'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-15 13:38:24,851 - DEBUG - request_id: req_92aef3fb723e6d9998f0dd6fb5b4b49d
2024-10-15 13:38:24,853 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZETB7sPObBT7gEGEAh6pLVZasde', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_ZcIauOsdlzZ2TlB3N7CeQhKX', function=Function(arguments='{\n  "content": [\n    {\n      "name": "ISPILANTE SENTIMENT BRUSLI",\n      "address": "Videle Jud: Teleorman, Sos. Giurgiului nr.1 695 TR"\n    }\n  ]\n}', name='Response'), type='function')]))], created=1728988701, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=54, prompt_tokens=472, total_tokens=526, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:38:24,853 - DEBUG - Returning model from AdapterBase
2024-10-15 13:38:26,192 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'instructor.dsl.simple_type.Response'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}}
2024-10-15 13:38:26,192 - DEBUG - max_retries: 1
2024-10-15 13:38:26,194 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}, 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}]}}
2024-10-15 13:38:26,195 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:38:26,195 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:38:26,195 - DEBUG - send_request_headers.complete
2024-10-15 13:38:26,196 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:38:26,196 - DEBUG - send_request_body.complete
2024-10-15 13:38:26,196 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:38:29,462 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:38:30 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'3112'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9998'), (b'x-ratelimit-remaining-tokens', b'9576'), (b'x-ratelimit-reset-requests', b'12.099s'), (b'x-ratelimit-reset-tokens', b'2.544s'), (b'x-request-id', b'req_69f9e2f3d58f170fde08d202db637b41'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f2df93c2e70d0-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:38:29,462 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:38:29,463 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:38:29,463 - DEBUG - receive_response_body.complete
2024-10-15 13:38:29,464 - DEBUG - response_closed.started
2024-10-15 13:38:29,464 - DEBUG - response_closed.complete
2024-10-15 13:38:29,464 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 10:38:30 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '3112', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9998', 'x-ratelimit-remaining-tokens': '9576', 'x-ratelimit-reset-requests': '12.099s', 'x-ratelimit-reset-tokens': '2.544s', 'x-request-id': 'req_69f9e2f3d58f170fde08d202db637b41', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f2df93c2e70d0-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 13:38:29,464 - DEBUG - request_id: req_69f9e2f3d58f170fde08d202db637b41
2024-10-15 13:38:29,465 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZEYXjo3OXaD0sFS8JaeoSfzCfnl', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_ClRYyDEnt0Qtl5Lm13JwXhON', function=Function(arguments='{\n  "content": [\n    {\n      "name": "ELENA VASILESCU",\n      "address": "Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B"\n    }\n  ]\n}', name='Response'), type='function')]))], created=1728988706, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=56, prompt_tokens=475, total_tokens=531, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:38:29,467 - DEBUG - Returning model from AdapterBase
2024-10-15 13:38:30,519 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 13:38:30,519 - DEBUG - max_retries: 1
2024-10-15 13:38:30,521 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 13:38:30,522 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:38:30,522 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:38:30,522 - DEBUG - send_request_headers.complete
2024-10-15 13:38:30,522 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:38:30,522 - DEBUG - send_request_body.complete
2024-10-15 13:38:30,522 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:38:31,618 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:38:32 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'939'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9998'), (b'x-ratelimit-remaining-tokens', b'9608'), (b'x-ratelimit-reset-requests', b'16.409s'), (b'x-ratelimit-reset-tokens', b'2.352s'), (b'x-request-id', b'req_c6e42ed71167e3389d1aaa3c3c3a37a3'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f2e144b5470d0-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:38:31,619 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:38:31,619 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:38:31,619 - DEBUG - receive_response_body.complete
2024-10-15 13:38:31,620 - DEBUG - response_closed.started
2024-10-15 13:38:31,620 - DEBUG - response_closed.complete
2024-10-15 13:38:31,620 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 10:38:32 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '939', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9998', 'x-ratelimit-remaining-tokens': '9608', 'x-ratelimit-reset-requests': '16.409s', 'x-ratelimit-reset-tokens': '2.352s', 'x-request-id': 'req_c6e42ed71167e3389d1aaa3c3c3a37a3', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f2e144b5470d0-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 13:38:31,620 - DEBUG - request_id: req_c6e42ed71167e3389d1aaa3c3c3a37a3
2024-10-15 13:38:31,621 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZEd2oj60cnFgxFwTlTuvQ0sYgPG', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_2wuMnwKMFOy3ge4Yw1477sbR', function=Function(arguments='\n{\n  "action": "determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728988711, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=13, prompt_tokens=360, total_tokens=373, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:38:33,474 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: Yes\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 13:38:33,474 - DEBUG - max_retries: 1
2024-10-15 13:38:33,476 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: Yes\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 13:38:33,476 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:38:33,477 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:38:33,477 - DEBUG - send_request_headers.complete
2024-10-15 13:38:33,477 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:38:33,477 - DEBUG - send_request_body.complete
2024-10-15 13:38:33,477 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:38:34,399 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:38:34 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'742'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9997'), (b'x-ratelimit-remaining-tokens', b'9608'), (b'x-ratelimit-reset-requests', b'22.083s'), (b'x-ratelimit-reset-tokens', b'2.352s'), (b'x-request-id', b'req_2f750b68ac6958fb5c6814a5f9d0cb8c'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f2e26b88e70d0-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:38:34,400 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:38:34,400 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:38:34,400 - DEBUG - receive_response_body.complete
2024-10-15 13:38:34,400 - DEBUG - response_closed.started
2024-10-15 13:38:34,401 - DEBUG - response_closed.complete
2024-10-15 13:38:34,401 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 10:38:34 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '742', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9997', 'x-ratelimit-remaining-tokens': '9608', 'x-ratelimit-reset-requests': '22.083s', 'x-ratelimit-reset-tokens': '2.352s', 'x-request-id': 'req_2f750b68ac6958fb5c6814a5f9d0cb8c', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f2e26b88e70d0-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 13:38:34,401 - DEBUG - request_id: req_2f750b68ac6958fb5c6814a5f9d0cb8c
2024-10-15 13:38:34,402 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZEgEMqCUjhOrEoAnu17OOjbAk3G', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_lXHaCc9Yz6ZhK3Wah37AipSa', function=Function(arguments='{\n  "action": "identify_parties"\n}', name='AgentAction'), type='function')]))], created=1728988714, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=11, prompt_tokens=360, total_tokens=371, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:38:34,555 - DEBUG - close.started
2024-10-15 13:38:34,556 - DEBUG - close.complete
2024-10-15 13:40:37,272 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-15 13:40:38,527 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-15 13:40:38,528 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-15 13:40:38,839 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-15 13:40:38,839 - DEBUG - Using proactor: IocpProactor
2024-10-15 13:40:38,865 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 13:40:38,865 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 13:40:38,865 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 13:40:38,865 - DEBUG - Compression method 0
2024-10-15 13:40:38,865 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 13:40:38,865 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 13:40:38,865 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 13:40:38,865 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 13:40:38,865 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 13:40:38,865 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 13:40:38,865 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 13:40:38,865 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 13:40:38,865 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 13:40:38,865 - DEBUG - Compression method 0
2024-10-15 13:40:38,865 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 13:40:38,865 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 13:40:38,865 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 13:40:38,866 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 13:40:38,866 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 13:40:38,866 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 13:40:38,875 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 13:40:38,875 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 13:40:38,875 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 13:40:38,875 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 13:40:38,876 - DEBUG - Error closing: Operation on closed image
2024-10-15 13:40:40,858 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 13:40:40,858 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 13:40:40,858 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 13:40:40,858 - DEBUG - Compression method 0
2024-10-15 13:40:40,858 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 13:40:40,858 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 13:40:40,858 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 13:40:40,858 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 13:40:40,858 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 13:40:40,858 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 13:40:40,858 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 13:40:40,858 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 13:40:40,858 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 13:40:40,858 - DEBUG - Compression method 0
2024-10-15 13:40:40,858 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 13:40:40,858 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 13:40:40,858 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 13:40:40,858 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 13:40:40,858 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 13:40:40,858 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 13:40:40,875 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 13:40:40,876 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 13:40:40,876 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 13:40:40,876 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 13:40:40,876 - DEBUG - Error closing: Operation on closed image
2024-10-15 13:40:43,496 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'instructor.dsl.simple_type.Response'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}}
2024-10-15 13:40:43,497 - DEBUG - max_retries: 1
2024-10-15 13:40:43,498 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}, 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}]}}
2024-10-15 13:40:43,528 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:40:43,529 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-15 13:40:43,599 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x0000020CDCCB6390>
2024-10-15 13:40:43,599 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x0000020CDCB4E850> server_hostname='api.openai.com' timeout=5.0
2024-10-15 13:40:43,607 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x0000020CDCA97B90>
2024-10-15 13:40:43,607 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:40:43,607 - DEBUG - send_request_headers.complete
2024-10-15 13:40:43,607 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:40:43,607 - DEBUG - send_request_body.complete
2024-10-15 13:40:43,607 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:40:46,532 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:40:47 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2757'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'9569'), (b'x-ratelimit-reset-requests', b'8.64s'), (b'x-ratelimit-reset-tokens', b'2.586s'), (b'x-request-id', b'req_a14285a15a7afe9ff2de0bbf6a10c06c'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=4q.asZQquA.U3oZUnhQG.JqvETxJWCQu_20QSmz4mz4-1728988847-1.0.1.1-SjbRLxgNN5bpKxjC4oigz2.g.UATXJKSSxXFWg0zSz2cauEnU.kXhB1VYzjTW8Pu6WW65rcuWdcMcXG_A8OPng; path=/; expires=Tue, 15-Oct-24 11:10:47 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=e7IS3wvE6qcOj0MATeo2Nr0zQllZwwChF4ocYpBgMbs-1728988847094-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f31541aacc9cf-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:40:46,533 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:40:46,533 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:40:46,533 - DEBUG - receive_response_body.complete
2024-10-15 13:40:46,533 - DEBUG - response_closed.started
2024-10-15 13:40:46,533 - DEBUG - response_closed.complete
2024-10-15 13:40:46,533 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Tue, 15 Oct 2024 10:40:47 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-kzzh9hik9ryjiou4ftvhondh'), ('openai-processing-ms', '2757'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '10000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '9569'), ('x-ratelimit-reset-requests', '8.64s'), ('x-ratelimit-reset-tokens', '2.586s'), ('x-request-id', 'req_a14285a15a7afe9ff2de0bbf6a10c06c'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=4q.asZQquA.U3oZUnhQG.JqvETxJWCQu_20QSmz4mz4-1728988847-1.0.1.1-SjbRLxgNN5bpKxjC4oigz2.g.UATXJKSSxXFWg0zSz2cauEnU.kXhB1VYzjTW8Pu6WW65rcuWdcMcXG_A8OPng; path=/; expires=Tue, 15-Oct-24 11:10:47 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=e7IS3wvE6qcOj0MATeo2Nr0zQllZwwChF4ocYpBgMbs-1728988847094-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d2f31541aacc9cf-OTP'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-15 13:40:46,533 - DEBUG - request_id: req_a14285a15a7afe9ff2de0bbf6a10c06c
2024-10-15 13:40:46,535 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZGmzt8Ymxt4pelLJzjNOHMTu82B', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_G1AuHFABCZS2Q7xTeInI6UOZ', function=Function(arguments='{\n  "content": [\n    {\n      "name": "T525M ISPILANTE SENTIMENT BRUSLI",\n      "address": "Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR"\n    }\n  ]\n}', name='Response'), type='function')]))], created=1728988844, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=56, prompt_tokens=472, total_tokens=528, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:40:46,535 - DEBUG - Returning model from AdapterBase
2024-10-15 13:40:47,796 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'instructor.dsl.simple_type.Response'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}}
2024-10-15 13:40:47,796 - DEBUG - max_retries: 1
2024-10-15 13:40:47,798 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}, 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}]}}
2024-10-15 13:40:47,799 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:40:47,799 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:40:47,799 - DEBUG - send_request_headers.complete
2024-10-15 13:40:47,799 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:40:47,799 - DEBUG - send_request_body.complete
2024-10-15 13:40:47,799 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:40:50,280 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:40:50 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2327'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9998'), (b'x-ratelimit-remaining-tokens', b'9576'), (b'x-ratelimit-reset-requests', b'13.096s'), (b'x-ratelimit-reset-tokens', b'2.544s'), (b'x-request-id', b'req_801bde1b7c1d5e1f1e8a2422af5ee98c'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f316e4b38c9cf-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:40:50,281 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:40:50,281 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:40:50,281 - DEBUG - receive_response_body.complete
2024-10-15 13:40:50,281 - DEBUG - response_closed.started
2024-10-15 13:40:50,281 - DEBUG - response_closed.complete
2024-10-15 13:40:50,281 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 10:40:50 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '2327', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9998', 'x-ratelimit-remaining-tokens': '9576', 'x-ratelimit-reset-requests': '13.096s', 'x-ratelimit-reset-tokens': '2.544s', 'x-request-id': 'req_801bde1b7c1d5e1f1e8a2422af5ee98c', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f316e4b38c9cf-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 13:40:50,281 - DEBUG - request_id: req_801bde1b7c1d5e1f1e8a2422af5ee98c
2024-10-15 13:40:50,281 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZGq6wyFGQxOmPsIjCnP37kwJo8s', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_KUjBsh9dSYDJQLvIxup9Xzsb', function=Function(arguments='{\n  "content": [\n    {\n      "name": "ELENA VASILESCU",\n      "address": "Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3"\n    }\n  ]\n}', name='Response'), type='function')]))], created=1728988848, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=53, prompt_tokens=475, total_tokens=528, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:40:50,282 - DEBUG - Returning model from AdapterBase
2024-10-15 13:40:51,305 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 13:40:51,305 - DEBUG - max_retries: 1
2024-10-15 13:40:51,306 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 13:40:51,307 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:40:51,307 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:40:51,307 - DEBUG - send_request_headers.complete
2024-10-15 13:40:51,307 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:40:51,307 - DEBUG - send_request_body.complete
2024-10-15 13:40:51,307 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:40:52,352 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:40:52 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'877'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9997'), (b'x-ratelimit-remaining-tokens', b'9608'), (b'x-ratelimit-reset-requests', b'18.224s'), (b'x-ratelimit-reset-tokens', b'2.352s'), (b'x-request-id', b'req_a65c926b765afef0d0f8aa4a39095286'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f31843e2fc9cf-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:40:52,352 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:40:52,352 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:40:52,352 - DEBUG - receive_response_body.complete
2024-10-15 13:40:52,352 - DEBUG - response_closed.started
2024-10-15 13:40:52,352 - DEBUG - response_closed.complete
2024-10-15 13:40:52,352 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 10:40:52 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '877', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9997', 'x-ratelimit-remaining-tokens': '9608', 'x-ratelimit-reset-requests': '18.224s', 'x-ratelimit-reset-tokens': '2.352s', 'x-request-id': 'req_a65c926b765afef0d0f8aa4a39095286', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f31843e2fc9cf-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 13:40:52,352 - DEBUG - request_id: req_a65c926b765afef0d0f8aa4a39095286
2024-10-15 13:40:52,353 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZGuFKM2Y4SgaatCAF318T97a4sN', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_H4qcCGRyorDvGPgmfZS5xDBJ', function=Function(arguments='{\n  "action": "determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728988852, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=12, prompt_tokens=360, total_tokens=372, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:40:54,543 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: Yes\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 13:40:54,543 - DEBUG - max_retries: 1
2024-10-15 13:40:54,545 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: Yes\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 13:40:54,546 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:40:54,546 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:40:54,546 - DEBUG - send_request_headers.complete
2024-10-15 13:40:54,546 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:40:54,546 - DEBUG - send_request_body.complete
2024-10-15 13:40:54,546 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:40:55,462 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:40:56 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'764'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9997'), (b'x-ratelimit-remaining-tokens', b'9608'), (b'x-ratelimit-reset-requests', b'23.632s'), (b'x-ratelimit-reset-tokens', b'2.352s'), (b'x-request-id', b'req_e1099dd14d9fc42966e2fe352ae2b692'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f31987bc9c9cf-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:40:55,463 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:40:55,463 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:40:55,463 - DEBUG - receive_response_body.complete
2024-10-15 13:40:55,463 - DEBUG - response_closed.started
2024-10-15 13:40:55,463 - DEBUG - response_closed.complete
2024-10-15 13:40:55,463 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 10:40:56 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '764', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9997', 'x-ratelimit-remaining-tokens': '9608', 'x-ratelimit-reset-requests': '23.632s', 'x-ratelimit-reset-tokens': '2.352s', 'x-request-id': 'req_e1099dd14d9fc42966e2fe352ae2b692', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f31987bc9c9cf-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 13:40:55,463 - DEBUG - request_id: req_e1099dd14d9fc42966e2fe352ae2b692
2024-10-15 13:40:55,463 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZGxwMPG7GWNFp3wIszQS6ptbroE', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_iBFFu0Zi6x0Fsxl1ekRBr3n5', function=Function(arguments='{\n  "action": "identify_parties"\n}', name='AgentAction'), type='function')]))], created=1728988855, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=11, prompt_tokens=360, total_tokens=371, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:40:55,613 - DEBUG - close.started
2024-10-15 13:40:55,614 - DEBUG - close.complete
2024-10-15 13:41:15,736 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-15 13:41:16,991 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-15 13:41:16,992 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-15 13:41:17,318 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-15 13:41:17,319 - DEBUG - Using proactor: IocpProactor
2024-10-15 13:41:17,345 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 13:41:17,345 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 13:41:17,345 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 13:41:17,345 - DEBUG - Compression method 0
2024-10-15 13:41:17,345 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 13:41:17,345 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 13:41:17,345 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 13:41:17,345 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 13:41:17,345 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 13:41:17,345 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 13:41:17,345 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 13:41:17,345 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 13:41:17,345 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 13:41:17,345 - DEBUG - Compression method 0
2024-10-15 13:41:17,345 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 13:41:17,345 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 13:41:17,346 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 13:41:17,346 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 13:41:17,346 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 13:41:17,346 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 13:41:17,355 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 13:41:17,355 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 13:41:17,355 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 13:41:17,355 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 13:41:17,356 - DEBUG - Error closing: Operation on closed image
2024-10-15 13:41:19,374 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 13:41:19,374 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 13:41:19,374 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 13:41:19,374 - DEBUG - Compression method 0
2024-10-15 13:41:19,374 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 13:41:19,374 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 13:41:19,374 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 13:41:19,374 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 13:41:19,374 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 13:41:19,374 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 13:41:19,374 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 13:41:19,374 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 13:41:19,374 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 13:41:19,374 - DEBUG - Compression method 0
2024-10-15 13:41:19,374 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 13:41:19,374 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 13:41:19,374 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 13:41:19,374 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 13:41:19,374 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 13:41:19,374 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 13:41:19,392 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 13:41:19,392 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 13:41:19,392 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 13:41:19,392 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 13:41:19,392 - DEBUG - Error closing: Operation on closed image
2024-10-15 13:41:21,872 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'instructor.dsl.simple_type.Response'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}}
2024-10-15 13:41:21,873 - DEBUG - max_retries: 1
2024-10-15 13:41:21,875 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}, 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}]}}
2024-10-15 13:41:21,913 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:41:21,913 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-15 13:41:21,923 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001C46D7CA570>
2024-10-15 13:41:21,923 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x000001C46D7DE7D0> server_hostname='api.openai.com' timeout=5.0
2024-10-15 13:41:21,930 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001C467E4D340>
2024-10-15 13:41:21,930 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:41:21,930 - DEBUG - send_request_headers.complete
2024-10-15 13:41:21,930 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:41:21,930 - DEBUG - send_request_body.complete
2024-10-15 13:41:21,930 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:41:24,952 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:41:25 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2864'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'9569'), (b'x-ratelimit-reset-requests', b'8.64s'), (b'x-ratelimit-reset-tokens', b'2.586s'), (b'x-request-id', b'req_2cab768ae41f41a91ca954e3f85fa4ab'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=.hDavZmRMsUhxnAiTbesBtmR.m1XOBf7_TKWyqAI4iM-1728988885-1.0.1.1-HOjVFYt5.oCfGqldtlkq8mfTO4d37w3s8awE0tbhF3TAP8uHwMzuWAKSMtXI.cXH8CJ.uPAweWeI9r685dCYMg; path=/; expires=Tue, 15-Oct-24 11:11:25 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=4xExtsqHTalAaUIwJMTNPnGC5oyScCfmHBWKfcZfeBg-1728988885515-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f32439b056261-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:41:24,955 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:41:24,955 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:41:24,956 - DEBUG - receive_response_body.complete
2024-10-15 13:41:24,956 - DEBUG - response_closed.started
2024-10-15 13:41:24,956 - DEBUG - response_closed.complete
2024-10-15 13:41:24,956 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Tue, 15 Oct 2024 10:41:25 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-kzzh9hik9ryjiou4ftvhondh'), ('openai-processing-ms', '2864'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '10000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '9569'), ('x-ratelimit-reset-requests', '8.64s'), ('x-ratelimit-reset-tokens', '2.586s'), ('x-request-id', 'req_2cab768ae41f41a91ca954e3f85fa4ab'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=.hDavZmRMsUhxnAiTbesBtmR.m1XOBf7_TKWyqAI4iM-1728988885-1.0.1.1-HOjVFYt5.oCfGqldtlkq8mfTO4d37w3s8awE0tbhF3TAP8uHwMzuWAKSMtXI.cXH8CJ.uPAweWeI9r685dCYMg; path=/; expires=Tue, 15-Oct-24 11:11:25 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=4xExtsqHTalAaUIwJMTNPnGC5oyScCfmHBWKfcZfeBg-1728988885515-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d2f32439b056261-OTP'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-15 13:41:24,957 - DEBUG - request_id: req_2cab768ae41f41a91ca954e3f85fa4ab
2024-10-15 13:41:24,959 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZHOaNTrM5YOiJu09613XnnHOVLx', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_qrtNKOfxyEf3nxWeMubHy7lZ', function=Function(arguments='{\n  "content": [\n    {\n      "name": "ISPILANTE SENTIMENT BRUSLI",\n      "address": "Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR"\n    }\n  ]\n}', name='Response'), type='function')]))], created=1728988882, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=53, prompt_tokens=472, total_tokens=525, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:41:24,959 - DEBUG - Returning model from AdapterBase
2024-10-15 13:41:27,501 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'instructor.dsl.simple_type.Response'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}}
2024-10-15 13:41:27,501 - DEBUG - max_retries: 1
2024-10-15 13:41:27,503 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}, 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}]}}
2024-10-15 13:41:27,504 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:41:27,504 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:41:27,504 - DEBUG - send_request_headers.complete
2024-10-15 13:41:27,504 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:41:27,504 - DEBUG - send_request_body.complete
2024-10-15 13:41:27,504 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:41:30,157 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:41:30 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2489'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9998'), (b'x-ratelimit-remaining-tokens', b'9576'), (b'x-ratelimit-reset-requests', b'11.705s'), (b'x-ratelimit-reset-tokens', b'2.544s'), (b'x-request-id', b'req_c47b0259d2f4c2d20865802bc701d4cc'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f326679cb6261-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:41:30,158 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:41:30,159 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:41:30,160 - DEBUG - receive_response_body.complete
2024-10-15 13:41:30,160 - DEBUG - response_closed.started
2024-10-15 13:41:30,160 - DEBUG - response_closed.complete
2024-10-15 13:41:30,160 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 10:41:30 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '2489', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9998', 'x-ratelimit-remaining-tokens': '9576', 'x-ratelimit-reset-requests': '11.705s', 'x-ratelimit-reset-tokens': '2.544s', 'x-request-id': 'req_c47b0259d2f4c2d20865802bc701d4cc', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f326679cb6261-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 13:41:30,161 - DEBUG - request_id: req_c47b0259d2f4c2d20865802bc701d4cc
2024-10-15 13:41:30,162 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZHU7NxApTr4QiOmmvKXUh8mF7yQ', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_brscngDgI0fP3yS4q6VzBKEq', function=Function(arguments='{\n  "content": [\n    {\n      "name": "ELENA VASILESCU",\n      "address": "Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B"\n    }\n  ]\n}', name='Response'), type='function')]))], created=1728988888, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=56, prompt_tokens=475, total_tokens=531, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:41:30,164 - DEBUG - Returning model from AdapterBase
2024-10-15 13:41:31,183 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 13:41:31,183 - DEBUG - max_retries: 1
2024-10-15 13:41:31,185 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 13:41:31,186 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:41:31,186 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:41:31,186 - DEBUG - send_request_headers.complete
2024-10-15 13:41:31,186 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:41:31,186 - DEBUG - send_request_body.complete
2024-10-15 13:41:31,186 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:41:32,129 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:41:32 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'762'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9998'), (b'x-ratelimit-remaining-tokens', b'9608'), (b'x-ratelimit-reset-requests', b'16.642s'), (b'x-ratelimit-reset-tokens', b'2.352s'), (b'x-request-id', b'req_463e70204569d3f255b1ed055dc4be61'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f327d7e426261-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:41:32,130 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:41:32,130 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:41:32,131 - DEBUG - receive_response_body.complete
2024-10-15 13:41:32,131 - DEBUG - response_closed.started
2024-10-15 13:41:32,131 - DEBUG - response_closed.complete
2024-10-15 13:41:32,131 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 10:41:32 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '762', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9998', 'x-ratelimit-remaining-tokens': '9608', 'x-ratelimit-reset-requests': '16.642s', 'x-ratelimit-reset-tokens': '2.352s', 'x-request-id': 'req_463e70204569d3f255b1ed055dc4be61', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f327d7e426261-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 13:41:32,131 - DEBUG - request_id: req_463e70204569d3f255b1ed055dc4be61
2024-10-15 13:41:32,133 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZHXp1rP0qhf2E9uvAjobL5XZs46', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_ZcIauOsdlzZ2TlB3N7CeQhKX', function=Function(arguments='{\n  "action": "determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728988891, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=12, prompt_tokens=360, total_tokens=372, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:41:34,005 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: Yes\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 13:41:34,005 - DEBUG - max_retries: 1
2024-10-15 13:41:34,007 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: Yes\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 13:41:34,008 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:41:34,008 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:41:34,008 - DEBUG - send_request_headers.complete
2024-10-15 13:41:34,008 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:41:34,008 - DEBUG - send_request_body.complete
2024-10-15 13:41:34,008 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:41:35,204 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:41:35 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1034'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9997'), (b'x-ratelimit-remaining-tokens', b'9608'), (b'x-ratelimit-reset-requests', b'22.479s'), (b'x-ratelimit-reset-tokens', b'2.352s'), (b'x-request-id', b'req_5a071f1cc1cf4bee71ffaf20923f5ceb'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f328f1ec16261-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:41:35,205 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:41:35,206 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:41:35,206 - DEBUG - receive_response_body.complete
2024-10-15 13:41:35,206 - DEBUG - response_closed.started
2024-10-15 13:41:35,206 - DEBUG - response_closed.complete
2024-10-15 13:41:35,207 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 10:41:35 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1034', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9997', 'x-ratelimit-remaining-tokens': '9608', 'x-ratelimit-reset-requests': '22.479s', 'x-ratelimit-reset-tokens': '2.352s', 'x-request-id': 'req_5a071f1cc1cf4bee71ffaf20923f5ceb', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f328f1ec16261-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 13:41:35,207 - DEBUG - request_id: req_5a071f1cc1cf4bee71ffaf20923f5ceb
2024-10-15 13:41:35,208 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZHa3lguU43jUpRZQwEKHhV6JBDf', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_sPxLvweItGaK8eobmOSLdDgf', function=Function(arguments='\n{\n  "action": "identify_parties"\n}', name='AgentAction'), type='function')]))], created=1728988894, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=12, prompt_tokens=360, total_tokens=372, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:41:35,212 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.ContractParties'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    For a it contract, show the roles available for the following parties based on their personal information:\n\n    Name: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B\n\n    Your task is to show the roles available for each person in the context of a it contract. \n    The human will pick one of the roles.\n    '}], 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'$defs': {'ContractParty': {'properties': {'name': {'description': 'Name of the party', 'title': 'Name', 'type': 'string'}, 'role': {'description': 'Role of the party in the contract', 'title': 'Role', 'type': 'string'}}, 'required': ['name', 'role'], 'title': 'ContractParty', 'type': 'object'}}, 'properties': {'parties': {'description': 'List of parties involved in the contract', 'items': {'$ref': '#/$defs/ContractParty'}, 'title': 'Parties', 'type': 'array'}}, 'required': ['parties'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}}
2024-10-15 13:41:35,212 - DEBUG - max_retries: 1
2024-10-15 13:41:35,215 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    For a it contract, show the roles available for the following parties based on their personal information:\n\n    Name: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B\n\n    Your task is to show the roles available for each person in the context of a it contract. \n    The human will pick one of the roles.\n    '}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}, 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'$defs': {'ContractParty': {'properties': {'name': {'description': 'Name of the party', 'title': 'Name', 'type': 'string'}, 'role': {'description': 'Role of the party in the contract', 'title': 'Role', 'type': 'string'}}, 'required': ['name', 'role'], 'title': 'ContractParty', 'type': 'object'}}, 'properties': {'parties': {'description': 'List of parties involved in the contract', 'items': {'$ref': '#/$defs/ContractParty'}, 'title': 'Parties', 'type': 'array'}}, 'required': ['parties'], 'type': 'object'}}}]}}
2024-10-15 13:41:35,215 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:41:35,216 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:41:35,216 - DEBUG - send_request_headers.complete
2024-10-15 13:41:35,216 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:41:35,216 - DEBUG - send_request_body.complete
2024-10-15 13:41:35,216 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:41:39,303 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:41:39 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'3926'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9996'), (b'x-ratelimit-remaining-tokens', b'9450'), (b'x-ratelimit-reset-requests', b'29.907s'), (b'x-ratelimit-reset-tokens', b'3.294s'), (b'x-request-id', b'req_cdcbffd7df49485859002029b44539e1'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f3296ad096261-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:41:39,304 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:41:39,304 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:41:39,305 - DEBUG - receive_response_body.complete
2024-10-15 13:41:39,305 - DEBUG - response_closed.started
2024-10-15 13:41:39,305 - DEBUG - response_closed.complete
2024-10-15 13:41:39,305 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 10:41:39 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '3926', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9996', 'x-ratelimit-remaining-tokens': '9450', 'x-ratelimit-reset-requests': '29.907s', 'x-ratelimit-reset-tokens': '3.294s', 'x-request-id': 'req_cdcbffd7df49485859002029b44539e1', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f3296ad096261-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 13:41:39,306 - DEBUG - request_id: req_cdcbffd7df49485859002029b44539e1
2024-10-15 13:41:39,307 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZHclpJ8kSkyvJTUR3JgtKWIyS3g', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_krSC1IppUF80PWgUWvjXFUdd', function=Function(arguments='\n{\n  "parties": [\n    {\n      "name": "ISPILANTE SENTIMENT BRUSLI",\n      "role": "Service Provider"\n    },\n    {\n      "name": "ELENA VASILESCU",\n      "role": "Client"\n    }\n  ]\n}', name='ContractParties'), type='function')]))], created=1728988896, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=62, prompt_tokens=393, total_tokens=455, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:42:46,700 - DEBUG - close.started
2024-10-15 13:42:46,701 - DEBUG - close.complete
2024-10-15 13:42:46,701 - ERROR - Task exception was never retrieved
future: <Task finished name='Task-1' coro=<agent_workflow() done, defined at D:\deve\contract_automation\src\main.py:26> exception=KeyboardInterrupt()>
Traceback (most recent call last):
  File "D:\deve\contract_automation\src\main.py", line 100, in <module>
    asyncio.run(agent_workflow())
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 30, in run
    return loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 92, in run_until_complete
    self._run_once()
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 133, in _run_once
    handle._run()
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 386, in __wakeup
    self.__step()
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 293, in __step
    self.__step_run_and_handle_result(exc)
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 304, in __step_run_and_handle_result
    result = coro.send(None)
             ^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\src\main.py", line 63, in agent_workflow
    state.parties = identify_parties(state.verified_pii_data, state.contract_details.contract_type)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\src\ai_functions.py", line 152, in identify_parties
    confirmation = input(f"Is this role correct for {party.name}? (yes/no): ").lower()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
2024-10-15 13:42:53,550 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-15 13:42:54,824 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-15 13:42:54,825 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-15 13:42:55,153 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-15 13:42:55,153 - DEBUG - Using proactor: IocpProactor
2024-10-15 13:42:55,181 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 13:42:55,181 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 13:42:55,181 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 13:42:55,181 - DEBUG - Compression method 0
2024-10-15 13:42:55,181 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 13:42:55,181 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 13:42:55,181 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 13:42:55,181 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 13:42:55,181 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 13:42:55,181 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 13:42:55,181 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 13:42:55,181 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 13:42:55,181 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 13:42:55,181 - DEBUG - Compression method 0
2024-10-15 13:42:55,182 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 13:42:55,182 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 13:42:55,182 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 13:42:55,182 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 13:42:55,182 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 13:42:55,182 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 13:42:55,191 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 13:42:55,192 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 13:42:55,192 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 13:42:55,192 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 13:42:55,192 - DEBUG - Error closing: Operation on closed image
2024-10-15 13:42:57,207 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 13:42:57,207 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 13:42:57,207 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 13:42:57,207 - DEBUG - Compression method 0
2024-10-15 13:42:57,207 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 13:42:57,207 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 13:42:57,207 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 13:42:57,208 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 13:42:57,208 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 13:42:57,208 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 13:42:57,208 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 13:42:57,208 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 13:42:57,208 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 13:42:57,208 - DEBUG - Compression method 0
2024-10-15 13:42:57,208 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 13:42:57,208 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 13:42:57,208 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 13:42:57,208 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 13:42:57,208 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 13:42:57,208 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 13:42:57,233 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 13:42:57,233 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 13:42:57,233 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 13:42:57,233 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 13:42:57,234 - DEBUG - Error closing: Operation on closed image
2024-10-15 13:43:01,877 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'instructor.dsl.simple_type.Response'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}}
2024-10-15 13:43:01,878 - DEBUG - max_retries: 1
2024-10-15 13:43:01,882 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}, 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}]}}
2024-10-15 13:43:01,927 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:43:01,927 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-15 13:43:01,972 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000002A049B7F380>
2024-10-15 13:43:01,972 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x000002A049BBE7D0> server_hostname='api.openai.com' timeout=5.0
2024-10-15 13:43:01,979 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000002A0499BC440>
2024-10-15 13:43:01,979 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:43:01,979 - DEBUG - send_request_headers.complete
2024-10-15 13:43:01,979 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:43:01,979 - DEBUG - send_request_body.complete
2024-10-15 13:43:01,979 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:43:04,858 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:43:05 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2731'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'9569'), (b'x-ratelimit-reset-requests', b'8.64s'), (b'x-ratelimit-reset-tokens', b'2.586s'), (b'x-request-id', b'req_95689a7daff72f35876f3a3bf2b10314'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=WHs54uYcT_WGm1HjV0jV6oR1o8dLPn7OWarRUNMtl9k-1728988985-1.0.1.1-EJgQQ942NV.OlQUFfVLAUVYMX2mQ1VQRckdHuRpgRrZIpIFGJQWvasf00q_LfsVuNXyeQbvqhf6_JG8H34dkKg; path=/; expires=Tue, 15-Oct-24 11:13:05 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=1KRKeaNGfNIzob_bn8_tZ4BFSB8wMWVBuGnktF0kuv4-1728988985426-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f34b4fb05c9cc-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:43:04,859 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:43:04,859 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:43:04,859 - DEBUG - receive_response_body.complete
2024-10-15 13:43:04,859 - DEBUG - response_closed.started
2024-10-15 13:43:04,859 - DEBUG - response_closed.complete
2024-10-15 13:43:04,860 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Tue, 15 Oct 2024 10:43:05 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-kzzh9hik9ryjiou4ftvhondh'), ('openai-processing-ms', '2731'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '10000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '9569'), ('x-ratelimit-reset-requests', '8.64s'), ('x-ratelimit-reset-tokens', '2.586s'), ('x-request-id', 'req_95689a7daff72f35876f3a3bf2b10314'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=WHs54uYcT_WGm1HjV0jV6oR1o8dLPn7OWarRUNMtl9k-1728988985-1.0.1.1-EJgQQ942NV.OlQUFfVLAUVYMX2mQ1VQRckdHuRpgRrZIpIFGJQWvasf00q_LfsVuNXyeQbvqhf6_JG8H34dkKg; path=/; expires=Tue, 15-Oct-24 11:13:05 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=1KRKeaNGfNIzob_bn8_tZ4BFSB8wMWVBuGnktF0kuv4-1728988985426-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d2f34b4fb05c9cc-OTP'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-15 13:43:04,860 - DEBUG - request_id: req_95689a7daff72f35876f3a3bf2b10314
2024-10-15 13:43:04,862 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZJ0fUYTmjteybysvBMgepKPrMwv', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_PPQbAaQMgjzGMQUkJBMzrDdn', function=Function(arguments='{\n  "content": [\n    {\n      "name": "ISPILANTE SENTIMENT BRUSLI",\n      "address": "Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR"\n    }\n  ]\n}', name='Response'), type='function')]))], created=1728988982, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=53, prompt_tokens=472, total_tokens=525, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:43:04,863 - DEBUG - Returning model from AdapterBase
2024-10-15 13:43:20,741 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'instructor.dsl.simple_type.Response'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}}
2024-10-15 13:43:20,741 - DEBUG - max_retries: 1
2024-10-15 13:43:20,744 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}, 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}]}}
2024-10-15 13:43:20,745 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:43:20,745 - DEBUG - close.started
2024-10-15 13:43:20,746 - DEBUG - close.complete
2024-10-15 13:43:20,746 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-15 13:43:20,770 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000002A049CB72C0>
2024-10-15 13:43:20,770 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x000002A049BBE7D0> server_hostname='api.openai.com' timeout=5.0
2024-10-15 13:43:20,778 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000002A048796E40>
2024-10-15 13:43:20,778 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:43:20,778 - DEBUG - send_request_headers.complete
2024-10-15 13:43:20,779 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:43:20,779 - DEBUG - send_request_body.complete
2024-10-15 13:43:20,779 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:43:23,883 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:43:24 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2948'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'9576'), (b'x-ratelimit-reset-requests', b'8.64s'), (b'x-ratelimit-reset-tokens', b'2.544s'), (b'x-request-id', b'req_b368b1e97055e18b45bb894365602e4b'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f352a7855c9cc-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:43:23,883 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:43:23,884 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:43:23,884 - DEBUG - receive_response_body.complete
2024-10-15 13:43:23,884 - DEBUG - response_closed.started
2024-10-15 13:43:23,884 - DEBUG - response_closed.complete
2024-10-15 13:43:23,884 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 10:43:24 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '2948', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9999', 'x-ratelimit-remaining-tokens': '9576', 'x-ratelimit-reset-requests': '8.64s', 'x-ratelimit-reset-tokens': '2.544s', 'x-request-id': 'req_b368b1e97055e18b45bb894365602e4b', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f352a7855c9cc-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 13:43:23,884 - DEBUG - request_id: req_b368b1e97055e18b45bb894365602e4b
2024-10-15 13:43:23,884 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZJJ6jy4t66wRCra2WkV22ZVSdJv', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_c7kpngUmwYy3ljj13s6MfghY', function=Function(arguments='{\n  "content": [\n    {\n      "name": "ELENA VASILESCU",\n      "address": "Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B"\n    }\n  ]\n}', name='Response'), type='function')]))], created=1728989001, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=56, prompt_tokens=475, total_tokens=531, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:43:23,885 - DEBUG - Returning model from AdapterBase
2024-10-15 13:43:25,009 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 13:43:25,009 - DEBUG - max_retries: 1
2024-10-15 13:43:25,011 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 13:43:25,011 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:43:25,011 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:43:25,012 - DEBUG - send_request_headers.complete
2024-10-15 13:43:25,012 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:43:25,012 - DEBUG - send_request_body.complete
2024-10-15 13:43:25,012 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:43:26,075 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:43:26 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'910'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9998'), (b'x-ratelimit-remaining-tokens', b'9608'), (b'x-ratelimit-reset-requests', b'13.043s'), (b'x-ratelimit-reset-tokens', b'2.352s'), (b'x-request-id', b'req_fe3f42fb91d81b2dc3c8d7126f36429f'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f3544e9f4c9cc-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:43:26,075 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:43:26,075 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:43:26,076 - DEBUG - receive_response_body.complete
2024-10-15 13:43:26,076 - DEBUG - response_closed.started
2024-10-15 13:43:26,076 - DEBUG - response_closed.complete
2024-10-15 13:43:26,076 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 10:43:26 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '910', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9998', 'x-ratelimit-remaining-tokens': '9608', 'x-ratelimit-reset-requests': '13.043s', 'x-ratelimit-reset-tokens': '2.352s', 'x-request-id': 'req_fe3f42fb91d81b2dc3c8d7126f36429f', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f3544e9f4c9cc-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 13:43:26,076 - DEBUG - request_id: req_fe3f42fb91d81b2dc3c8d7126f36429f
2024-10-15 13:43:26,076 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZJNvfIIgBSBvFArLlcT0ZHwuewW', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_TyWcsQXOvUDJ2IZ3873y9ODk', function=Function(arguments='\n{\n  "action": "determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728989005, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=13, prompt_tokens=360, total_tokens=373, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:43:30,299 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: Yes\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 13:43:30,299 - DEBUG - max_retries: 1
2024-10-15 13:43:30,301 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: Yes\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 13:43:30,302 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:43:30,302 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:43:30,302 - DEBUG - send_request_headers.complete
2024-10-15 13:43:30,302 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:43:30,302 - DEBUG - send_request_body.complete
2024-10-15 13:43:30,303 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:43:31,194 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:43:31 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'746'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9998'), (b'x-ratelimit-remaining-tokens', b'9608'), (b'x-ratelimit-reset-requests', b'16.398s'), (b'x-ratelimit-reset-tokens', b'2.352s'), (b'x-request-id', b'req_1b4847cc8b7c1e65ecb4678525287cee'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f3565ff31c9cc-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:43:31,195 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:43:31,195 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:43:31,196 - DEBUG - receive_response_body.complete
2024-10-15 13:43:31,197 - DEBUG - response_closed.started
2024-10-15 13:43:31,197 - DEBUG - response_closed.complete
2024-10-15 13:43:31,197 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 10:43:31 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '746', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9998', 'x-ratelimit-remaining-tokens': '9608', 'x-ratelimit-reset-requests': '16.398s', 'x-ratelimit-reset-tokens': '2.352s', 'x-request-id': 'req_1b4847cc8b7c1e65ecb4678525287cee', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f3565ff31c9cc-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 13:43:31,197 - DEBUG - request_id: req_1b4847cc8b7c1e65ecb4678525287cee
2024-10-15 13:43:31,198 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZJTUAuJF9Pbo8A9G4Y5Lybv62NQ', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_iKSmGhRw5Xc3ocaFZF2CvsVi', function=Function(arguments='{\n  "action": "identify_parties"\n}', name='AgentAction'), type='function')]))], created=1728989011, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=11, prompt_tokens=360, total_tokens=371, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:43:31,203 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.ContractParties'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    For a airbnb contract, show the roles available for the following parties based on their personal information:\n\n    Name: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B\n\n    Your task is to show the roles available for each person in the context of a airbnb contract. \n    The human will pick one of the roles.\n    '}], 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'$defs': {'ContractParty': {'properties': {'name': {'description': 'Name of the party', 'title': 'Name', 'type': 'string'}, 'role': {'description': 'Role of the party in the contract', 'title': 'Role', 'type': 'string'}}, 'required': ['name', 'role'], 'title': 'ContractParty', 'type': 'object'}}, 'properties': {'parties': {'description': 'List of parties involved in the contract', 'items': {'$ref': '#/$defs/ContractParty'}, 'title': 'Parties', 'type': 'array'}}, 'required': ['parties'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}}
2024-10-15 13:43:31,203 - DEBUG - max_retries: 1
2024-10-15 13:43:31,208 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    For a airbnb contract, show the roles available for the following parties based on their personal information:\n\n    Name: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B\n\n    Your task is to show the roles available for each person in the context of a airbnb contract. \n    The human will pick one of the roles.\n    '}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}, 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'$defs': {'ContractParty': {'properties': {'name': {'description': 'Name of the party', 'title': 'Name', 'type': 'string'}, 'role': {'description': 'Role of the party in the contract', 'title': 'Role', 'type': 'string'}}, 'required': ['name', 'role'], 'title': 'ContractParty', 'type': 'object'}}, 'properties': {'parties': {'description': 'List of parties involved in the contract', 'items': {'$ref': '#/$defs/ContractParty'}, 'title': 'Parties', 'type': 'array'}}, 'required': ['parties'], 'type': 'object'}}}]}}
2024-10-15 13:43:31,209 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:43:31,209 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:43:31,209 - DEBUG - send_request_headers.complete
2024-10-15 13:43:31,209 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:43:31,209 - DEBUG - send_request_body.complete
2024-10-15 13:43:31,210 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:43:34,367 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:43:34 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2997'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9997'), (b'x-ratelimit-remaining-tokens', b'9399'), (b'x-ratelimit-reset-requests', b'24.13s'), (b'x-ratelimit-reset-tokens', b'3.603s'), (b'x-request-id', b'req_b97636782b68c9ea62153b6f1f568e77'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f356baf70c9cc-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:43:34,368 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:43:34,368 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:43:34,369 - DEBUG - receive_response_body.complete
2024-10-15 13:43:34,369 - DEBUG - response_closed.started
2024-10-15 13:43:34,369 - DEBUG - response_closed.complete
2024-10-15 13:43:34,369 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 10:43:34 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '2997', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9997', 'x-ratelimit-remaining-tokens': '9399', 'x-ratelimit-reset-requests': '24.13s', 'x-ratelimit-reset-tokens': '3.603s', 'x-request-id': 'req_b97636782b68c9ea62153b6f1f568e77', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f356baf70c9cc-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 13:43:34,369 - DEBUG - request_id: req_b97636782b68c9ea62153b6f1f568e77
2024-10-15 13:43:34,370 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZJUnMjLoJq1tnTncoY2c8CWA35o', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_33Qrdkf6gWPqI7Zu2VRBXCZC', function=Function(arguments='\n{\n"parties": [\n    {\n        "name": "ISPILANTE SENTIMENT BRUSLI",\n        "role": "Landlord"\n    },\n    {\n        "name": "ELENA VASILESCU",\n        "role": "Tenant"\n    }\n]\n}', name='ContractParties'), type='function')]))], created=1728989012, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=60, prompt_tokens=395, total_tokens=455, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:43:38,865 - DEBUG - close.started
2024-10-15 13:43:38,865 - DEBUG - close.complete
2024-10-15 13:43:38,866 - ERROR - Task exception was never retrieved
future: <Task finished name='Task-1' coro=<agent_workflow() done, defined at D:\deve\contract_automation\src\main.py:26> exception=KeyboardInterrupt()>
Traceback (most recent call last):
  File "D:\deve\contract_automation\src\main.py", line 100, in <module>
    asyncio.run(agent_workflow())
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 30, in run
    return loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 92, in run_until_complete
    self._run_once()
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 133, in _run_once
    handle._run()
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 386, in __wakeup
    self.__step()
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 293, in __step
    self.__step_run_and_handle_result(exc)
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 304, in __step_run_and_handle_result
    result = coro.send(None)
             ^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\src\main.py", line 63, in agent_workflow
    state.parties = identify_parties(state.verified_pii_data, state.contract_details.contract_type)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\src\ai_functions.py", line 152, in identify_parties
    confirmation = input(f"Is this role correct for {party.name}? (yes/no): ").lower()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
2024-10-15 13:49:28,642 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-15 13:49:29,906 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-15 13:49:29,907 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-15 13:49:30,226 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-15 13:49:30,226 - DEBUG - Using proactor: IocpProactor
2024-10-15 13:49:30,253 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 13:49:30,253 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 13:49:30,254 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 13:49:30,254 - DEBUG - Compression method 0
2024-10-15 13:49:30,254 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 13:49:30,254 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 13:49:30,254 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 13:49:30,254 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 13:49:30,254 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 13:49:30,254 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 13:49:30,254 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 13:49:30,254 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 13:49:30,254 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 13:49:30,254 - DEBUG - Compression method 0
2024-10-15 13:49:30,254 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 13:49:30,254 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 13:49:30,254 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 13:49:30,254 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 13:49:30,254 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 13:49:30,254 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 13:49:30,264 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 13:49:30,264 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 13:49:30,264 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 13:49:30,264 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 13:49:30,265 - DEBUG - Error closing: Operation on closed image
2024-10-15 13:49:32,266 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 13:49:32,266 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 13:49:32,266 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 13:49:32,266 - DEBUG - Compression method 0
2024-10-15 13:49:32,266 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 13:49:32,266 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 13:49:32,266 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 13:49:32,266 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 13:49:32,266 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 13:49:32,266 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 13:49:32,266 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 13:49:32,266 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 13:49:32,266 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 13:49:32,266 - DEBUG - Compression method 0
2024-10-15 13:49:32,266 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 13:49:32,266 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 13:49:32,266 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 13:49:32,266 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 13:49:32,266 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 13:49:32,266 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 13:49:32,284 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 13:49:32,284 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 13:49:32,284 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 13:49:32,284 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 13:49:32,285 - DEBUG - Error closing: Operation on closed image
2024-10-15 13:49:34,824 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'instructor.dsl.simple_type.Response'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}}
2024-10-15 13:49:34,825 - DEBUG - max_retries: 1
2024-10-15 13:49:34,826 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}, 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}]}}
2024-10-15 13:49:34,862 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:49:34,862 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-15 13:49:34,934 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x0000028ECD26B3B0>
2024-10-15 13:49:34,934 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x0000028ECD35E7D0> server_hostname='api.openai.com' timeout=5.0
2024-10-15 13:49:34,945 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x0000028ECD4C6240>
2024-10-15 13:49:34,945 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:49:34,945 - DEBUG - send_request_headers.complete
2024-10-15 13:49:34,945 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:49:34,945 - DEBUG - send_request_body.complete
2024-10-15 13:49:34,945 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:49:37,400 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:49:37 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2287'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'9569'), (b'x-ratelimit-reset-requests', b'8.64s'), (b'x-ratelimit-reset-tokens', b'2.586s'), (b'x-request-id', b'req_5f26d3ef60be43ff67fd0d65ae8221ca'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=VqN5qzcZqViKQc6asB2RAsc0PH5EUSJ33MiIbmR4BSU-1728989377-1.0.1.1-TvhTo4GonK8vaSgOsX.ulLEzCcImDWO_JJFmk8eqWtId9J8.1mAZysaXQmgR0iWZjEZffS6WJwpii7bnxZdGwA; path=/; expires=Tue, 15-Oct-24 11:19:37 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=jdhx_fOirr7u2dDi7SYBYn4pAleLtiQrQQQfaY4dj50-1728989377983-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f3e4d1df30544-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:49:37,402 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:49:37,402 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:49:37,403 - DEBUG - receive_response_body.complete
2024-10-15 13:49:37,403 - DEBUG - response_closed.started
2024-10-15 13:49:37,403 - DEBUG - response_closed.complete
2024-10-15 13:49:37,404 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Tue, 15 Oct 2024 10:49:37 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-kzzh9hik9ryjiou4ftvhondh'), ('openai-processing-ms', '2287'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '10000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '9569'), ('x-ratelimit-reset-requests', '8.64s'), ('x-ratelimit-reset-tokens', '2.586s'), ('x-request-id', 'req_5f26d3ef60be43ff67fd0d65ae8221ca'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=VqN5qzcZqViKQc6asB2RAsc0PH5EUSJ33MiIbmR4BSU-1728989377-1.0.1.1-TvhTo4GonK8vaSgOsX.ulLEzCcImDWO_JJFmk8eqWtId9J8.1mAZysaXQmgR0iWZjEZffS6WJwpii7bnxZdGwA; path=/; expires=Tue, 15-Oct-24 11:19:37 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=jdhx_fOirr7u2dDi7SYBYn4pAleLtiQrQQQfaY4dj50-1728989377983-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d2f3e4d1df30544-OTP'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-15 13:49:37,404 - DEBUG - request_id: req_5f26d3ef60be43ff67fd0d65ae8221ca
2024-10-15 13:49:37,407 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZPLn2aFGnd3cXFl8dWchHCFenFI', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_JZ9vf1HDZJmcoa16A1p6YsQt', function=Function(arguments='{\n"content": [\n  {\n    "name": "ISPILANTE SENTIMENT BRUSLI",\n    "address": "Videle Jud: Teleorman Sos. Giurgiului nr.1"\n  }\n]\n}', name='Response'), type='function')]))], created=1728989375, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=48, prompt_tokens=472, total_tokens=520, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:49:37,407 - DEBUG - Returning model from AdapterBase
2024-10-15 13:49:39,184 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'instructor.dsl.simple_type.Response'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}}
2024-10-15 13:49:39,184 - DEBUG - max_retries: 1
2024-10-15 13:49:39,186 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}, 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}]}}
2024-10-15 13:49:39,187 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:49:39,187 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:49:39,187 - DEBUG - send_request_headers.complete
2024-10-15 13:49:39,187 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:49:39,188 - DEBUG - send_request_body.complete
2024-10-15 13:49:39,188 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:49:42,621 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:49:43 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'3274'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9998'), (b'x-ratelimit-remaining-tokens', b'9576'), (b'x-ratelimit-reset-requests', b'13.046s'), (b'x-ratelimit-reset-tokens', b'2.544s'), (b'x-request-id', b'req_10ade88c175e9062753e2e4aeaf91efb'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f3e679c150544-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:49:42,622 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:49:42,623 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:49:42,623 - DEBUG - receive_response_body.complete
2024-10-15 13:49:42,623 - DEBUG - response_closed.started
2024-10-15 13:49:42,623 - DEBUG - response_closed.complete
2024-10-15 13:49:42,624 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 10:49:43 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '3274', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9998', 'x-ratelimit-remaining-tokens': '9576', 'x-ratelimit-reset-requests': '13.046s', 'x-ratelimit-reset-tokens': '2.544s', 'x-request-id': 'req_10ade88c175e9062753e2e4aeaf91efb', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f3e679c150544-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 13:49:42,624 - DEBUG - request_id: req_10ade88c175e9062753e2e4aeaf91efb
2024-10-15 13:49:42,625 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZPQEymKhcbmSvKF0jkxjgmmIIFm', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_egQ7G8sLReiusHm1Ki3iv8ON', function=Function(arguments='{\n  "content": [\n    {\n      "name": "ELENA VASILESCU",\n      "address": "Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B"\n    }\n  ]\n}', name='Response'), type='function')]))], created=1728989380, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=56, prompt_tokens=475, total_tokens=531, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:49:42,626 - DEBUG - Returning model from AdapterBase
2024-10-15 13:49:43,683 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 13:49:43,683 - DEBUG - max_retries: 1
2024-10-15 13:49:43,685 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 13:49:43,685 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:49:43,686 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:49:43,686 - DEBUG - send_request_headers.complete
2024-10-15 13:49:43,686 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:49:43,686 - DEBUG - send_request_body.complete
2024-10-15 13:49:43,686 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:49:45,327 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:49:45 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1489'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9998'), (b'x-ratelimit-remaining-tokens', b'9608'), (b'x-ratelimit-reset-requests', b'17.197s'), (b'x-ratelimit-reset-tokens', b'2.352s'), (b'x-request-id', b'req_be84ad3fa410cd9d0a69afa010c8ae6a'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f3e83ba630544-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:49:45,328 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:49:45,328 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:49:45,329 - DEBUG - receive_response_body.complete
2024-10-15 13:49:45,329 - DEBUG - response_closed.started
2024-10-15 13:49:45,329 - DEBUG - response_closed.complete
2024-10-15 13:49:45,329 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 10:49:45 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1489', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9998', 'x-ratelimit-remaining-tokens': '9608', 'x-ratelimit-reset-requests': '17.197s', 'x-ratelimit-reset-tokens': '2.352s', 'x-request-id': 'req_be84ad3fa410cd9d0a69afa010c8ae6a', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f3e83ba630544-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 13:49:45,329 - DEBUG - request_id: req_be84ad3fa410cd9d0a69afa010c8ae6a
2024-10-15 13:49:45,331 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZPUSJBwevppY2IPO9Qb4pm77aEo', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_yTzbGknEKTqiNmDn77DFVX5K', function=Function(arguments='{\n    "action": "determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728989384, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=12, prompt_tokens=360, total_tokens=372, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:49:47,811 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: Yes\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 13:49:47,811 - DEBUG - max_retries: 1
2024-10-15 13:49:47,813 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: Yes\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 13:49:47,814 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:49:47,814 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:49:47,814 - DEBUG - send_request_headers.complete
2024-10-15 13:49:47,814 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:49:47,815 - DEBUG - send_request_body.complete
2024-10-15 13:49:47,815 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:49:49,264 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:49:49 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1282'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9997'), (b'x-ratelimit-remaining-tokens', b'9608'), (b'x-ratelimit-reset-requests', b'21.703s'), (b'x-ratelimit-reset-tokens', b'2.352s'), (b'x-request-id', b'req_d7286084231a553586697d2d2cbdef7e'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f3e9d8f900544-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:49:49,264 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:49:49,264 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:49:49,264 - DEBUG - receive_response_body.complete
2024-10-15 13:49:49,265 - DEBUG - response_closed.started
2024-10-15 13:49:49,265 - DEBUG - response_closed.complete
2024-10-15 13:49:49,265 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 10:49:49 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1282', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9997', 'x-ratelimit-remaining-tokens': '9608', 'x-ratelimit-reset-requests': '21.703s', 'x-ratelimit-reset-tokens': '2.352s', 'x-request-id': 'req_d7286084231a553586697d2d2cbdef7e', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f3e9d8f900544-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 13:49:49,265 - DEBUG - request_id: req_d7286084231a553586697d2d2cbdef7e
2024-10-15 13:49:49,265 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZPYHrGAE1b2R2EMdvxi7KrJDcKu', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_HSchXfc7lGVMoGtMAyfO8eaV', function=Function(arguments='\n{\n  "action": "identify_parties"\n}', name='AgentAction'), type='function')]))], created=1728989388, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=12, prompt_tokens=360, total_tokens=372, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:49:49,267 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.ContractParties'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    For a it contract, show the roles available for the following parties based on their personal information:\n\n    Name: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B\n\n    Your task is to show the roles available for each person in the context of a it contract. \n    The human will pick one of the roles.\n    '}], 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'$defs': {'ContractParty': {'properties': {'name': {'description': 'Name of the party', 'title': 'Name', 'type': 'string'}, 'role': {'description': 'Role of the party in the contract', 'title': 'Role', 'type': 'string'}}, 'required': ['name', 'role'], 'title': 'ContractParty', 'type': 'object'}}, 'properties': {'parties': {'description': 'List of parties involved in the contract', 'items': {'$ref': '#/$defs/ContractParty'}, 'title': 'Parties', 'type': 'array'}}, 'required': ['parties'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}}
2024-10-15 13:49:49,267 - DEBUG - max_retries: 1
2024-10-15 13:49:49,269 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    For a it contract, show the roles available for the following parties based on their personal information:\n\n    Name: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B\n\n    Your task is to show the roles available for each person in the context of a it contract. \n    The human will pick one of the roles.\n    '}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}, 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'$defs': {'ContractParty': {'properties': {'name': {'description': 'Name of the party', 'title': 'Name', 'type': 'string'}, 'role': {'description': 'Role of the party in the contract', 'title': 'Role', 'type': 'string'}}, 'required': ['name', 'role'], 'title': 'ContractParty', 'type': 'object'}}, 'properties': {'parties': {'description': 'List of parties involved in the contract', 'items': {'$ref': '#/$defs/ContractParty'}, 'title': 'Parties', 'type': 'array'}}, 'required': ['parties'], 'type': 'object'}}}]}}
2024-10-15 13:49:49,270 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:49:49,270 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:49:49,270 - DEBUG - send_request_headers.complete
2024-10-15 13:49:49,270 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:49:49,270 - DEBUG - send_request_body.complete
2024-10-15 13:49:49,270 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:49:52,396 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:49:52 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2980'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9996'), (b'x-ratelimit-remaining-tokens', b'9492'), (b'x-ratelimit-reset-requests', b'28.893s'), (b'x-ratelimit-reset-tokens', b'3.043s'), (b'x-request-id', b'req_4af72fb1291a2efc21f51dbabb3d672d'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f3ea699e80544-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:49:52,397 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:49:52,397 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:49:52,397 - DEBUG - receive_response_body.complete
2024-10-15 13:49:52,397 - DEBUG - response_closed.started
2024-10-15 13:49:52,398 - DEBUG - response_closed.complete
2024-10-15 13:49:52,398 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 10:49:52 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '2980', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9996', 'x-ratelimit-remaining-tokens': '9492', 'x-ratelimit-reset-requests': '28.893s', 'x-ratelimit-reset-tokens': '3.043s', 'x-request-id': 'req_4af72fb1291a2efc21f51dbabb3d672d', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f3ea699e80544-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 13:49:52,398 - DEBUG - request_id: req_4af72fb1291a2efc21f51dbabb3d672d
2024-10-15 13:49:52,399 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZPaiNadLzhU0OWhGrHYCS9d4Z7m', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_1VELGRkF39j5bi0iaReC5oOX', function=Function(arguments='\n{\n  "parties": [\n    {\n      "name": "ISPILANTE SENTIMENT BRUSLI",\n      "role": "Client"\n    },\n    {\n      "name": "ELENA VASILESCU",\n      "role": "Service Provider"\n    }\n  ]\n}', name='ContractParties'), type='function')]))], created=1728989390, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=62, prompt_tokens=390, total_tokens=452, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:50:29,884 - DEBUG - close.started
2024-10-15 13:50:29,885 - DEBUG - close.complete
2024-10-15 13:50:29,885 - ERROR - Task exception was never retrieved
future: <Task finished name='Task-1' coro=<agent_workflow() done, defined at D:\deve\contract_automation\src\main.py:26> exception=KeyboardInterrupt()>
Traceback (most recent call last):
  File "D:\deve\contract_automation\src\main.py", line 100, in <module>
    asyncio.run(agent_workflow())
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 30, in run
    return loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 92, in run_until_complete
    self._run_once()
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 133, in _run_once
    handle._run()
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 386, in __wakeup
    self.__step()
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 293, in __step
    self.__step_run_and_handle_result(exc)
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 304, in __step_run_and_handle_result
    result = coro.send(None)
             ^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\src\main.py", line 63, in agent_workflow
    state.parties = identify_parties(state.verified_pii_data, state.contract_details.contract_type)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\src\ai_functions.py", line 152, in identify_parties
    confirmation = input(f"What role is correct for {party.name}?: ").lower()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
2024-10-15 13:50:33,632 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-15 13:50:34,905 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-15 13:50:34,906 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-15 13:50:35,225 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-15 13:50:35,226 - DEBUG - Using proactor: IocpProactor
2024-10-15 13:50:35,252 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 13:50:35,252 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 13:50:35,252 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 13:50:35,252 - DEBUG - Compression method 0
2024-10-15 13:50:35,252 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 13:50:35,252 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 13:50:35,252 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 13:50:35,252 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 13:50:35,252 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 13:50:35,252 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 13:50:35,252 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 13:50:35,252 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 13:50:35,252 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 13:50:35,252 - DEBUG - Compression method 0
2024-10-15 13:50:35,252 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 13:50:35,252 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 13:50:35,252 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 13:50:35,252 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 13:50:35,252 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 13:50:35,252 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 13:50:35,262 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 13:50:35,262 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 13:50:35,262 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 13:50:35,262 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 13:50:35,263 - DEBUG - Error closing: Operation on closed image
2024-10-15 13:50:37,248 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 13:50:37,248 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 13:50:37,248 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 13:50:37,248 - DEBUG - Compression method 0
2024-10-15 13:50:37,248 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 13:50:37,248 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 13:50:37,248 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 13:50:37,248 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 13:50:37,248 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 13:50:37,248 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 13:50:37,248 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 13:50:37,248 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 13:50:37,248 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 13:50:37,248 - DEBUG - Compression method 0
2024-10-15 13:50:37,248 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 13:50:37,248 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 13:50:37,248 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 13:50:37,248 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 13:50:37,248 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 13:50:37,248 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 13:50:37,265 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 13:50:37,265 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 13:50:37,265 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 13:50:37,265 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 13:50:37,266 - DEBUG - Error closing: Operation on closed image
2024-10-15 13:50:39,753 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'instructor.dsl.simple_type.Response'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}}
2024-10-15 13:50:39,754 - DEBUG - max_retries: 1
2024-10-15 13:50:39,755 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}, 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}]}}
2024-10-15 13:50:39,793 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:50:39,793 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-15 13:50:39,876 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x0000023EE3301580>
2024-10-15 13:50:39,876 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x0000023EE478E7D0> server_hostname='api.openai.com' timeout=5.0
2024-10-15 13:50:39,889 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x0000023EE48F6540>
2024-10-15 13:50:39,889 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:50:39,889 - DEBUG - send_request_headers.complete
2024-10-15 13:50:39,889 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:50:39,890 - DEBUG - send_request_body.complete
2024-10-15 13:50:39,890 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:50:42,154 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:50:42 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2122'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'9569'), (b'x-ratelimit-reset-requests', b'8.64s'), (b'x-ratelimit-reset-tokens', b'2.586s'), (b'x-request-id', b'req_d76e94fbef5f2620d1bbc04070fdc18d'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=ILtc1hoHKUOX5wFOEZb6T.2E0A70ZaJohtHCsrBVyIo-1728989442-1.0.1.1-2tRv7yi1UlWUXgy7pwgnV8r7R5F1SDjGj0CFmm.AwTUwioUyz5BiQFeV6CnVN3rJBlQJ8e1XW8flIcPhGum6wg; path=/; expires=Tue, 15-Oct-24 11:20:42 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=BmuRMrLylWmfoli82Rrq6YRo7I9KdtYVIaFWtfrN.Iw-1728989442740-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f3fe30dcfca28-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:50:42,156 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:50:42,157 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:50:42,157 - DEBUG - receive_response_body.complete
2024-10-15 13:50:42,158 - DEBUG - response_closed.started
2024-10-15 13:50:42,158 - DEBUG - response_closed.complete
2024-10-15 13:50:42,158 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Tue, 15 Oct 2024 10:50:42 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-kzzh9hik9ryjiou4ftvhondh'), ('openai-processing-ms', '2122'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '10000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '9569'), ('x-ratelimit-reset-requests', '8.64s'), ('x-ratelimit-reset-tokens', '2.586s'), ('x-request-id', 'req_d76e94fbef5f2620d1bbc04070fdc18d'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=ILtc1hoHKUOX5wFOEZb6T.2E0A70ZaJohtHCsrBVyIo-1728989442-1.0.1.1-2tRv7yi1UlWUXgy7pwgnV8r7R5F1SDjGj0CFmm.AwTUwioUyz5BiQFeV6CnVN3rJBlQJ8e1XW8flIcPhGum6wg; path=/; expires=Tue, 15-Oct-24 11:20:42 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=BmuRMrLylWmfoli82Rrq6YRo7I9KdtYVIaFWtfrN.Iw-1728989442740-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d2f3fe30dcfca28-OTP'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-15 13:50:42,158 - DEBUG - request_id: req_d76e94fbef5f2620d1bbc04070fdc18d
2024-10-15 13:50:42,160 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZQOXnWQlfOnokDXmSJELLZMk8Nr', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_bE41HsooaEplc3GoTdFsajmJ', function=Function(arguments='{\n  "content": [\n    {\n      "name": "ISPILANTE SENTIMENT BRUSLI",\n      "address": "Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR"\n    }\n  ]\n}', name='Response'), type='function')]))], created=1728989440, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=53, prompt_tokens=472, total_tokens=525, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:50:42,161 - DEBUG - Returning model from AdapterBase
2024-10-15 13:50:44,012 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'instructor.dsl.simple_type.Response'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}}
2024-10-15 13:50:44,012 - DEBUG - max_retries: 1
2024-10-15 13:50:44,014 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}, 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}]}}
2024-10-15 13:50:44,015 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:50:44,015 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:50:44,015 - DEBUG - send_request_headers.complete
2024-10-15 13:50:44,015 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:50:44,015 - DEBUG - send_request_body.complete
2024-10-15 13:50:44,016 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:50:46,832 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:50:47 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2677'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9998'), (b'x-ratelimit-remaining-tokens', b'9576'), (b'x-ratelimit-reset-requests', b'13.156s'), (b'x-ratelimit-reset-tokens', b'2.544s'), (b'x-request-id', b'req_08a60ee84330e7d9d3d45fd8c686a09b'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f3ffccd87ca28-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:50:46,832 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:50:46,833 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:50:46,833 - DEBUG - receive_response_body.complete
2024-10-15 13:50:46,833 - DEBUG - response_closed.started
2024-10-15 13:50:46,833 - DEBUG - response_closed.complete
2024-10-15 13:50:46,833 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 10:50:47 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '2677', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9998', 'x-ratelimit-remaining-tokens': '9576', 'x-ratelimit-reset-requests': '13.156s', 'x-ratelimit-reset-tokens': '2.544s', 'x-request-id': 'req_08a60ee84330e7d9d3d45fd8c686a09b', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f3ffccd87ca28-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 13:50:46,833 - DEBUG - request_id: req_08a60ee84330e7d9d3d45fd8c686a09b
2024-10-15 13:50:46,833 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZQS3FUA6eY1sZssvh8nKMPcm0q7', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_dBFZoKU40pCCXIyezlfp47aT', function=Function(arguments='{\n  "content": [\n    {\n      "name": "ELENA VASILESCU",\n      "address": "Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B"\n    }\n  ]\n}', name='Response'), type='function')]))], created=1728989444, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=56, prompt_tokens=475, total_tokens=531, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:50:46,834 - DEBUG - Returning model from AdapterBase
2024-10-15 13:50:48,422 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 13:50:48,422 - DEBUG - max_retries: 1
2024-10-15 13:50:48,424 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 13:50:48,425 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:50:48,425 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:50:48,425 - DEBUG - send_request_headers.complete
2024-10-15 13:50:48,425 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:50:48,425 - DEBUG - send_request_body.complete
2024-10-15 13:50:48,426 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:50:49,378 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:50:49 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'809'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9997'), (b'x-ratelimit-remaining-tokens', b'9608'), (b'x-ratelimit-reset-requests', b'17.384s'), (b'x-ratelimit-reset-tokens', b'2.352s'), (b'x-request-id', b'req_e563aa9e344c5dd8e091cbbea8807505'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f40185c07ca28-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:50:49,379 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:50:49,380 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:50:49,380 - DEBUG - receive_response_body.complete
2024-10-15 13:50:49,380 - DEBUG - response_closed.started
2024-10-15 13:50:49,380 - DEBUG - response_closed.complete
2024-10-15 13:50:49,381 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 10:50:49 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '809', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9997', 'x-ratelimit-remaining-tokens': '9608', 'x-ratelimit-reset-requests': '17.384s', 'x-ratelimit-reset-tokens': '2.352s', 'x-request-id': 'req_e563aa9e344c5dd8e091cbbea8807505', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f40185c07ca28-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 13:50:49,381 - DEBUG - request_id: req_e563aa9e344c5dd8e091cbbea8807505
2024-10-15 13:50:49,382 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZQXDgbBekR8ljknb0xjYeoYVyqC', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_hJLEBKY6ESsiGXwI1iw1YUB6', function=Function(arguments='\n{\n  "action": "determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728989449, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=13, prompt_tokens=360, total_tokens=373, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:50:51,362 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: Yes\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 13:50:51,362 - DEBUG - max_retries: 1
2024-10-15 13:50:51,364 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: Yes\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 13:50:51,365 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:50:51,365 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:50:51,365 - DEBUG - send_request_headers.complete
2024-10-15 13:50:51,365 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:50:51,366 - DEBUG - send_request_body.complete
2024-10-15 13:50:51,366 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:50:52,564 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:50:53 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1047'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9997'), (b'x-ratelimit-remaining-tokens', b'9608'), (b'x-ratelimit-reset-requests', b'23.086s'), (b'x-ratelimit-reset-tokens', b'2.352s'), (b'x-request-id', b'req_4a3e058aa4d0cd2eebdd39053087fde0'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f402ab81dca28-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:50:52,565 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:50:52,566 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:50:52,566 - DEBUG - receive_response_body.complete
2024-10-15 13:50:52,566 - DEBUG - response_closed.started
2024-10-15 13:50:52,566 - DEBUG - response_closed.complete
2024-10-15 13:50:52,567 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 10:50:53 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1047', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9997', 'x-ratelimit-remaining-tokens': '9608', 'x-ratelimit-reset-requests': '23.086s', 'x-ratelimit-reset-tokens': '2.352s', 'x-request-id': 'req_4a3e058aa4d0cd2eebdd39053087fde0', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f402ab81dca28-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 13:50:52,567 - DEBUG - request_id: req_4a3e058aa4d0cd2eebdd39053087fde0
2024-10-15 13:50:52,568 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZQaGD04QDIgLFvzx8v0xyRQynKj', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_cZCbD58CXJb65f9LA7zTdvR9', function=Function(arguments='\n    {\n        "action": "identify_parties"\n    }', name='AgentAction'), type='function')]))], created=1728989452, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=14, prompt_tokens=360, total_tokens=374, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:50:52,571 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.ContractParties'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    For a it contract, show the roles available for the following parties based on their personal information:\n\n    Name: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B\n\n    Your task is to show the roles available for each person in the context of a it contract. \n    The human will pick one of the roles.\n    '}], 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'$defs': {'ContractParty': {'properties': {'name': {'description': 'Name of the party', 'title': 'Name', 'type': 'string'}, 'role': {'description': 'Role of the party in the contract', 'title': 'Role', 'type': 'string'}}, 'required': ['name', 'role'], 'title': 'ContractParty', 'type': 'object'}}, 'properties': {'parties': {'description': 'List of parties involved in the contract', 'items': {'$ref': '#/$defs/ContractParty'}, 'title': 'Parties', 'type': 'array'}}, 'required': ['parties'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}}
2024-10-15 13:50:52,571 - DEBUG - max_retries: 1
2024-10-15 13:50:52,575 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    For a it contract, show the roles available for the following parties based on their personal information:\n\n    Name: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B\n\n    Your task is to show the roles available for each person in the context of a it contract. \n    The human will pick one of the roles.\n    '}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}, 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'$defs': {'ContractParty': {'properties': {'name': {'description': 'Name of the party', 'title': 'Name', 'type': 'string'}, 'role': {'description': 'Role of the party in the contract', 'title': 'Role', 'type': 'string'}}, 'required': ['name', 'role'], 'title': 'ContractParty', 'type': 'object'}}, 'properties': {'parties': {'description': 'List of parties involved in the contract', 'items': {'$ref': '#/$defs/ContractParty'}, 'title': 'Parties', 'type': 'array'}}, 'required': ['parties'], 'type': 'object'}}}]}}
2024-10-15 13:50:52,575 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:50:52,575 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:50:52,576 - DEBUG - send_request_headers.complete
2024-10-15 13:50:52,576 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:50:52,576 - DEBUG - send_request_body.complete
2024-10-15 13:50:52,576 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:50:55,801 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:50:56 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'3055'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9996'), (b'x-ratelimit-remaining-tokens', b'9449'), (b'x-ratelimit-reset-requests', b'30.509s'), (b'x-ratelimit-reset-tokens', b'3.3s'), (b'x-request-id', b'req_5885dfa4ca709cf8fa19d2daea6003e6'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f4032480dca28-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:50:55,802 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:50:55,802 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:50:55,802 - DEBUG - receive_response_body.complete
2024-10-15 13:50:55,802 - DEBUG - response_closed.started
2024-10-15 13:50:55,802 - DEBUG - response_closed.complete
2024-10-15 13:50:55,802 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 10:50:56 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '3055', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9996', 'x-ratelimit-remaining-tokens': '9449', 'x-ratelimit-reset-requests': '30.509s', 'x-ratelimit-reset-tokens': '3.3s', 'x-request-id': 'req_5885dfa4ca709cf8fa19d2daea6003e6', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f4032480dca28-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 13:50:55,802 - DEBUG - request_id: req_5885dfa4ca709cf8fa19d2daea6003e6
2024-10-15 13:50:55,803 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZQbe6q7YPKaYFPHUdY5ANgultqg', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_3vHMV9xFTTHBii9S9Nqq0t1e', function=Function(arguments='\n{\n  "parties": [\n    {\n      "name": "ISPILANTE SENTIMENT BRUSLI",\n      "role": "Client"\n    },\n    {\n      "name": "ELENA VASILESCU",\n      "role": "IT Service Provider"\n    }\n  ]\n}', name='ContractParties'), type='function')]))], created=1728989453, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=63, prompt_tokens=393, total_tokens=456, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:52:04,904 - DEBUG - close.started
2024-10-15 13:52:04,904 - DEBUG - close.complete
2024-10-15 13:52:32,002 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-15 13:52:33,251 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-15 13:52:33,251 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-15 13:52:33,562 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-15 13:52:33,563 - DEBUG - Using proactor: IocpProactor
2024-10-15 13:52:33,589 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 13:52:33,589 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 13:52:33,589 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 13:52:33,589 - DEBUG - Compression method 0
2024-10-15 13:52:33,590 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 13:52:33,590 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 13:52:33,590 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 13:52:33,590 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 13:52:33,590 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 13:52:33,590 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 13:52:33,590 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 13:52:33,590 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 13:52:33,590 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 13:52:33,590 - DEBUG - Compression method 0
2024-10-15 13:52:33,590 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 13:52:33,590 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 13:52:33,590 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 13:52:33,590 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 13:52:33,590 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 13:52:33,590 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 13:52:33,600 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 13:52:33,600 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 13:52:33,600 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 13:52:33,600 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 13:52:33,601 - DEBUG - Error closing: Operation on closed image
2024-10-15 13:52:35,583 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 13:52:35,583 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 13:52:35,583 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 13:52:35,583 - DEBUG - Compression method 0
2024-10-15 13:52:35,583 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 13:52:35,583 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 13:52:35,583 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 13:52:35,583 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 13:52:35,583 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 13:52:35,583 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 13:52:35,583 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 13:52:35,583 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 13:52:35,583 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 13:52:35,583 - DEBUG - Compression method 0
2024-10-15 13:52:35,583 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 13:52:35,583 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 13:52:35,583 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 13:52:35,583 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 13:52:35,583 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 13:52:35,583 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 13:52:35,600 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 13:52:35,600 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 13:52:35,600 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 13:52:35,600 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 13:52:35,601 - DEBUG - Error closing: Operation on closed image
2024-10-15 13:52:38,078 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'instructor.dsl.simple_type.Response'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}}
2024-10-15 13:52:38,079 - DEBUG - max_retries: 1
2024-10-15 13:52:38,081 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}, 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}]}}
2024-10-15 13:52:38,118 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:52:38,119 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-15 13:52:38,197 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x0000024D7EEC48F0>
2024-10-15 13:52:38,197 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x0000024D1422E7D0> server_hostname='api.openai.com' timeout=5.0
2024-10-15 13:52:38,209 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x0000024D7FFA7650>
2024-10-15 13:52:38,209 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:52:38,209 - DEBUG - send_request_headers.complete
2024-10-15 13:52:38,209 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:52:38,209 - DEBUG - send_request_body.complete
2024-10-15 13:52:38,209 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:52:40,607 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:52:41 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2236'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'9569'), (b'x-ratelimit-reset-requests', b'8.64s'), (b'x-ratelimit-reset-tokens', b'2.586s'), (b'x-request-id', b'req_bb1efff78d7394e011d2606e4132d69a'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=r2Rxjgj6zv4U9FLZG5bzoA2Lt9n58qx4vpxZ6MKweng-1728989561-1.0.1.1-wvIzGpTO3RYsnnKO7p_ZVEwQ4P6pgCDMMmhaPn_jUOWKacmdq6Px2tcK_acPg77Akv16DzTuFq9E0tJBm4qTQA; path=/; expires=Tue, 15-Oct-24 11:22:41 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=Mt4czCPonYocLzGdytFDs3pULHPBkmsc_G_zTrm.dA8-1728989561198-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f42c68a2cc9e9-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:52:40,607 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:52:40,608 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:52:40,608 - DEBUG - receive_response_body.complete
2024-10-15 13:52:40,608 - DEBUG - response_closed.started
2024-10-15 13:52:40,608 - DEBUG - response_closed.complete
2024-10-15 13:52:40,608 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Tue, 15 Oct 2024 10:52:41 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-kzzh9hik9ryjiou4ftvhondh'), ('openai-processing-ms', '2236'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '10000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '9569'), ('x-ratelimit-reset-requests', '8.64s'), ('x-ratelimit-reset-tokens', '2.586s'), ('x-request-id', 'req_bb1efff78d7394e011d2606e4132d69a'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=r2Rxjgj6zv4U9FLZG5bzoA2Lt9n58qx4vpxZ6MKweng-1728989561-1.0.1.1-wvIzGpTO3RYsnnKO7p_ZVEwQ4P6pgCDMMmhaPn_jUOWKacmdq6Px2tcK_acPg77Akv16DzTuFq9E0tJBm4qTQA; path=/; expires=Tue, 15-Oct-24 11:22:41 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=Mt4czCPonYocLzGdytFDs3pULHPBkmsc_G_zTrm.dA8-1728989561198-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d2f42c68a2cc9e9-OTP'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-15 13:52:40,608 - DEBUG - request_id: req_bb1efff78d7394e011d2606e4132d69a
2024-10-15 13:52:40,610 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZSIo4UztSQuPfJ9vC46q1QoYQIu', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_gJ9MQmlrssFNgb14kCw1kug8', function=Function(arguments='{\n  "content": [\n    {\n      "name": "ISPILANTE SENTIMENT BRUSLI",\n      "address": "Videle Jud: Teleorman Sos. Giurgiului nr.1"\n    }\n  ]\n}', name='Response'), type='function')]))], created=1728989558, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=50, prompt_tokens=472, total_tokens=522, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:52:40,611 - DEBUG - Returning model from AdapterBase
2024-10-15 13:52:42,175 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'instructor.dsl.simple_type.Response'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}}
2024-10-15 13:52:42,175 - DEBUG - max_retries: 1
2024-10-15 13:52:42,177 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}, 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}]}}
2024-10-15 13:52:42,178 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:52:42,178 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:52:42,178 - DEBUG - send_request_headers.complete
2024-10-15 13:52:42,178 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:52:42,179 - DEBUG - send_request_body.complete
2024-10-15 13:52:42,179 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:52:45,488 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:52:46 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'3162'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9998'), (b'x-ratelimit-remaining-tokens', b'9576'), (b'x-ratelimit-reset-requests', b'13.317s'), (b'x-ratelimit-reset-tokens', b'2.544s'), (b'x-request-id', b'req_39b7451fbc0f1c0ca0d5ab8489eec62b'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f42df5a25c9e9-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:52:45,489 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:52:45,490 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:52:45,490 - DEBUG - receive_response_body.complete
2024-10-15 13:52:45,490 - DEBUG - response_closed.started
2024-10-15 13:52:45,490 - DEBUG - response_closed.complete
2024-10-15 13:52:45,491 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 10:52:46 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '3162', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9998', 'x-ratelimit-remaining-tokens': '9576', 'x-ratelimit-reset-requests': '13.317s', 'x-ratelimit-reset-tokens': '2.544s', 'x-request-id': 'req_39b7451fbc0f1c0ca0d5ab8489eec62b', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f42df5a25c9e9-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 13:52:45,491 - DEBUG - request_id: req_39b7451fbc0f1c0ca0d5ab8489eec62b
2024-10-15 13:52:45,492 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZSMvisnUAY75PIzZ80EKyh5hvaI', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_KdJ5cVHX1nuDQfoU5YFPxEz0', function=Function(arguments='{\n  "content": [\n    {\n      "name": "ELENA VASILESCU",\n      "address": "Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B"\n    }\n  ]\n}', name='Response'), type='function')]))], created=1728989562, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=56, prompt_tokens=475, total_tokens=531, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:52:45,493 - DEBUG - Returning model from AdapterBase
2024-10-15 13:52:46,848 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 13:52:46,848 - DEBUG - max_retries: 1
2024-10-15 13:52:46,850 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 13:52:46,850 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:52:46,850 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:52:46,851 - DEBUG - send_request_headers.complete
2024-10-15 13:52:46,851 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:52:46,851 - DEBUG - send_request_body.complete
2024-10-15 13:52:46,851 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:52:47,850 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:52:48 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'854'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9997'), (b'x-ratelimit-remaining-tokens', b'9608'), (b'x-ratelimit-reset-requests', b'17.3s'), (b'x-ratelimit-reset-tokens', b'2.352s'), (b'x-request-id', b'req_77dd948a242f51bd8e4ccbca36008782'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f42fc8c2ec9e9-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:52:47,850 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:52:47,850 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:52:47,851 - DEBUG - receive_response_body.complete
2024-10-15 13:52:47,851 - DEBUG - response_closed.started
2024-10-15 13:52:47,851 - DEBUG - response_closed.complete
2024-10-15 13:52:47,851 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 10:52:48 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '854', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9997', 'x-ratelimit-remaining-tokens': '9608', 'x-ratelimit-reset-requests': '17.3s', 'x-ratelimit-reset-tokens': '2.352s', 'x-request-id': 'req_77dd948a242f51bd8e4ccbca36008782', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f42fc8c2ec9e9-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 13:52:47,851 - DEBUG - request_id: req_77dd948a242f51bd8e4ccbca36008782
2024-10-15 13:52:47,851 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZSR3cmrTsKUTuMThhKY9S9YbqC3', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_HopoVWiUdxMyIjGTqBhGQj5E', function=Function(arguments='\n{\n  "action": "determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728989567, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=13, prompt_tokens=360, total_tokens=373, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:52:51,577 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: Yes\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 13:52:51,577 - DEBUG - max_retries: 1
2024-10-15 13:52:51,579 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: Yes\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 13:52:51,580 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:52:51,580 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:52:51,580 - DEBUG - send_request_headers.complete
2024-10-15 13:52:51,580 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:52:51,581 - DEBUG - send_request_body.complete
2024-10-15 13:52:51,581 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:52:52,715 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:52:53 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'989'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9997'), (b'x-ratelimit-remaining-tokens', b'9608'), (b'x-ratelimit-reset-requests', b'21.198s'), (b'x-ratelimit-reset-tokens', b'2.352s'), (b'x-request-id', b'req_253b3c4ba775cd382726987b499c0f26'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f431a1be9c9e9-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:52:52,715 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:52:52,715 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:52:52,715 - DEBUG - receive_response_body.complete
2024-10-15 13:52:52,715 - DEBUG - response_closed.started
2024-10-15 13:52:52,715 - DEBUG - response_closed.complete
2024-10-15 13:52:52,715 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 10:52:53 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '989', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9997', 'x-ratelimit-remaining-tokens': '9608', 'x-ratelimit-reset-requests': '21.198s', 'x-ratelimit-reset-tokens': '2.352s', 'x-request-id': 'req_253b3c4ba775cd382726987b499c0f26', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f431a1be9c9e9-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 13:52:52,715 - DEBUG - request_id: req_253b3c4ba775cd382726987b499c0f26
2024-10-15 13:52:52,715 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZSWmwxBHsIKsdchgQyxY6gJLYxS', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_A9s2lA8EdkggMxOISgifBI7g', function=Function(arguments='{\n  "action": "identify_parties"\n}', name='AgentAction'), type='function')]))], created=1728989572, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=11, prompt_tokens=360, total_tokens=371, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:52:52,717 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.ContractParties'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    For a it contract, show the roles available for the following parties based on their personal information:\n\n    Name: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B\n\n    Your task is to show the roles available for each person in the context of a it contract. \n    The human will pick one of the roles.\n    '}], 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'$defs': {'ContractParty': {'properties': {'name': {'description': 'Name of the party', 'title': 'Name', 'type': 'string'}, 'role': {'description': 'Role of the party in the contract', 'title': 'Role', 'type': 'string'}}, 'required': ['name', 'role'], 'title': 'ContractParty', 'type': 'object'}}, 'properties': {'parties': {'description': 'List of parties involved in the contract', 'items': {'$ref': '#/$defs/ContractParty'}, 'title': 'Parties', 'type': 'array'}}, 'required': ['parties'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}}
2024-10-15 13:52:52,717 - DEBUG - max_retries: 1
2024-10-15 13:52:52,719 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    For a it contract, show the roles available for the following parties based on their personal information:\n\n    Name: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B\n\n    Your task is to show the roles available for each person in the context of a it contract. \n    The human will pick one of the roles.\n    '}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}, 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'$defs': {'ContractParty': {'properties': {'name': {'description': 'Name of the party', 'title': 'Name', 'type': 'string'}, 'role': {'description': 'Role of the party in the contract', 'title': 'Role', 'type': 'string'}}, 'required': ['name', 'role'], 'title': 'ContractParty', 'type': 'object'}}, 'properties': {'parties': {'description': 'List of parties involved in the contract', 'items': {'$ref': '#/$defs/ContractParty'}, 'title': 'Parties', 'type': 'array'}}, 'required': ['parties'], 'type': 'object'}}}]}}
2024-10-15 13:52:52,719 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:52:52,720 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:52:52,720 - DEBUG - send_request_headers.complete
2024-10-15 13:52:52,720 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:52:52,720 - DEBUG - send_request_body.complete
2024-10-15 13:52:52,720 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:52:55,191 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:52:55 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2322'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9996'), (b'x-ratelimit-remaining-tokens', b'9443'), (b'x-ratelimit-reset-requests', b'28.69s'), (b'x-ratelimit-reset-tokens', b'3.34s'), (b'x-request-id', b'req_20b59175774b5c03b0d8a19379696db3'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f432139c9c9e9-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:52:55,192 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:52:55,192 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:52:55,192 - DEBUG - receive_response_body.complete
2024-10-15 13:52:55,192 - DEBUG - response_closed.started
2024-10-15 13:52:55,192 - DEBUG - response_closed.complete
2024-10-15 13:52:55,192 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 10:52:55 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '2322', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9996', 'x-ratelimit-remaining-tokens': '9443', 'x-ratelimit-reset-requests': '28.69s', 'x-ratelimit-reset-tokens': '3.34s', 'x-request-id': 'req_20b59175774b5c03b0d8a19379696db3', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f432139c9c9e9-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 13:52:55,192 - DEBUG - request_id: req_20b59175774b5c03b0d8a19379696db3
2024-10-15 13:52:55,193 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZSXmHTm8N1bd3YQx05SMA3cnJ3O', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_vjWQe4TmcHVS5jRXMYDe0hk7', function=Function(arguments='\n{\n  "parties": [\n    {\n      "name": "ISPILANTE SENTIMENT BRUSLI",\n      "role": "Client"\n    },\n    {\n      "name": "ELENA VASILESCU",\n      "role": "Service Provider"\n    }\n  ]\n}', name='ContractParties'), type='function')]))], created=1728989573, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=62, prompt_tokens=390, total_tokens=452, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:53:05,909 - DEBUG - close.started
2024-10-15 13:53:05,909 - DEBUG - close.complete
2024-10-15 13:54:46,886 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-15 13:54:48,159 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-15 13:54:48,159 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-15 13:54:48,477 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-15 13:54:48,478 - DEBUG - Using proactor: IocpProactor
2024-10-15 13:54:48,504 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 13:54:48,504 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 13:54:48,504 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 13:54:48,505 - DEBUG - Compression method 0
2024-10-15 13:54:48,505 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 13:54:48,505 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 13:54:48,505 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 13:54:48,505 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 13:54:48,505 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 13:54:48,505 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 13:54:48,505 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 13:54:48,505 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 13:54:48,505 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 13:54:48,505 - DEBUG - Compression method 0
2024-10-15 13:54:48,505 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 13:54:48,505 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 13:54:48,505 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 13:54:48,505 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 13:54:48,505 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 13:54:48,505 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 13:54:48,514 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 13:54:48,514 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 13:54:48,514 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 13:54:48,514 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 13:54:48,515 - DEBUG - Error closing: Operation on closed image
2024-10-15 13:54:50,505 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 13:54:50,505 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 13:54:50,505 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 13:54:50,506 - DEBUG - Compression method 0
2024-10-15 13:54:50,506 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 13:54:50,506 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 13:54:50,506 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 13:54:50,506 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 13:54:50,506 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 13:54:50,506 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 13:54:50,506 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 13:54:50,506 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 13:54:50,506 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 13:54:50,506 - DEBUG - Compression method 0
2024-10-15 13:54:50,506 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 13:54:50,506 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 13:54:50,506 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 13:54:50,506 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 13:54:50,506 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 13:54:50,506 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 13:54:50,523 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 13:54:50,523 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 13:54:50,523 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 13:54:50,523 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 13:54:50,524 - DEBUG - Error closing: Operation on closed image
2024-10-15 13:54:53,014 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'instructor.dsl.simple_type.Response'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n3. Determine_contract_type: Determine the type of contract to be created.\n4. Construct_contract: Construct a contract using the provided information and templates.\n5. Finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}}
2024-10-15 13:54:53,015 - DEBUG - max_retries: 1
2024-10-15 13:54:53,017 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n3. Determine_contract_type: Determine the type of contract to be created.\n4. Construct_contract: Construct a contract using the provided information and templates.\n5. Finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}, 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}]}}
2024-10-15 13:54:53,051 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:54:53,052 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-15 13:54:53,110 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001A530055F10>
2024-10-15 13:54:53,110 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x000001A5302CE7D0> server_hostname='api.openai.com' timeout=5.0
2024-10-15 13:54:53,121 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001A50273E450>
2024-10-15 13:54:53,122 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:54:53,122 - DEBUG - send_request_headers.complete
2024-10-15 13:54:53,122 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:54:53,122 - DEBUG - send_request_body.complete
2024-10-15 13:54:53,122 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:54:55,727 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:54:56 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2437'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'9569'), (b'x-ratelimit-reset-requests', b'8.64s'), (b'x-ratelimit-reset-tokens', b'2.586s'), (b'x-request-id', b'req_8adbcf023fa64c085deba6e5e61ef876'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=U3s6s6vw67lykeHzqiqwRjY281aiVrCg.jtAu4VxBxU-1728989696-1.0.1.1-jKWOqHZPiA00Ka4nXmsLC_01I20iOZDUrPWmo33PR2o5C57vVfnIbBDf5re7ALHz.QCQz3KwUGeIRYwO0AhrVg; path=/; expires=Tue, 15-Oct-24 11:24:56 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=EYRkYup4xytv04N9lqCvct89I4XlYVa6MbfCNx5o_6w-1728989696325-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f4611ca1a627d-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:54:55,727 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:54:55,727 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:54:55,727 - DEBUG - receive_response_body.complete
2024-10-15 13:54:55,727 - DEBUG - response_closed.started
2024-10-15 13:54:55,728 - DEBUG - response_closed.complete
2024-10-15 13:54:55,728 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Tue, 15 Oct 2024 10:54:56 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-kzzh9hik9ryjiou4ftvhondh'), ('openai-processing-ms', '2437'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '10000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '9569'), ('x-ratelimit-reset-requests', '8.64s'), ('x-ratelimit-reset-tokens', '2.586s'), ('x-request-id', 'req_8adbcf023fa64c085deba6e5e61ef876'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=U3s6s6vw67lykeHzqiqwRjY281aiVrCg.jtAu4VxBxU-1728989696-1.0.1.1-jKWOqHZPiA00Ka4nXmsLC_01I20iOZDUrPWmo33PR2o5C57vVfnIbBDf5re7ALHz.QCQz3KwUGeIRYwO0AhrVg; path=/; expires=Tue, 15-Oct-24 11:24:56 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=EYRkYup4xytv04N9lqCvct89I4XlYVa6MbfCNx5o_6w-1728989696325-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d2f4611ca1a627d-OTP'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-15 13:54:55,728 - DEBUG - request_id: req_8adbcf023fa64c085deba6e5e61ef876
2024-10-15 13:54:55,729 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZUTVfPAI0T2owdbZIqeSr6aaYwX', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_EmEFHheVRg01PgEQdgeuhYrE', function=Function(arguments='{\n  "content": [\n    {\n      "name": "ISPILANTE SENTIMENT BRUSLI",\n      "address": "Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR"\n    }\n  ]\n}', name='Response'), type='function')]))], created=1728989693, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=53, prompt_tokens=473, total_tokens=526, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:54:55,730 - DEBUG - Returning model from AdapterBase
2024-10-15 13:54:57,138 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'instructor.dsl.simple_type.Response'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n3. Determine_contract_type: Determine the type of contract to be created.\n4. Construct_contract: Construct a contract using the provided information and templates.\n5. Finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}}
2024-10-15 13:54:57,139 - DEBUG - max_retries: 1
2024-10-15 13:54:57,141 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n3. Determine_contract_type: Determine the type of contract to be created.\n4. Construct_contract: Construct a contract using the provided information and templates.\n5. Finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}, 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}]}}
2024-10-15 13:54:57,141 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:54:57,141 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:54:57,142 - DEBUG - send_request_headers.complete
2024-10-15 13:54:57,142 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:54:57,142 - DEBUG - send_request_body.complete
2024-10-15 13:54:57,142 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:54:59,811 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:55:00 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2517'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9998'), (b'x-ratelimit-remaining-tokens', b'9575'), (b'x-ratelimit-reset-requests', b'13.26s'), (b'x-ratelimit-reset-tokens', b'2.55s'), (b'x-request-id', b'req_c59f51e184da9ba99de1db0fa7b61f79'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f462aee06627d-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:54:59,812 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:54:59,813 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:54:59,813 - DEBUG - receive_response_body.complete
2024-10-15 13:54:59,813 - DEBUG - response_closed.started
2024-10-15 13:54:59,813 - DEBUG - response_closed.complete
2024-10-15 13:54:59,814 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 10:55:00 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '2517', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9998', 'x-ratelimit-remaining-tokens': '9575', 'x-ratelimit-reset-requests': '13.26s', 'x-ratelimit-reset-tokens': '2.55s', 'x-request-id': 'req_c59f51e184da9ba99de1db0fa7b61f79', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f462aee06627d-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 13:54:59,814 - DEBUG - request_id: req_c59f51e184da9ba99de1db0fa7b61f79
2024-10-15 13:54:59,815 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZUXzWUO8pOk72MIQxK3Kwn21XKX', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_xRHmTaK3aOCIGdHoLdpYhLUp', function=Function(arguments='{\n  "content": [\n    {\n      "name": "ELENA VASILESCU",\n      "address": "Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3"\n    }\n  ]\n}', name='Response'), type='function')]))], created=1728989697, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=53, prompt_tokens=476, total_tokens=529, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:54:59,817 - DEBUG - Returning model from AdapterBase
2024-10-15 13:55:00,699 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n3. Determine_contract_type: Determine the type of contract to be created.\n4. Construct_contract: Construct a contract using the provided information and templates.\n5. Finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 13:55:00,699 - DEBUG - max_retries: 1
2024-10-15 13:55:00,701 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n3. Determine_contract_type: Determine the type of contract to be created.\n4. Construct_contract: Construct a contract using the provided information and templates.\n5. Finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 13:55:00,702 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:55:00,702 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:55:00,702 - DEBUG - send_request_headers.complete
2024-10-15 13:55:00,702 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:55:00,702 - DEBUG - send_request_body.complete
2024-10-15 13:55:00,702 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:55:01,721 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:55:02 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'835'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9997'), (b'x-ratelimit-remaining-tokens', b'9607'), (b'x-ratelimit-reset-requests', b'18.332s'), (b'x-ratelimit-reset-tokens', b'2.358s'), (b'x-request-id', b'req_0ec8502cf6b601ced58121437c8ca6ea'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f46412f9c627d-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:55:01,721 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:55:01,722 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:55:01,722 - DEBUG - receive_response_body.complete
2024-10-15 13:55:01,722 - DEBUG - response_closed.started
2024-10-15 13:55:01,722 - DEBUG - response_closed.complete
2024-10-15 13:55:01,722 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 10:55:02 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '835', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9997', 'x-ratelimit-remaining-tokens': '9607', 'x-ratelimit-reset-requests': '18.332s', 'x-ratelimit-reset-tokens': '2.358s', 'x-request-id': 'req_0ec8502cf6b601ced58121437c8ca6ea', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f46412f9c627d-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 13:55:01,722 - DEBUG - request_id: req_0ec8502cf6b601ced58121437c8ca6ea
2024-10-15 13:55:01,722 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZUbyPitkG9GBppjs6o7LkBrjI9i', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_Uu5HZPAR7hBZAKynVDdgYR6T', function=Function(arguments='{\n  "action": "Determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728989701, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=12, prompt_tokens=361, total_tokens=373, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:55:01,724 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n3. Determine_contract_type: Determine the type of contract to be created.\n4. Construct_contract: Construct a contract using the provided information and templates.\n5. Finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 13:55:01,724 - DEBUG - max_retries: 1
2024-10-15 13:55:01,726 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n3. Determine_contract_type: Determine the type of contract to be created.\n4. Construct_contract: Construct a contract using the provided information and templates.\n5. Finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 13:55:01,727 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:55:01,727 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:55:01,727 - DEBUG - send_request_headers.complete
2024-10-15 13:55:01,727 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:55:01,727 - DEBUG - send_request_body.complete
2024-10-15 13:55:01,727 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:55:02,806 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:55:03 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'917'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9996'), (b'x-ratelimit-remaining-tokens', b'9404'), (b'x-ratelimit-reset-requests', b'25.951s'), (b'x-ratelimit-reset-tokens', b'3.574s'), (b'x-request-id', b'req_add16a75c7c259115874c04848b36de3'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f46478cd0627d-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:55:02,807 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:55:02,807 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:55:02,808 - DEBUG - receive_response_body.complete
2024-10-15 13:55:02,808 - DEBUG - response_closed.started
2024-10-15 13:55:02,808 - DEBUG - response_closed.complete
2024-10-15 13:55:02,808 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 10:55:03 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '917', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9996', 'x-ratelimit-remaining-tokens': '9404', 'x-ratelimit-reset-requests': '25.951s', 'x-ratelimit-reset-tokens': '3.574s', 'x-request-id': 'req_add16a75c7c259115874c04848b36de3', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f46478cd0627d-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 13:55:02,808 - DEBUG - request_id: req_add16a75c7c259115874c04848b36de3
2024-10-15 13:55:02,809 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZUcWDBIkBnokTi7mg1waT9MD0Gj', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_ChCDVcItJIrLAJTUSpGUtW1Y', function=Function(arguments='\n{\n  "action": "Determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728989702, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=13, prompt_tokens=361, total_tokens=374, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:55:02,813 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n3. Determine_contract_type: Determine the type of contract to be created.\n4. Construct_contract: Construct a contract using the provided information and templates.\n5. Finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 13:55:02,814 - DEBUG - max_retries: 1
2024-10-15 13:55:02,818 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n3. Determine_contract_type: Determine the type of contract to be created.\n4. Construct_contract: Construct a contract using the provided information and templates.\n5. Finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 13:55:02,819 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:55:02,819 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:55:02,820 - DEBUG - send_request_headers.complete
2024-10-15 13:55:02,820 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:55:02,820 - DEBUG - send_request_body.complete
2024-10-15 13:55:02,820 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:55:03,756 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:55:04 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'776'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9996'), (b'x-ratelimit-remaining-tokens', b'9211'), (b'x-ratelimit-reset-requests', b'33.504s'), (b'x-ratelimit-reset-tokens', b'4.731s'), (b'x-request-id', b'req_e66eaeeb2cf0d16358e5a3247a3a3112'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f464e6b11627d-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:55:03,757 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:55:03,757 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:55:03,758 - DEBUG - receive_response_body.complete
2024-10-15 13:55:03,758 - DEBUG - response_closed.started
2024-10-15 13:55:03,758 - DEBUG - response_closed.complete
2024-10-15 13:55:03,758 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 10:55:04 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '776', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9996', 'x-ratelimit-remaining-tokens': '9211', 'x-ratelimit-reset-requests': '33.504s', 'x-ratelimit-reset-tokens': '4.731s', 'x-request-id': 'req_e66eaeeb2cf0d16358e5a3247a3a3112', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f464e6b11627d-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 13:55:03,758 - DEBUG - request_id: req_e66eaeeb2cf0d16358e5a3247a3a3112
2024-10-15 13:55:03,759 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZUdbSKPtPN6V6lyaxLNW8Glv9Pa', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_vXz2IORnz8M8EAFJ6I8OE1Vc', function=Function(arguments='{\n  "action": "Determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728989703, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=12, prompt_tokens=361, total_tokens=373, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:55:03,762 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n3. Determine_contract_type: Determine the type of contract to be created.\n4. Construct_contract: Construct a contract using the provided information and templates.\n5. Finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 13:55:03,763 - DEBUG - max_retries: 1
2024-10-15 13:55:03,765 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n3. Determine_contract_type: Determine the type of contract to be created.\n4. Construct_contract: Construct a contract using the provided information and templates.\n5. Finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 13:55:03,765 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:55:03,766 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:55:03,766 - DEBUG - send_request_headers.complete
2024-10-15 13:55:03,766 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:55:03,766 - DEBUG - send_request_body.complete
2024-10-15 13:55:03,766 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:55:04,702 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:55:05 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'788'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9995'), (b'x-ratelimit-remaining-tokens', b'8996'), (b'x-ratelimit-reset-requests', b'41.198s'), (b'x-ratelimit-reset-tokens', b'6.023s'), (b'x-request-id', b'req_e865e3cb55fbb3bb8fa9c955fe67d0ce'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f46544fd3627d-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:55:04,703 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:55:04,704 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:55:04,704 - DEBUG - receive_response_body.complete
2024-10-15 13:55:04,704 - DEBUG - response_closed.started
2024-10-15 13:55:04,704 - DEBUG - response_closed.complete
2024-10-15 13:55:04,705 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 10:55:05 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '788', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9995', 'x-ratelimit-remaining-tokens': '8996', 'x-ratelimit-reset-requests': '41.198s', 'x-ratelimit-reset-tokens': '6.023s', 'x-request-id': 'req_e865e3cb55fbb3bb8fa9c955fe67d0ce', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f46544fd3627d-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 13:55:04,705 - DEBUG - request_id: req_e865e3cb55fbb3bb8fa9c955fe67d0ce
2024-10-15 13:55:04,706 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZUeFz7zVNb3GdkOdrOxpRarD82M', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_CQ5twNwdHPLuyoHBqLVQvcME', function=Function(arguments='\n{\n  "action": "Determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728989704, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=13, prompt_tokens=361, total_tokens=374, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:55:04,709 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n3. Determine_contract_type: Determine the type of contract to be created.\n4. Construct_contract: Construct a contract using the provided information and templates.\n5. Finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 13:55:04,709 - DEBUG - max_retries: 1
2024-10-15 13:55:04,712 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n3. Determine_contract_type: Determine the type of contract to be created.\n4. Construct_contract: Construct a contract using the provided information and templates.\n5. Finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 13:55:04,712 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:55:04,713 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:55:04,713 - DEBUG - send_request_headers.complete
2024-10-15 13:55:04,713 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:55:04,713 - DEBUG - send_request_body.complete
2024-10-15 13:55:04,713 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:55:05,568 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:55:06 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'698'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9994'), (b'x-ratelimit-remaining-tokens', b'8780'), (b'x-ratelimit-reset-requests', b'48.887s'), (b'x-ratelimit-reset-tokens', b'7.316s'), (b'x-request-id', b'req_5071e1bb0364f6e0ec7895f40ba5cfe1'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f465a3c37627d-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:55:05,568 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:55:05,568 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:55:05,568 - DEBUG - receive_response_body.complete
2024-10-15 13:55:05,568 - DEBUG - response_closed.started
2024-10-15 13:55:05,568 - DEBUG - response_closed.complete
2024-10-15 13:55:05,568 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 10:55:06 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '698', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9994', 'x-ratelimit-remaining-tokens': '8780', 'x-ratelimit-reset-requests': '48.887s', 'x-ratelimit-reset-tokens': '7.316s', 'x-request-id': 'req_5071e1bb0364f6e0ec7895f40ba5cfe1', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f465a3c37627d-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 13:55:05,568 - DEBUG - request_id: req_5071e1bb0364f6e0ec7895f40ba5cfe1
2024-10-15 13:55:05,569 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZUfULtFKi2SVkxGiyhb74KXhLXw', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_alC5SwnWuPJhGVNV9DYG8AEs', function=Function(arguments='{\n"action": "Determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728989705, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=11, prompt_tokens=361, total_tokens=372, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:55:05,570 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n3. Determine_contract_type: Determine the type of contract to be created.\n4. Construct_contract: Construct a contract using the provided information and templates.\n5. Finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 13:55:05,570 - DEBUG - max_retries: 1
2024-10-15 13:55:05,571 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n3. Determine_contract_type: Determine the type of contract to be created.\n4. Construct_contract: Construct a contract using the provided information and templates.\n5. Finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 13:55:05,572 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:55:05,572 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:55:05,572 - DEBUG - send_request_headers.complete
2024-10-15 13:55:05,572 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:55:05,572 - DEBUG - send_request_body.complete
2024-10-15 13:55:05,572 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:55:07,126 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:55:07 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'785'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9993'), (b'x-ratelimit-remaining-tokens', b'8556'), (b'x-ratelimit-reset-requests', b'56.637s'), (b'x-ratelimit-reset-tokens', b'8.658s'), (b'x-request-id', b'req_8487d7dd99eaf0a043d92b6972593ee8'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f465f987e627d-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:55:07,127 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:55:07,127 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:55:07,128 - DEBUG - receive_response_body.complete
2024-10-15 13:55:07,128 - DEBUG - response_closed.started
2024-10-15 13:55:07,128 - DEBUG - response_closed.complete
2024-10-15 13:55:07,128 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 10:55:07 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '785', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9993', 'x-ratelimit-remaining-tokens': '8556', 'x-ratelimit-reset-requests': '56.637s', 'x-ratelimit-reset-tokens': '8.658s', 'x-request-id': 'req_8487d7dd99eaf0a043d92b6972593ee8', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f465f987e627d-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 13:55:07,128 - DEBUG - request_id: req_8487d7dd99eaf0a043d92b6972593ee8
2024-10-15 13:55:07,130 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZUgIgBMi38cGGKWpS4ctofT16vU', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_v5uxwusmVwn9pmwzdgWZIepQ', function=Function(arguments='{\n  "action": "Determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728989706, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=12, prompt_tokens=361, total_tokens=373, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:55:07,133 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n3. Determine_contract_type: Determine the type of contract to be created.\n4. Construct_contract: Construct a contract using the provided information and templates.\n5. Finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 13:55:07,133 - DEBUG - max_retries: 1
2024-10-15 13:55:07,134 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n3. Determine_contract_type: Determine the type of contract to be created.\n4. Construct_contract: Construct a contract using the provided information and templates.\n5. Finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 13:55:07,135 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:55:07,135 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:55:07,135 - DEBUG - send_request_headers.complete
2024-10-15 13:55:07,135 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:55:07,135 - DEBUG - send_request_body.complete
2024-10-15 13:55:07,135 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:55:07,937 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:55:08 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'650'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9992'), (b'x-ratelimit-remaining-tokens', b'8439'), (b'x-ratelimit-reset-requests', b'1m3.744s'), (b'x-ratelimit-reset-tokens', b'9.363s'), (b'x-request-id', b'req_7458dbbb8c7e31097d53da54801d7f0a'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f46695867627d-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:55:07,937 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:55:07,938 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:55:07,938 - DEBUG - receive_response_body.complete
2024-10-15 13:55:07,938 - DEBUG - response_closed.started
2024-10-15 13:55:07,938 - DEBUG - response_closed.complete
2024-10-15 13:55:07,938 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 10:55:08 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '650', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9992', 'x-ratelimit-remaining-tokens': '8439', 'x-ratelimit-reset-requests': '1m3.744s', 'x-ratelimit-reset-tokens': '9.363s', 'x-request-id': 'req_7458dbbb8c7e31097d53da54801d7f0a', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f46695867627d-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 13:55:07,938 - DEBUG - request_id: req_7458dbbb8c7e31097d53da54801d7f0a
2024-10-15 13:55:07,939 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZUhcXmUCzMNJhRUpgGlonZauYsJ', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_8JB8Y1MGUXDQrpDao6ImYLLW', function=Function(arguments='\n{\n  "action": "Determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728989707, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=13, prompt_tokens=361, total_tokens=374, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:55:07,941 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n3. Determine_contract_type: Determine the type of contract to be created.\n4. Construct_contract: Construct a contract using the provided information and templates.\n5. Finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 13:55:07,941 - DEBUG - max_retries: 1
2024-10-15 13:55:07,943 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n3. Determine_contract_type: Determine the type of contract to be created.\n4. Construct_contract: Construct a contract using the provided information and templates.\n5. Finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 13:55:07,944 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:55:07,944 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:55:07,944 - DEBUG - send_request_headers.complete
2024-10-15 13:55:07,944 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:55:07,944 - DEBUG - send_request_body.complete
2024-10-15 13:55:07,944 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:55:08,890 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:55:09 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'798'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9991'), (b'x-ratelimit-remaining-tokens', b'8199'), (b'x-ratelimit-reset-requests', b'1m11.579s'), (b'x-ratelimit-reset-tokens', b'10.802s'), (b'x-request-id', b'req_e8833bdffa5e284c63555ca8ee3a4700'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f466e6c86627d-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:55:08,890 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:55:08,890 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:55:08,890 - DEBUG - receive_response_body.complete
2024-10-15 13:55:08,891 - DEBUG - response_closed.started
2024-10-15 13:55:08,891 - DEBUG - response_closed.complete
2024-10-15 13:55:08,891 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 10:55:09 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '798', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9991', 'x-ratelimit-remaining-tokens': '8199', 'x-ratelimit-reset-requests': '1m11.579s', 'x-ratelimit-reset-tokens': '10.802s', 'x-request-id': 'req_e8833bdffa5e284c63555ca8ee3a4700', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f466e6c86627d-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 13:55:08,891 - DEBUG - request_id: req_e8833bdffa5e284c63555ca8ee3a4700
2024-10-15 13:55:08,891 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZUivWVZ2OzUUMkuvNTFWqcQIPcy', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_paw4v4GX8G8ozO4gWFCJQeSi', function=Function(arguments='\n{\n  "action": "Determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728989708, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=13, prompt_tokens=361, total_tokens=374, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:55:08,892 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n3. Determine_contract_type: Determine the type of contract to be created.\n4. Construct_contract: Construct a contract using the provided information and templates.\n5. Finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 13:55:08,893 - DEBUG - max_retries: 1
2024-10-15 13:55:08,894 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n3. Determine_contract_type: Determine the type of contract to be created.\n4. Construct_contract: Construct a contract using the provided information and templates.\n5. Finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 13:55:08,894 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:55:08,894 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:55:08,895 - DEBUG - send_request_headers.complete
2024-10-15 13:55:08,895 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:55:08,895 - DEBUG - send_request_body.complete
2024-10-15 13:55:08,895 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:55:09,836 - DEBUG - receive_response_headers.failed exception=KeyboardInterrupt()
2024-10-15 13:55:09,836 - DEBUG - response_closed.started
2024-10-15 13:55:09,836 - DEBUG - response_closed.complete
2024-10-15 13:55:10,009 - ERROR - Task exception was never retrieved
future: <Task finished name='Task-1' coro=<agent_workflow() done, defined at D:\deve\contract_automation\src\main.py:26> exception=KeyboardInterrupt()>
Traceback (most recent call last):
  File "D:\deve\contract_automation\src\main.py", line 100, in <module>
    asyncio.run(agent_workflow())
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 30, in run
    return loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 92, in run_until_complete
    self._run_once()
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 133, in _run_once
    handle._run()
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 386, in __wakeup
    self.__step()
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 293, in __step
    self.__step_run_and_handle_result(exc)
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 304, in __step_run_and_handle_result
    result = coro.send(None)
             ^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\src\main.py", line 42, in agent_workflow
    action = agent_action(state, templates)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\src\ai_functions.py", line 199, in agent_action
    response = client.chat.completions.create(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\instructor\patch.py", line 291, in new_create_sync
    response = retry_sync(
               ^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\instructor\retry.py", line 189, in retry_sync
    for attempt in max_retries:
  File "D:\deve\contract_automation\.venv\Lib\site-packages\tenacity\__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\tenacity\__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\tenacity\__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\deve\contract_automation\.venv\Lib\site-packages\instructor\retry.py", line 192, in retry_sync
    response = func(*args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\openai\_utils\_utils.py", line 274, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\openai\resources\chat\completions.py", line 742, in create
    return self._post(
           ^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\openai\_base_client.py", line 1270, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\openai\_base_client.py", line 947, in request
    return self._request(
           ^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\openai\_base_client.py", line 983, in _request
    response = self._client.send(
               ^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpx\_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpx\_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpx\_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpx\_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpx\_transports\default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpcore\_sync\connection_pool.py", line 216, in handle_request
    raise exc from None
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpcore\_sync\connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpcore\_sync\connection.py", line 101, in handle_request
    return self._connection.handle_request(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpcore\_sync\http11.py", line 143, in handle_request
    raise exc
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpcore\_sync\http11.py", line 113, in handle_request
    ) = self._receive_response_headers(**kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpcore\_sync\http11.py", line 186, in _receive_response_headers
    event = self._receive_event(timeout=timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpcore\_sync\http11.py", line 224, in _receive_event
    data = self._network_stream.read(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpcore\_backends\sync.py", line 126, in read
    return self._sock.recv(max_bytes)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\ssl.py", line 1234, in recv
    return self.read(buflen)
           ^^^^^^^^^^^^^^^^^
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\ssl.py", line 1107, in read
    return self._sslobj.read(len)
           ^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
2024-10-15 13:55:21,722 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-15 13:55:22,971 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-15 13:55:22,971 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-15 13:55:23,291 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-15 13:55:23,292 - DEBUG - Using proactor: IocpProactor
2024-10-15 13:55:23,317 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 13:55:23,317 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 13:55:23,317 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 13:55:23,317 - DEBUG - Compression method 0
2024-10-15 13:55:23,317 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 13:55:23,317 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 13:55:23,317 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 13:55:23,318 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 13:55:23,318 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 13:55:23,318 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 13:55:23,318 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 13:55:23,318 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 13:55:23,318 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 13:55:23,318 - DEBUG - Compression method 0
2024-10-15 13:55:23,318 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 13:55:23,318 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 13:55:23,318 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 13:55:23,318 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 13:55:23,318 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 13:55:23,318 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 13:55:23,327 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 13:55:23,327 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 13:55:23,327 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 13:55:23,327 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 13:55:23,328 - DEBUG - Error closing: Operation on closed image
2024-10-15 13:55:25,315 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 13:55:25,315 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 13:55:25,315 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 13:55:25,315 - DEBUG - Compression method 0
2024-10-15 13:55:25,315 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 13:55:25,315 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 13:55:25,315 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 13:55:25,315 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 13:55:25,315 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 13:55:25,315 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 13:55:25,315 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 13:55:25,315 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 13:55:25,315 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 13:55:25,315 - DEBUG - Compression method 0
2024-10-15 13:55:25,315 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 13:55:25,315 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 13:55:25,315 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 13:55:25,315 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 13:55:25,315 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 13:55:25,315 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 13:55:25,332 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 13:55:25,332 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 13:55:25,332 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 13:55:25,332 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 13:55:25,333 - DEBUG - Error closing: Operation on closed image
2024-10-15 13:55:27,861 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'instructor.dsl.simple_type.Response'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n3. Determine_contract_type: Determine the type of contract to be created.\n4. Construct_contract: Construct a contract using the provided information and templates.\n5. Finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}}
2024-10-15 13:55:27,862 - DEBUG - max_retries: 1
2024-10-15 13:55:27,864 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n3. Determine_contract_type: Determine the type of contract to be created.\n4. Construct_contract: Construct a contract using the provided information and templates.\n5. Finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}, 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}]}}
2024-10-15 13:55:27,901 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:55:27,901 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-15 13:55:27,923 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x00000218DB846240>
2024-10-15 13:55:27,923 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x00000218DBBCE7D0> server_hostname='api.openai.com' timeout=5.0
2024-10-15 13:55:27,934 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x00000218DBA89AC0>
2024-10-15 13:55:27,934 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:55:27,935 - DEBUG - send_request_headers.complete
2024-10-15 13:55:27,935 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:55:27,935 - DEBUG - send_request_body.complete
2024-10-15 13:55:27,935 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:55:30,337 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:55:30 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2247'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9992'), (b'x-ratelimit-remaining-tokens', b'9569'), (b'x-ratelimit-reset-requests', b'1m8.869s'), (b'x-ratelimit-reset-tokens', b'2.586s'), (b'x-request-id', b'req_562b3d91a740469a1463aa400271f43d'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=luxFQjr26aTCWZebHJwrJqrFgWmfwGr9HE5V6BfOWKM-1728989730-1.0.1.1-mRhZ6fr5kT86egtJmEQtGJlQ418Vl67XPjAm6XlP13HFiH2p1Melf2OaJB5ST2eOwPvy93yPafMw_EYPPZmmjQ; path=/; expires=Tue, 15-Oct-24 11:25:30 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=UEbrPVYCstPffpLj7bO1h5Of4lTyMxNS5GdADoAtyqE-1728989730935-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f46eb5f9bc9d0-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:55:30,339 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:55:30,340 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:55:30,340 - DEBUG - receive_response_body.complete
2024-10-15 13:55:30,341 - DEBUG - response_closed.started
2024-10-15 13:55:30,341 - DEBUG - response_closed.complete
2024-10-15 13:55:30,341 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Tue, 15 Oct 2024 10:55:30 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-kzzh9hik9ryjiou4ftvhondh'), ('openai-processing-ms', '2247'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '10000'), ('x-ratelimit-remaining-requests', '9992'), ('x-ratelimit-remaining-tokens', '9569'), ('x-ratelimit-reset-requests', '1m8.869s'), ('x-ratelimit-reset-tokens', '2.586s'), ('x-request-id', 'req_562b3d91a740469a1463aa400271f43d'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=luxFQjr26aTCWZebHJwrJqrFgWmfwGr9HE5V6BfOWKM-1728989730-1.0.1.1-mRhZ6fr5kT86egtJmEQtGJlQ418Vl67XPjAm6XlP13HFiH2p1Melf2OaJB5ST2eOwPvy93yPafMw_EYPPZmmjQ; path=/; expires=Tue, 15-Oct-24 11:25:30 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=UEbrPVYCstPffpLj7bO1h5Of4lTyMxNS5GdADoAtyqE-1728989730935-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d2f46eb5f9bc9d0-OTP'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-15 13:55:30,341 - DEBUG - request_id: req_562b3d91a740469a1463aa400271f43d
2024-10-15 13:55:30,344 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZV2kHW0Ov1wvZzsT0BVDvZLMGz3', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_yCWhxq8GjLby8kTc5ooS6hLn', function=Function(arguments='{\n  "content": [\n    {\n      "name": "ISPILANTE SENTIMENT BRUSLI",\n      "address": "Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR"\n    }\n  ]\n}', name='Response'), type='function')]))], created=1728989728, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=53, prompt_tokens=473, total_tokens=526, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:55:30,345 - DEBUG - Returning model from AdapterBase
2024-10-15 13:55:37,706 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'instructor.dsl.simple_type.Response'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n3. Determine_contract_type: Determine the type of contract to be created.\n4. Construct_contract: Construct a contract using the provided information and templates.\n5. Finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}}
2024-10-15 13:55:37,706 - DEBUG - max_retries: 1
2024-10-15 13:55:37,707 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n3. Determine_contract_type: Determine the type of contract to be created.\n4. Construct_contract: Construct a contract using the provided information and templates.\n5. Finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}, 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}]}}
2024-10-15 13:55:37,708 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:55:37,708 - DEBUG - close.started
2024-10-15 13:55:37,708 - DEBUG - close.complete
2024-10-15 13:55:37,708 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-15 13:55:37,731 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x00000218DBBE94F0>
2024-10-15 13:55:37,731 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x00000218DBBCE7D0> server_hostname='api.openai.com' timeout=5.0
2024-10-15 13:55:37,738 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x00000218DB9C64B0>
2024-10-15 13:55:37,738 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:55:37,738 - DEBUG - send_request_headers.complete
2024-10-15 13:55:37,738 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:55:37,738 - DEBUG - send_request_body.complete
2024-10-15 13:55:37,738 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:55:40,140 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:55:40 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2244'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9992'), (b'x-ratelimit-remaining-tokens', b'9575'), (b'x-ratelimit-reset-requests', b'1m7.699s'), (b'x-ratelimit-reset-tokens', b'2.55s'), (b'x-request-id', b'req_b1b4ef298752771fa85639cc126b58fe'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f4728a88bca1c-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:55:40,141 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:55:40,141 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:55:40,141 - DEBUG - receive_response_body.complete
2024-10-15 13:55:40,141 - DEBUG - response_closed.started
2024-10-15 13:55:40,141 - DEBUG - response_closed.complete
2024-10-15 13:55:40,141 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 10:55:40 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '2244', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9992', 'x-ratelimit-remaining-tokens': '9575', 'x-ratelimit-reset-requests': '1m7.699s', 'x-ratelimit-reset-tokens': '2.55s', 'x-request-id': 'req_b1b4ef298752771fa85639cc126b58fe', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f4728a88bca1c-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 13:55:40,141 - DEBUG - request_id: req_b1b4ef298752771fa85639cc126b58fe
2024-10-15 13:55:40,141 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZVCzq1ssYbBGIcVyDVQp045r2N9', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_IeNQNmp0cjscAj4dK4ctkVI8', function=Function(arguments='{\n  "content": [\n    {\n      "name": "ELENA VASILESCU",\n      "address": "Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B"\n    }\n  ]\n}', name='Response'), type='function')]))], created=1728989738, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=56, prompt_tokens=476, total_tokens=532, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:55:40,142 - DEBUG - Returning model from AdapterBase
2024-10-15 13:55:42,337 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n3. Determine_contract_type: Determine the type of contract to be created.\n4. Construct_contract: Construct a contract using the provided information and templates.\n5. Finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 13:55:42,337 - DEBUG - max_retries: 1
2024-10-15 13:55:42,339 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n3. Determine_contract_type: Determine the type of contract to be created.\n4. Construct_contract: Construct a contract using the provided information and templates.\n5. Finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 13:55:42,339 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:55:42,339 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:55:42,340 - DEBUG - send_request_headers.complete
2024-10-15 13:55:42,340 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:55:42,340 - DEBUG - send_request_body.complete
2024-10-15 13:55:42,340 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:55:43,166 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:55:43 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'674'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9991'), (b'x-ratelimit-remaining-tokens', b'9607'), (b'x-ratelimit-reset-requests', b'1m11.741s'), (b'x-ratelimit-reset-tokens', b'2.358s'), (b'x-request-id', b'req_2f5e03ccc80d8c3ad16e99292ca0fcf2'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f47456ec8ca1c-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:55:43,167 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:55:43,167 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:55:43,168 - DEBUG - receive_response_body.complete
2024-10-15 13:55:43,168 - DEBUG - response_closed.started
2024-10-15 13:55:43,168 - DEBUG - response_closed.complete
2024-10-15 13:55:43,168 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 10:55:43 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '674', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9991', 'x-ratelimit-remaining-tokens': '9607', 'x-ratelimit-reset-requests': '1m11.741s', 'x-ratelimit-reset-tokens': '2.358s', 'x-request-id': 'req_2f5e03ccc80d8c3ad16e99292ca0fcf2', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f47456ec8ca1c-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 13:55:43,168 - DEBUG - request_id: req_2f5e03ccc80d8c3ad16e99292ca0fcf2
2024-10-15 13:55:43,170 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZVH2ymxDhj0ovhlXCtckUgye1Wc', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_QEqQYAX9q097qwnzHagGT9hA', function=Function(arguments='\n{\n  "action": "Determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728989743, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=13, prompt_tokens=361, total_tokens=374, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:55:43,173 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n3. Determine_contract_type: Determine the type of contract to be created.\n4. Construct_contract: Construct a contract using the provided information and templates.\n5. Finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 13:55:43,173 - DEBUG - max_retries: 1
2024-10-15 13:55:43,175 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n3. Determine_contract_type: Determine the type of contract to be created.\n4. Construct_contract: Construct a contract using the provided information and templates.\n5. Finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 13:55:43,175 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:55:43,175 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:55:43,175 - DEBUG - send_request_headers.complete
2024-10-15 13:55:43,175 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:55:43,175 - DEBUG - send_request_body.complete
2024-10-15 13:55:43,175 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:55:44,071 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:55:44 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'733'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9990'), (b'x-ratelimit-remaining-tokens', b'9372'), (b'x-ratelimit-reset-requests', b'1m19.544s'), (b'x-ratelimit-reset-tokens', b'3.765s'), (b'x-request-id', b'req_d6508d2830b859a6458c1c00ec1e5ad8'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f474a987eca1c-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:55:44,072 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:55:44,073 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:55:44,073 - DEBUG - receive_response_body.complete
2024-10-15 13:55:44,074 - DEBUG - response_closed.started
2024-10-15 13:55:44,074 - DEBUG - response_closed.complete
2024-10-15 13:55:44,074 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 10:55:44 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '733', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9990', 'x-ratelimit-remaining-tokens': '9372', 'x-ratelimit-reset-requests': '1m19.544s', 'x-ratelimit-reset-tokens': '3.765s', 'x-request-id': 'req_d6508d2830b859a6458c1c00ec1e5ad8', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f474a987eca1c-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 13:55:44,074 - DEBUG - request_id: req_d6508d2830b859a6458c1c00ec1e5ad8
2024-10-15 13:55:44,076 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZVHqHr66EiQXJcKjJu8V7ROnxHG', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_sZnd1FpJjANWimZsKuHdrObI', function=Function(arguments='\n{\n  "action": "Determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728989743, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=13, prompt_tokens=361, total_tokens=374, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:55:44,080 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n3. Determine_contract_type: Determine the type of contract to be created.\n4. Construct_contract: Construct a contract using the provided information and templates.\n5. Finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 13:55:44,081 - DEBUG - max_retries: 1
2024-10-15 13:55:44,085 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n3. Determine_contract_type: Determine the type of contract to be created.\n4. Construct_contract: Construct a contract using the provided information and templates.\n5. Finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 13:55:44,085 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:55:44,085 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:55:44,085 - DEBUG - send_request_headers.complete
2024-10-15 13:55:44,085 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:55:44,086 - DEBUG - send_request_body.complete
2024-10-15 13:55:44,086 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:55:45,321 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:55:45 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1074'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9989'), (b'x-ratelimit-remaining-tokens', b'9150'), (b'x-ratelimit-reset-requests', b'1m27.274s'), (b'x-ratelimit-reset-tokens', b'5.099s'), (b'x-request-id', b'req_aa5c7c975b3c73af7dbd278dcb312165'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f475049b3ca1c-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:55:45,322 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:55:45,323 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:55:45,323 - DEBUG - receive_response_body.complete
2024-10-15 13:55:45,323 - DEBUG - response_closed.started
2024-10-15 13:55:45,324 - DEBUG - response_closed.complete
2024-10-15 13:55:45,324 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 10:55:45 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1074', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9989', 'x-ratelimit-remaining-tokens': '9150', 'x-ratelimit-reset-requests': '1m27.274s', 'x-ratelimit-reset-tokens': '5.099s', 'x-request-id': 'req_aa5c7c975b3c73af7dbd278dcb312165', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f475049b3ca1c-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 13:55:45,324 - DEBUG - request_id: req_aa5c7c975b3c73af7dbd278dcb312165
2024-10-15 13:55:45,325 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZVJC7JyDt5dOihaxm7uSZ3cvsIP', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_qdUoWuzjRvInx8mn8YsJBP8M', function=Function(arguments='{\n  "action": "Determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728989745, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=12, prompt_tokens=361, total_tokens=373, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:55:45,329 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n3. Determine_contract_type: Determine the type of contract to be created.\n4. Construct_contract: Construct a contract using the provided information and templates.\n5. Finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 13:55:45,329 - DEBUG - max_retries: 1
2024-10-15 13:55:45,333 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n3. Determine_contract_type: Determine the type of contract to be created.\n4. Construct_contract: Construct a contract using the provided information and templates.\n5. Finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 13:55:45,334 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:55:45,334 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:55:45,334 - DEBUG - send_request_headers.complete
2024-10-15 13:55:45,335 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:55:45,335 - DEBUG - send_request_body.complete
2024-10-15 13:55:45,335 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:55:46,290 - DEBUG - receive_response_headers.failed exception=KeyboardInterrupt()
2024-10-15 13:55:46,290 - DEBUG - response_closed.started
2024-10-15 13:55:46,290 - DEBUG - response_closed.complete
2024-10-15 13:55:46,465 - ERROR - Task exception was never retrieved
future: <Task finished name='Task-1' coro=<agent_workflow() done, defined at D:\deve\contract_automation\src\main.py:26> exception=KeyboardInterrupt()>
Traceback (most recent call last):
  File "D:\deve\contract_automation\src\main.py", line 100, in <module>
    asyncio.run(agent_workflow())
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 30, in run
    return loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 92, in run_until_complete
    self._run_once()
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 133, in _run_once
    handle._run()
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 386, in __wakeup
    self.__step()
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 293, in __step
    self.__step_run_and_handle_result(exc)
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 304, in __step_run_and_handle_result
    result = coro.send(None)
             ^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\src\main.py", line 42, in agent_workflow
    action = agent_action(state, templates)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\src\ai_functions.py", line 199, in agent_action
    response = client.chat.completions.create(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\instructor\patch.py", line 291, in new_create_sync
    response = retry_sync(
               ^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\instructor\retry.py", line 189, in retry_sync
    for attempt in max_retries:
  File "D:\deve\contract_automation\.venv\Lib\site-packages\tenacity\__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\tenacity\__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\tenacity\__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\deve\contract_automation\.venv\Lib\site-packages\instructor\retry.py", line 192, in retry_sync
    response = func(*args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\openai\_utils\_utils.py", line 274, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\openai\resources\chat\completions.py", line 742, in create
    return self._post(
           ^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\openai\_base_client.py", line 1270, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\openai\_base_client.py", line 947, in request
    return self._request(
           ^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\openai\_base_client.py", line 983, in _request
    response = self._client.send(
               ^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpx\_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpx\_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpx\_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpx\_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpx\_transports\default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpcore\_sync\connection_pool.py", line 216, in handle_request
    raise exc from None
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpcore\_sync\connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpcore\_sync\connection.py", line 101, in handle_request
    return self._connection.handle_request(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpcore\_sync\http11.py", line 143, in handle_request
    raise exc
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpcore\_sync\http11.py", line 113, in handle_request
    ) = self._receive_response_headers(**kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpcore\_sync\http11.py", line 186, in _receive_response_headers
    event = self._receive_event(timeout=timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpcore\_sync\http11.py", line 224, in _receive_event
    data = self._network_stream.read(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpcore\_backends\sync.py", line 126, in read
    return self._sock.recv(max_bytes)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\ssl.py", line 1234, in recv
    return self.read(buflen)
           ^^^^^^^^^^^^^^^^^
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\ssl.py", line 1107, in read
    return self._sslobj.read(len)
           ^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
2024-10-15 13:55:59,145 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-15 13:56:00,393 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-15 13:56:00,393 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-15 13:56:00,719 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-15 13:56:00,720 - DEBUG - Using proactor: IocpProactor
2024-10-15 13:56:00,745 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 13:56:00,746 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 13:56:00,746 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 13:56:00,746 - DEBUG - Compression method 0
2024-10-15 13:56:00,746 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 13:56:00,746 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 13:56:00,746 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 13:56:00,746 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 13:56:00,746 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 13:56:00,746 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 13:56:00,746 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 13:56:00,746 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 13:56:00,746 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 13:56:00,746 - DEBUG - Compression method 0
2024-10-15 13:56:00,746 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 13:56:00,746 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 13:56:00,746 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 13:56:00,746 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 13:56:00,746 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 13:56:00,746 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 13:56:00,755 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 13:56:00,755 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 13:56:00,755 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 13:56:00,755 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 13:56:00,756 - DEBUG - Error closing: Operation on closed image
2024-10-15 13:56:02,741 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 13:56:02,742 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 13:56:02,742 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 13:56:02,742 - DEBUG - Compression method 0
2024-10-15 13:56:02,742 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 13:56:02,742 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 13:56:02,742 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 13:56:02,742 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 13:56:02,742 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 13:56:02,742 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 13:56:02,742 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 13:56:02,742 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 13:56:02,742 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 13:56:02,742 - DEBUG - Compression method 0
2024-10-15 13:56:02,742 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 13:56:02,742 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 13:56:02,742 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 13:56:02,742 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 13:56:02,742 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 13:56:02,742 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 13:56:02,759 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 13:56:02,759 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 13:56:02,759 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 13:56:02,759 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 13:56:02,760 - DEBUG - Error closing: Operation on closed image
2024-10-15 13:56:05,235 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'instructor.dsl.simple_type.Response'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n3. Determine_contract_type: Determine the type of contract to be created.\n4. Construct_contract: Construct a contract using the provided information and templates.\n5. Finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}}
2024-10-15 13:56:05,236 - DEBUG - max_retries: 1
2024-10-15 13:56:05,240 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n3. Determine_contract_type: Determine the type of contract to be created.\n4. Construct_contract: Construct a contract using the provided information and templates.\n5. Finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}, 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}]}}
2024-10-15 13:56:05,277 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:56:05,278 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-15 13:56:05,323 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001D9F06AB8F0>
2024-10-15 13:56:05,323 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x000001D9F08AE7D0> server_hostname='api.openai.com' timeout=5.0
2024-10-15 13:56:05,331 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001D9F0876510>
2024-10-15 13:56:05,331 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:56:05,331 - DEBUG - send_request_headers.complete
2024-10-15 13:56:05,331 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:56:05,331 - DEBUG - send_request_body.complete
2024-10-15 13:56:05,331 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:56:08,104 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:56:08 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2587'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9990'), (b'x-ratelimit-remaining-tokens', b'9569'), (b'x-ratelimit-reset-requests', b'1m23.272s'), (b'x-ratelimit-reset-tokens', b'2.586s'), (b'x-request-id', b'req_7ca7bbe3735c1542a88421409800708c'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=fUeoeSZjRjJxFeA5FdN.QDAp1rdorG2n1deZ_PkpHxM-1728989768-1.0.1.1-_mNssHneLmUS22XOwaNM62QA_yuxf14KWpBT1nwr702cMSX6XCyMnwt1X0grdYGfQL_6qgsygdzQYPNcMMb6IA; path=/; expires=Tue, 15-Oct-24 11:26:08 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=D4lJIeFzuJUJPF_Zl3HP_CjYbpkiWagUz_IjZXNBNlE-1728989768704-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f47d51cc50544-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:56:08,105 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:56:08,106 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:56:08,106 - DEBUG - receive_response_body.complete
2024-10-15 13:56:08,106 - DEBUG - response_closed.started
2024-10-15 13:56:08,106 - DEBUG - response_closed.complete
2024-10-15 13:56:08,106 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Tue, 15 Oct 2024 10:56:08 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-kzzh9hik9ryjiou4ftvhondh'), ('openai-processing-ms', '2587'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '10000'), ('x-ratelimit-remaining-requests', '9990'), ('x-ratelimit-remaining-tokens', '9569'), ('x-ratelimit-reset-requests', '1m23.272s'), ('x-ratelimit-reset-tokens', '2.586s'), ('x-request-id', 'req_7ca7bbe3735c1542a88421409800708c'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=fUeoeSZjRjJxFeA5FdN.QDAp1rdorG2n1deZ_PkpHxM-1728989768-1.0.1.1-_mNssHneLmUS22XOwaNM62QA_yuxf14KWpBT1nwr702cMSX6XCyMnwt1X0grdYGfQL_6qgsygdzQYPNcMMb6IA; path=/; expires=Tue, 15-Oct-24 11:26:08 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=D4lJIeFzuJUJPF_Zl3HP_CjYbpkiWagUz_IjZXNBNlE-1728989768704-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d2f47d51cc50544-OTP'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-15 13:56:08,106 - DEBUG - request_id: req_7ca7bbe3735c1542a88421409800708c
2024-10-15 13:56:08,109 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZVeLUjiJ5ZrHZFbQPjiwAXgpvUs', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_2aFImfFPLgA7eksNGFFoiYZK', function=Function(arguments='{\n  "content": [\n    {\n      "name": "T525M ISPILANTE SENTIMENT BRUSLI",\n      "address": "Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR"\n    }\n  ]\n}', name='Response'), type='function')]))], created=1728989766, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=56, prompt_tokens=473, total_tokens=529, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:56:08,110 - DEBUG - Returning model from AdapterBase
2024-10-15 13:56:10,556 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'instructor.dsl.simple_type.Response'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n3. Determine_contract_type: Determine the type of contract to be created.\n4. Construct_contract: Construct a contract using the provided information and templates.\n5. Finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}}
2024-10-15 13:56:10,556 - DEBUG - max_retries: 1
2024-10-15 13:56:10,559 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n3. Determine_contract_type: Determine the type of contract to be created.\n4. Construct_contract: Construct a contract using the provided information and templates.\n5. Finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}, 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}]}}
2024-10-15 13:56:10,560 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:56:10,560 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:56:10,561 - DEBUG - send_request_headers.complete
2024-10-15 13:56:10,561 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:56:10,561 - DEBUG - send_request_body.complete
2024-10-15 13:56:10,561 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:56:13,455 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:56:14 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2729'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9989'), (b'x-ratelimit-remaining-tokens', b'9575'), (b'x-ratelimit-reset-requests', b'1m26.716s'), (b'x-ratelimit-reset-tokens', b'2.55s'), (b'x-request-id', b'req_7667e448aa5cdb7cffa97dddfc606a71'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f47f5cb850544-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:56:13,456 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:56:13,457 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:56:13,457 - DEBUG - receive_response_body.complete
2024-10-15 13:56:13,457 - DEBUG - response_closed.started
2024-10-15 13:56:13,457 - DEBUG - response_closed.complete
2024-10-15 13:56:13,458 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 10:56:14 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '2729', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9989', 'x-ratelimit-remaining-tokens': '9575', 'x-ratelimit-reset-requests': '1m26.716s', 'x-ratelimit-reset-tokens': '2.55s', 'x-request-id': 'req_7667e448aa5cdb7cffa97dddfc606a71', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f47f5cb850544-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 13:56:13,458 - DEBUG - request_id: req_7667e448aa5cdb7cffa97dddfc606a71
2024-10-15 13:56:13,459 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZVjoCmVt0L0Lxhq0Xh4VBulNO7x', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_cMy9POAJnsamT1SYh2sJzqas', function=Function(arguments='{\n  "content": [\n    {\n      "name": "ELENA VASILESCU",\n      "address": "Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3"\n    }\n  ]\n}', name='Response'), type='function')]))], created=1728989771, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=53, prompt_tokens=476, total_tokens=529, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:56:13,461 - DEBUG - Returning model from AdapterBase
2024-10-15 13:56:14,998 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n3. Determine_contract_type: Determine the type of contract to be created.\n4. Construct_contract: Construct a contract using the provided information and templates.\n5. Finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 13:56:14,998 - DEBUG - max_retries: 1
2024-10-15 13:56:15,000 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n3. Determine_contract_type: Determine the type of contract to be created.\n4. Construct_contract: Construct a contract using the provided information and templates.\n5. Finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 13:56:15,000 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:56:15,001 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:56:15,001 - DEBUG - send_request_headers.complete
2024-10-15 13:56:15,001 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:56:15,001 - DEBUG - send_request_body.complete
2024-10-15 13:56:15,001 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:56:16,024 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:56:16 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'861'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9989'), (b'x-ratelimit-remaining-tokens', b'9607'), (b'x-ratelimit-reset-requests', b'1m30.91s'), (b'x-ratelimit-reset-tokens', b'2.358s'), (b'x-request-id', b'req_f3befe91de7376e613ddec98dcce49a9'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f48118e7c0544-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:56:16,024 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:56:16,024 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:56:16,024 - DEBUG - receive_response_body.complete
2024-10-15 13:56:16,024 - DEBUG - response_closed.started
2024-10-15 13:56:16,025 - DEBUG - response_closed.complete
2024-10-15 13:56:16,025 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 10:56:16 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '861', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9989', 'x-ratelimit-remaining-tokens': '9607', 'x-ratelimit-reset-requests': '1m30.91s', 'x-ratelimit-reset-tokens': '2.358s', 'x-request-id': 'req_f3befe91de7376e613ddec98dcce49a9', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f48118e7c0544-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 13:56:16,025 - DEBUG - request_id: req_f3befe91de7376e613ddec98dcce49a9
2024-10-15 13:56:16,025 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZVn7PjQZQEXSJrqydIWIqxSsTxt', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_BiHowIxcuzufv3xElXfdJqtw', function=Function(arguments='{\n  "action": "Determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728989775, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=12, prompt_tokens=361, total_tokens=373, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:56:16,026 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n3. Determine_contract_type: Determine the type of contract to be created.\n4. Construct_contract: Construct a contract using the provided information and templates.\n5. Finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 13:56:16,026 - DEBUG - max_retries: 1
2024-10-15 13:56:16,028 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n3. Determine_contract_type: Determine the type of contract to be created.\n4. Construct_contract: Construct a contract using the provided information and templates.\n5. Finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 13:56:16,028 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:56:16,028 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:56:16,028 - DEBUG - send_request_headers.complete
2024-10-15 13:56:16,028 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:56:16,029 - DEBUG - send_request_body.complete
2024-10-15 13:56:16,029 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:56:16,970 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:56:17 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'781'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9988'), (b'x-ratelimit-remaining-tokens', b'9404'), (b'x-ratelimit-reset-requests', b'1m38.527s'), (b'x-ratelimit-reset-tokens', b'3.573s'), (b'x-request-id', b'req_c131c221afa4b708a3ad0bf543fcf502'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f4817fe980544-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:56:16,971 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:56:16,971 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:56:16,971 - DEBUG - receive_response_body.complete
2024-10-15 13:56:16,972 - DEBUG - response_closed.started
2024-10-15 13:56:16,972 - DEBUG - response_closed.complete
2024-10-15 13:56:16,972 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 10:56:17 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '781', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9988', 'x-ratelimit-remaining-tokens': '9404', 'x-ratelimit-reset-requests': '1m38.527s', 'x-ratelimit-reset-tokens': '3.573s', 'x-request-id': 'req_c131c221afa4b708a3ad0bf543fcf502', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f4817fe980544-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 13:56:16,972 - DEBUG - request_id: req_c131c221afa4b708a3ad0bf543fcf502
2024-10-15 13:56:16,973 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZVoSOtRRPhnh9VWS3dWCq31UhTf', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_ZcIauOsdlzZ2TlB3N7CeQhKX', function=Function(arguments='\n{\n  "action": "Determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728989776, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=13, prompt_tokens=361, total_tokens=374, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:56:16,977 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n3. Determine_contract_type: Determine the type of contract to be created.\n4. Construct_contract: Construct a contract using the provided information and templates.\n5. Finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 13:56:16,977 - DEBUG - max_retries: 1
2024-10-15 13:56:16,983 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n3. Determine_contract_type: Determine the type of contract to be created.\n4. Construct_contract: Construct a contract using the provided information and templates.\n5. Finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 13:56:16,984 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:56:16,985 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:56:16,985 - DEBUG - send_request_headers.complete
2024-10-15 13:56:16,986 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:56:16,986 - DEBUG - send_request_body.complete
2024-10-15 13:56:16,986 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:56:18,069 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:56:18 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'922'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9987'), (b'x-ratelimit-remaining-tokens', b'9190'), (b'x-ratelimit-reset-requests', b'1m46.208s'), (b'x-ratelimit-reset-tokens', b'4.858s'), (b'x-request-id', b'req_f914b1aa24fc64529c760e246d83e472'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f481dfddd0544-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:56:18,069 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:56:18,069 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:56:18,069 - DEBUG - receive_response_body.complete
2024-10-15 13:56:18,069 - DEBUG - response_closed.started
2024-10-15 13:56:18,069 - DEBUG - response_closed.complete
2024-10-15 13:56:18,069 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 10:56:18 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '922', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9987', 'x-ratelimit-remaining-tokens': '9190', 'x-ratelimit-reset-requests': '1m46.208s', 'x-ratelimit-reset-tokens': '4.858s', 'x-request-id': 'req_f914b1aa24fc64529c760e246d83e472', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f481dfddd0544-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 13:56:18,069 - DEBUG - request_id: req_f914b1aa24fc64529c760e246d83e472
2024-10-15 13:56:18,070 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZVpuZxpGQN6QV2nb2ZfaGQqE1QI', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_ToIFgsqW5dik2MPlI9zJ77zh', function=Function(arguments='\n{\n  "action": "Determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728989777, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=13, prompt_tokens=361, total_tokens=374, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:56:18,073 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n3. Determine_contract_type: Determine the type of contract to be created.\n4. Construct_contract: Construct a contract using the provided information and templates.\n5. Finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 13:56:18,073 - DEBUG - max_retries: 1
2024-10-15 13:56:18,075 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n3. Determine_contract_type: Determine the type of contract to be created.\n4. Construct_contract: Construct a contract using the provided information and templates.\n5. Finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 13:56:18,075 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:56:18,075 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:56:18,075 - DEBUG - send_request_headers.complete
2024-10-15 13:56:18,075 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:56:18,075 - DEBUG - send_request_body.complete
2024-10-15 13:56:18,075 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:56:19,021 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:56:19 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'786'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9986'), (b'x-ratelimit-remaining-tokens', b'8995'), (b'x-ratelimit-reset-requests', b'1m53.774s'), (b'x-ratelimit-reset-tokens', b'6.028s'), (b'x-request-id', b'req_f60ae1858cc9597e0cf35902b48f414e'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f4824be170544-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:56:19,022 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:56:19,022 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:56:19,022 - DEBUG - receive_response_body.complete
2024-10-15 13:56:19,022 - DEBUG - response_closed.started
2024-10-15 13:56:19,022 - DEBUG - response_closed.complete
2024-10-15 13:56:19,022 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 10:56:19 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '786', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9986', 'x-ratelimit-remaining-tokens': '8995', 'x-ratelimit-reset-requests': '1m53.774s', 'x-ratelimit-reset-tokens': '6.028s', 'x-request-id': 'req_f60ae1858cc9597e0cf35902b48f414e', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f4824be170544-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 13:56:19,022 - DEBUG - request_id: req_f60ae1858cc9597e0cf35902b48f414e
2024-10-15 13:56:19,022 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZVq5F5ZLCKPoosQObO8Nt9ewCwN', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_xI3wasysxGhRrTZZeVAStSCn', function=Function(arguments='{\n  "action": "Determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728989778, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=12, prompt_tokens=361, total_tokens=373, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:56:19,024 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n3. Determine_contract_type: Determine the type of contract to be created.\n4. Construct_contract: Construct a contract using the provided information and templates.\n5. Finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 13:56:19,024 - DEBUG - max_retries: 1
2024-10-15 13:56:19,026 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n3. Determine_contract_type: Determine the type of contract to be created.\n4. Construct_contract: Construct a contract using the provided information and templates.\n5. Finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 13:56:19,026 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:56:19,026 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:56:19,026 - DEBUG - send_request_headers.complete
2024-10-15 13:56:19,026 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:56:19,027 - DEBUG - send_request_body.complete
2024-10-15 13:56:19,027 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:56:19,939 - DEBUG - receive_response_headers.failed exception=KeyboardInterrupt()
2024-10-15 13:56:19,939 - DEBUG - response_closed.started
2024-10-15 13:56:19,939 - DEBUG - response_closed.complete
2024-10-15 13:56:20,115 - ERROR - Task exception was never retrieved
future: <Task finished name='Task-1' coro=<agent_workflow() done, defined at D:\deve\contract_automation\src\main.py:26> exception=KeyboardInterrupt()>
Traceback (most recent call last):
  File "D:\deve\contract_automation\src\main.py", line 100, in <module>
    asyncio.run(agent_workflow())
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 30, in run
    return loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 92, in run_until_complete
    self._run_once()
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 133, in _run_once
    handle._run()
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 386, in __wakeup
    self.__step()
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 293, in __step
    self.__step_run_and_handle_result(exc)
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 304, in __step_run_and_handle_result
    result = coro.send(None)
             ^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\src\main.py", line 42, in agent_workflow
    action = agent_action(state, templates)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\src\ai_functions.py", line 199, in agent_action
    response = client.chat.completions.create(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\instructor\patch.py", line 291, in new_create_sync
    response = retry_sync(
               ^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\instructor\retry.py", line 189, in retry_sync
    for attempt in max_retries:
  File "D:\deve\contract_automation\.venv\Lib\site-packages\tenacity\__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\tenacity\__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\tenacity\__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\deve\contract_automation\.venv\Lib\site-packages\instructor\retry.py", line 192, in retry_sync
    response = func(*args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\openai\_utils\_utils.py", line 274, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\openai\resources\chat\completions.py", line 742, in create
    return self._post(
           ^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\openai\_base_client.py", line 1270, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\openai\_base_client.py", line 947, in request
    return self._request(
           ^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\openai\_base_client.py", line 983, in _request
    response = self._client.send(
               ^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpx\_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpx\_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpx\_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpx\_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpx\_transports\default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpcore\_sync\connection_pool.py", line 216, in handle_request
    raise exc from None
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpcore\_sync\connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpcore\_sync\connection.py", line 101, in handle_request
    return self._connection.handle_request(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpcore\_sync\http11.py", line 143, in handle_request
    raise exc
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpcore\_sync\http11.py", line 113, in handle_request
    ) = self._receive_response_headers(**kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpcore\_sync\http11.py", line 186, in _receive_response_headers
    event = self._receive_event(timeout=timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpcore\_sync\http11.py", line 224, in _receive_event
    data = self._network_stream.read(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpcore\_backends\sync.py", line 126, in read
    return self._sock.recv(max_bytes)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\ssl.py", line 1234, in recv
    return self.read(buflen)
           ^^^^^^^^^^^^^^^^^
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\ssl.py", line 1107, in read
    return self._sslobj.read(len)
           ^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
2024-10-15 13:56:56,531 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-15 13:56:57,778 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-15 13:56:57,779 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-15 13:56:58,096 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-15 13:56:58,097 - DEBUG - Using proactor: IocpProactor
2024-10-15 13:56:58,124 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 13:56:58,124 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 13:56:58,124 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 13:56:58,124 - DEBUG - Compression method 0
2024-10-15 13:56:58,124 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 13:56:58,124 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 13:56:58,124 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 13:56:58,124 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 13:56:58,124 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 13:56:58,124 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 13:56:58,124 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 13:56:58,124 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 13:56:58,124 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 13:56:58,124 - DEBUG - Compression method 0
2024-10-15 13:56:58,124 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 13:56:58,124 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 13:56:58,124 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 13:56:58,124 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 13:56:58,124 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 13:56:58,124 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 13:56:58,134 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 13:56:58,134 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 13:56:58,134 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 13:56:58,134 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 13:56:58,134 - DEBUG - Error closing: Operation on closed image
2024-10-15 13:57:00,118 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 13:57:00,118 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 13:57:00,118 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 13:57:00,118 - DEBUG - Compression method 0
2024-10-15 13:57:00,118 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 13:57:00,118 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 13:57:00,118 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 13:57:00,118 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 13:57:00,118 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 13:57:00,118 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 13:57:00,118 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 13:57:00,118 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 13:57:00,118 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 13:57:00,118 - DEBUG - Compression method 0
2024-10-15 13:57:00,118 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 13:57:00,118 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 13:57:00,118 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 13:57:00,118 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 13:57:00,118 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 13:57:00,118 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 13:57:00,135 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 13:57:00,135 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 13:57:00,135 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 13:57:00,135 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 13:57:00,136 - DEBUG - Error closing: Operation on closed image
2024-10-15 13:57:02,636 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'instructor.dsl.simple_type.Response'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Determine_contract_type: Determine the type of contract to be created.\n3. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}}
2024-10-15 13:57:02,637 - DEBUG - max_retries: 1
2024-10-15 13:57:02,639 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Determine_contract_type: Determine the type of contract to be created.\n3. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}, 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}]}}
2024-10-15 13:57:02,676 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:57:02,677 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-15 13:57:02,710 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001BEFF8D0FB0>
2024-10-15 13:57:02,710 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x000001BE972FE7D0> server_hostname='api.openai.com' timeout=5.0
2024-10-15 13:57:02,718 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001BE97466210>
2024-10-15 13:57:02,718 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:57:02,718 - DEBUG - send_request_headers.complete
2024-10-15 13:57:02,718 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:57:02,719 - DEBUG - send_request_body.complete
2024-10-15 13:57:02,719 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:57:05,464 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:57:06 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2587'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9990'), (b'x-ratelimit-remaining-tokens', b'9569'), (b'x-ratelimit-reset-requests', b'1m26.396s'), (b'x-ratelimit-reset-tokens', b'2.586s'), (b'x-request-id', b'req_5c59e9e0dc608686feb4ad635dfe666d'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=Dkiyn3AJBALCX9DLzPTJ_0M6p0xdMzwQine.ZQfY4W4-1728989826-1.0.1.1-Ur..ZAUpnZI70scjeQPo0askLw7qZDS7YS3j48ZA.QPY5EKFtT7hITWpA8zOifhJlrgNUEpXpfZHxXZFoEsRPw; path=/; expires=Tue, 15-Oct-24 11:27:06 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=uuXmjcWEHDIvDNgie1pgNstAgIc9aUiwSKOSXAm1mlU-1728989826066-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f493bce37ca23-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:57:05,466 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:57:05,467 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:57:05,467 - DEBUG - receive_response_body.complete
2024-10-15 13:57:05,467 - DEBUG - response_closed.started
2024-10-15 13:57:05,468 - DEBUG - response_closed.complete
2024-10-15 13:57:05,468 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Tue, 15 Oct 2024 10:57:06 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-kzzh9hik9ryjiou4ftvhondh'), ('openai-processing-ms', '2587'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '10000'), ('x-ratelimit-remaining-requests', '9990'), ('x-ratelimit-remaining-tokens', '9569'), ('x-ratelimit-reset-requests', '1m26.396s'), ('x-ratelimit-reset-tokens', '2.586s'), ('x-request-id', 'req_5c59e9e0dc608686feb4ad635dfe666d'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=Dkiyn3AJBALCX9DLzPTJ_0M6p0xdMzwQine.ZQfY4W4-1728989826-1.0.1.1-Ur..ZAUpnZI70scjeQPo0askLw7qZDS7YS3j48ZA.QPY5EKFtT7hITWpA8zOifhJlrgNUEpXpfZHxXZFoEsRPw; path=/; expires=Tue, 15-Oct-24 11:27:06 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=uuXmjcWEHDIvDNgie1pgNstAgIc9aUiwSKOSXAm1mlU-1728989826066-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d2f493bce37ca23-OTP'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-15 13:57:05,468 - DEBUG - request_id: req_5c59e9e0dc608686feb4ad635dfe666d
2024-10-15 13:57:05,470 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZWZ1IigxQaTwZZUKnbRbsDylXeQ', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_I0MLsSl1HezHEAEIFj1o2tIE', function=Function(arguments='{\n"content": [\n  {\n    "name": "ISPILANTE SENTIMENT BRUSLI",\n    "address": "Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR"\n  }\n]\n}', name='Response'), type='function')]))], created=1728989823, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=51, prompt_tokens=473, total_tokens=524, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:57:05,471 - DEBUG - Returning model from AdapterBase
2024-10-15 13:57:09,803 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'instructor.dsl.simple_type.Response'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Determine_contract_type: Determine the type of contract to be created.\n3. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}}
2024-10-15 13:57:09,803 - DEBUG - max_retries: 1
2024-10-15 13:57:09,806 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Determine_contract_type: Determine the type of contract to be created.\n3. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}, 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}]}}
2024-10-15 13:57:09,806 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:57:09,807 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:57:09,807 - DEBUG - send_request_headers.complete
2024-10-15 13:57:09,807 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:57:09,807 - DEBUG - send_request_body.complete
2024-10-15 13:57:09,807 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:57:13,756 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:57:14 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'3802'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9989'), (b'x-ratelimit-remaining-tokens', b'9575'), (b'x-ratelimit-reset-requests', b'1m27.951s'), (b'x-ratelimit-reset-tokens', b'2.55s'), (b'x-request-id', b'req_141df1bbab0e908bc1fbae839caf3e58'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f49681f52ca23-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:57:13,756 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:57:13,757 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:57:13,757 - DEBUG - receive_response_body.complete
2024-10-15 13:57:13,757 - DEBUG - response_closed.started
2024-10-15 13:57:13,757 - DEBUG - response_closed.complete
2024-10-15 13:57:13,757 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 10:57:14 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '3802', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9989', 'x-ratelimit-remaining-tokens': '9575', 'x-ratelimit-reset-requests': '1m27.951s', 'x-ratelimit-reset-tokens': '2.55s', 'x-request-id': 'req_141df1bbab0e908bc1fbae839caf3e58', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f49681f52ca23-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 13:57:13,757 - DEBUG - request_id: req_141df1bbab0e908bc1fbae839caf3e58
2024-10-15 13:57:13,758 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZWgtKV5qODEStWK0Q2oJss7lRRs', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_pTEmeHNqyTUfbGwWsVzOGtZ7', function=Function(arguments='{\n  "content": [\n    {\n      "name": "ELENA VASILESCU",\n      "address": "Mun: Bucuresti, Sec. 5, Str Nicolae Iorga nr.3, 900 B"\n    }\n  ]\n}', name='Response'), type='function')]))], created=1728989830, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=59, prompt_tokens=476, total_tokens=535, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:57:13,759 - DEBUG - Returning model from AdapterBase
2024-10-15 13:57:15,214 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Determine_contract_type: Determine the type of contract to be created.\n3. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 13:57:15,214 - DEBUG - max_retries: 1
2024-10-15 13:57:15,216 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Determine_contract_type: Determine the type of contract to be created.\n3. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 13:57:15,217 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:57:15,217 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:57:15,217 - DEBUG - send_request_headers.complete
2024-10-15 13:57:15,217 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:57:15,217 - DEBUG - send_request_body.complete
2024-10-15 13:57:15,217 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:57:16,079 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:57:16 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'699'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9989'), (b'x-ratelimit-remaining-tokens', b'9607'), (b'x-ratelimit-reset-requests', b'1m31.177s'), (b'x-ratelimit-reset-tokens', b'2.358s'), (b'x-request-id', b'req_2b60014e8f8efab2f4fdfa6c68884c1d'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f4989ea37ca23-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:57:16,079 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:57:16,079 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:57:16,079 - DEBUG - receive_response_body.complete
2024-10-15 13:57:16,079 - DEBUG - response_closed.started
2024-10-15 13:57:16,079 - DEBUG - response_closed.complete
2024-10-15 13:57:16,079 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 10:57:16 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '699', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9989', 'x-ratelimit-remaining-tokens': '9607', 'x-ratelimit-reset-requests': '1m31.177s', 'x-ratelimit-reset-tokens': '2.358s', 'x-request-id': 'req_2b60014e8f8efab2f4fdfa6c68884c1d', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f4989ea37ca23-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 13:57:16,079 - DEBUG - request_id: req_2b60014e8f8efab2f4fdfa6c68884c1d
2024-10-15 13:57:16,079 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZWmAw49DbHqRzfgTT8YZIyp1Zvf', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_VLnV1d3XIfbz3iywdMK9r5FP', function=Function(arguments='\n{\n  "action": "Determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728989836, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=13, prompt_tokens=361, total_tokens=374, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:57:16,081 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Determine_contract_type: Determine the type of contract to be created.\n3. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 13:57:16,081 - DEBUG - max_retries: 1
2024-10-15 13:57:16,082 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Determine_contract_type: Determine the type of contract to be created.\n3. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 13:57:16,083 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:57:16,083 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:57:16,083 - DEBUG - send_request_headers.complete
2024-10-15 13:57:16,083 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:57:16,083 - DEBUG - send_request_body.complete
2024-10-15 13:57:16,083 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:57:17,162 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:57:17 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'926'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9988'), (b'x-ratelimit-remaining-tokens', b'9376'), (b'x-ratelimit-reset-requests', b'1m38.955s'), (b'x-ratelimit-reset-tokens', b'3.739s'), (b'x-request-id', b'req_0531facd2e31788fb6475548b7033b4f'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f498f59f6ca23-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:57:17,163 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:57:17,163 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:57:17,164 - DEBUG - receive_response_body.complete
2024-10-15 13:57:17,164 - DEBUG - response_closed.started
2024-10-15 13:57:17,164 - DEBUG - response_closed.complete
2024-10-15 13:57:17,164 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 10:57:17 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '926', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9988', 'x-ratelimit-remaining-tokens': '9376', 'x-ratelimit-reset-requests': '1m38.955s', 'x-ratelimit-reset-tokens': '3.739s', 'x-request-id': 'req_0531facd2e31788fb6475548b7033b4f', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f498f59f6ca23-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 13:57:17,165 - DEBUG - request_id: req_0531facd2e31788fb6475548b7033b4f
2024-10-15 13:57:17,166 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZWmknqXnChWOKjLpUo23MYdajj9', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_OgrAQ8ve5bHzTan760dUpDc0', function=Function(arguments='\n{\n  "action": "Determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728989836, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=13, prompt_tokens=361, total_tokens=374, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:57:17,169 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Determine_contract_type: Determine the type of contract to be created.\n3. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 13:57:17,169 - DEBUG - max_retries: 1
2024-10-15 13:57:17,172 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Determine_contract_type: Determine the type of contract to be created.\n3. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 13:57:17,172 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:57:17,172 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:57:17,173 - DEBUG - send_request_headers.complete
2024-10-15 13:57:17,173 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:57:17,173 - DEBUG - send_request_body.complete
2024-10-15 13:57:17,173 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:57:18,424 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:57:19 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1089'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9987'), (b'x-ratelimit-remaining-tokens', b'9185'), (b'x-ratelimit-reset-requests', b'1m46.498s'), (b'x-ratelimit-reset-tokens', b'4.887s'), (b'x-request-id', b'req_515fe2b6df8b0ac34d675637ad784396'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f49961c85ca23-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:57:18,425 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:57:18,425 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:57:18,425 - DEBUG - receive_response_body.complete
2024-10-15 13:57:18,426 - DEBUG - response_closed.started
2024-10-15 13:57:18,426 - DEBUG - response_closed.complete
2024-10-15 13:57:18,426 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 10:57:19 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1089', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9987', 'x-ratelimit-remaining-tokens': '9185', 'x-ratelimit-reset-requests': '1m46.498s', 'x-ratelimit-reset-tokens': '4.887s', 'x-request-id': 'req_515fe2b6df8b0ac34d675637ad784396', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f49961c85ca23-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 13:57:18,426 - DEBUG - request_id: req_515fe2b6df8b0ac34d675637ad784396
2024-10-15 13:57:18,427 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZWo3R9xCBnztWtzC2Eh1JrCl3Oq', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_bdUiY6zk3eETpDtyDhwdhrFW', function=Function(arguments='{\n  "action": "Determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728989838, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=12, prompt_tokens=361, total_tokens=373, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:57:18,430 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Determine_contract_type: Determine the type of contract to be created.\n3. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 13:57:18,430 - DEBUG - max_retries: 1
2024-10-15 13:57:18,431 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Determine_contract_type: Determine the type of contract to be created.\n3. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 13:57:18,432 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:57:18,432 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:57:18,432 - DEBUG - send_request_headers.complete
2024-10-15 13:57:18,432 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:57:18,432 - DEBUG - send_request_body.complete
2024-10-15 13:57:18,432 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:57:19,516 - DEBUG - receive_response_headers.failed exception=KeyboardInterrupt()
2024-10-15 13:57:19,516 - DEBUG - response_closed.started
2024-10-15 13:57:19,517 - DEBUG - response_closed.complete
2024-10-15 13:57:50,497 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-15 13:57:51,765 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-15 13:57:51,765 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-15 13:57:52,084 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-15 13:57:52,084 - DEBUG - Using proactor: IocpProactor
2024-10-15 13:57:52,112 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 13:57:52,112 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 13:57:52,112 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 13:57:52,112 - DEBUG - Compression method 0
2024-10-15 13:57:52,112 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 13:57:52,112 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 13:57:52,112 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 13:57:52,112 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 13:57:52,112 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 13:57:52,112 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 13:57:52,112 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 13:57:52,112 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 13:57:52,112 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 13:57:52,112 - DEBUG - Compression method 0
2024-10-15 13:57:52,113 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 13:57:52,113 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 13:57:52,113 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 13:57:52,113 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 13:57:52,113 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 13:57:52,113 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 13:57:52,122 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 13:57:52,122 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 13:57:52,122 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 13:57:52,122 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 13:57:52,123 - DEBUG - Error closing: Operation on closed image
2024-10-15 13:57:54,149 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 13:57:54,149 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 13:57:54,149 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 13:57:54,149 - DEBUG - Compression method 0
2024-10-15 13:57:54,149 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 13:57:54,149 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 13:57:54,149 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 13:57:54,149 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 13:57:54,149 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 13:57:54,149 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 13:57:54,149 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 13:57:54,149 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 13:57:54,149 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 13:57:54,149 - DEBUG - Compression method 0
2024-10-15 13:57:54,149 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 13:57:54,149 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 13:57:54,149 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 13:57:54,149 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 13:57:54,149 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 13:57:54,149 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 13:57:54,166 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 13:57:54,167 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 13:57:54,167 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 13:57:54,167 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 13:57:54,167 - DEBUG - Error closing: Operation on closed image
2024-10-15 13:57:56,690 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'instructor.dsl.simple_type.Response'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Determine_contract_type: Determine the type of contract to be created.\n3. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}}
2024-10-15 13:57:56,691 - DEBUG - max_retries: 1
2024-10-15 13:57:56,693 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Determine_contract_type: Determine the type of contract to be created.\n3. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}, 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}]}}
2024-10-15 13:57:56,731 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:57:56,731 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-15 13:57:56,832 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001D95E8BBDD0>
2024-10-15 13:57:56,832 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x000001D95E83E7D0> server_hostname='api.openai.com' timeout=5.0
2024-10-15 13:57:56,843 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001D95E8B9580>
2024-10-15 13:57:56,843 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:57:56,844 - DEBUG - send_request_headers.complete
2024-10-15 13:57:56,844 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:57:56,844 - DEBUG - send_request_body.complete
2024-10-15 13:57:56,844 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:57:59,349 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:57:59 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2353'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9990'), (b'x-ratelimit-remaining-tokens', b'9569'), (b'x-ratelimit-reset-requests', b'1m24.111s'), (b'x-ratelimit-reset-tokens', b'2.586s'), (b'x-request-id', b'req_b3e0e6c97c65299cb6e496c57696f5f5'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=yqbtceM_Fx0D72HhzolrGmSSf8bdjkRoTKDmHZOSppw-1728989879-1.0.1.1-JZxOadcvwYzJ5JZ6jVnvwZIW1A9IMXQVvC2SzFnKmdvFCnu9sIeS.K4cKOEuCIAeu4HgZ.HlDFzG3BIuOluhRQ; path=/; expires=Tue, 15-Oct-24 11:27:59 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=ACVm3pIaiFn0fWlXUSL0O2irkUAXY1Rxz8IFgvMVSoI-1728989879954-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f4a8e1db5c9c7-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:57:59,349 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:57:59,349 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:57:59,350 - DEBUG - receive_response_body.complete
2024-10-15 13:57:59,350 - DEBUG - response_closed.started
2024-10-15 13:57:59,350 - DEBUG - response_closed.complete
2024-10-15 13:57:59,350 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Tue, 15 Oct 2024 10:57:59 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-kzzh9hik9ryjiou4ftvhondh'), ('openai-processing-ms', '2353'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '10000'), ('x-ratelimit-remaining-requests', '9990'), ('x-ratelimit-remaining-tokens', '9569'), ('x-ratelimit-reset-requests', '1m24.111s'), ('x-ratelimit-reset-tokens', '2.586s'), ('x-request-id', 'req_b3e0e6c97c65299cb6e496c57696f5f5'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=yqbtceM_Fx0D72HhzolrGmSSf8bdjkRoTKDmHZOSppw-1728989879-1.0.1.1-JZxOadcvwYzJ5JZ6jVnvwZIW1A9IMXQVvC2SzFnKmdvFCnu9sIeS.K4cKOEuCIAeu4HgZ.HlDFzG3BIuOluhRQ; path=/; expires=Tue, 15-Oct-24 11:27:59 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=ACVm3pIaiFn0fWlXUSL0O2irkUAXY1Rxz8IFgvMVSoI-1728989879954-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d2f4a8e1db5c9c7-OTP'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-15 13:57:59,350 - DEBUG - request_id: req_b3e0e6c97c65299cb6e496c57696f5f5
2024-10-15 13:57:59,351 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZXROq2pyHzhuEmiZq7RGddusyN7', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_J5ZQ9XxSdXNMsCpNHhyHWJOp', function=Function(arguments='{\n  "content": [\n    {\n      "name": "ISPILANTE SENTIMENT BRUSLI",\n      "address": "Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR"\n    }\n  ]\n}', name='Response'), type='function')]))], created=1728989877, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=53, prompt_tokens=473, total_tokens=526, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:57:59,352 - DEBUG - Returning model from AdapterBase
2024-10-15 13:58:02,782 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'instructor.dsl.simple_type.Response'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Determine_contract_type: Determine the type of contract to be created.\n3. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}}
2024-10-15 13:58:02,782 - DEBUG - max_retries: 1
2024-10-15 13:58:02,784 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Determine_contract_type: Determine the type of contract to be created.\n3. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}, 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}]}}
2024-10-15 13:58:02,785 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:58:02,785 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:58:02,786 - DEBUG - send_request_headers.complete
2024-10-15 13:58:02,786 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:58:02,786 - DEBUG - send_request_body.complete
2024-10-15 13:58:02,786 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:58:05,506 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:58:06 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2576'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9989'), (b'x-ratelimit-remaining-tokens', b'9575'), (b'x-ratelimit-reset-requests', b'1m26.815s'), (b'x-ratelimit-reset-tokens', b'2.55s'), (b'x-request-id', b'req_03852cfaf42ac090962572a97759a414'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f4ab33902c9c7-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:58:05,507 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:58:05,507 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:58:05,508 - DEBUG - receive_response_body.complete
2024-10-15 13:58:05,508 - DEBUG - response_closed.started
2024-10-15 13:58:05,508 - DEBUG - response_closed.complete
2024-10-15 13:58:05,508 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 10:58:06 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '2576', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9989', 'x-ratelimit-remaining-tokens': '9575', 'x-ratelimit-reset-requests': '1m26.815s', 'x-ratelimit-reset-tokens': '2.55s', 'x-request-id': 'req_03852cfaf42ac090962572a97759a414', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f4ab33902c9c7-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 13:58:05,509 - DEBUG - request_id: req_03852cfaf42ac090962572a97759a414
2024-10-15 13:58:05,510 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZXXksOqwt4B2Vjaf6EfkvK8IbDz', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_NwkABNdq1S2oBI75ubVXbhaP', function=Function(arguments='{\n  "content": [\n    {\n      "name": "ELENA VASILESCU",\n      "address": "Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B"\n    }\n  ]\n}', name='Response'), type='function')]))], created=1728989883, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=56, prompt_tokens=476, total_tokens=532, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:58:05,512 - DEBUG - Returning model from AdapterBase
2024-10-15 13:58:06,619 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Determine_contract_type: Determine the type of contract to be created.\n3. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 13:58:06,619 - DEBUG - max_retries: 1
2024-10-15 13:58:06,621 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Determine_contract_type: Determine the type of contract to be created.\n3. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 13:58:06,622 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:58:06,622 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:58:06,622 - DEBUG - send_request_headers.complete
2024-10-15 13:58:06,622 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:58:06,622 - DEBUG - send_request_body.complete
2024-10-15 13:58:06,622 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:58:07,987 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:58:08 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1220'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9989'), (b'x-ratelimit-remaining-tokens', b'9607'), (b'x-ratelimit-reset-requests', b'1m31.614s'), (b'x-ratelimit-reset-tokens', b'2.358s'), (b'x-request-id', b'req_956f723b86f476935de771a7be8ac4c6'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f4acb3e69c9c7-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:58:07,988 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:58:07,989 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:58:07,989 - DEBUG - receive_response_body.complete
2024-10-15 13:58:07,989 - DEBUG - response_closed.started
2024-10-15 13:58:07,990 - DEBUG - response_closed.complete
2024-10-15 13:58:07,990 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 10:58:08 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1220', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9989', 'x-ratelimit-remaining-tokens': '9607', 'x-ratelimit-reset-requests': '1m31.614s', 'x-ratelimit-reset-tokens': '2.358s', 'x-request-id': 'req_956f723b86f476935de771a7be8ac4c6', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f4acb3e69c9c7-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 13:58:07,990 - DEBUG - request_id: req_956f723b86f476935de771a7be8ac4c6
2024-10-15 13:58:07,991 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZXbDNWccZOdjbhX9TpaI3QmhTpq', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_0e2B6yzCi4WNN3s0kHw5PMuf', function=Function(arguments='\n{\n  "action": "Determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728989887, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=13, prompt_tokens=361, total_tokens=374, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:58:07,994 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Determine_contract_type: Determine the type of contract to be created.\n3. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 13:58:07,994 - DEBUG - max_retries: 1
2024-10-15 13:58:07,996 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Determine_contract_type: Determine the type of contract to be created.\n3. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 13:58:07,997 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:58:07,998 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:58:07,998 - DEBUG - send_request_headers.complete
2024-10-15 13:58:07,998 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:58:07,998 - DEBUG - send_request_body.complete
2024-10-15 13:58:07,998 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:58:08,878 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:58:09 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'734'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9988'), (b'x-ratelimit-remaining-tokens', b'9462'), (b'x-ratelimit-reset-requests', b'1m38.879s'), (b'x-ratelimit-reset-tokens', b'3.227s'), (b'x-request-id', b'req_fe49a77bd38e00f58deded965f66ae3b'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f4ad3ce6cc9c7-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:58:08,879 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:58:08,879 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:58:08,879 - DEBUG - receive_response_body.complete
2024-10-15 13:58:08,880 - DEBUG - response_closed.started
2024-10-15 13:58:08,880 - DEBUG - response_closed.complete
2024-10-15 13:58:08,880 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 10:58:09 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '734', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9988', 'x-ratelimit-remaining-tokens': '9462', 'x-ratelimit-reset-requests': '1m38.879s', 'x-ratelimit-reset-tokens': '3.227s', 'x-request-id': 'req_fe49a77bd38e00f58deded965f66ae3b', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f4ad3ce6cc9c7-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 13:58:08,880 - DEBUG - request_id: req_fe49a77bd38e00f58deded965f66ae3b
2024-10-15 13:58:08,881 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZXc6fQqFzKyZ8nFusf1xhZ1Nthe', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_5lvzh2DjofyLTpnUbWOIxD4H', function=Function(arguments='\n{\n  "action": "Determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728989888, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=13, prompt_tokens=361, total_tokens=374, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:58:08,884 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Determine_contract_type: Determine the type of contract to be created.\n3. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 13:58:08,884 - DEBUG - max_retries: 1
2024-10-15 13:58:08,887 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Determine_contract_type: Determine the type of contract to be created.\n3. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 13:58:08,888 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:58:08,888 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:58:08,889 - DEBUG - send_request_headers.complete
2024-10-15 13:58:08,889 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:58:08,889 - DEBUG - send_request_body.complete
2024-10-15 13:58:08,889 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:58:09,924 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:58:10 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'829'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9987'), (b'x-ratelimit-remaining-tokens', b'9239'), (b'x-ratelimit-reset-requests', b'1m46.613s'), (b'x-ratelimit-reset-tokens', b'4.565s'), (b'x-request-id', b'req_c10fe0f467fabae9859e4957641562d9'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f4ad95e0dc9c7-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:58:09,925 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:58:09,925 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:58:09,926 - DEBUG - receive_response_body.complete
2024-10-15 13:58:09,926 - DEBUG - response_closed.started
2024-10-15 13:58:09,926 - DEBUG - response_closed.complete
2024-10-15 13:58:09,926 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 10:58:10 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '829', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9987', 'x-ratelimit-remaining-tokens': '9239', 'x-ratelimit-reset-requests': '1m46.613s', 'x-ratelimit-reset-tokens': '4.565s', 'x-request-id': 'req_c10fe0f467fabae9859e4957641562d9', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f4ad95e0dc9c7-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 13:58:09,927 - DEBUG - request_id: req_c10fe0f467fabae9859e4957641562d9
2024-10-15 13:58:09,928 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZXduptEGS49CaLetmoMyiFfWIaa', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_rBqZawgCKVBKVKkvWQiES9aS', function=Function(arguments='\n{\n  "action": "Determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728989889, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=13, prompt_tokens=361, total_tokens=374, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:58:09,933 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Determine_contract_type: Determine the type of contract to be created.\n3. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 13:58:09,934 - DEBUG - max_retries: 1
2024-10-15 13:58:09,938 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Determine_contract_type: Determine the type of contract to be created.\n3. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 13:58:09,939 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:58:09,939 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:58:09,939 - DEBUG - send_request_headers.complete
2024-10-15 13:58:09,939 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:58:09,939 - DEBUG - send_request_body.complete
2024-10-15 13:58:09,939 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:58:10,920 - DEBUG - receive_response_headers.failed exception=KeyboardInterrupt()
2024-10-15 13:58:10,920 - DEBUG - response_closed.started
2024-10-15 13:58:10,921 - DEBUG - response_closed.complete
2024-10-15 13:58:11,096 - ERROR - Task exception was never retrieved
future: <Task finished name='Task-1' coro=<agent_workflow() done, defined at D:\deve\contract_automation\src\main.py:26> exception=KeyboardInterrupt()>
Traceback (most recent call last):
  File "D:\deve\contract_automation\src\main.py", line 100, in <module>
    asyncio.run(agent_workflow())
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 30, in run
    return loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 92, in run_until_complete
    self._run_once()
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 133, in _run_once
    handle._run()
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 386, in __wakeup
    self.__step()
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 293, in __step
    self.__step_run_and_handle_result(exc)
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 304, in __step_run_and_handle_result
    result = coro.send(None)
             ^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\src\main.py", line 42, in agent_workflow
    action = agent_action(state, templates)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\src\ai_functions.py", line 199, in agent_action
    response = client.chat.completions.create(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\instructor\patch.py", line 291, in new_create_sync
    response = retry_sync(
               ^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\instructor\retry.py", line 189, in retry_sync
    for attempt in max_retries:
  File "D:\deve\contract_automation\.venv\Lib\site-packages\tenacity\__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\tenacity\__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\tenacity\__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\deve\contract_automation\.venv\Lib\site-packages\instructor\retry.py", line 192, in retry_sync
    response = func(*args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\openai\_utils\_utils.py", line 274, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\openai\resources\chat\completions.py", line 742, in create
    return self._post(
           ^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\openai\_base_client.py", line 1270, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\openai\_base_client.py", line 947, in request
    return self._request(
           ^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\openai\_base_client.py", line 983, in _request
    response = self._client.send(
               ^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpx\_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpx\_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpx\_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpx\_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpx\_transports\default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpcore\_sync\connection_pool.py", line 216, in handle_request
    raise exc from None
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpcore\_sync\connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpcore\_sync\connection.py", line 101, in handle_request
    return self._connection.handle_request(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpcore\_sync\http11.py", line 143, in handle_request
    raise exc
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpcore\_sync\http11.py", line 113, in handle_request
    ) = self._receive_response_headers(**kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpcore\_sync\http11.py", line 186, in _receive_response_headers
    event = self._receive_event(timeout=timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpcore\_sync\http11.py", line 224, in _receive_event
    data = self._network_stream.read(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpcore\_backends\sync.py", line 126, in read
    return self._sock.recv(max_bytes)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\ssl.py", line 1234, in recv
    return self.read(buflen)
           ^^^^^^^^^^^^^^^^^
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\ssl.py", line 1107, in read
    return self._sslobj.read(len)
           ^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
2024-10-15 13:58:53,966 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-15 13:58:55,211 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-15 13:58:55,212 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-15 13:58:55,526 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-15 13:58:55,527 - DEBUG - Using proactor: IocpProactor
2024-10-15 13:58:55,555 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 13:58:55,555 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 13:58:55,555 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 13:58:55,555 - DEBUG - Compression method 0
2024-10-15 13:58:55,555 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 13:58:55,555 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 13:58:55,555 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 13:58:55,556 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 13:58:55,556 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 13:58:55,556 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 13:58:55,556 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 13:58:55,556 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 13:58:55,556 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 13:58:55,556 - DEBUG - Compression method 0
2024-10-15 13:58:55,556 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 13:58:55,556 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 13:58:55,556 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 13:58:55,556 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 13:58:55,556 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 13:58:55,556 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 13:58:55,566 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 13:58:55,567 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 13:58:55,567 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 13:58:55,567 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 13:58:55,568 - DEBUG - Error closing: Operation on closed image
2024-10-15 13:58:57,569 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 13:58:57,569 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 13:58:57,569 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 13:58:57,569 - DEBUG - Compression method 0
2024-10-15 13:58:57,569 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 13:58:57,569 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 13:58:57,569 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 13:58:57,569 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 13:58:57,569 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 13:58:57,569 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 13:58:57,569 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 13:58:57,569 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 13:58:57,569 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 13:58:57,569 - DEBUG - Compression method 0
2024-10-15 13:58:57,569 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 13:58:57,569 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 13:58:57,569 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 13:58:57,569 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 13:58:57,569 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 13:58:57,569 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 13:58:57,587 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 13:58:57,587 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 13:58:57,587 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 13:58:57,587 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 13:58:57,588 - DEBUG - Error closing: Operation on closed image
2024-10-15 13:59:00,091 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'instructor.dsl.simple_type.Response'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}}
2024-10-15 13:59:00,092 - DEBUG - max_retries: 1
2024-10-15 13:59:00,093 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}, 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}]}}
2024-10-15 13:59:00,129 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:59:00,129 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-15 13:59:00,177 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001C044E36570>
2024-10-15 13:59:00,177 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x000001C044DEE750> server_hostname='api.openai.com' timeout=5.0
2024-10-15 13:59:00,187 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001C044BA6930>
2024-10-15 13:59:00,187 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:59:00,187 - DEBUG - send_request_headers.complete
2024-10-15 13:59:00,187 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:59:00,187 - DEBUG - send_request_body.complete
2024-10-15 13:59:00,187 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:59:02,713 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:59:03 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2370'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9991'), (b'x-ratelimit-remaining-tokens', b'9569'), (b'x-ratelimit-reset-requests', b'1m12.605s'), (b'x-ratelimit-reset-tokens', b'2.586s'), (b'x-request-id', b'req_1d8255f10a67195d7f8f56bd3e6f66dc'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=xUOe2RTyyZU8VtgpOjmD8JD0OnpIb73yozKSpm5di7I-1728989943-1.0.1.1-MQjajlNMntB4h7yrZK2xIvf190So8xCjB3heb5SkY7DXdufuSpmg.EowXgpftFUDYQBn5bQNLhskUAnK4Gm8EQ; path=/; expires=Tue, 15-Oct-24 11:29:03 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=Y5Tpu4a8LExSWxoaBFnxMr3jDfeeumCX3wTMuQiiYzk-1728989943319-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f4c19ff9db68b-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:59:02,714 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:59:02,714 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:59:02,715 - DEBUG - receive_response_body.complete
2024-10-15 13:59:02,715 - DEBUG - response_closed.started
2024-10-15 13:59:02,715 - DEBUG - response_closed.complete
2024-10-15 13:59:02,716 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Tue, 15 Oct 2024 10:59:03 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-kzzh9hik9ryjiou4ftvhondh'), ('openai-processing-ms', '2370'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '10000'), ('x-ratelimit-remaining-requests', '9991'), ('x-ratelimit-remaining-tokens', '9569'), ('x-ratelimit-reset-requests', '1m12.605s'), ('x-ratelimit-reset-tokens', '2.586s'), ('x-request-id', 'req_1d8255f10a67195d7f8f56bd3e6f66dc'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=xUOe2RTyyZU8VtgpOjmD8JD0OnpIb73yozKSpm5di7I-1728989943-1.0.1.1-MQjajlNMntB4h7yrZK2xIvf190So8xCjB3heb5SkY7DXdufuSpmg.EowXgpftFUDYQBn5bQNLhskUAnK4Gm8EQ; path=/; expires=Tue, 15-Oct-24 11:29:03 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=Y5Tpu4a8LExSWxoaBFnxMr3jDfeeumCX3wTMuQiiYzk-1728989943319-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d2f4c19ff9db68b-OTP'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-15 13:59:02,716 - DEBUG - request_id: req_1d8255f10a67195d7f8f56bd3e6f66dc
2024-10-15 13:59:02,719 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZYThyUSfHS1UfLyhsRoqfjBLVUz', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_k8tvOWBHGSZoeFvUXUpLOHHj', function=Function(arguments='{\n  "content": [\n    {\n      "name": "ISPILANTE SENTIMENT BRUSLI",\n      "address": "Videle, Jud: Teleorman, Sos. Giurgiului nr.1 695 TR"\n    }\n  ]\n}', name='Response'), type='function')]))], created=1728989941, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=55, prompt_tokens=472, total_tokens=527, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:59:02,720 - DEBUG - Returning model from AdapterBase
2024-10-15 13:59:04,661 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'instructor.dsl.simple_type.Response'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}}
2024-10-15 13:59:04,661 - DEBUG - max_retries: 1
2024-10-15 13:59:04,663 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}, 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}]}}
2024-10-15 13:59:04,664 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:59:04,664 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:59:04,664 - DEBUG - send_request_headers.complete
2024-10-15 13:59:04,665 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:59:04,665 - DEBUG - send_request_body.complete
2024-10-15 13:59:04,665 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:59:07,743 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:59:08 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2931'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9991'), (b'x-ratelimit-remaining-tokens', b'9576'), (b'x-ratelimit-reset-requests', b'1m16.771s'), (b'x-ratelimit-reset-tokens', b'2.544s'), (b'x-request-id', b'req_be53b3a9e876d1f57fb4f28b060fcb5c'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f4c35fbd7b68b-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:59:07,744 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:59:07,744 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:59:07,745 - DEBUG - receive_response_body.complete
2024-10-15 13:59:07,745 - DEBUG - response_closed.started
2024-10-15 13:59:07,745 - DEBUG - response_closed.complete
2024-10-15 13:59:07,745 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 10:59:08 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '2931', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9991', 'x-ratelimit-remaining-tokens': '9576', 'x-ratelimit-reset-requests': '1m16.771s', 'x-ratelimit-reset-tokens': '2.544s', 'x-request-id': 'req_be53b3a9e876d1f57fb4f28b060fcb5c', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f4c35fbd7b68b-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 13:59:07,745 - DEBUG - request_id: req_be53b3a9e876d1f57fb4f28b060fcb5c
2024-10-15 13:59:07,746 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZYXDnRXlCMHCcFyh5Nc0MJRlhZ8', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_Q71KA0PRke6Txtnv0kyn6U92', function=Function(arguments='{\n  "content": [\n    {\n      "name": "ELENA VASILESCU",\n      "address": "Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B"\n    }\n  ]\n}', name='Response'), type='function')]))], created=1728989945, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=56, prompt_tokens=475, total_tokens=531, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:59:07,748 - DEBUG - Returning model from AdapterBase
2024-10-15 13:59:08,650 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 13:59:08,650 - DEBUG - max_retries: 1
2024-10-15 13:59:08,652 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 13:59:08,652 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:59:08,653 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:59:08,653 - DEBUG - send_request_headers.complete
2024-10-15 13:59:08,653 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:59:08,653 - DEBUG - send_request_body.complete
2024-10-15 13:59:08,653 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:59:09,687 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:59:10 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'857'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9990'), (b'x-ratelimit-remaining-tokens', b'9608'), (b'x-ratelimit-reset-requests', b'1m21.401s'), (b'x-ratelimit-reset-tokens', b'2.352s'), (b'x-request-id', b'req_f9203f630ca54f090c4279dd0ca93568'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f4c4ee9e6b68b-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:59:09,688 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:59:09,688 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:59:09,688 - DEBUG - receive_response_body.complete
2024-10-15 13:59:09,688 - DEBUG - response_closed.started
2024-10-15 13:59:09,688 - DEBUG - response_closed.complete
2024-10-15 13:59:09,688 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 10:59:10 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '857', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9990', 'x-ratelimit-remaining-tokens': '9608', 'x-ratelimit-reset-requests': '1m21.401s', 'x-ratelimit-reset-tokens': '2.352s', 'x-request-id': 'req_f9203f630ca54f090c4279dd0ca93568', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f4c4ee9e6b68b-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 13:59:09,688 - DEBUG - request_id: req_f9203f630ca54f090c4279dd0ca93568
2024-10-15 13:59:09,688 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZYbJmoL5S2YuyXTKkkCci0hzGrj', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_F9QuoO7EHFVabpa6VEIO3raf', function=Function(arguments='{\n  "action": "determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728989949, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=12, prompt_tokens=360, total_tokens=372, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:59:11,588 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: Yes\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 13:59:11,589 - DEBUG - max_retries: 1
2024-10-15 13:59:11,591 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: Yes\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 13:59:11,591 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:59:11,591 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:59:11,592 - DEBUG - send_request_headers.complete
2024-10-15 13:59:11,592 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:59:11,592 - DEBUG - send_request_body.complete
2024-10-15 13:59:11,592 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:59:13,066 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:59:13 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1293'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9989'), (b'x-ratelimit-remaining-tokens', b'9608'), (b'x-ratelimit-reset-requests', b'1m27.122s'), (b'x-ratelimit-reset-tokens', b'2.352s'), (b'x-request-id', b'req_77a40a9284d6bb2c215d0ff8f85d4e9e'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f4c614969b68b-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:59:13,066 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:59:13,066 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:59:13,066 - DEBUG - receive_response_body.complete
2024-10-15 13:59:13,066 - DEBUG - response_closed.started
2024-10-15 13:59:13,066 - DEBUG - response_closed.complete
2024-10-15 13:59:13,066 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 10:59:13 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1293', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9989', 'x-ratelimit-remaining-tokens': '9608', 'x-ratelimit-reset-requests': '1m27.122s', 'x-ratelimit-reset-tokens': '2.352s', 'x-request-id': 'req_77a40a9284d6bb2c215d0ff8f85d4e9e', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f4c614969b68b-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 13:59:13,066 - DEBUG - request_id: req_77a40a9284d6bb2c215d0ff8f85d4e9e
2024-10-15 13:59:13,067 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZYe0iCBcC0crmFJ8WCVfjjO3ow8', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_H3bnxrJW11Nvhw0L745yyq8m', function=Function(arguments='\n{\n  "action": "identify_parties"\n}', name='AgentAction'), type='function')]))], created=1728989952, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=12, prompt_tokens=360, total_tokens=372, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:59:13,068 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.ContractParties'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': 'Identify the parties and their roles for a it contract based on the following information:\n\nName: ISPILANTE SENTIMENT BRUSLI, Address: Videle, Jud: Teleorman, Sos. Giurgiului nr.1 695 TR\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'$defs': {'ContractParty': {'properties': {'name': {'description': 'Name of the party', 'title': 'Name', 'type': 'string'}, 'role': {'description': 'Role of the party in the contract', 'title': 'Role', 'type': 'string'}}, 'required': ['name', 'role'], 'title': 'ContractParty', 'type': 'object'}}, 'properties': {'parties': {'description': 'List of parties involved in the contract', 'items': {'$ref': '#/$defs/ContractParty'}, 'title': 'Parties', 'type': 'array'}}, 'required': ['parties'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}}
2024-10-15 13:59:13,068 - DEBUG - max_retries: 1
2024-10-15 13:59:13,069 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': 'Identify the parties and their roles for a it contract based on the following information:\n\nName: ISPILANTE SENTIMENT BRUSLI, Address: Videle, Jud: Teleorman, Sos. Giurgiului nr.1 695 TR\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}, 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'$defs': {'ContractParty': {'properties': {'name': {'description': 'Name of the party', 'title': 'Name', 'type': 'string'}, 'role': {'description': 'Role of the party in the contract', 'title': 'Role', 'type': 'string'}}, 'required': ['name', 'role'], 'title': 'ContractParty', 'type': 'object'}}, 'properties': {'parties': {'description': 'List of parties involved in the contract', 'items': {'$ref': '#/$defs/ContractParty'}, 'title': 'Parties', 'type': 'array'}}, 'required': ['parties'], 'type': 'object'}}}]}}
2024-10-15 13:59:13,070 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:59:13,070 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:59:13,070 - DEBUG - send_request_headers.complete
2024-10-15 13:59:13,070 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:59:13,070 - DEBUG - send_request_body.complete
2024-10-15 13:59:13,070 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:59:16,013 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:59:16 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2787'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9989'), (b'x-ratelimit-remaining-tokens', b'9538'), (b'x-ratelimit-reset-requests', b'1m34.276s'), (b'x-ratelimit-reset-tokens', b'2.767s'), (b'x-request-id', b'req_7b41d90a1cb6e4a99bc41342612b96a0'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f4c6a8cecb68b-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:59:16,013 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:59:16,013 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:59:16,014 - DEBUG - receive_response_body.complete
2024-10-15 13:59:16,014 - DEBUG - response_closed.started
2024-10-15 13:59:16,014 - DEBUG - response_closed.complete
2024-10-15 13:59:16,014 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 10:59:16 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '2787', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9989', 'x-ratelimit-remaining-tokens': '9538', 'x-ratelimit-reset-requests': '1m34.276s', 'x-ratelimit-reset-tokens': '2.767s', 'x-request-id': 'req_7b41d90a1cb6e4a99bc41342612b96a0', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f4c6a8cecb68b-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 13:59:16,014 - DEBUG - request_id: req_7b41d90a1cb6e4a99bc41342612b96a0
2024-10-15 13:59:16,014 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZYfULoGVCr6LmjmOMUBqHvDsIF3', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_mOkI96afAt653gAgMRKxdfaT', function=Function(arguments='{\n  "parties": [\n    {\n      "name": "ISPILANTE SENTIMENT BRUSLI",\n      "role": "Service Provider"\n    },\n    {\n      "name": "ELENA VASILESCU",\n      "role": "Client"\n    }\n  ]\n}', name='ContractParties'), type='function')]))], created=1728989953, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=61, prompt_tokens=357, total_tokens=418, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:59:16,016 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: Yes\n    - Parties identified: Yes\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 13:59:16,016 - DEBUG - max_retries: 1
2024-10-15 13:59:16,018 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: Yes\n    - Parties identified: Yes\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 13:59:16,018 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:59:16,018 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:59:16,019 - DEBUG - send_request_headers.complete
2024-10-15 13:59:16,019 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:59:16,019 - DEBUG - send_request_body.complete
2024-10-15 13:59:16,019 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:59:16,896 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:59:17 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'728'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9988'), (b'x-ratelimit-remaining-tokens', b'9550'), (b'x-ratelimit-reset-requests', b'1m39.971s'), (b'x-ratelimit-reset-tokens', b'2.698s'), (b'x-request-id', b'req_c28efc21fa90e215dbd0decb49f62b71'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f4c7cfdc5b68b-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:59:16,896 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:59:16,896 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:59:16,896 - DEBUG - receive_response_body.complete
2024-10-15 13:59:16,896 - DEBUG - response_closed.started
2024-10-15 13:59:16,896 - DEBUG - response_closed.complete
2024-10-15 13:59:16,896 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 10:59:17 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '728', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9988', 'x-ratelimit-remaining-tokens': '9550', 'x-ratelimit-reset-requests': '1m39.971s', 'x-ratelimit-reset-tokens': '2.698s', 'x-request-id': 'req_c28efc21fa90e215dbd0decb49f62b71', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f4c7cfdc5b68b-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 13:59:16,896 - DEBUG - request_id: req_c28efc21fa90e215dbd0decb49f62b71
2024-10-15 13:59:16,897 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZYip76SwwMz5SP0p88YtWseLoVU', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_772PTnhzKXK3xL9u4K82td3w', function=Function(arguments='{\n  "action": "construct_contract"\n}', name='AgentAction'), type='function')]))], created=1728989956, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=10, prompt_tokens=360, total_tokens=370, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:59:16,898 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.Contract'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': 'Construct a it contract using the following template and information:\n\nTemplate:\nConsulting Agreement\n\nThis Consulting Agreement ("Agreement") is made on [date] between:\n\n1. Parties\n\nConsultant: [Consultant\'s Name], residing at [Consultant\'s Address].\n\nClient: [Client\'s Name], with a principal office at [Client\'s Address].\n\n2. Scope of Services\n\nThe Consultant agrees to provide the following IT consulting services ("Services") to the Client:\n\nDescription of Services: [Provide a detailed description of the IT services to be provided, e.g., network setup, cybersecurity assessment, software development, etc.]\n\nDeliverables: [List of specific deliverables, if applicable]\n\n3. Term of Agreement\n\nStart Date: This Agreement shall commence on [Start Date].\n\nEnd Date: The Agreement will continue until [End Date/Project Completion] or until terminated by either party in accordance with this Agreement.\n\n4. Compensation\n\nHourly Rate: [Rate in USD per hour] or Fixed Fee: [Total Amount in USD]\n\nPayment Terms: Invoices shall be submitted [weekly/bi-weekly/monthly] and are payable within [X] days of receipt.\n\n5. Expenses\n\nReimbursement: The Client shall reimburse the Consultant for reasonable expenses incurred in connection with the Services, provided such expenses have been pre-approved by the Client.\n\n6. Confidentiality\n\nConfidential Information: The Consultant agrees not to disclose any confidential or proprietary information obtained during the term of this Agreement. Confidential information includes, but is not limited to, business strategies, technical details, and client data.\n\n7. Intellectual Property\n\nOwnership: Any work product or deliverables created by the Consultant in the course of providing the Services shall be the sole property of the Client. The Consultant hereby assigns all rights, title, and interest in such work product to the Client.\n\n8. Termination\n\nTermination Notice: Either party may terminate this Agreement by giving [X] days\' written notice to the other party.\n\nTermination for Cause: The Client may terminate this Agreement immediately if the Consultant fails to perform their obligations.\n\n9. Liability\n\nLimitation of Liability: The Consultant shall not be liable for any indirect, incidental, or consequential damages arising from the Services provided. The Consultant\'s liability under this Agreement shall be limited to the total amount of fees paid by the Client.\n\n10. Governing Law\n\nThis Agreement shall be governed by the laws of [Jurisdiction].\n\n11. Entire Agreement\n\nThis Agreement constitutes the entire understanding between the Consultant and the Client regarding the Services and supersedes all prior negotiations and understandings, whether written or oral.\n\n12. Signatures\n\nConsultant Signature: ______________________\n\nDate: ______________________\n\nClient Signature: ______________________\n\nDate: ______________________\n\nParties: Service Provider: ISPILANTE SENTIMENT BRUSLI, Client: ELENA VASILESCU\nAddress: Videle, Jud: Teleorman, Sos. Giurgiului nr.1 695 TR\nAdditional Details: {}'}], 'tools': [{'type': 'function', 'function': {'name': 'Contract', 'description': 'Correctly extracted `Contract` with all the required parameters with correct types', 'parameters': {'$defs': {'ContractParty': {'properties': {'name': {'description': 'Name of the party', 'title': 'Name', 'type': 'string'}, 'role': {'description': 'Role of the party in the contract', 'title': 'Role', 'type': 'string'}}, 'required': ['name', 'role'], 'title': 'ContractParty', 'type': 'object'}}, 'properties': {'parties': {'description': 'List of parties involved in the contract', 'items': {'$ref': '#/$defs/ContractParty'}, 'title': 'Parties', 'type': 'array'}, 'address': {'description': 'Address where the contract is applicable', 'title': 'Address', 'type': 'string'}, 'terms': {'description': 'Terms of the contract', 'title': 'Terms', 'type': 'string'}}, 'required': ['address', 'parties', 'terms'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'Contract'}}}
2024-10-15 13:59:16,898 - DEBUG - max_retries: 1
2024-10-15 13:59:16,900 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': 'Construct a it contract using the following template and information:\n\nTemplate:\nConsulting Agreement\n\nThis Consulting Agreement ("Agreement") is made on [date] between:\n\n1. Parties\n\nConsultant: [Consultant\'s Name], residing at [Consultant\'s Address].\n\nClient: [Client\'s Name], with a principal office at [Client\'s Address].\n\n2. Scope of Services\n\nThe Consultant agrees to provide the following IT consulting services ("Services") to the Client:\n\nDescription of Services: [Provide a detailed description of the IT services to be provided, e.g., network setup, cybersecurity assessment, software development, etc.]\n\nDeliverables: [List of specific deliverables, if applicable]\n\n3. Term of Agreement\n\nStart Date: This Agreement shall commence on [Start Date].\n\nEnd Date: The Agreement will continue until [End Date/Project Completion] or until terminated by either party in accordance with this Agreement.\n\n4. Compensation\n\nHourly Rate: [Rate in USD per hour] or Fixed Fee: [Total Amount in USD]\n\nPayment Terms: Invoices shall be submitted [weekly/bi-weekly/monthly] and are payable within [X] days of receipt.\n\n5. Expenses\n\nReimbursement: The Client shall reimburse the Consultant for reasonable expenses incurred in connection with the Services, provided such expenses have been pre-approved by the Client.\n\n6. Confidentiality\n\nConfidential Information: The Consultant agrees not to disclose any confidential or proprietary information obtained during the term of this Agreement. Confidential information includes, but is not limited to, business strategies, technical details, and client data.\n\n7. Intellectual Property\n\nOwnership: Any work product or deliverables created by the Consultant in the course of providing the Services shall be the sole property of the Client. The Consultant hereby assigns all rights, title, and interest in such work product to the Client.\n\n8. Termination\n\nTermination Notice: Either party may terminate this Agreement by giving [X] days\' written notice to the other party.\n\nTermination for Cause: The Client may terminate this Agreement immediately if the Consultant fails to perform their obligations.\n\n9. Liability\n\nLimitation of Liability: The Consultant shall not be liable for any indirect, incidental, or consequential damages arising from the Services provided. The Consultant\'s liability under this Agreement shall be limited to the total amount of fees paid by the Client.\n\n10. Governing Law\n\nThis Agreement shall be governed by the laws of [Jurisdiction].\n\n11. Entire Agreement\n\nThis Agreement constitutes the entire understanding between the Consultant and the Client regarding the Services and supersedes all prior negotiations and understandings, whether written or oral.\n\n12. Signatures\n\nConsultant Signature: ______________________\n\nDate: ______________________\n\nClient Signature: ______________________\n\nDate: ______________________\n\nParties: Service Provider: ISPILANTE SENTIMENT BRUSLI, Client: ELENA VASILESCU\nAddress: Videle, Jud: Teleorman, Sos. Giurgiului nr.1 695 TR\nAdditional Details: {}'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'Contract'}}, 'tools': [{'type': 'function', 'function': {'name': 'Contract', 'description': 'Correctly extracted `Contract` with all the required parameters with correct types', 'parameters': {'$defs': {'ContractParty': {'properties': {'name': {'description': 'Name of the party', 'title': 'Name', 'type': 'string'}, 'role': {'description': 'Role of the party in the contract', 'title': 'Role', 'type': 'string'}}, 'required': ['name', 'role'], 'title': 'ContractParty', 'type': 'object'}}, 'properties': {'parties': {'description': 'List of parties involved in the contract', 'items': {'$ref': '#/$defs/ContractParty'}, 'title': 'Parties', 'type': 'array'}, 'address': {'description': 'Address where the contract is applicable', 'title': 'Address', 'type': 'string'}, 'terms': {'description': 'Terms of the contract', 'title': 'Terms', 'type': 'string'}}, 'required': ['address', 'parties', 'terms'], 'type': 'object'}}}]}}
2024-10-15 13:59:16,900 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:59:16,900 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:59:16,900 - DEBUG - send_request_headers.complete
2024-10-15 13:59:16,900 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:59:16,900 - DEBUG - send_request_body.complete
2024-10-15 13:59:16,900 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:59:21,885 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:59:22 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'4828'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9987'), (b'x-ratelimit-remaining-tokens', b'8689'), (b'x-ratelimit-reset-requests', b'1m47.73s'), (b'x-ratelimit-reset-tokens', b'7.865s'), (b'x-request-id', b'req_f58bef101014761373e4b9f3c32e2be9'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f4c827ca9b68b-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:59:21,886 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:59:21,886 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:59:21,888 - DEBUG - receive_response_body.complete
2024-10-15 13:59:21,888 - DEBUG - response_closed.started
2024-10-15 13:59:21,888 - DEBUG - response_closed.complete
2024-10-15 13:59:21,888 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 10:59:22 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '4828', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9987', 'x-ratelimit-remaining-tokens': '8689', 'x-ratelimit-reset-requests': '1m47.73s', 'x-ratelimit-reset-tokens': '7.865s', 'x-request-id': 'req_f58bef101014761373e4b9f3c32e2be9', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f4c827ca9b68b-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 13:59:21,888 - DEBUG - request_id: req_f58bef101014761373e4b9f3c32e2be9
2024-10-15 13:59:21,889 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZYjKwwiyf3NmMjn1xur8k7Hg6CA', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_Hn73OJ4EAmCTWSrhJZKKObcP', function=Function(arguments='{\n  "parties": [\n    {\n      "name": "ISPILANTE SENTIMENT BRUSLI",\n      "role": "Service Provider"\n    },\n    {\n      "name": "ELENA VASILESCU",\n      "role": "Client"\n    }\n  ],\n  "address": "Videle, Jud: Teleorman, Sos. Giurgiului nr.1 695 TR",\n  "terms": "Consulting Agreement Template, IT Consulting Services"\n}', name='Contract'), type='function')]))], created=1728989957, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=103, prompt_tokens=895, total_tokens=998, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:59:21,892 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: Yes\n    - Parties identified: Yes\n    - Contract constructed: Yes\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 13:59:21,892 - DEBUG - max_retries: 1
2024-10-15 13:59:21,895 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. The possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: Yes\n    - Parties identified: Yes\n    - Contract constructed: Yes\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 13:59:21,895 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 13:59:21,895 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 13:59:21,895 - DEBUG - send_request_headers.complete
2024-10-15 13:59:21,896 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 13:59:21,896 - DEBUG - send_request_body.complete
2024-10-15 13:59:21,896 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 13:59:22,740 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 10:59:23 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'670'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9987'), (b'x-ratelimit-remaining-tokens', b'9161'), (b'x-ratelimit-reset-requests', b'1m51.373s'), (b'x-ratelimit-reset-tokens', b'5.028s'), (b'x-request-id', b'req_0076759e6aeebdbe22f571d59fcaf575'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f4ca1a991b68b-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 13:59:22,740 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 13:59:22,740 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 13:59:22,740 - DEBUG - receive_response_body.complete
2024-10-15 13:59:22,740 - DEBUG - response_closed.started
2024-10-15 13:59:22,740 - DEBUG - response_closed.complete
2024-10-15 13:59:22,740 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 10:59:23 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '670', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9987', 'x-ratelimit-remaining-tokens': '9161', 'x-ratelimit-reset-requests': '1m51.373s', 'x-ratelimit-reset-tokens': '5.028s', 'x-request-id': 'req_0076759e6aeebdbe22f571d59fcaf575', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f4ca1a991b68b-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 13:59:22,740 - DEBUG - request_id: req_0076759e6aeebdbe22f571d59fcaf575
2024-10-15 13:59:22,741 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZYoSn6UkYnIz6fEzOdmvx911L7r', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_K096P1WJYe9UIqzERSmPOrhq', function=Function(arguments='{\n  "action": "finish"\n}', name='AgentAction'), type='function')]))], created=1728989962, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=9, prompt_tokens=360, total_tokens=369, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 13:59:22,887 - DEBUG - close.started
2024-10-15 13:59:22,888 - DEBUG - close.complete
2024-10-15 14:01:58,634 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-15 14:01:59,892 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-15 14:01:59,893 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-15 14:02:00,204 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-15 14:02:00,205 - DEBUG - Using proactor: IocpProactor
2024-10-15 14:02:00,232 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 14:02:00,232 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 14:02:00,232 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 14:02:00,232 - DEBUG - Compression method 0
2024-10-15 14:02:00,232 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 14:02:00,232 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 14:02:00,232 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 14:02:00,232 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 14:02:00,232 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 14:02:00,232 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 14:02:00,233 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 14:02:00,233 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 14:02:00,233 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 14:02:00,233 - DEBUG - Compression method 0
2024-10-15 14:02:00,233 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 14:02:00,233 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 14:02:00,233 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 14:02:00,233 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 14:02:00,233 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 14:02:00,233 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 14:02:00,244 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 14:02:00,244 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 14:02:00,244 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 14:02:00,244 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 14:02:00,244 - DEBUG - Error closing: Operation on closed image
2024-10-15 14:02:02,229 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 14:02:02,229 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 14:02:02,229 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 14:02:02,229 - DEBUG - Compression method 0
2024-10-15 14:02:02,229 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 14:02:02,229 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 14:02:02,229 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 14:02:02,229 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 14:02:02,229 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 14:02:02,229 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 14:02:02,229 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 14:02:02,229 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 14:02:02,229 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 14:02:02,229 - DEBUG - Compression method 0
2024-10-15 14:02:02,229 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 14:02:02,229 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 14:02:02,229 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 14:02:02,229 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 14:02:02,229 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 14:02:02,229 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 14:02:02,246 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 14:02:02,246 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 14:02:02,246 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 14:02:02,246 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 14:02:02,247 - DEBUG - Error closing: Operation on closed image
2024-10-15 14:02:04,760 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'instructor.dsl.simple_type.Response'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Determine_contract_type: Determine the type of contract to be created.\n3. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}}
2024-10-15 14:02:04,761 - DEBUG - max_retries: 1
2024-10-15 14:02:04,763 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Determine_contract_type: Determine the type of contract to be created.\n3. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}, 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}]}}
2024-10-15 14:02:04,799 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 14:02:04,800 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-15 14:02:04,839 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001A3AE2A3680>
2024-10-15 14:02:04,839 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x000001A3AE2FE850> server_hostname='api.openai.com' timeout=5.0
2024-10-15 14:02:04,846 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001A3AE24C440>
2024-10-15 14:02:04,846 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 14:02:04,846 - DEBUG - send_request_headers.complete
2024-10-15 14:02:04,846 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 14:02:04,847 - DEBUG - send_request_body.complete
2024-10-15 14:02:04,847 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 14:02:07,901 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 11:02:08 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2905'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'9569'), (b'x-ratelimit-reset-requests', b'8.64s'), (b'x-ratelimit-reset-tokens', b'2.586s'), (b'x-request-id', b'req_94599b86547b322bc28fb2c922c9ee56'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=tmnR2zD5LyWv7GBIcuPcydJIloJxNtJzM64skWZAUq8-1728990128-1.0.1.1-hex3mO_LRIakpozXzsDQZWzdkxWt0oFvme6ktzouGWW5Wu9t5YqbvX.UtEB8ii_Jer3x.gMisTOYm291TZAPdQ; path=/; expires=Tue, 15-Oct-24 11:32:08 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=aoFvZRqTf6urheJwkSZxuZYJAh1oMnRPl9DV12aR6aE-1728990128517-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f509c2869c9ec-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 14:02:07,902 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 14:02:07,902 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 14:02:07,902 - DEBUG - receive_response_body.complete
2024-10-15 14:02:07,902 - DEBUG - response_closed.started
2024-10-15 14:02:07,902 - DEBUG - response_closed.complete
2024-10-15 14:02:07,902 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Tue, 15 Oct 2024 11:02:08 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-kzzh9hik9ryjiou4ftvhondh'), ('openai-processing-ms', '2905'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '10000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '9569'), ('x-ratelimit-reset-requests', '8.64s'), ('x-ratelimit-reset-tokens', '2.586s'), ('x-request-id', 'req_94599b86547b322bc28fb2c922c9ee56'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=tmnR2zD5LyWv7GBIcuPcydJIloJxNtJzM64skWZAUq8-1728990128-1.0.1.1-hex3mO_LRIakpozXzsDQZWzdkxWt0oFvme6ktzouGWW5Wu9t5YqbvX.UtEB8ii_Jer3x.gMisTOYm291TZAPdQ; path=/; expires=Tue, 15-Oct-24 11:32:08 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=aoFvZRqTf6urheJwkSZxuZYJAh1oMnRPl9DV12aR6aE-1728990128517-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d2f509c2869c9ec-OTP'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-15 14:02:07,902 - DEBUG - request_id: req_94599b86547b322bc28fb2c922c9ee56
2024-10-15 14:02:07,904 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZbRsKz0UaErzdVZouyDUsE85V8U', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_Q86e6i6UcmY4DG3B3Ljd8odp', function=Function(arguments='{\n  "content": [\n    {\n      "name": "ISPILANTE SENTIMENT BRUSLI",\n      "address": "Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR"\n    }\n  ]\n}', name='Response'), type='function')]))], created=1728990125, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=67, prompt_tokens=473, total_tokens=540, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 14:02:07,905 - DEBUG - Returning model from AdapterBase
2024-10-15 14:02:10,082 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'instructor.dsl.simple_type.Response'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Determine_contract_type: Determine the type of contract to be created.\n3. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}}
2024-10-15 14:02:10,082 - DEBUG - max_retries: 1
2024-10-15 14:02:10,084 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Determine_contract_type: Determine the type of contract to be created.\n3. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}, 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}]}}
2024-10-15 14:02:10,085 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 14:02:10,085 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 14:02:10,085 - DEBUG - send_request_headers.complete
2024-10-15 14:02:10,085 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 14:02:10,085 - DEBUG - send_request_body.complete
2024-10-15 14:02:10,085 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 14:02:13,146 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 11:02:13 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2916'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9998'), (b'x-ratelimit-remaining-tokens', b'9575'), (b'x-ratelimit-reset-requests', b'12.041s'), (b'x-ratelimit-reset-tokens', b'2.55s'), (b'x-request-id', b'req_5fde77e26796279bbced316d48f25d7c'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f50bcec40c9ec-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 14:02:13,147 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 14:02:13,148 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 14:02:13,148 - DEBUG - receive_response_body.complete
2024-10-15 14:02:13,148 - DEBUG - response_closed.started
2024-10-15 14:02:13,148 - DEBUG - response_closed.complete
2024-10-15 14:02:13,148 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 11:02:13 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '2916', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9998', 'x-ratelimit-remaining-tokens': '9575', 'x-ratelimit-reset-requests': '12.041s', 'x-ratelimit-reset-tokens': '2.55s', 'x-request-id': 'req_5fde77e26796279bbced316d48f25d7c', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f50bcec40c9ec-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 14:02:13,149 - DEBUG - request_id: req_5fde77e26796279bbced316d48f25d7c
2024-10-15 14:02:13,150 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZbWfUyBXoPTpBgk3oW6SZ4rQX7O', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_eOp9nflnHMyoelI3rN17RkWX', function=Function(arguments='{\n  "content": [\n    {\n      "name": "ELENA VASILESCU",\n      "address": "Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B"\n    }\n  ]\n}', name='Response'), type='function')]))], created=1728990130, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=56, prompt_tokens=476, total_tokens=532, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 14:02:13,151 - DEBUG - Returning model from AdapterBase
2024-10-15 14:02:14,247 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Determine_contract_type: Determine the type of contract to be created.\n3. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 14:02:14,247 - DEBUG - max_retries: 1
2024-10-15 14:02:14,249 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Determine_contract_type: Determine the type of contract to be created.\n3. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 14:02:14,249 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 14:02:14,250 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 14:02:14,250 - DEBUG - send_request_headers.complete
2024-10-15 14:02:14,250 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 14:02:14,250 - DEBUG - send_request_body.complete
2024-10-15 14:02:14,250 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 14:02:15,844 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 11:02:16 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1437'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9998'), (b'x-ratelimit-remaining-tokens', b'9607'), (b'x-ratelimit-reset-requests', b'16.511s'), (b'x-ratelimit-reset-tokens', b'2.358s'), (b'x-request-id', b'req_3d5df06ac71d19bbb2ae599a383cec71'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f50d6ed23c9ec-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 14:02:15,844 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 14:02:15,845 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 14:02:15,845 - DEBUG - receive_response_body.complete
2024-10-15 14:02:15,845 - DEBUG - response_closed.started
2024-10-15 14:02:15,845 - DEBUG - response_closed.complete
2024-10-15 14:02:15,845 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 11:02:16 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1437', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9998', 'x-ratelimit-remaining-tokens': '9607', 'x-ratelimit-reset-requests': '16.511s', 'x-ratelimit-reset-tokens': '2.358s', 'x-request-id': 'req_3d5df06ac71d19bbb2ae599a383cec71', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f50d6ed23c9ec-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 14:02:15,845 - DEBUG - request_id: req_3d5df06ac71d19bbb2ae599a383cec71
2024-10-15 14:02:15,845 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZbbVAsgSj9EeNrx6zvNOj0mpsFq', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_1zp3d6fLJBx2NmDLKR81INel', function=Function(arguments='{\n  "action": "Determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728990135, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=12, prompt_tokens=361, total_tokens=373, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 14:02:15,846 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Determine_contract_type: Determine the type of contract to be created.\n3. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 14:02:15,847 - DEBUG - max_retries: 1
2024-10-15 14:02:15,848 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Determine_contract_type: Determine the type of contract to be created.\n3. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 14:02:15,848 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 14:02:15,848 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 14:02:15,849 - DEBUG - send_request_headers.complete
2024-10-15 14:02:15,849 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 14:02:15,849 - DEBUG - send_request_body.complete
2024-10-15 14:02:15,849 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 14:02:16,859 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 11:02:17 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'846'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9997'), (b'x-ratelimit-remaining-tokens', b'9499'), (b'x-ratelimit-reset-requests', b'23.557s'), (b'x-ratelimit-reset-tokens', b'3.001s'), (b'x-request-id', b'req_1cc890ec3ab2f346ab14a93d585623a5'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f50e0ed50c9ec-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 14:02:16,859 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 14:02:16,859 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 14:02:16,859 - DEBUG - receive_response_body.complete
2024-10-15 14:02:16,859 - DEBUG - response_closed.started
2024-10-15 14:02:16,859 - DEBUG - response_closed.complete
2024-10-15 14:02:16,859 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 11:02:17 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '846', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9997', 'x-ratelimit-remaining-tokens': '9499', 'x-ratelimit-reset-requests': '23.557s', 'x-ratelimit-reset-tokens': '3.001s', 'x-request-id': 'req_1cc890ec3ab2f346ab14a93d585623a5', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f50e0ed50c9ec-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 14:02:16,859 - DEBUG - request_id: req_1cc890ec3ab2f346ab14a93d585623a5
2024-10-15 14:02:16,860 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZbcQCuy7i5nw27VNmcYIJWKmxnw', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_1lF9UtIKmnby0cySIPxlE9ap', function=Function(arguments='{\n"action": "Determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728990136, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=11, prompt_tokens=361, total_tokens=372, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 14:02:16,861 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Determine_contract_type: Determine the type of contract to be created.\n3. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 14:02:16,861 - DEBUG - max_retries: 1
2024-10-15 14:02:16,863 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Determine_contract_type: Determine the type of contract to be created.\n3. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 14:02:16,863 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 14:02:16,863 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 14:02:16,864 - DEBUG - send_request_headers.complete
2024-10-15 14:02:16,864 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 14:02:16,864 - DEBUG - send_request_body.complete
2024-10-15 14:02:16,864 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 14:02:18,069 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 11:02:18 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1053'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9996'), (b'x-ratelimit-remaining-tokens', b'9296'), (b'x-ratelimit-reset-requests', b'31.183s'), (b'x-ratelimit-reset-tokens', b'4.219s'), (b'x-request-id', b'req_aa8e24c0fe4eba59e3825c4894d0a105'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f50e74ac5c9ec-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 14:02:18,070 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 14:02:18,070 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 14:02:18,071 - DEBUG - receive_response_body.complete
2024-10-15 14:02:18,071 - DEBUG - response_closed.started
2024-10-15 14:02:18,071 - DEBUG - response_closed.complete
2024-10-15 14:02:18,071 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 11:02:18 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1053', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9996', 'x-ratelimit-remaining-tokens': '9296', 'x-ratelimit-reset-requests': '31.183s', 'x-ratelimit-reset-tokens': '4.219s', 'x-request-id': 'req_aa8e24c0fe4eba59e3825c4894d0a105', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f50e74ac5c9ec-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 14:02:18,071 - DEBUG - request_id: req_aa8e24c0fe4eba59e3825c4894d0a105
2024-10-15 14:02:18,072 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZbdrulOwOeL2ZyqXH06KsnTnE6k', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_BEXm1mcQX7zvkDSqccH25aqd', function=Function(arguments='\n{\n  "action": "Determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728990137, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=13, prompt_tokens=361, total_tokens=374, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 14:02:18,077 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Determine_contract_type: Determine the type of contract to be created.\n3. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 14:02:18,077 - DEBUG - max_retries: 1
2024-10-15 14:02:18,080 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Determine_contract_type: Determine the type of contract to be created.\n3. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 14:02:18,081 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 14:02:18,081 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 14:02:18,081 - DEBUG - send_request_headers.complete
2024-10-15 14:02:18,081 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 14:02:18,081 - DEBUG - send_request_body.complete
2024-10-15 14:02:18,081 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 14:02:18,956 - DEBUG - receive_response_headers.failed exception=KeyboardInterrupt()
2024-10-15 14:02:18,956 - DEBUG - response_closed.started
2024-10-15 14:02:18,956 - DEBUG - response_closed.complete
2024-10-15 14:02:19,126 - ERROR - Task exception was never retrieved
future: <Task finished name='Task-1' coro=<agent_workflow() done, defined at D:\deve\contract_automation\src\main.py:26> exception=KeyboardInterrupt()>
Traceback (most recent call last):
  File "D:\deve\contract_automation\src\main.py", line 100, in <module>
    asyncio.run(agent_workflow())
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 30, in run
    return loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 92, in run_until_complete
    self._run_once()
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 133, in _run_once
    handle._run()
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 386, in __wakeup
    self.__step()
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 293, in __step
    self.__step_run_and_handle_result(exc)
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 304, in __step_run_and_handle_result
    result = coro.send(None)
             ^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\src\main.py", line 42, in agent_workflow
    action = agent_action(state, templates)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\src\ai_functions.py", line 194, in agent_action
    response = client.chat.completions.create(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\instructor\patch.py", line 291, in new_create_sync
    response = retry_sync(
               ^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\instructor\retry.py", line 189, in retry_sync
    for attempt in max_retries:
  File "D:\deve\contract_automation\.venv\Lib\site-packages\tenacity\__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\tenacity\__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\tenacity\__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\deve\contract_automation\.venv\Lib\site-packages\instructor\retry.py", line 192, in retry_sync
    response = func(*args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\openai\_utils\_utils.py", line 274, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\openai\resources\chat\completions.py", line 742, in create
    return self._post(
           ^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\openai\_base_client.py", line 1270, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\openai\_base_client.py", line 947, in request
    return self._request(
           ^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\openai\_base_client.py", line 983, in _request
    response = self._client.send(
               ^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpx\_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpx\_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpx\_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpx\_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpx\_transports\default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpcore\_sync\connection_pool.py", line 216, in handle_request
    raise exc from None
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpcore\_sync\connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpcore\_sync\connection.py", line 101, in handle_request
    return self._connection.handle_request(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpcore\_sync\http11.py", line 143, in handle_request
    raise exc
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpcore\_sync\http11.py", line 113, in handle_request
    ) = self._receive_response_headers(**kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpcore\_sync\http11.py", line 186, in _receive_response_headers
    event = self._receive_event(timeout=timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpcore\_sync\http11.py", line 224, in _receive_event
    data = self._network_stream.read(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpcore\_backends\sync.py", line 126, in read
    return self._sock.recv(max_bytes)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\ssl.py", line 1234, in recv
    return self.read(buflen)
           ^^^^^^^^^^^^^^^^^
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\ssl.py", line 1107, in read
    return self._sslobj.read(len)
           ^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
2024-10-15 14:02:53,604 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-15 14:02:54,852 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-15 14:02:54,852 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-15 14:02:55,181 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-15 14:02:55,181 - DEBUG - Using proactor: IocpProactor
2024-10-15 14:02:55,212 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 14:02:55,212 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 14:02:55,212 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 14:02:55,212 - DEBUG - Compression method 0
2024-10-15 14:02:55,212 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 14:02:55,212 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 14:02:55,212 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 14:02:55,212 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 14:02:55,212 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 14:02:55,213 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 14:02:55,213 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 14:02:55,213 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 14:02:55,213 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 14:02:55,213 - DEBUG - Compression method 0
2024-10-15 14:02:55,213 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 14:02:55,213 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 14:02:55,213 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 14:02:55,213 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 14:02:55,213 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 14:02:55,213 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 14:02:55,223 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 14:02:55,223 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 14:02:55,223 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 14:02:55,223 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 14:02:55,224 - DEBUG - Error closing: Operation on closed image
2024-10-15 14:02:57,229 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 14:02:57,229 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 14:02:57,229 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 14:02:57,229 - DEBUG - Compression method 0
2024-10-15 14:02:57,229 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 14:02:57,229 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 14:02:57,229 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 14:02:57,229 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 14:02:57,229 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 14:02:57,229 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 14:02:57,229 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 14:02:57,229 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 14:02:57,229 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 14:02:57,229 - DEBUG - Compression method 0
2024-10-15 14:02:57,229 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 14:02:57,229 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 14:02:57,229 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 14:02:57,229 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 14:02:57,229 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 14:02:57,229 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 14:02:57,246 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 14:02:57,246 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 14:02:57,246 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 14:02:57,247 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 14:02:57,247 - DEBUG - Error closing: Operation on closed image
2024-10-15 14:02:59,733 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'instructor.dsl.simple_type.Response'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Determine_contract_type: Determine the type of contract to be created.\n3. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}}
2024-10-15 14:02:59,734 - DEBUG - max_retries: 1
2024-10-15 14:02:59,736 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Determine_contract_type: Determine the type of contract to be created.\n3. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}, 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}]}}
2024-10-15 14:02:59,773 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 14:02:59,773 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-15 14:02:59,863 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000002C0E7F9E930>
2024-10-15 14:02:59,863 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x000002C0E7F7E850> server_hostname='api.openai.com' timeout=5.0
2024-10-15 14:02:59,872 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000002C0E7E04440>
2024-10-15 14:02:59,872 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 14:02:59,872 - DEBUG - send_request_headers.complete
2024-10-15 14:02:59,872 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 14:02:59,872 - DEBUG - send_request_body.complete
2024-10-15 14:02:59,872 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 14:03:03,032 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 11:03:03 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2980'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'9569'), (b'x-ratelimit-reset-requests', b'8.64s'), (b'x-ratelimit-reset-tokens', b'2.586s'), (b'x-request-id', b'req_4b54c889a8429048c997b2e68a43daa3'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=ZDVkAX3qp7SWOjxtNbPwXt769APvOYfRvYHZZNVLJXs-1728990183-1.0.1.1-2bHPtn_912KdAGfbGtMTu4fimQ_l5nNolmknhOUa0b0J4psYw0wD44dWvdOB5pQgi2QCbC4ToLnijMAZ4EFxag; path=/; expires=Tue, 15-Oct-24 11:33:03 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=bbXHoPSdolKe3Bzf7.kSD4xIM5mvDCNV9EQkKEcQOe4-1728990183650-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f51f41d5a6253-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 14:03:03,033 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 14:03:03,033 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 14:03:03,033 - DEBUG - receive_response_body.complete
2024-10-15 14:03:03,033 - DEBUG - response_closed.started
2024-10-15 14:03:03,033 - DEBUG - response_closed.complete
2024-10-15 14:03:03,033 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Tue, 15 Oct 2024 11:03:03 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-kzzh9hik9ryjiou4ftvhondh'), ('openai-processing-ms', '2980'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '10000'), ('x-ratelimit-remaining-requests', '9999'), ('x-ratelimit-remaining-tokens', '9569'), ('x-ratelimit-reset-requests', '8.64s'), ('x-ratelimit-reset-tokens', '2.586s'), ('x-request-id', 'req_4b54c889a8429048c997b2e68a43daa3'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=ZDVkAX3qp7SWOjxtNbPwXt769APvOYfRvYHZZNVLJXs-1728990183-1.0.1.1-2bHPtn_912KdAGfbGtMTu4fimQ_l5nNolmknhOUa0b0J4psYw0wD44dWvdOB5pQgi2QCbC4ToLnijMAZ4EFxag; path=/; expires=Tue, 15-Oct-24 11:33:03 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=bbXHoPSdolKe3Bzf7.kSD4xIM5mvDCNV9EQkKEcQOe4-1728990183650-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d2f51f41d5a6253-OTP'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-15 14:03:03,033 - DEBUG - request_id: req_4b54c889a8429048c997b2e68a43daa3
2024-10-15 14:03:03,035 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZcKlYJR1brSnqOUau2vHlqDXOpm', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_O0M7E57SmwERcHyQfx5DKewZ', function=Function(arguments='{\n  "content": [\n    {\n      "name": "ISPILANTE SENTIMENT BRUSLI",\n      "address": "Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR"\n    }\n  ]\n}', name='Response'), type='function')]))], created=1728990180, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=67, prompt_tokens=473, total_tokens=540, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 14:03:03,036 - DEBUG - Returning model from AdapterBase
2024-10-15 14:03:10,173 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'instructor.dsl.simple_type.Response'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Determine_contract_type: Determine the type of contract to be created.\n3. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}}
2024-10-15 14:03:10,173 - DEBUG - max_retries: 1
2024-10-15 14:03:10,175 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Determine_contract_type: Determine the type of contract to be created.\n3. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}, 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}]}}
2024-10-15 14:03:10,176 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 14:03:10,176 - DEBUG - close.started
2024-10-15 14:03:10,177 - DEBUG - close.complete
2024-10-15 14:03:10,177 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-15 14:03:10,181 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000002C0E80A4170>
2024-10-15 14:03:10,181 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x000002C0E7F7E850> server_hostname='api.openai.com' timeout=5.0
2024-10-15 14:03:10,188 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000002C0E7E05D30>
2024-10-15 14:03:10,188 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 14:03:10,188 - DEBUG - send_request_headers.complete
2024-10-15 14:03:10,188 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 14:03:10,188 - DEBUG - send_request_body.complete
2024-10-15 14:03:10,188 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 14:03:12,744 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 11:03:13 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2398'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9999'), (b'x-ratelimit-remaining-tokens', b'9575'), (b'x-ratelimit-reset-requests', b'8.64s'), (b'x-ratelimit-reset-tokens', b'2.55s'), (b'x-request-id', b'req_c8b07dc205a40dae64207f337583b616'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f52348c27c9c8-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 14:03:12,745 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 14:03:12,746 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 14:03:12,746 - DEBUG - receive_response_body.complete
2024-10-15 14:03:12,746 - DEBUG - response_closed.started
2024-10-15 14:03:12,746 - DEBUG - response_closed.complete
2024-10-15 14:03:12,747 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 11:03:13 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '2398', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9999', 'x-ratelimit-remaining-tokens': '9575', 'x-ratelimit-reset-requests': '8.64s', 'x-ratelimit-reset-tokens': '2.55s', 'x-request-id': 'req_c8b07dc205a40dae64207f337583b616', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f52348c27c9c8-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 14:03:12,747 - DEBUG - request_id: req_c8b07dc205a40dae64207f337583b616
2024-10-15 14:03:12,748 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZcV34gpT9LObTsUI35zCGsHzRUB', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_FGHSUWWS4FmHLTFoT1B2CaDY', function=Function(arguments='{\n  "content": [\n    {\n      "name": "ELENA VASILESCU",\n      "address": "Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B"\n    }\n  ]\n}', name='Response'), type='function')]))], created=1728990191, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=56, prompt_tokens=476, total_tokens=532, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 14:03:12,750 - DEBUG - Returning model from AdapterBase
2024-10-15 14:03:13,812 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Determine_contract_type: Determine the type of contract to be created.\n3. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 14:03:13,812 - DEBUG - max_retries: 1
2024-10-15 14:03:13,814 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Determine_contract_type: Determine the type of contract to be created.\n3. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 14:03:13,815 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 14:03:13,815 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 14:03:13,815 - DEBUG - send_request_headers.complete
2024-10-15 14:03:13,815 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 14:03:13,816 - DEBUG - send_request_body.complete
2024-10-15 14:03:13,816 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 14:03:14,647 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 11:03:15 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'684'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9998'), (b'x-ratelimit-remaining-tokens', b'9607'), (b'x-ratelimit-reset-requests', b'13.654s'), (b'x-ratelimit-reset-tokens', b'2.358s'), (b'x-request-id', b'req_a4d896ed60b9347554f8a942bb09af0d'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f524b3febc9c8-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 14:03:14,647 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 14:03:14,647 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 14:03:14,647 - DEBUG - receive_response_body.complete
2024-10-15 14:03:14,647 - DEBUG - response_closed.started
2024-10-15 14:03:14,647 - DEBUG - response_closed.complete
2024-10-15 14:03:14,647 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 11:03:15 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '684', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9998', 'x-ratelimit-remaining-tokens': '9607', 'x-ratelimit-reset-requests': '13.654s', 'x-ratelimit-reset-tokens': '2.358s', 'x-request-id': 'req_a4d896ed60b9347554f8a942bb09af0d', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f524b3febc9c8-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 14:03:14,647 - DEBUG - request_id: req_a4d896ed60b9347554f8a942bb09af0d
2024-10-15 14:03:14,648 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZcY1oqANyyzaa5cWZsIuQRJqXhI', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_xH4TdDOJZ3UbkmyOrlyxjUz5', function=Function(arguments='\n{\n  "action": "Determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728990194, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=13, prompt_tokens=361, total_tokens=374, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 14:03:14,649 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Determine_contract_type: Determine the type of contract to be created.\n3. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 14:03:14,649 - DEBUG - max_retries: 1
2024-10-15 14:03:14,650 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Determine_contract_type: Determine the type of contract to be created.\n3. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 14:03:14,651 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 14:03:14,651 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 14:03:14,651 - DEBUG - send_request_headers.complete
2024-10-15 14:03:14,651 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 14:03:14,651 - DEBUG - send_request_body.complete
2024-10-15 14:03:14,651 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 14:03:15,542 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 11:03:16 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'740'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9997'), (b'x-ratelimit-remaining-tokens', b'9372'), (b'x-ratelimit-reset-requests', b'21.458s'), (b'x-ratelimit-reset-tokens', b'3.765s'), (b'x-request-id', b'req_080c9714d6624a324e8e3510b77340cc'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f5250786cc9c8-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 14:03:15,543 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 14:03:15,543 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 14:03:15,543 - DEBUG - receive_response_body.complete
2024-10-15 14:03:15,543 - DEBUG - response_closed.started
2024-10-15 14:03:15,543 - DEBUG - response_closed.complete
2024-10-15 14:03:15,543 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 11:03:16 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '740', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9997', 'x-ratelimit-remaining-tokens': '9372', 'x-ratelimit-reset-requests': '21.458s', 'x-ratelimit-reset-tokens': '3.765s', 'x-request-id': 'req_080c9714d6624a324e8e3510b77340cc', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f5250786cc9c8-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 14:03:15,543 - DEBUG - request_id: req_080c9714d6624a324e8e3510b77340cc
2024-10-15 14:03:15,544 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZcZEDcuKcb7qMJtKrPXTGr0lwQ9', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_V0HdoS3hWHUPSokMmEduv0go', function=Function(arguments='{\n  "action": "Determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728990195, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=12, prompt_tokens=361, total_tokens=373, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 14:03:15,546 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Determine_contract_type: Determine the type of contract to be created.\n3. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 14:03:15,546 - DEBUG - max_retries: 1
2024-10-15 14:03:15,548 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Determine_contract_type: Determine the type of contract to be created.\n3. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 14:03:15,548 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 14:03:15,548 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 14:03:15,549 - DEBUG - send_request_headers.complete
2024-10-15 14:03:15,549 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 14:03:15,549 - DEBUG - send_request_body.complete
2024-10-15 14:03:15,549 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 14:03:16,934 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 11:03:17 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1237'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9996'), (b'x-ratelimit-remaining-tokens', b'9149'), (b'x-ratelimit-reset-requests', b'29.198s'), (b'x-ratelimit-reset-tokens', b'5.103s'), (b'x-request-id', b'req_e793db300c64c3710e274724ab7d01bf'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f525619e8c9c8-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 14:03:16,935 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 14:03:16,935 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 14:03:16,935 - DEBUG - receive_response_body.complete
2024-10-15 14:03:16,935 - DEBUG - response_closed.started
2024-10-15 14:03:16,935 - DEBUG - response_closed.complete
2024-10-15 14:03:16,935 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 11:03:17 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1237', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9996', 'x-ratelimit-remaining-tokens': '9149', 'x-ratelimit-reset-requests': '29.198s', 'x-ratelimit-reset-tokens': '5.103s', 'x-request-id': 'req_e793db300c64c3710e274724ab7d01bf', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f525619e8c9c8-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 14:03:16,935 - DEBUG - request_id: req_e793db300c64c3710e274724ab7d01bf
2024-10-15 14:03:16,935 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZcaZXByzspMhPuxsuu622ztXWsH', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_zjfZzML4cppz0vPIE2QaHojg', function=Function(arguments='\n{\n  "action": "Determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728990196, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=13, prompt_tokens=361, total_tokens=374, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 14:03:16,937 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Determine_contract_type: Determine the type of contract to be created.\n3. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 14:03:16,937 - DEBUG - max_retries: 1
2024-10-15 14:03:16,938 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Determine_contract_type: Determine the type of contract to be created.\n3. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 14:03:16,938 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 14:03:16,938 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 14:03:16,939 - DEBUG - send_request_headers.complete
2024-10-15 14:03:16,939 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 14:03:16,939 - DEBUG - send_request_body.complete
2024-10-15 14:03:16,939 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 14:03:18,122 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 11:03:18 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'1025'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9995'), (b'x-ratelimit-remaining-tokens', b'9007'), (b'x-ratelimit-reset-requests', b'36.446s'), (b'x-ratelimit-reset-tokens', b'5.955s'), (b'x-request-id', b'req_100874418b4f3502d73656251b13bf75'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f525ecca0c9c8-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 14:03:18,122 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 14:03:18,122 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 14:03:18,122 - DEBUG - receive_response_body.complete
2024-10-15 14:03:18,122 - DEBUG - response_closed.started
2024-10-15 14:03:18,122 - DEBUG - response_closed.complete
2024-10-15 14:03:18,122 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 11:03:18 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '1025', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9995', 'x-ratelimit-remaining-tokens': '9007', 'x-ratelimit-reset-requests': '36.446s', 'x-ratelimit-reset-tokens': '5.955s', 'x-request-id': 'req_100874418b4f3502d73656251b13bf75', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f525ecca0c9c8-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 14:03:18,122 - DEBUG - request_id: req_100874418b4f3502d73656251b13bf75
2024-10-15 14:03:18,123 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZcbPHTXoOp48cwnbjgQ1IHNQKPw', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_IiQGdWUpGmMaj8KWXNrVI30f', function=Function(arguments='{\n  "action": "Determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728990197, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=12, prompt_tokens=361, total_tokens=373, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 14:03:18,124 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Determine_contract_type: Determine the type of contract to be created.\n3. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 14:03:18,124 - DEBUG - max_retries: 1
2024-10-15 14:03:18,125 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Determine_contract_type: Determine the type of contract to be created.\n3. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 14:03:18,126 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 14:03:18,126 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 14:03:18,126 - DEBUG - send_request_headers.complete
2024-10-15 14:03:18,126 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 14:03:18,126 - DEBUG - send_request_body.complete
2024-10-15 14:03:18,126 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 14:03:18,916 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 11:03:19 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'634'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9994'), (b'x-ratelimit-remaining-tokens', b'8832'), (b'x-ratelimit-reset-requests', b'43.894s'), (b'x-ratelimit-reset-tokens', b'7.002s'), (b'x-request-id', b'req_1ad7beead24b1181a501bd4977d06aed'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f52662c02c9c8-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 14:03:18,917 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 14:03:18,917 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 14:03:18,917 - DEBUG - receive_response_body.complete
2024-10-15 14:03:18,917 - DEBUG - response_closed.started
2024-10-15 14:03:18,918 - DEBUG - response_closed.complete
2024-10-15 14:03:18,918 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 11:03:19 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '634', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9994', 'x-ratelimit-remaining-tokens': '8832', 'x-ratelimit-reset-requests': '43.894s', 'x-ratelimit-reset-tokens': '7.002s', 'x-request-id': 'req_1ad7beead24b1181a501bd4977d06aed', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f52662c02c9c8-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 14:03:18,918 - DEBUG - request_id: req_1ad7beead24b1181a501bd4977d06aed
2024-10-15 14:03:18,919 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZccOLbzuCsBmhYeZGj2CHcFBEJK', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_LJ6HMti0VXURY6FqUTurMjzo', function=Function(arguments='\n{\n  "action": "Determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728990198, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=13, prompt_tokens=361, total_tokens=374, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 14:03:18,921 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Determine_contract_type: Determine the type of contract to be created.\n3. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 14:03:18,921 - DEBUG - max_retries: 1
2024-10-15 14:03:18,924 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Determine_contract_type: Determine the type of contract to be created.\n3. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 14:03:18,925 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 14:03:18,925 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 14:03:18,925 - DEBUG - send_request_headers.complete
2024-10-15 14:03:18,925 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 14:03:18,925 - DEBUG - send_request_body.complete
2024-10-15 14:03:18,925 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 14:03:20,015 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 11:03:20 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'939'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9994'), (b'x-ratelimit-remaining-tokens', b'8591'), (b'x-ratelimit-reset-requests', b'51.742s'), (b'x-ratelimit-reset-tokens', b'8.453s'), (b'x-request-id', b'req_a9f74e5218d82695c2a5b67646c36e3a'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f526b2d56c9c8-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 14:03:20,017 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 14:03:20,017 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 14:03:20,018 - DEBUG - receive_response_body.complete
2024-10-15 14:03:20,018 - DEBUG - response_closed.started
2024-10-15 14:03:20,018 - DEBUG - response_closed.complete
2024-10-15 14:03:20,018 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 11:03:20 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '939', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9994', 'x-ratelimit-remaining-tokens': '8591', 'x-ratelimit-reset-requests': '51.742s', 'x-ratelimit-reset-tokens': '8.453s', 'x-request-id': 'req_a9f74e5218d82695c2a5b67646c36e3a', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f526b2d56c9c8-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 14:03:20,019 - DEBUG - request_id: req_a9f74e5218d82695c2a5b67646c36e3a
2024-10-15 14:03:20,020 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZcdV3Ffq5gqsoeCOtG4cHbUJmMb', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_8ghY0LC6oeG411bi5cmJp4KD', function=Function(arguments='{\n  "action": "Determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728990199, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=12, prompt_tokens=361, total_tokens=373, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 14:03:20,022 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Determine_contract_type: Determine the type of contract to be created.\n3. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 14:03:20,022 - DEBUG - max_retries: 1
2024-10-15 14:03:20,024 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Determine_contract_type: Determine the type of contract to be created.\n3. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 14:03:20,025 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 14:03:20,025 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 14:03:20,025 - DEBUG - send_request_headers.complete
2024-10-15 14:03:20,025 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 14:03:20,025 - DEBUG - send_request_body.complete
2024-10-15 14:03:20,025 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 14:03:20,987 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 11:03:21 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'810'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9993'), (b'x-ratelimit-remaining-tokens', b'8401'), (b'x-ratelimit-reset-requests', b'59.283s'), (b'x-ratelimit-reset-tokens', b'9.592s'), (b'x-request-id', b'req_5f32274a8d720300de20d1a004f0812d'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f52720addc9c8-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 14:03:20,987 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 14:03:20,988 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 14:03:20,988 - DEBUG - receive_response_body.complete
2024-10-15 14:03:20,988 - DEBUG - response_closed.started
2024-10-15 14:03:20,989 - DEBUG - response_closed.complete
2024-10-15 14:03:20,989 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 11:03:21 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '810', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9993', 'x-ratelimit-remaining-tokens': '8401', 'x-ratelimit-reset-requests': '59.283s', 'x-ratelimit-reset-tokens': '9.592s', 'x-request-id': 'req_5f32274a8d720300de20d1a004f0812d', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f52720addc9c8-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 14:03:20,989 - DEBUG - request_id: req_5f32274a8d720300de20d1a004f0812d
2024-10-15 14:03:20,991 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZcedxld1VuEHSPWogbtzQYQCwSV', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_bVt5COy5LL3e6kYSqNdSIb97', function=Function(arguments='\n{\n  "action": "Determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728990200, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=13, prompt_tokens=361, total_tokens=374, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 14:03:20,993 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Determine_contract_type: Determine the type of contract to be created.\n3. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 14:03:20,994 - DEBUG - max_retries: 1
2024-10-15 14:03:20,995 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Determine_contract_type: Determine the type of contract to be created.\n3. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 14:03:20,995 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 14:03:20,995 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 14:03:20,996 - DEBUG - send_request_headers.complete
2024-10-15 14:03:20,996 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 14:03:20,996 - DEBUG - send_request_body.complete
2024-10-15 14:03:20,996 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 14:03:22,142 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 11:03:22 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'920'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9992'), (b'x-ratelimit-remaining-tokens', b'8198'), (b'x-ratelimit-reset-requests', b'1m6.895s'), (b'x-ratelimit-reset-tokens', b'10.808s'), (b'x-request-id', b'req_ce783b759991d78b3d5664adfae800ce'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f52781d4dc9c8-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 14:03:22,142 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 14:03:22,142 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 14:03:22,142 - DEBUG - receive_response_body.complete
2024-10-15 14:03:22,142 - DEBUG - response_closed.started
2024-10-15 14:03:22,142 - DEBUG - response_closed.complete
2024-10-15 14:03:22,142 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 11:03:22 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '920', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9992', 'x-ratelimit-remaining-tokens': '8198', 'x-ratelimit-reset-requests': '1m6.895s', 'x-ratelimit-reset-tokens': '10.808s', 'x-request-id': 'req_ce783b759991d78b3d5664adfae800ce', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f52781d4dc9c8-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 14:03:22,142 - DEBUG - request_id: req_ce783b759991d78b3d5664adfae800ce
2024-10-15 14:03:22,143 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZcfOiyZ4t47m3yFndm0rznKjKFD', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_HyCp9UxxjtnHYa4fgbQJctKa', function=Function(arguments='\n{\n  "action": "Determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728990201, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=13, prompt_tokens=361, total_tokens=374, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 14:03:22,144 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Determine_contract_type: Determine the type of contract to be created.\n3. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 14:03:22,144 - DEBUG - max_retries: 1
2024-10-15 14:03:22,145 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. Extract_pii: Extract personal identifiable information (PII) from documents.\n2. Determine_contract_type: Determine the type of contract to be created.\n3. Identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 14:03:22,146 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 14:03:22,146 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 14:03:22,146 - DEBUG - send_request_headers.complete
2024-10-15 14:03:22,146 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 14:03:22,146 - DEBUG - send_request_body.complete
2024-10-15 14:03:22,146 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 14:03:23,173 - DEBUG - receive_response_headers.failed exception=KeyboardInterrupt()
2024-10-15 14:03:23,173 - DEBUG - response_closed.started
2024-10-15 14:03:23,174 - DEBUG - response_closed.complete
2024-10-15 14:03:23,353 - ERROR - Task exception was never retrieved
future: <Task finished name='Task-1' coro=<agent_workflow() done, defined at D:\deve\contract_automation\src\main.py:26> exception=KeyboardInterrupt()>
Traceback (most recent call last):
  File "D:\deve\contract_automation\src\main.py", line 100, in <module>
    asyncio.run(agent_workflow())
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 30, in run
    return loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 92, in run_until_complete
    self._run_once()
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 133, in _run_once
    handle._run()
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 386, in __wakeup
    self.__step()
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 293, in __step
    self.__step_run_and_handle_result(exc)
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 304, in __step_run_and_handle_result
    result = coro.send(None)
             ^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\src\main.py", line 42, in agent_workflow
    action = agent_action(state, templates)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\src\ai_functions.py", line 194, in agent_action
    response = client.chat.completions.create(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\instructor\patch.py", line 291, in new_create_sync
    response = retry_sync(
               ^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\instructor\retry.py", line 189, in retry_sync
    for attempt in max_retries:
  File "D:\deve\contract_automation\.venv\Lib\site-packages\tenacity\__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\tenacity\__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\tenacity\__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\deve\contract_automation\.venv\Lib\site-packages\instructor\retry.py", line 192, in retry_sync
    response = func(*args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\openai\_utils\_utils.py", line 274, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\openai\resources\chat\completions.py", line 742, in create
    return self._post(
           ^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\openai\_base_client.py", line 1270, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\openai\_base_client.py", line 947, in request
    return self._request(
           ^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\openai\_base_client.py", line 983, in _request
    response = self._client.send(
               ^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpx\_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpx\_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpx\_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpx\_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpx\_transports\default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpcore\_sync\connection_pool.py", line 216, in handle_request
    raise exc from None
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpcore\_sync\connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpcore\_sync\connection.py", line 101, in handle_request
    return self._connection.handle_request(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpcore\_sync\http11.py", line 143, in handle_request
    raise exc
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpcore\_sync\http11.py", line 113, in handle_request
    ) = self._receive_response_headers(**kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpcore\_sync\http11.py", line 186, in _receive_response_headers
    event = self._receive_event(timeout=timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpcore\_sync\http11.py", line 224, in _receive_event
    data = self._network_stream.read(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\httpcore\_backends\sync.py", line 126, in read
    return self._sock.recv(max_bytes)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\ssl.py", line 1234, in recv
    return self.read(buflen)
           ^^^^^^^^^^^^^^^^^
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\ssl.py", line 1107, in read
    return self._sslobj.read(len)
           ^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
2024-10-15 14:03:58,867 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2024-10-15 14:04:00,125 - DEBUG - load_ssl_context verify=True cert=None trust_env=True http2=False
2024-10-15 14:04:00,125 - DEBUG - load_verify_locations cafile='D:\\deve\\contract_automation\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2024-10-15 14:04:00,438 - DEBUG - Patching `client.chat.completions.create` with mode=<Mode.TOOLS: 'tool_call'>
2024-10-15 14:04:00,439 - DEBUG - Using proactor: IocpProactor
2024-10-15 14:04:00,465 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 14:04:00,465 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 14:04:00,465 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 14:04:00,465 - DEBUG - Compression method 0
2024-10-15 14:04:00,465 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 14:04:00,465 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 14:04:00,465 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 14:04:00,466 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 14:04:00,466 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 14:04:00,466 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 14:04:00,466 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 14:04:00,466 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 14:04:00,466 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 14:04:00,466 - DEBUG - Compression method 0
2024-10-15 14:04:00,466 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 14:04:00,466 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 14:04:00,466 - DEBUG - STREAM b'iTXt' 3376 470
2024-10-15 14:04:00,466 - DEBUG - STREAM b'iDOT' 3858 28
2024-10-15 14:04:00,466 - DEBUG - b'iDOT' 3858 28 (unknown)
2024-10-15 14:04:00,466 - DEBUG - STREAM b'IDAT' 3898 16384
2024-10-15 14:04:00,475 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 14:04:00,475 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 14:04:00,475 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 14:04:00,475 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 14:04:00,476 - DEBUG - Error closing: Operation on closed image
2024-10-15 14:04:02,485 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 14:04:02,485 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 14:04:02,485 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 14:04:02,485 - DEBUG - Compression method 0
2024-10-15 14:04:02,485 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 14:04:02,485 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 14:04:02,485 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 14:04:02,485 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 14:04:02,485 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 14:04:02,485 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 14:04:02,485 - DEBUG - STREAM b'IHDR' 16 13
2024-10-15 14:04:02,485 - DEBUG - STREAM b'iCCP' 41 3152
2024-10-15 14:04:02,485 - DEBUG - iCCP profile name b'ICC Profile'
2024-10-15 14:04:02,485 - DEBUG - Compression method 0
2024-10-15 14:04:02,485 - DEBUG - STREAM b'eXIf' 3205 138
2024-10-15 14:04:02,485 - DEBUG - STREAM b'pHYs' 3355 9
2024-10-15 14:04:02,485 - DEBUG - STREAM b'iTXt' 3376 471
2024-10-15 14:04:02,486 - DEBUG - STREAM b'iDOT' 3859 28
2024-10-15 14:04:02,486 - DEBUG - b'iDOT' 3859 28 (unknown)
2024-10-15 14:04:02,486 - DEBUG - STREAM b'IDAT' 3899 16384
2024-10-15 14:04:02,503 - DEBUG - tag: XResolution (282) - type: rational (5) Tag Location: 22 - Data Location: 62 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 14:04:02,503 - DEBUG - tag: YResolution (283) - type: rational (5) Tag Location: 34 - Data Location: 70 - value: b'\x00\x00\x00\x90\x00\x00\x00\x01'
2024-10-15 14:04:02,503 - DEBUG - tag: ResolutionUnit (296) - type: short (3) - value: b'\x00\x02'
2024-10-15 14:04:02,503 - DEBUG - tag: ExifIFD (34665) - type: long (4) - value: b'\x00\x00\x00N'
2024-10-15 14:04:02,504 - DEBUG - Error closing: Operation on closed image
2024-10-15 14:04:05,015 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'instructor.dsl.simple_type.Response'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}}
2024-10-15 14:04:05,016 - DEBUG - max_retries: 1
2024-10-15 14:04:05,018 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROMAWI ROMANIA Carte CARTE De |Dentitate IDEnTITY D'iDENTITE seria TR Na 409131 CarD cNP 1891113341181 Nume/Nom/Last name T525M ISPILANTE Prenume/Prenom/First namo SENTIMENT BRUSLI Cetatenle/Nallonallte/Nallonallly Sox SexeiSox Romn\u0103 ROU M Loc nastere/Liou do naissancelPlace ol birth Or\u0219. Videle Jud.Teleorman Dom IlulAdresse/Addrass Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR Emisa dolDelivree parlIssuad by ValabilltatelValldlte Valldlty SPCLEP Videle 04.11.11-13.11.2018 IDROUISPILANTE<<SENTIMENT <BRUSLI<<<< TR409131<0R0u8911137M181113513411813 Or\u0219:"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}, 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}]}}
2024-10-15 14:04:05,056 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 14:04:05,056 - DEBUG - connect_tcp.started host='api.openai.com' port=443 local_address=None timeout=5.0 socket_options=None
2024-10-15 14:04:05,089 - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x00000279B7D102F0>
2024-10-15 14:04:05,089 - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x00000279B7BCE850> server_hostname='api.openai.com' timeout=5.0
2024-10-15 14:04:05,098 - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x00000279B7D36BD0>
2024-10-15 14:04:05,098 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 14:04:05,098 - DEBUG - send_request_headers.complete
2024-10-15 14:04:05,098 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 14:04:05,099 - DEBUG - send_request_body.complete
2024-10-15 14:04:05,099 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 14:04:07,941 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 11:04:08 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2692'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9995'), (b'x-ratelimit-remaining-tokens', b'9569'), (b'x-ratelimit-reset-requests', b'40.129s'), (b'x-ratelimit-reset-tokens', b'2.586s'), (b'x-request-id', b'req_121c58f1e52b7c97707de4e68cac4d95'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=_01qDJYDWndKn7S6eAqwFsw2bZx2aLbzoWAdKXh3_MM-1728990248-1.0.1.1-6iLcYKmpWqjILbJpdlCzQeyFd6n8dy2zFTXgE71AC4dVzMPUGywl7ePuST1Vf0q3M_14.vjK3OxmdWWpicF4Ow; path=/; expires=Tue, 15-Oct-24 11:34:08 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'X-Content-Type-Options', b'nosniff'), (b'Set-Cookie', b'_cfuvid=Jw1zRZx5tzDRZvCe6_k7iRmiO5RNGiQFRtPTFHhqeCM-1728990248560-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f538bcf26ca1d-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 14:04:07,943 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 14:04:07,944 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 14:04:07,944 - DEBUG - receive_response_body.complete
2024-10-15 14:04:07,945 - DEBUG - response_closed.started
2024-10-15 14:04:07,945 - DEBUG - response_closed.complete
2024-10-15 14:04:07,945 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers([('date', 'Tue, 15 Oct 2024 11:04:08 GMT'), ('content-type', 'application/json'), ('transfer-encoding', 'chunked'), ('connection', 'keep-alive'), ('access-control-expose-headers', 'X-Request-ID'), ('openai-organization', 'user-kzzh9hik9ryjiou4ftvhondh'), ('openai-processing-ms', '2692'), ('openai-version', '2020-10-01'), ('x-ratelimit-limit-requests', '10000'), ('x-ratelimit-limit-tokens', '10000'), ('x-ratelimit-remaining-requests', '9995'), ('x-ratelimit-remaining-tokens', '9569'), ('x-ratelimit-reset-requests', '40.129s'), ('x-ratelimit-reset-tokens', '2.586s'), ('x-request-id', 'req_121c58f1e52b7c97707de4e68cac4d95'), ('strict-transport-security', 'max-age=31536000; includeSubDomains; preload'), ('cf-cache-status', 'DYNAMIC'), ('set-cookie', '__cf_bm=_01qDJYDWndKn7S6eAqwFsw2bZx2aLbzoWAdKXh3_MM-1728990248-1.0.1.1-6iLcYKmpWqjILbJpdlCzQeyFd6n8dy2zFTXgE71AC4dVzMPUGywl7ePuST1Vf0q3M_14.vjK3OxmdWWpicF4Ow; path=/; expires=Tue, 15-Oct-24 11:34:08 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('x-content-type-options', 'nosniff'), ('set-cookie', '_cfuvid=Jw1zRZx5tzDRZvCe6_k7iRmiO5RNGiQFRtPTFHhqeCM-1728990248560-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None'), ('server', 'cloudflare'), ('cf-ray', '8d2f538bcf26ca1d-OTP'), ('content-encoding', 'gzip'), ('alt-svc', 'h3=":443"; ma=86400')])
2024-10-15 14:04:07,945 - DEBUG - request_id: req_121c58f1e52b7c97707de4e68cac4d95
2024-10-15 14:04:07,948 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZdNjkw5TgRw41UhuDjuwHnOcJ5T', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_qqZ33GZAmMABVpyh50lHYV0H', function=Function(arguments='{\n  "content": [\n    {\n      "name": "ISPILANTE SENTIMENT BRUSLI",\n      "address": "Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR"\n    }\n  ]\n}', name='Response'), type='function')]))], created=1728990245, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=53, prompt_tokens=473, total_tokens=526, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 14:04:07,948 - DEBUG - Returning model from AdapterBase
2024-10-15 14:04:09,950 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'instructor.dsl.simple_type.Response'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}}
2024-10-15 14:04:09,950 - DEBUG - max_retries: 1
2024-10-15 14:04:09,952 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': "Extract personal identifiable information from the following text:\n\nROUMANIE ROVIAINIA ROMANIA Carte Carte DE iDentitate IdEnTITY Didentite seala SS Nr 099994 Card CNP 2410415400542 93coQ Nume/NomiLast name VASILESCU Pronume/Prenom/Flrst name ELENA < CetatenielNatlonallte/Natlonalily M Sex SexelSer Romn\u0103 ROU Loc nastore/Licu de naissancolF 'ar0 ol birth Mun: Dej Jud. Cluj Domiciliu/Adresse A ess Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B Emisa delDelivree parllssued by Valabilitate/Vahidile Valiouy D.EPAB.D- 06.01.17-15.04.2077 IDROUVASILESCU<<ELENA<<<<<<<<<<<<<<< SS099994<0R0u4104151F770415824003421"}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'Response'}}, 'tools': [{'type': 'function', 'function': {'name': 'Response', 'description': 'Correctly Formated and Extracted Response.', 'parameters': {'$defs': {'PIIData': {'properties': {'name': {'description': 'Full name of the person', 'title': 'Name', 'type': 'string'}, 'address': {'description': 'Residential address of the person', 'title': 'Address', 'type': 'string'}}, 'required': ['name', 'address'], 'title': 'PIIData', 'type': 'object'}}, 'properties': {'content': {'items': {'$ref': '#/$defs/PIIData'}, 'title': 'Content', 'type': 'array'}}, 'required': ['content'], 'type': 'object'}}}]}}
2024-10-15 14:04:09,952 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 14:04:09,953 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 14:04:09,953 - DEBUG - send_request_headers.complete
2024-10-15 14:04:09,953 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 14:04:09,953 - DEBUG - send_request_body.complete
2024-10-15 14:04:09,953 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 14:04:12,384 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 11:04:13 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2267'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9994'), (b'x-ratelimit-remaining-tokens', b'9575'), (b'x-ratelimit-reset-requests', b'43.913s'), (b'x-ratelimit-reset-tokens', b'2.55s'), (b'x-request-id', b'req_e7a9e81a5db7486efd33d9e9f5684442'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f53aa1ab6ca1d-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 14:04:12,385 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 14:04:12,385 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 14:04:12,386 - DEBUG - receive_response_body.complete
2024-10-15 14:04:12,386 - DEBUG - response_closed.started
2024-10-15 14:04:12,386 - DEBUG - response_closed.complete
2024-10-15 14:04:12,386 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 11:04:13 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '2267', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9994', 'x-ratelimit-remaining-tokens': '9575', 'x-ratelimit-reset-requests': '43.913s', 'x-ratelimit-reset-tokens': '2.55s', 'x-request-id': 'req_e7a9e81a5db7486efd33d9e9f5684442', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f53aa1ab6ca1d-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 14:04:12,387 - DEBUG - request_id: req_e7a9e81a5db7486efd33d9e9f5684442
2024-10-15 14:04:12,388 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZdS3OwdQ3pRSiChOf6KrwvQwm5Y', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_hASOEgNbPokV2lMIu4c3abyr', function=Function(arguments='{\n  "content": [{\n    "name": "ELENA VASILESCU",\n    "address": "Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B"\n  }]\n}', name='Response'), type='function')]))], created=1728990250, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=52, prompt_tokens=476, total_tokens=528, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 14:04:12,389 - DEBUG - Returning model from AdapterBase
2024-10-15 14:04:13,536 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 14:04:13,536 - DEBUG - max_retries: 1
2024-10-15 14:04:13,538 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: No\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 14:04:13,539 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 14:04:13,539 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 14:04:13,539 - DEBUG - send_request_headers.complete
2024-10-15 14:04:13,539 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 14:04:13,539 - DEBUG - send_request_body.complete
2024-10-15 14:04:13,539 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 14:04:14,540 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 11:04:15 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'837'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9994'), (b'x-ratelimit-remaining-tokens', b'9607'), (b'x-ratelimit-reset-requests', b'48.957s'), (b'x-ratelimit-reset-tokens', b'2.358s'), (b'x-request-id', b'req_afe4f0f2ce3b0123e753eeed454b20b4'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f53c08dfcca1d-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 14:04:14,541 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 14:04:14,541 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 14:04:14,542 - DEBUG - receive_response_body.complete
2024-10-15 14:04:14,542 - DEBUG - response_closed.started
2024-10-15 14:04:14,542 - DEBUG - response_closed.complete
2024-10-15 14:04:14,542 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 11:04:15 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '837', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9994', 'x-ratelimit-remaining-tokens': '9607', 'x-ratelimit-reset-requests': '48.957s', 'x-ratelimit-reset-tokens': '2.358s', 'x-request-id': 'req_afe4f0f2ce3b0123e753eeed454b20b4', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f53c08dfcca1d-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 14:04:14,542 - DEBUG - request_id: req_afe4f0f2ce3b0123e753eeed454b20b4
2024-10-15 14:04:14,544 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZdWA3fgioz8zoxYQHmzeGQv3xlX', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_ytwnSPQAQ779cWY6pipMwL4G', function=Function(arguments='\n{\n  "action": "determine_contract_type"\n}', name='AgentAction'), type='function')]))], created=1728990254, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=13, prompt_tokens=361, total_tokens=374, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 14:04:17,266 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.AgentAction'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: Yes\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}}
2024-10-15 14:04:17,266 - DEBUG - max_retries: 1
2024-10-15 14:04:17,268 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    Current state:\n    - Verified PII data: 2 entries\n    - Contract type determined: Yes\n    - Parties identified: No\n    - Contract constructed: No\n    Available templates: airbnb.txt, buy-sell.agreement.txt, it.consulting.txt\n    \nBased on the current state and available templates, determine the next action to take in the contract creation process. If the contract type is not determined, suggest asking the human for the contract type. Provide a detailed explanation for your choice.'}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'AgentAction'}}, 'tools': [{'type': 'function', 'function': {'name': 'AgentAction', 'description': 'Correctly extracted `AgentAction` with all the required parameters with correct types', 'parameters': {'properties': {'action': {'description': 'Action to be performed by the agent', 'title': 'Action', 'type': 'string'}, 'parameters': {'additionalProperties': {'type': 'string'}, 'description': 'Parameters for the action', 'title': 'Parameters', 'type': 'object'}}, 'required': ['action', 'parameters'], 'type': 'object'}}}]}}
2024-10-15 14:04:17,269 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 14:04:17,269 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 14:04:17,269 - DEBUG - send_request_headers.complete
2024-10-15 14:04:17,269 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 14:04:17,269 - DEBUG - send_request_body.complete
2024-10-15 14:04:17,269 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 14:04:18,306 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 11:04:18 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'881'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9993'), (b'x-ratelimit-remaining-tokens', b'9607'), (b'x-ratelimit-reset-requests', b'53.877s'), (b'x-ratelimit-reset-tokens', b'2.358s'), (b'x-request-id', b'req_c3216f7e51de06d69fa9f1269b41a087'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f53d7d865ca1d-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 14:04:18,306 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 14:04:18,306 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 14:04:18,306 - DEBUG - receive_response_body.complete
2024-10-15 14:04:18,306 - DEBUG - response_closed.started
2024-10-15 14:04:18,307 - DEBUG - response_closed.complete
2024-10-15 14:04:18,307 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 11:04:18 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '881', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9993', 'x-ratelimit-remaining-tokens': '9607', 'x-ratelimit-reset-requests': '53.877s', 'x-ratelimit-reset-tokens': '2.358s', 'x-request-id': 'req_c3216f7e51de06d69fa9f1269b41a087', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f53d7d865ca1d-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 14:04:18,307 - DEBUG - request_id: req_c3216f7e51de06d69fa9f1269b41a087
2024-10-15 14:04:18,307 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZdaKKODqz3pIXkgPl4BDWiL8QF2', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_vXTMrpAtA3GpADQJQkWGRhaV', function=Function(arguments='\n{\n  "action": "identify_parties"\n}', name='AgentAction'), type='function')]))], created=1728990258, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=12, prompt_tokens=361, total_tokens=373, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 14:04:18,308 - DEBUG - Instructor Request: mode.value='tool_call', response_model=<class 'models.ContractParties'>, new_kwargs={'model': 'gpt-4', 'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    For a it contract, suggest roles for the following parties based on their personal information:\n\n    Name: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B\n\n    Your task is to suggest appropriate roles for each person in the context of a it contract. \n    The human will then confirm or modify these suggestions.\n    '}], 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'$defs': {'ContractParty': {'properties': {'name': {'description': 'Name of the party', 'title': 'Name', 'type': 'string'}, 'role': {'description': 'Role of the party in the contract', 'title': 'Role', 'type': 'string'}}, 'required': ['name', 'role'], 'title': 'ContractParty', 'type': 'object'}}, 'properties': {'parties': {'description': 'List of parties involved in the contract', 'items': {'$ref': '#/$defs/ContractParty'}, 'title': 'Parties', 'type': 'array'}}, 'required': ['parties'], 'type': 'object'}}}], 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}}
2024-10-15 14:04:18,308 - DEBUG - max_retries: 1
2024-10-15 14:04:18,310 - DEBUG - Request options: {'method': 'post', 'url': '/chat/completions', 'files': None, 'json_data': {'messages': [{'role': 'system', 'content': '\nYou are an AI agent specializing in contract creation and personal information extraction. Your role is to guide the process of creating a contract by determining the next best action at each step. \n\nThe possible actions are:\n\n1. extract_pii: Extract personal identifiable information (PII) from documents.\n2. determine_contract_type: Determine the type of contract to be created.\n3. identify_parties: Identify parties and their roles in the contract based on the PII and contract type.\n4. construct_contract: Construct a contract using the provided information and templates.\n5. finish: Complete the contract creation process.\n\nFor each action, provide a structured response that includes the action to be taken and a reason for your choice. Always consider the current state of the process when making your decision.\n\nYour goal is to efficiently guide the contract creation process from start to finish, ensuring all necessary information is collected and verified before constructing the final contract.\n'}, {'role': 'user', 'content': '\n    For a it contract, suggest roles for the following parties based on their personal information:\n\n    Name: ISPILANTE SENTIMENT BRUSLI, Address: Videle Jud: Teleorman Sos. Giurgiului nr.1 695 TR\nName: ELENA VASILESCU, Address: Mun. Bucuresti Sec. 5 Str Nicolae Iorga nr.3 900 B\n\n    Your task is to suggest appropriate roles for each person in the context of a it contract. \n    The human will then confirm or modify these suggestions.\n    '}], 'model': 'gpt-4', 'tool_choice': {'type': 'function', 'function': {'name': 'ContractParties'}}, 'tools': [{'type': 'function', 'function': {'name': 'ContractParties', 'description': 'Correctly extracted `ContractParties` with all the required parameters with correct types', 'parameters': {'$defs': {'ContractParty': {'properties': {'name': {'description': 'Name of the party', 'title': 'Name', 'type': 'string'}, 'role': {'description': 'Role of the party in the contract', 'title': 'Role', 'type': 'string'}}, 'required': ['name', 'role'], 'title': 'ContractParty', 'type': 'object'}}, 'properties': {'parties': {'description': 'List of parties involved in the contract', 'items': {'$ref': '#/$defs/ContractParty'}, 'title': 'Parties', 'type': 'array'}}, 'required': ['parties'], 'type': 'object'}}}]}}
2024-10-15 14:04:18,310 - DEBUG - Sending HTTP Request: POST https://api.openai.com/v1/chat/completions
2024-10-15 14:04:18,310 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-10-15 14:04:18,310 - DEBUG - send_request_headers.complete
2024-10-15 14:04:18,310 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-10-15 14:04:18,310 - DEBUG - send_request_body.complete
2024-10-15 14:04:18,311 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-10-15 14:04:21,224 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Tue, 15 Oct 2024 11:04:21 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'access-control-expose-headers', b'X-Request-ID'), (b'openai-organization', b'user-kzzh9hik9ryjiou4ftvhondh'), (b'openai-processing-ms', b'2758'), (b'openai-version', b'2020-10-01'), (b'x-ratelimit-limit-requests', b'10000'), (b'x-ratelimit-limit-tokens', b'10000'), (b'x-ratelimit-remaining-requests', b'9992'), (b'x-ratelimit-remaining-tokens', b'9419'), (b'x-ratelimit-reset-requests', b'1m1.475s'), (b'x-ratelimit-reset-tokens', b'3.482s'), (b'x-request-id', b'req_b583b49c4827163a4a2606072175d24c'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8d2f53de5ce1ca1d-OTP'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2024-10-15 14:04:21,224 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2024-10-15 14:04:21,225 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-10-15 14:04:21,225 - DEBUG - receive_response_body.complete
2024-10-15 14:04:21,225 - DEBUG - response_closed.started
2024-10-15 14:04:21,225 - DEBUG - response_closed.complete
2024-10-15 14:04:21,225 - DEBUG - HTTP Response: POST https://api.openai.com/v1/chat/completions "200 OK" Headers({'date': 'Tue, 15 Oct 2024 11:04:21 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'access-control-expose-headers': 'X-Request-ID', 'openai-organization': 'user-kzzh9hik9ryjiou4ftvhondh', 'openai-processing-ms': '2758', 'openai-version': '2020-10-01', 'x-ratelimit-limit-requests': '10000', 'x-ratelimit-limit-tokens': '10000', 'x-ratelimit-remaining-requests': '9992', 'x-ratelimit-remaining-tokens': '9419', 'x-ratelimit-reset-requests': '1m1.475s', 'x-ratelimit-reset-tokens': '3.482s', 'x-request-id': 'req_b583b49c4827163a4a2606072175d24c', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'cf-cache-status': 'DYNAMIC', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '8d2f53de5ce1ca1d-OTP', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2024-10-15 14:04:21,225 - DEBUG - request_id: req_b583b49c4827163a4a2606072175d24c
2024-10-15 14:04:21,226 - DEBUG - Instructor Raw Response: ChatCompletion(id='chatcmpl-AIZdboxZ3twRnrDwdw0wINxC0b4Ta', choices=[Choice(finish_reason='stop', index=0, logprobs=None, message=ChatCompletionMessage(content=None, refusal=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_Vdv4q9Y0Ywn0NnqlF2A0oZB3', function=Function(arguments='\n{\n  "parties": [\n    {\n      "name": "ISPILANTE SENTIMENT BRUSLI",\n      "role": "Service Provider"\n    },\n    {\n      "name": "ELENA VASILESCU",\n      "role": "Client"\n    }\n  ]\n}', name='ContractParties'), type='function')]))], created=1728990259, model='gpt-4-0613', object='chat.completion', service_tier=None, system_fingerprint=None, usage=CompletionUsage(completion_tokens=62, prompt_tokens=392, total_tokens=454, completion_tokens_details=None, prompt_tokens_details=None))
2024-10-15 14:04:48,057 - DEBUG - close.started
2024-10-15 14:04:48,058 - DEBUG - close.complete
2024-10-15 14:04:48,058 - ERROR - Task exception was never retrieved
future: <Task finished name='Task-1' coro=<agent_workflow() done, defined at D:\deve\contract_automation\src\main.py:26> exception=KeyboardInterrupt()>
Traceback (most recent call last):
  File "D:\deve\contract_automation\src\main.py", line 100, in <module>
    asyncio.run(agent_workflow())
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 30, in run
    return loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 92, in run_until_complete
    self._run_once()
  File "D:\deve\contract_automation\.venv\Lib\site-packages\nest_asyncio.py", line 133, in _run_once
    handle._run()
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 386, in __wakeup
    self.__step()
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 293, in __step
    self.__step_run_and_handle_result(exc)
  File "C:\Users\neuro\.rye\py\cpython@3.12.0\Lib\asyncio\tasks.py", line 304, in __step_run_and_handle_result
    result = coro.send(None)
             ^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\src\main.py", line 63, in agent_workflow
    state.parties = identify_parties(state.verified_pii_data, state.contract_details.contract_type)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\deve\contract_automation\src\ai_functions.py", line 152, in identify_parties
    confirmation = input(f"Is this role correct for {party.name}? (yes/no): ").lower()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
